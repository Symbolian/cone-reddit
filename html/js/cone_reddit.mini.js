function cond_hide_tutorial(){0==tutorial_counter?$(".tutorial").fadeOut():tutorial_counter-=1}function weird_double_parser(n){var e=$.parseHTML(n);if(e&&e.length>0)var t=$.parseHTML(e[0].data);else var t=e;return t}function show_post(n,e,t){console.log("Selected post '"+e),cond_hide_tutorial();var r=t.split(";-;"),o=r[1],a=r[2],i=r[3],u=r[4];if($("#overview").slideUp(function(){$(".comment_content").fadeOut(function(){$(".post_content").fadeIn()})}),$(".img_content").hide(),$(".movie_content").hide(),""!=i){i.indexOf("://")>-1?domain=i.split("/")[2]:domain=i.split("/")[0],$(".post_content .text_post").hide(),$(".post_content .link_post").show(),$(".post_content .content").hide(),$(".post_content .source").attr("href",i),$(".post_content .domain").html(domain);var c=i.substr(-3).toLowerCase(),l=i.substr(-4).toLowerCase();if($.inArray(c,["jpg","png","gif"])>=0||"jpeg"==l)$(".img_content").show(),$(".img_content").attr("src",i);else if("gifv"==l){var s=i.slice(0,-4)+"webm",f=i.slice(0,-4)+"mp4";$(".movie_content").html("<video class='img-responsive' autoplay='' loop='' muted='' preload=''><source src='"+s+"' type='video/webm'><source src='"+f+"' type='video/mp4'></video>"),$(".movie_content").show()}}else $(".post_content .text_post").show(),$(".post_content .link_post").hide(),""!=u?($(".post_content .content").show(),$(".post_content .content").html(""),$(".post_content .content").append(weird_double_parser(u))):$(".post_content .content").hide();$(".post_content .title").html(e),$(".post_content .score").html(n),$(".post_content .permalink").attr("href",a),$(".post_content .author").html(o)}function show_comment(n,e){var t=e.split(";-;"),r=t[1],o=t[2],a=t[3];cond_hide_tutorial(),$("#overview").slideUp(function(){$(".post_content .content").slideUp(function(){$(".comment_content").fadeIn()})}),$(".comment_content .score").html(a),$(".comment_content .author").html(n),$(".comment_content .content").html(""),$(".comment_content .content").append(weird_double_parser(o));var i=$(".post_content .permalink").attr("href")+r;$(".comment_content .source").attr("href",i)}function show_subreddit(n){console.log("Selected subreddit '"+n+"'"),$(".post_content").fadeOut(function(){$(".comment_content").fadeOut(function(){$("#overview").slideDown()})}),$(".subreddit_list li").removeClass("bg-primary"),$(".subreddit_list strong:contains('"+n+"')").parent().addClass("bg-primary")}!function(n,e){"object"==typeof module&&"object"==typeof module.exports?module.exports=n.document?e(n,!0):function(n){if(!n.document)throw new Error("jQuery requires a window with a document");return e(n)}:e(n)}("undefined"!=typeof window?window:this,function(n,e){function t(n){var e="length"in n&&n.length,t=on.type(n);return"function"===t||on.isWindow(n)?!1:1===n.nodeType&&e?!0:"array"===t||0===e||"number"==typeof e&&e>0&&e-1 in n}function r(n,e,t){if(on.isFunction(e))return on.grep(n,function(n,r){return!!e.call(n,r,n)!==t});if(e.nodeType)return on.grep(n,function(n){return n===e!==t});if("string"==typeof e){if(vn.test(e))return on.filter(e,n,t);e=on.filter(e,n)}return on.grep(n,function(n){return on.inArray(n,e)>=0!==t})}function o(n,e){do n=n[e];while(n&&1!==n.nodeType);return n}function a(n){var e=Pn[n]={};return on.each(n.match(Sn)||[],function(n,t){e[t]=!0}),e}function i(){hn.addEventListener?(hn.removeEventListener("DOMContentLoaded",u,!1),n.removeEventListener("load",u,!1)):(hn.detachEvent("onreadystatechange",u),n.detachEvent("onload",u))}function u(){(hn.addEventListener||"load"===event.type||"complete"===hn.readyState)&&(i(),on.ready())}function c(n,e,t){if(void 0===t&&1===n.nodeType){var r="data-"+e.replace(xn,"-$1").toLowerCase();if(t=n.getAttribute(r),"string"==typeof t){try{t="true"===t?!0:"false"===t?!1:"null"===t?null:+t+""===t?+t:En.test(t)?on.parseJSON(t):t}catch(o){}on.data(n,e,t)}else t=void 0}return t}function l(n){var e;for(e in n)if(("data"!==e||!on.isEmptyObject(n[e]))&&"toJSON"!==e)return!1;return!0}function s(n,e,t,r){if(on.acceptData(n)){var o,a,i=on.expando,u=n.nodeType,c=u?on.cache:n,l=u?n[i]:n[i]&&i;if(l&&c[l]&&(r||c[l].data)||void 0!==t||"string"!=typeof e)return l||(l=u?n[i]=q.pop()||on.guid++:i),c[l]||(c[l]=u?{}:{toJSON:on.noop}),"object"!=typeof e&&"function"!=typeof e||(r?c[l]=on.extend(c[l],e):c[l].data=on.extend(c[l].data,e)),a=c[l],r||(a.data||(a.data={}),a=a.data),void 0!==t&&(a[on.camelCase(e)]=t),"string"==typeof e?(o=a[e],null==o&&(o=a[on.camelCase(e)])):o=a,o}}function f(n,e,t){if(on.acceptData(n)){var r,o,a=n.nodeType,i=a?on.cache:n,u=a?n[on.expando]:on.expando;if(i[u]){if(e&&(r=t?i[u]:i[u].data)){on.isArray(e)?e=e.concat(on.map(e,on.camelCase)):e in r?e=[e]:(e=on.camelCase(e),e=e in r?[e]:e.split(" ")),o=e.length;for(;o--;)delete r[e[o]];if(t?!l(r):!on.isEmptyObject(r))return}(t||(delete i[u].data,l(i[u])))&&(a?on.cleanData([n],!0):tn.deleteExpando||i!=i.window?delete i[u]:i[u]=null)}}}function d(){return!0}function v(){return!1}function m(){try{return hn.activeElement}catch(n){}}function h(n){var e=kn.split("|"),t=n.createDocumentFragment();if(t.createElement)for(;e.length;)t.createElement(e.pop());return t}function p(n,e){var t,r,o=0,a=typeof n.getElementsByTagName!==bn?n.getElementsByTagName(e||"*"):typeof n.querySelectorAll!==bn?n.querySelectorAll(e||"*"):void 0;if(!a)for(a=[],t=n.childNodes||n;null!=(r=t[o]);o++)!e||on.nodeName(r,e)?a.push(r):on.merge(a,p(r,e));return void 0===e||e&&on.nodeName(n,e)?on.merge([n],a):a}function w(n){Dn.test(n.type)&&(n.defaultChecked=n.checked)}function g(n,e){return on.nodeName(n,"table")&&on.nodeName(11!==e.nodeType?e:e.firstChild,"tr")?n.getElementsByTagName("tbody")[0]||n.appendChild(n.ownerDocument.createElement("tbody")):n}function C(n){return n.type=(null!==on.find.attr(n,"type"))+"/"+n.type,n}function S(n){var e=qn.exec(n.type);return e?n.type=e[1]:n.removeAttribute("type"),n}function P(n,e){for(var t,r=0;null!=(t=n[r]);r++)on._data(t,"globalEval",!e||on._data(e[r],"globalEval"))}function y(n,e){if(1===e.nodeType&&on.hasData(n)){var t,r,o,a=on._data(n),i=on._data(e,a),u=a.events;if(u){delete i.handle,i.events={};for(t in u)for(r=0,o=u[t].length;o>r;r++)on.event.add(e,t,u[t][r])}i.data&&(i.data=on.extend({},i.data))}}function T(n,e){var t,r,o;if(1===e.nodeType){if(t=e.nodeName.toLowerCase(),!tn.noCloneEvent&&e[on.expando]){o=on._data(e);for(r in o.events)on.removeEvent(e,r,o.handle);e.removeAttribute(on.expando)}"script"===t&&e.text!==n.text?(C(e).text=n.text,S(e)):"object"===t?(e.parentNode&&(e.outerHTML=n.outerHTML),tn.html5Clone&&n.innerHTML&&!on.trim(e.innerHTML)&&(e.innerHTML=n.innerHTML)):"input"===t&&Dn.test(n.type)?(e.defaultChecked=e.checked=n.checked,e.value!==n.value&&(e.value=n.value)):"option"===t?e.defaultSelected=e.selected=n.defaultSelected:"input"!==t&&"textarea"!==t||(e.defaultValue=n.defaultValue)}}function b(e,t){var r,o=on(t.createElement(e)).appendTo(t.body),a=n.getDefaultComputedStyle&&(r=n.getDefaultComputedStyle(o[0]))?r.display:on.css(o[0],"display");return o.detach(),a}function E(n){var e=hn,t=ne[n];return t||(t=b(n,e),"none"!==t&&t||(Qn=(Qn||on("<iframe frameborder='0' width='0' height='0'/>")).appendTo(e.documentElement),e=(Qn[0].contentWindow||Qn[0].contentDocument).document,e.write(),e.close(),t=b(n,e),Qn.detach()),ne[n]=t),t}function x(n,e){return{get:function(){var t=n();if(null!=t)return t?void delete this.get:(this.get=e).apply(this,arguments)}}}function F(n,e){if(e in n)return e;for(var t=e.charAt(0).toUpperCase()+e.slice(1),r=e,o=ve.length;o--;)if(e=ve[o]+t,e in n)return e;return r}function A(n,e){for(var t,r,o,a=[],i=0,u=n.length;u>i;i++)r=n[i],r.style&&(a[i]=on._data(r,"olddisplay"),t=r.style.display,e?(a[i]||"none"!==t||(r.style.display=""),""===r.style.display&&Nn(r)&&(a[i]=on._data(r,"olddisplay",E(r.nodeName)))):(o=Nn(r),(t&&"none"!==t||!o)&&on._data(r,"olddisplay",o?t:on.css(r,"display"))));for(i=0;u>i;i++)r=n[i],r.style&&(e&&"none"!==r.style.display&&""!==r.style.display||(r.style.display=e?a[i]||"":"none"));return n}function N(n,e,t){var r=le.exec(e);return r?Math.max(0,r[1]-(t||0))+(r[2]||"px"):e}function _(n,e,t,r,o){for(var a=t===(r?"border":"content")?4:"width"===e?1:0,i=0;4>a;a+=2)"margin"===t&&(i+=on.css(n,t+An[a],!0,o)),r?("content"===t&&(i-=on.css(n,"padding"+An[a],!0,o)),"margin"!==t&&(i-=on.css(n,"border"+An[a]+"Width",!0,o))):(i+=on.css(n,"padding"+An[a],!0,o),"padding"!==t&&(i+=on.css(n,"border"+An[a]+"Width",!0,o)));return i}function D(n,e,t){var r=!0,o="width"===e?n.offsetWidth:n.offsetHeight,a=ee(n),i=tn.boxSizing&&"border-box"===on.css(n,"boxSizing",!1,a);if(0>=o||null==o){if(o=te(n,e,a),(0>o||null==o)&&(o=n.style[e]),oe.test(o))return o;r=i&&(tn.boxSizingReliable()||o===n.style[e]),o=parseFloat(o)||0}return o+_(n,e,t||(i?"border":"content"),r,a)+"px"}function M(n,e,t,r,o){return new M.prototype.init(n,e,t,r,o)}function L(){return setTimeout(function(){me=void 0}),me=on.now()}function I(n,e){var t,r={height:n},o=0;for(e=e?1:0;4>o;o+=2-e)t=An[o],r["margin"+t]=r["padding"+t]=n;return e&&(r.opacity=r.width=n),r}function O(n,e,t){for(var r,o=(Se[e]||[]).concat(Se["*"]),a=0,i=o.length;i>a;a++)if(r=o[a].call(t,e,n))return r}function R(n,e,t){var r,o,a,i,u,c,l,s,f=this,d={},v=n.style,m=n.nodeType&&Nn(n),h=on._data(n,"fxshow");t.queue||(u=on._queueHooks(n,"fx"),null==u.unqueued&&(u.unqueued=0,c=u.empty.fire,u.empty.fire=function(){u.unqueued||c()}),u.unqueued++,f.always(function(){f.always(function(){u.unqueued--,on.queue(n,"fx").length||u.empty.fire()})})),1===n.nodeType&&("height"in e||"width"in e)&&(t.overflow=[v.overflow,v.overflowX,v.overflowY],l=on.css(n,"display"),s="none"===l?on._data(n,"olddisplay")||E(n.nodeName):l,"inline"===s&&"none"===on.css(n,"float")&&(tn.inlineBlockNeedsLayout&&"inline"!==E(n.nodeName)?v.zoom=1:v.display="inline-block")),t.overflow&&(v.overflow="hidden",tn.shrinkWrapBlocks()||f.always(function(){v.overflow=t.overflow[0],v.overflowX=t.overflow[1],v.overflowY=t.overflow[2]}));for(r in e)if(o=e[r],pe.exec(o)){if(delete e[r],a=a||"toggle"===o,o===(m?"hide":"show")){if("show"!==o||!h||void 0===h[r])continue;m=!0}d[r]=h&&h[r]||on.style(n,r)}else l=void 0;if(on.isEmptyObject(d))"inline"===("none"===l?E(n.nodeName):l)&&(v.display=l);else{h?"hidden"in h&&(m=h.hidden):h=on._data(n,"fxshow",{}),a&&(h.hidden=!m),m?on(n).show():f.done(function(){on(n).hide()}),f.done(function(){var e;on._removeData(n,"fxshow");for(e in d)on.style(n,e,d[e])});for(r in d)i=O(m?h[r]:0,r,f),r in h||(h[r]=i.start,m&&(i.end=i.start,i.start="width"===r||"height"===r?1:0))}}function k(n,e){var t,r,o,a,i;for(t in n)if(r=on.camelCase(t),o=e[r],a=n[t],on.isArray(a)&&(o=a[1],a=n[t]=a[0]),t!==r&&(n[r]=a,delete n[t]),i=on.cssHooks[r],i&&"expand"in i){a=i.expand(a),delete n[r];for(t in a)t in n||(n[t]=a[t],e[t]=o)}else e[r]=o}function U(n,e,t){var r,o,a=0,i=Ce.length,u=on.Deferred().always(function(){delete c.elem}),c=function(){if(o)return!1;for(var e=me||L(),t=Math.max(0,l.startTime+l.duration-e),r=t/l.duration||0,a=1-r,i=0,c=l.tweens.length;c>i;i++)l.tweens[i].run(a);return u.notifyWith(n,[l,a,t]),1>a&&c?t:(u.resolveWith(n,[l]),!1)},l=u.promise({elem:n,props:on.extend({},e),opts:on.extend(!0,{specialEasing:{}},t),originalProperties:e,originalOptions:t,startTime:me||L(),duration:t.duration,tweens:[],createTween:function(e,t){var r=on.Tween(n,l.opts,e,t,l.opts.specialEasing[e]||l.opts.easing);return l.tweens.push(r),r},stop:function(e){var t=0,r=e?l.tweens.length:0;if(o)return this;for(o=!0;r>t;t++)l.tweens[t].run(1);return e?u.resolveWith(n,[l,e]):u.rejectWith(n,[l,e]),this}}),s=l.props;for(k(s,l.opts.specialEasing);i>a;a++)if(r=Ce[a].call(l,n,s,l.opts))return r;return on.map(s,O,l),on.isFunction(l.opts.start)&&l.opts.start.call(n,l),on.fx.timer(on.extend(c,{elem:n,anim:l,queue:l.opts.queue})),l.progress(l.opts.progress).done(l.opts.done,l.opts.complete).fail(l.opts.fail).always(l.opts.always)}function G(n){return function(e,t){"string"!=typeof e&&(t=e,e="*");var r,o=0,a=e.toLowerCase().match(Sn)||[];if(on.isFunction(t))for(;r=a[o++];)"+"===r.charAt(0)?(r=r.slice(1)||"*",(n[r]=n[r]||[]).unshift(t)):(n[r]=n[r]||[]).push(t)}}function B(n,e,t,r){function o(u){var c;return a[u]=!0,on.each(n[u]||[],function(n,u){var l=u(e,t,r);return"string"!=typeof l||i||a[l]?i?!(c=l):void 0:(e.dataTypes.unshift(l),o(l),!1)}),c}var a={},i=n===ze;return o(e.dataTypes[0])||!a["*"]&&o("*")}function J(n,e){var t,r,o=on.ajaxSettings.flatOptions||{};for(r in e)void 0!==e[r]&&((o[r]?n:t||(t={}))[r]=e[r]);return t&&on.extend(!0,n,t),n}function $(n,e,t){for(var r,o,a,i,u=n.contents,c=n.dataTypes;"*"===c[0];)c.shift(),void 0===o&&(o=n.mimeType||e.getResponseHeader("Content-Type"));if(o)for(i in u)if(u[i]&&u[i].test(o)){c.unshift(i);break}if(c[0]in t)a=c[0];else{for(i in t){if(!c[0]||n.converters[i+" "+c[0]]){a=i;break}r||(r=i)}a=a||r}return a?(a!==c[0]&&c.unshift(a),t[a]):void 0}function H(n,e,t,r){var o,a,i,u,c,l={},s=n.dataTypes.slice();if(s[1])for(i in n.converters)l[i.toLowerCase()]=n.converters[i];for(a=s.shift();a;)if(n.responseFields[a]&&(t[n.responseFields[a]]=e),!c&&r&&n.dataFilter&&(e=n.dataFilter(e,n.dataType)),c=a,a=s.shift())if("*"===a)a=c;else if("*"!==c&&c!==a){if(i=l[c+" "+a]||l["* "+a],!i)for(o in l)if(u=o.split(" "),u[1]===a&&(i=l[c+" "+u[0]]||l["* "+u[0]])){i===!0?i=l[o]:l[o]!==!0&&(a=u[0],s.unshift(u[1]));break}if(i!==!0)if(i&&n["throws"])e=i(e);else try{e=i(e)}catch(f){return{state:"parsererror",error:i?f:"No conversion from "+c+" to "+a}}}return{state:"success",data:e}}function z(n,e,t,r){var o;if(on.isArray(e))on.each(e,function(e,o){t||qe.test(n)?r(n,o):z(n+"["+("object"==typeof o?e:"")+"]",o,t,r)});else if(t||"object"!==on.type(e))r(n,e);else for(o in e)z(n+"["+o+"]",e[o],t,r)}function W(){try{return new n.XMLHttpRequest}catch(e){}}function j(){try{return new n.ActiveXObject("Microsoft.XMLHTTP")}catch(e){}}function V(n){return on.isWindow(n)?n:9===n.nodeType?n.defaultView||n.parentWindow:!1}var q=[],Z=q.slice,K=q.concat,X=q.push,Y=q.indexOf,Q={},nn=Q.toString,en=Q.hasOwnProperty,tn={},rn="1.11.3",on=function(n,e){return new on.fn.init(n,e)},an=/^[\s\uFEFF\xA0]+|[\s\uFEFF\xA0]+$/g,un=/^-ms-/,cn=/-([\da-z])/gi,ln=function(n,e){return e.toUpperCase()};on.fn=on.prototype={jquery:rn,constructor:on,selector:"",length:0,toArray:function(){return Z.call(this)},get:function(n){return null!=n?0>n?this[n+this.length]:this[n]:Z.call(this)},pushStack:function(n){var e=on.merge(this.constructor(),n);return e.prevObject=this,e.context=this.context,e},each:function(n,e){return on.each(this,n,e)},map:function(n){return this.pushStack(on.map(this,function(e,t){return n.call(e,t,e)}))},slice:function(){return this.pushStack(Z.apply(this,arguments))},first:function(){return this.eq(0)},last:function(){return this.eq(-1)},eq:function(n){var e=this.length,t=+n+(0>n?e:0);return this.pushStack(t>=0&&e>t?[this[t]]:[])},end:function(){return this.prevObject||this.constructor(null)},push:X,sort:q.sort,splice:q.splice},on.extend=on.fn.extend=function(){var n,e,t,r,o,a,i=arguments[0]||{},u=1,c=arguments.length,l=!1;for("boolean"==typeof i&&(l=i,i=arguments[u]||{},u++),"object"==typeof i||on.isFunction(i)||(i={}),u===c&&(i=this,u--);c>u;u++)if(null!=(o=arguments[u]))for(r in o)n=i[r],t=o[r],i!==t&&(l&&t&&(on.isPlainObject(t)||(e=on.isArray(t)))?(e?(e=!1,a=n&&on.isArray(n)?n:[]):a=n&&on.isPlainObject(n)?n:{},i[r]=on.extend(l,a,t)):void 0!==t&&(i[r]=t));return i},on.extend({expando:"jQuery"+(rn+Math.random()).replace(/\D/g,""),isReady:!0,error:function(n){throw new Error(n)},noop:function(){},isFunction:function(n){return"function"===on.type(n)},isArray:Array.isArray||function(n){return"array"===on.type(n)},isWindow:function(n){return null!=n&&n==n.window},isNumeric:function(n){return!on.isArray(n)&&n-parseFloat(n)+1>=0},isEmptyObject:function(n){var e;for(e in n)return!1;return!0},isPlainObject:function(n){var e;if(!n||"object"!==on.type(n)||n.nodeType||on.isWindow(n))return!1;try{if(n.constructor&&!en.call(n,"constructor")&&!en.call(n.constructor.prototype,"isPrototypeOf"))return!1}catch(t){return!1}if(tn.ownLast)for(e in n)return en.call(n,e);for(e in n);return void 0===e||en.call(n,e)},type:function(n){return null==n?n+"":"object"==typeof n||"function"==typeof n?Q[nn.call(n)]||"object":typeof n},globalEval:function(e){e&&on.trim(e)&&(n.execScript||function(e){n.eval.call(n,e)})(e)},camelCase:function(n){return n.replace(un,"ms-").replace(cn,ln)},nodeName:function(n,e){return n.nodeName&&n.nodeName.toLowerCase()===e.toLowerCase()},each:function(n,e,r){var o,a=0,i=n.length,u=t(n);if(r){if(u)for(;i>a&&(o=e.apply(n[a],r),o!==!1);a++);else for(a in n)if(o=e.apply(n[a],r),o===!1)break}else if(u)for(;i>a&&(o=e.call(n[a],a,n[a]),o!==!1);a++);else for(a in n)if(o=e.call(n[a],a,n[a]),o===!1)break;return n},trim:function(n){return null==n?"":(n+"").replace(an,"")},makeArray:function(n,e){var r=e||[];return null!=n&&(t(Object(n))?on.merge(r,"string"==typeof n?[n]:n):X.call(r,n)),r},inArray:function(n,e,t){var r;if(e){if(Y)return Y.call(e,n,t);for(r=e.length,t=t?0>t?Math.max(0,r+t):t:0;r>t;t++)if(t in e&&e[t]===n)return t}return-1},merge:function(n,e){for(var t=+e.length,r=0,o=n.length;t>r;)n[o++]=e[r++];if(t!==t)for(;void 0!==e[r];)n[o++]=e[r++];return n.length=o,n},grep:function(n,e,t){for(var r,o=[],a=0,i=n.length,u=!t;i>a;a++)r=!e(n[a],a),r!==u&&o.push(n[a]);return o},map:function(n,e,r){var o,a=0,i=n.length,u=t(n),c=[];if(u)for(;i>a;a++)o=e(n[a],a,r),null!=o&&c.push(o);else for(a in n)o=e(n[a],a,r),null!=o&&c.push(o);return K.apply([],c)},guid:1,proxy:function(n,e){var t,r,o;return"string"==typeof e&&(o=n[e],e=n,n=o),on.isFunction(n)?(t=Z.call(arguments,2),r=function(){return n.apply(e||this,t.concat(Z.call(arguments)))},r.guid=n.guid=n.guid||on.guid++,r):void 0},now:function(){return+new Date},support:tn}),on.each("Boolean Number String Function Array Date RegExp Object Error".split(" "),function(n,e){Q["[object "+e+"]"]=e.toLowerCase()});var sn=function(n){function e(n,e,t,r){var o,a,i,u,c,l,f,v,m,h;if((e?e.ownerDocument||e:B)!==M&&D(e),e=e||M,t=t||[],u=e.nodeType,"string"!=typeof n||!n||1!==u&&9!==u&&11!==u)return t;if(!r&&I){if(11!==u&&(o=Cn.exec(n)))if(i=o[1]){if(9===u){if(a=e.getElementById(i),!a||!a.parentNode)return t;if(a.id===i)return t.push(a),t}else if(e.ownerDocument&&(a=e.ownerDocument.getElementById(i))&&U(e,a)&&a.id===i)return t.push(a),t}else{if(o[2])return Y.apply(t,e.getElementsByTagName(n)),t;if((i=o[3])&&P.getElementsByClassName)return Y.apply(t,e.getElementsByClassName(i)),t}if(P.qsa&&(!O||!O.test(n))){if(v=f=G,m=e,h=1!==u&&n,1===u&&"object"!==e.nodeName.toLowerCase()){for(l=E(n),(f=e.getAttribute("id"))?v=f.replace(Pn,"\\$&"):e.setAttribute("id",v),v="[id='"+v+"'] ",c=l.length;c--;)l[c]=v+d(l[c]);m=Sn.test(n)&&s(e.parentNode)||e,h=l.join(",")}if(h)try{return Y.apply(t,m.querySelectorAll(h)),t}catch(p){}finally{f||e.removeAttribute("id")}}}return F(n.replace(ln,"$1"),e,t,r)}function t(){function n(t,r){return e.push(t+" ")>y.cacheLength&&delete n[e.shift()],n[t+" "]=r}var e=[];return n}function r(n){return n[G]=!0,n}function o(n){var e=M.createElement("div");try{return!!n(e)}catch(t){return!1}finally{e.parentNode&&e.parentNode.removeChild(e),e=null}}function a(n,e){for(var t=n.split("|"),r=n.length;r--;)y.attrHandle[t[r]]=e}function i(n,e){var t=e&&n,r=t&&1===n.nodeType&&1===e.nodeType&&(~e.sourceIndex||V)-(~n.sourceIndex||V);if(r)return r;if(t)for(;t=t.nextSibling;)if(t===e)return-1;return n?1:-1}function u(n){return function(e){var t=e.nodeName.toLowerCase();return"input"===t&&e.type===n}}function c(n){return function(e){var t=e.nodeName.toLowerCase();return("input"===t||"button"===t)&&e.type===n}}function l(n){return r(function(e){return e=+e,r(function(t,r){for(var o,a=n([],t.length,e),i=a.length;i--;)t[o=a[i]]&&(t[o]=!(r[o]=t[o]))})})}function s(n){return n&&"undefined"!=typeof n.getElementsByTagName&&n}function f(){}function d(n){for(var e=0,t=n.length,r="";t>e;e++)r+=n[e].value;return r}function v(n,e,t){var r=e.dir,o=t&&"parentNode"===r,a=$++;return e.first?function(e,t,a){for(;e=e[r];)if(1===e.nodeType||o)return n(e,t,a)}:function(e,t,i){var u,c,l=[J,a];if(i){for(;e=e[r];)if((1===e.nodeType||o)&&n(e,t,i))return!0}else for(;e=e[r];)if(1===e.nodeType||o){if(c=e[G]||(e[G]={}),(u=c[r])&&u[0]===J&&u[1]===a)return l[2]=u[2];if(c[r]=l,l[2]=n(e,t,i))return!0}}}function m(n){return n.length>1?function(e,t,r){for(var o=n.length;o--;)if(!n[o](e,t,r))return!1;return!0}:n[0]}function h(n,t,r){for(var o=0,a=t.length;a>o;o++)e(n,t[o],r);return r}function p(n,e,t,r,o){for(var a,i=[],u=0,c=n.length,l=null!=e;c>u;u++)(a=n[u])&&(t&&!t(a,r,o)||(i.push(a),l&&e.push(u)));return i}function w(n,e,t,o,a,i){return o&&!o[G]&&(o=w(o)),a&&!a[G]&&(a=w(a,i)),r(function(r,i,u,c){var l,s,f,d=[],v=[],m=i.length,w=r||h(e||"*",u.nodeType?[u]:u,[]),g=!n||!r&&e?w:p(w,d,n,u,c),C=t?a||(r?n:m||o)?[]:i:g;if(t&&t(g,C,u,c),o)for(l=p(C,v),o(l,[],u,c),s=l.length;s--;)(f=l[s])&&(C[v[s]]=!(g[v[s]]=f));if(r){if(a||n){if(a){for(l=[],s=C.length;s--;)(f=C[s])&&l.push(g[s]=f);a(null,C=[],l,c)}for(s=C.length;s--;)(f=C[s])&&(l=a?nn(r,f):d[s])>-1&&(r[l]=!(i[l]=f))}}else C=p(C===i?C.splice(m,C.length):C),a?a(null,i,C,c):Y.apply(i,C)})}function g(n){for(var e,t,r,o=n.length,a=y.relative[n[0].type],i=a||y.relative[" "],u=a?1:0,c=v(function(n){return n===e},i,!0),l=v(function(n){return nn(e,n)>-1},i,!0),s=[function(n,t,r){var o=!a&&(r||t!==A)||((e=t).nodeType?c(n,t,r):l(n,t,r));return e=null,o}];o>u;u++)if(t=y.relative[n[u].type])s=[v(m(s),t)];else{if(t=y.filter[n[u].type].apply(null,n[u].matches),t[G]){for(r=++u;o>r&&!y.relative[n[r].type];r++);return w(u>1&&m(s),u>1&&d(n.slice(0,u-1).concat({value:" "===n[u-2].type?"*":""})).replace(ln,"$1"),t,r>u&&g(n.slice(u,r)),o>r&&g(n=n.slice(r)),o>r&&d(n))}s.push(t)}return m(s)}function C(n,t){var o=t.length>0,a=n.length>0,i=function(r,i,u,c,l){var s,f,d,v=0,m="0",h=r&&[],w=[],g=A,C=r||a&&y.find.TAG("*",l),S=J+=null==g?1:Math.random()||.1,P=C.length;for(l&&(A=i!==M&&i);m!==P&&null!=(s=C[m]);m++){if(a&&s){for(f=0;d=n[f++];)if(d(s,i,u)){c.push(s);break}l&&(J=S)}o&&((s=!d&&s)&&v--,r&&h.push(s))}if(v+=m,o&&m!==v){for(f=0;d=t[f++];)d(h,w,i,u);if(r){if(v>0)for(;m--;)h[m]||w[m]||(w[m]=K.call(c));w=p(w)}Y.apply(c,w),l&&!r&&w.length>0&&v+t.length>1&&e.uniqueSort(c)}return l&&(J=S,A=g),h};return o?r(i):i}var S,P,y,T,b,E,x,F,A,N,_,D,M,L,I,O,R,k,U,G="sizzle"+1*new Date,B=n.document,J=0,$=0,H=t(),z=t(),W=t(),j=function(n,e){return n===e&&(_=!0),0},V=1<<31,q={}.hasOwnProperty,Z=[],K=Z.pop,X=Z.push,Y=Z.push,Q=Z.slice,nn=function(n,e){for(var t=0,r=n.length;r>t;t++)if(n[t]===e)return t;return-1},en="checked|selected|async|autofocus|autoplay|controls|defer|disabled|hidden|ismap|loop|multiple|open|readonly|required|scoped",tn="[\\x20\\t\\r\\n\\f]",rn="(?:\\\\.|[\\w-]|[^\\x00-\\xa0])+",on=rn.replace("w","w#"),an="\\["+tn+"*("+rn+")(?:"+tn+"*([*^$|!~]?=)"+tn+"*(?:'((?:\\\\.|[^\\\\'])*)'|\"((?:\\\\.|[^\\\\\"])*)\"|("+on+"))|)"+tn+"*\\]",un=":("+rn+")(?:\\((('((?:\\\\.|[^\\\\'])*)'|\"((?:\\\\.|[^\\\\\"])*)\")|((?:\\\\.|[^\\\\()[\\]]|"+an+")*)|.*)\\)|)",cn=new RegExp(tn+"+","g"),ln=new RegExp("^"+tn+"+|((?:^|[^\\\\])(?:\\\\.)*)"+tn+"+$","g"),sn=new RegExp("^"+tn+"*,"+tn+"*"),fn=new RegExp("^"+tn+"*([>+~]|"+tn+")"+tn+"*"),dn=new RegExp("="+tn+"*([^\\]'\"]*?)"+tn+"*\\]","g"),vn=new RegExp(un),mn=new RegExp("^"+on+"$"),hn={ID:new RegExp("^#("+rn+")"),CLASS:new RegExp("^\\.("+rn+")"),TAG:new RegExp("^("+rn.replace("w","w*")+")"),ATTR:new RegExp("^"+an),PSEUDO:new RegExp("^"+un),CHILD:new RegExp("^:(only|first|last|nth|nth-last)-(child|of-type)(?:\\("+tn+"*(even|odd|(([+-]|)(\\d*)n|)"+tn+"*(?:([+-]|)"+tn+"*(\\d+)|))"+tn+"*\\)|)","i"),bool:new RegExp("^(?:"+en+")$","i"),needsContext:new RegExp("^"+tn+"*[>+~]|:(even|odd|eq|gt|lt|nth|first|last)(?:\\("+tn+"*((?:-\\d)?\\d*)"+tn+"*\\)|)(?=[^-]|$)","i")},pn=/^(?:input|select|textarea|button)$/i,wn=/^h\d$/i,gn=/^[^{]+\{\s*\[native \w/,Cn=/^(?:#([\w-]+)|(\w+)|\.([\w-]+))$/,Sn=/[+~]/,Pn=/'|\\/g,yn=new RegExp("\\\\([\\da-f]{1,6}"+tn+"?|("+tn+")|.)","ig"),Tn=function(n,e,t){var r="0x"+e-65536;return r!==r||t?e:0>r?String.fromCharCode(r+65536):String.fromCharCode(r>>10|55296,1023&r|56320)},bn=function(){D()};try{Y.apply(Z=Q.call(B.childNodes),B.childNodes),Z[B.childNodes.length].nodeType}catch(En){Y={apply:Z.length?function(n,e){X.apply(n,Q.call(e))}:function(n,e){for(var t=n.length,r=0;n[t++]=e[r++];);n.length=t-1}}}P=e.support={},b=e.isXML=function(n){var e=n&&(n.ownerDocument||n).documentElement;return e?"HTML"!==e.nodeName:!1},D=e.setDocument=function(n){var e,t,r=n?n.ownerDocument||n:B;return r!==M&&9===r.nodeType&&r.documentElement?(M=r,L=r.documentElement,t=r.defaultView,t&&t!==t.top&&(t.addEventListener?t.addEventListener("unload",bn,!1):t.attachEvent&&t.attachEvent("onunload",bn)),I=!b(r),P.attributes=o(function(n){return n.className="i",!n.getAttribute("className")}),P.getElementsByTagName=o(function(n){return n.appendChild(r.createComment("")),!n.getElementsByTagName("*").length}),P.getElementsByClassName=gn.test(r.getElementsByClassName),P.getById=o(function(n){return L.appendChild(n).id=G,!r.getElementsByName||!r.getElementsByName(G).length}),P.getById?(y.find.ID=function(n,e){if("undefined"!=typeof e.getElementById&&I){var t=e.getElementById(n);return t&&t.parentNode?[t]:[]}},y.filter.ID=function(n){var e=n.replace(yn,Tn);return function(n){return n.getAttribute("id")===e}}):(delete y.find.ID,y.filter.ID=function(n){var e=n.replace(yn,Tn);return function(n){var t="undefined"!=typeof n.getAttributeNode&&n.getAttributeNode("id");return t&&t.value===e}}),y.find.TAG=P.getElementsByTagName?function(n,e){return"undefined"!=typeof e.getElementsByTagName?e.getElementsByTagName(n):P.qsa?e.querySelectorAll(n):void 0}:function(n,e){var t,r=[],o=0,a=e.getElementsByTagName(n);if("*"===n){for(;t=a[o++];)1===t.nodeType&&r.push(t);return r}return a},y.find.CLASS=P.getElementsByClassName&&function(n,e){return I?e.getElementsByClassName(n):void 0},R=[],O=[],(P.qsa=gn.test(r.querySelectorAll))&&(o(function(n){L.appendChild(n).innerHTML="<a id='"+G+"'></a><select id='"+G+"-\f]' msallowcapture=''><option selected=''></option></select>",n.querySelectorAll("[msallowcapture^='']").length&&O.push("[*^$]="+tn+"*(?:''|\"\")"),n.querySelectorAll("[selected]").length||O.push("\\["+tn+"*(?:value|"+en+")"),n.querySelectorAll("[id~="+G+"-]").length||O.push("~="),n.querySelectorAll(":checked").length||O.push(":checked"),n.querySelectorAll("a#"+G+"+*").length||O.push(".#.+[+~]")}),o(function(n){var e=r.createElement("input");e.setAttribute("type","hidden"),n.appendChild(e).setAttribute("name","D"),n.querySelectorAll("[name=d]").length&&O.push("name"+tn+"*[*^$|!~]?="),n.querySelectorAll(":enabled").length||O.push(":enabled",":disabled"),n.querySelectorAll("*,:x"),O.push(",.*:")})),(P.matchesSelector=gn.test(k=L.matches||L.webkitMatchesSelector||L.mozMatchesSelector||L.oMatchesSelector||L.msMatchesSelector))&&o(function(n){P.disconnectedMatch=k.call(n,"div"),k.call(n,"[s!='']:x"),R.push("!=",un)}),O=O.length&&new RegExp(O.join("|")),R=R.length&&new RegExp(R.join("|")),e=gn.test(L.compareDocumentPosition),U=e||gn.test(L.contains)?function(n,e){var t=9===n.nodeType?n.documentElement:n,r=e&&e.parentNode;return n===r||!(!r||1!==r.nodeType||!(t.contains?t.contains(r):n.compareDocumentPosition&&16&n.compareDocumentPosition(r)))}:function(n,e){if(e)for(;e=e.parentNode;)if(e===n)return!0;return!1},j=e?function(n,e){if(n===e)return _=!0,0;var t=!n.compareDocumentPosition-!e.compareDocumentPosition;return t?t:(t=(n.ownerDocument||n)===(e.ownerDocument||e)?n.compareDocumentPosition(e):1,1&t||!P.sortDetached&&e.compareDocumentPosition(n)===t?n===r||n.ownerDocument===B&&U(B,n)?-1:e===r||e.ownerDocument===B&&U(B,e)?1:N?nn(N,n)-nn(N,e):0:4&t?-1:1)}:function(n,e){if(n===e)return _=!0,0;var t,o=0,a=n.parentNode,u=e.parentNode,c=[n],l=[e];if(!a||!u)return n===r?-1:e===r?1:a?-1:u?1:N?nn(N,n)-nn(N,e):0;if(a===u)return i(n,e);for(t=n;t=t.parentNode;)c.unshift(t);for(t=e;t=t.parentNode;)l.unshift(t);for(;c[o]===l[o];)o++;return o?i(c[o],l[o]):c[o]===B?-1:l[o]===B?1:0},r):M},e.matches=function(n,t){return e(n,null,null,t)},e.matchesSelector=function(n,t){if((n.ownerDocument||n)!==M&&D(n),t=t.replace(dn,"='$1']"),P.matchesSelector&&I&&(!R||!R.test(t))&&(!O||!O.test(t)))try{var r=k.call(n,t);if(r||P.disconnectedMatch||n.document&&11!==n.document.nodeType)return r}catch(o){}return e(t,M,null,[n]).length>0},e.contains=function(n,e){return(n.ownerDocument||n)!==M&&D(n),U(n,e)},e.attr=function(n,e){(n.ownerDocument||n)!==M&&D(n);var t=y.attrHandle[e.toLowerCase()],r=t&&q.call(y.attrHandle,e.toLowerCase())?t(n,e,!I):void 0;return void 0!==r?r:P.attributes||!I?n.getAttribute(e):(r=n.getAttributeNode(e))&&r.specified?r.value:null},e.error=function(n){throw new Error("Syntax error, unrecognized expression: "+n)},e.uniqueSort=function(n){var e,t=[],r=0,o=0;if(_=!P.detectDuplicates,N=!P.sortStable&&n.slice(0),n.sort(j),_){for(;e=n[o++];)e===n[o]&&(r=t.push(o));for(;r--;)n.splice(t[r],1)}return N=null,n},T=e.getText=function(n){var e,t="",r=0,o=n.nodeType;if(o){if(1===o||9===o||11===o){if("string"==typeof n.textContent)return n.textContent;for(n=n.firstChild;n;n=n.nextSibling)t+=T(n)}else if(3===o||4===o)return n.nodeValue}else for(;e=n[r++];)t+=T(e);return t},y=e.selectors={cacheLength:50,createPseudo:r,match:hn,attrHandle:{},find:{},relative:{">":{dir:"parentNode",first:!0}," ":{dir:"parentNode"},"+":{dir:"previousSibling",first:!0},"~":{dir:"previousSibling"}},preFilter:{ATTR:function(n){return n[1]=n[1].replace(yn,Tn),n[3]=(n[3]||n[4]||n[5]||"").replace(yn,Tn),"~="===n[2]&&(n[3]=" "+n[3]+" "),n.slice(0,4)},CHILD:function(n){return n[1]=n[1].toLowerCase(),"nth"===n[1].slice(0,3)?(n[3]||e.error(n[0]),n[4]=+(n[4]?n[5]+(n[6]||1):2*("even"===n[3]||"odd"===n[3])),n[5]=+(n[7]+n[8]||"odd"===n[3])):n[3]&&e.error(n[0]),n},PSEUDO:function(n){var e,t=!n[6]&&n[2];return hn.CHILD.test(n[0])?null:(n[3]?n[2]=n[4]||n[5]||"":t&&vn.test(t)&&(e=E(t,!0))&&(e=t.indexOf(")",t.length-e)-t.length)&&(n[0]=n[0].slice(0,e),n[2]=t.slice(0,e)),n.slice(0,3))}},filter:{TAG:function(n){var e=n.replace(yn,Tn).toLowerCase();return"*"===n?function(){return!0}:function(n){return n.nodeName&&n.nodeName.toLowerCase()===e}},CLASS:function(n){var e=H[n+" "];return e||(e=new RegExp("(^|"+tn+")"+n+"("+tn+"|$)"))&&H(n,function(n){return e.test("string"==typeof n.className&&n.className||"undefined"!=typeof n.getAttribute&&n.getAttribute("class")||"")})},ATTR:function(n,t,r){return function(o){var a=e.attr(o,n);return null==a?"!="===t:t?(a+="","="===t?a===r:"!="===t?a!==r:"^="===t?r&&0===a.indexOf(r):"*="===t?r&&a.indexOf(r)>-1:"$="===t?r&&a.slice(-r.length)===r:"~="===t?(" "+a.replace(cn," ")+" ").indexOf(r)>-1:"|="===t?a===r||a.slice(0,r.length+1)===r+"-":!1):!0}},CHILD:function(n,e,t,r,o){var a="nth"!==n.slice(0,3),i="last"!==n.slice(-4),u="of-type"===e;return 1===r&&0===o?function(n){return!!n.parentNode}:function(e,t,c){var l,s,f,d,v,m,h=a!==i?"nextSibling":"previousSibling",p=e.parentNode,w=u&&e.nodeName.toLowerCase(),g=!c&&!u;if(p){if(a){for(;h;){for(f=e;f=f[h];)if(u?f.nodeName.toLowerCase()===w:1===f.nodeType)return!1;m=h="only"===n&&!m&&"nextSibling"}return!0}if(m=[i?p.firstChild:p.lastChild],i&&g){for(s=p[G]||(p[G]={}),l=s[n]||[],v=l[0]===J&&l[1],d=l[0]===J&&l[2],f=v&&p.childNodes[v];f=++v&&f&&f[h]||(d=v=0)||m.pop();)if(1===f.nodeType&&++d&&f===e){s[n]=[J,v,d];break}}else if(g&&(l=(e[G]||(e[G]={}))[n])&&l[0]===J)d=l[1];else for(;(f=++v&&f&&f[h]||(d=v=0)||m.pop())&&((u?f.nodeName.toLowerCase()!==w:1!==f.nodeType)||!++d||(g&&((f[G]||(f[G]={}))[n]=[J,d]),f!==e)););return d-=o,d===r||d%r===0&&d/r>=0}}},PSEUDO:function(n,t){var o,a=y.pseudos[n]||y.setFilters[n.toLowerCase()]||e.error("unsupported pseudo: "+n);return a[G]?a(t):a.length>1?(o=[n,n,"",t],y.setFilters.hasOwnProperty(n.toLowerCase())?r(function(n,e){for(var r,o=a(n,t),i=o.length;i--;)r=nn(n,o[i]),n[r]=!(e[r]=o[i])}):function(n){return a(n,0,o)}):a}},pseudos:{not:r(function(n){var e=[],t=[],o=x(n.replace(ln,"$1"));return o[G]?r(function(n,e,t,r){for(var a,i=o(n,null,r,[]),u=n.length;u--;)(a=i[u])&&(n[u]=!(e[u]=a))}):function(n,r,a){return e[0]=n,
o(e,null,a,t),e[0]=null,!t.pop()}}),has:r(function(n){return function(t){return e(n,t).length>0}}),contains:r(function(n){return n=n.replace(yn,Tn),function(e){return(e.textContent||e.innerText||T(e)).indexOf(n)>-1}}),lang:r(function(n){return mn.test(n||"")||e.error("unsupported lang: "+n),n=n.replace(yn,Tn).toLowerCase(),function(e){var t;do if(t=I?e.lang:e.getAttribute("xml:lang")||e.getAttribute("lang"))return t=t.toLowerCase(),t===n||0===t.indexOf(n+"-");while((e=e.parentNode)&&1===e.nodeType);return!1}}),target:function(e){var t=n.location&&n.location.hash;return t&&t.slice(1)===e.id},root:function(n){return n===L},focus:function(n){return n===M.activeElement&&(!M.hasFocus||M.hasFocus())&&!!(n.type||n.href||~n.tabIndex)},enabled:function(n){return n.disabled===!1},disabled:function(n){return n.disabled===!0},checked:function(n){var e=n.nodeName.toLowerCase();return"input"===e&&!!n.checked||"option"===e&&!!n.selected},selected:function(n){return n.parentNode&&n.parentNode.selectedIndex,n.selected===!0},empty:function(n){for(n=n.firstChild;n;n=n.nextSibling)if(n.nodeType<6)return!1;return!0},parent:function(n){return!y.pseudos.empty(n)},header:function(n){return wn.test(n.nodeName)},input:function(n){return pn.test(n.nodeName)},button:function(n){var e=n.nodeName.toLowerCase();return"input"===e&&"button"===n.type||"button"===e},text:function(n){var e;return"input"===n.nodeName.toLowerCase()&&"text"===n.type&&(null==(e=n.getAttribute("type"))||"text"===e.toLowerCase())},first:l(function(){return[0]}),last:l(function(n,e){return[e-1]}),eq:l(function(n,e,t){return[0>t?t+e:t]}),even:l(function(n,e){for(var t=0;e>t;t+=2)n.push(t);return n}),odd:l(function(n,e){for(var t=1;e>t;t+=2)n.push(t);return n}),lt:l(function(n,e,t){for(var r=0>t?t+e:t;--r>=0;)n.push(r);return n}),gt:l(function(n,e,t){for(var r=0>t?t+e:t;++r<e;)n.push(r);return n})}},y.pseudos.nth=y.pseudos.eq;for(S in{radio:!0,checkbox:!0,file:!0,password:!0,image:!0})y.pseudos[S]=u(S);for(S in{submit:!0,reset:!0})y.pseudos[S]=c(S);return f.prototype=y.filters=y.pseudos,y.setFilters=new f,E=e.tokenize=function(n,t){var r,o,a,i,u,c,l,s=z[n+" "];if(s)return t?0:s.slice(0);for(u=n,c=[],l=y.preFilter;u;){r&&!(o=sn.exec(u))||(o&&(u=u.slice(o[0].length)||u),c.push(a=[])),r=!1,(o=fn.exec(u))&&(r=o.shift(),a.push({value:r,type:o[0].replace(ln," ")}),u=u.slice(r.length));for(i in y.filter)!(o=hn[i].exec(u))||l[i]&&!(o=l[i](o))||(r=o.shift(),a.push({value:r,type:i,matches:o}),u=u.slice(r.length));if(!r)break}return t?u.length:u?e.error(n):z(n,c).slice(0)},x=e.compile=function(n,e){var t,r=[],o=[],a=W[n+" "];if(!a){for(e||(e=E(n)),t=e.length;t--;)a=g(e[t]),a[G]?r.push(a):o.push(a);a=W(n,C(o,r)),a.selector=n}return a},F=e.select=function(n,e,t,r){var o,a,i,u,c,l="function"==typeof n&&n,f=!r&&E(n=l.selector||n);if(t=t||[],1===f.length){if(a=f[0]=f[0].slice(0),a.length>2&&"ID"===(i=a[0]).type&&P.getById&&9===e.nodeType&&I&&y.relative[a[1].type]){if(e=(y.find.ID(i.matches[0].replace(yn,Tn),e)||[])[0],!e)return t;l&&(e=e.parentNode),n=n.slice(a.shift().value.length)}for(o=hn.needsContext.test(n)?0:a.length;o--&&(i=a[o],!y.relative[u=i.type]);)if((c=y.find[u])&&(r=c(i.matches[0].replace(yn,Tn),Sn.test(a[0].type)&&s(e.parentNode)||e))){if(a.splice(o,1),n=r.length&&d(a),!n)return Y.apply(t,r),t;break}}return(l||x(n,f))(r,e,!I,t,Sn.test(n)&&s(e.parentNode)||e),t},P.sortStable=G.split("").sort(j).join("")===G,P.detectDuplicates=!!_,D(),P.sortDetached=o(function(n){return 1&n.compareDocumentPosition(M.createElement("div"))}),o(function(n){return n.innerHTML="<a href='#'></a>","#"===n.firstChild.getAttribute("href")})||a("type|href|height|width",function(n,e,t){return t?void 0:n.getAttribute(e,"type"===e.toLowerCase()?1:2)}),P.attributes&&o(function(n){return n.innerHTML="<input/>",n.firstChild.setAttribute("value",""),""===n.firstChild.getAttribute("value")})||a("value",function(n,e,t){return t||"input"!==n.nodeName.toLowerCase()?void 0:n.defaultValue}),o(function(n){return null==n.getAttribute("disabled")})||a(en,function(n,e,t){var r;return t?void 0:n[e]===!0?e.toLowerCase():(r=n.getAttributeNode(e))&&r.specified?r.value:null}),e}(n);on.find=sn,on.expr=sn.selectors,on.expr[":"]=on.expr.pseudos,on.unique=sn.uniqueSort,on.text=sn.getText,on.isXMLDoc=sn.isXML,on.contains=sn.contains;var fn=on.expr.match.needsContext,dn=/^<(\w+)\s*\/?>(?:<\/\1>|)$/,vn=/^.[^:#\[\.,]*$/;on.filter=function(n,e,t){var r=e[0];return t&&(n=":not("+n+")"),1===e.length&&1===r.nodeType?on.find.matchesSelector(r,n)?[r]:[]:on.find.matches(n,on.grep(e,function(n){return 1===n.nodeType}))},on.fn.extend({find:function(n){var e,t=[],r=this,o=r.length;if("string"!=typeof n)return this.pushStack(on(n).filter(function(){for(e=0;o>e;e++)if(on.contains(r[e],this))return!0}));for(e=0;o>e;e++)on.find(n,r[e],t);return t=this.pushStack(o>1?on.unique(t):t),t.selector=this.selector?this.selector+" "+n:n,t},filter:function(n){return this.pushStack(r(this,n||[],!1))},not:function(n){return this.pushStack(r(this,n||[],!0))},is:function(n){return!!r(this,"string"==typeof n&&fn.test(n)?on(n):n||[],!1).length}});var mn,hn=n.document,pn=/^(?:\s*(<[\w\W]+>)[^>]*|#([\w-]*))$/,wn=on.fn.init=function(n,e){var t,r;if(!n)return this;if("string"==typeof n){if(t="<"===n.charAt(0)&&">"===n.charAt(n.length-1)&&n.length>=3?[null,n,null]:pn.exec(n),!t||!t[1]&&e)return!e||e.jquery?(e||mn).find(n):this.constructor(e).find(n);if(t[1]){if(e=e instanceof on?e[0]:e,on.merge(this,on.parseHTML(t[1],e&&e.nodeType?e.ownerDocument||e:hn,!0)),dn.test(t[1])&&on.isPlainObject(e))for(t in e)on.isFunction(this[t])?this[t](e[t]):this.attr(t,e[t]);return this}if(r=hn.getElementById(t[2]),r&&r.parentNode){if(r.id!==t[2])return mn.find(n);this.length=1,this[0]=r}return this.context=hn,this.selector=n,this}return n.nodeType?(this.context=this[0]=n,this.length=1,this):on.isFunction(n)?"undefined"!=typeof mn.ready?mn.ready(n):n(on):(void 0!==n.selector&&(this.selector=n.selector,this.context=n.context),on.makeArray(n,this))};wn.prototype=on.fn,mn=on(hn);var gn=/^(?:parents|prev(?:Until|All))/,Cn={children:!0,contents:!0,next:!0,prev:!0};on.extend({dir:function(n,e,t){for(var r=[],o=n[e];o&&9!==o.nodeType&&(void 0===t||1!==o.nodeType||!on(o).is(t));)1===o.nodeType&&r.push(o),o=o[e];return r},sibling:function(n,e){for(var t=[];n;n=n.nextSibling)1===n.nodeType&&n!==e&&t.push(n);return t}}),on.fn.extend({has:function(n){var e,t=on(n,this),r=t.length;return this.filter(function(){for(e=0;r>e;e++)if(on.contains(this,t[e]))return!0})},closest:function(n,e){for(var t,r=0,o=this.length,a=[],i=fn.test(n)||"string"!=typeof n?on(n,e||this.context):0;o>r;r++)for(t=this[r];t&&t!==e;t=t.parentNode)if(t.nodeType<11&&(i?i.index(t)>-1:1===t.nodeType&&on.find.matchesSelector(t,n))){a.push(t);break}return this.pushStack(a.length>1?on.unique(a):a)},index:function(n){return n?"string"==typeof n?on.inArray(this[0],on(n)):on.inArray(n.jquery?n[0]:n,this):this[0]&&this[0].parentNode?this.first().prevAll().length:-1},add:function(n,e){return this.pushStack(on.unique(on.merge(this.get(),on(n,e))))},addBack:function(n){return this.add(null==n?this.prevObject:this.prevObject.filter(n))}}),on.each({parent:function(n){var e=n.parentNode;return e&&11!==e.nodeType?e:null},parents:function(n){return on.dir(n,"parentNode")},parentsUntil:function(n,e,t){return on.dir(n,"parentNode",t)},next:function(n){return o(n,"nextSibling")},prev:function(n){return o(n,"previousSibling")},nextAll:function(n){return on.dir(n,"nextSibling")},prevAll:function(n){return on.dir(n,"previousSibling")},nextUntil:function(n,e,t){return on.dir(n,"nextSibling",t)},prevUntil:function(n,e,t){return on.dir(n,"previousSibling",t)},siblings:function(n){return on.sibling((n.parentNode||{}).firstChild,n)},children:function(n){return on.sibling(n.firstChild)},contents:function(n){return on.nodeName(n,"iframe")?n.contentDocument||n.contentWindow.document:on.merge([],n.childNodes)}},function(n,e){on.fn[n]=function(t,r){var o=on.map(this,e,t);return"Until"!==n.slice(-5)&&(r=t),r&&"string"==typeof r&&(o=on.filter(r,o)),this.length>1&&(Cn[n]||(o=on.unique(o)),gn.test(n)&&(o=o.reverse())),this.pushStack(o)}});var Sn=/\S+/g,Pn={};on.Callbacks=function(n){n="string"==typeof n?Pn[n]||a(n):on.extend({},n);var e,t,r,o,i,u,c=[],l=!n.once&&[],s=function(a){for(t=n.memory&&a,r=!0,i=u||0,u=0,o=c.length,e=!0;c&&o>i;i++)if(c[i].apply(a[0],a[1])===!1&&n.stopOnFalse){t=!1;break}e=!1,c&&(l?l.length&&s(l.shift()):t?c=[]:f.disable())},f={add:function(){if(c){var r=c.length;!function a(e){on.each(e,function(e,t){var r=on.type(t);"function"===r?n.unique&&f.has(t)||c.push(t):t&&t.length&&"string"!==r&&a(t)})}(arguments),e?o=c.length:t&&(u=r,s(t))}return this},remove:function(){return c&&on.each(arguments,function(n,t){for(var r;(r=on.inArray(t,c,r))>-1;)c.splice(r,1),e&&(o>=r&&o--,i>=r&&i--)}),this},has:function(n){return n?on.inArray(n,c)>-1:!(!c||!c.length)},empty:function(){return c=[],o=0,this},disable:function(){return c=l=t=void 0,this},disabled:function(){return!c},lock:function(){return l=void 0,t||f.disable(),this},locked:function(){return!l},fireWith:function(n,t){return!c||r&&!l||(t=t||[],t=[n,t.slice?t.slice():t],e?l.push(t):s(t)),this},fire:function(){return f.fireWith(this,arguments),this},fired:function(){return!!r}};return f},on.extend({Deferred:function(n){var e=[["resolve","done",on.Callbacks("once memory"),"resolved"],["reject","fail",on.Callbacks("once memory"),"rejected"],["notify","progress",on.Callbacks("memory")]],t="pending",r={state:function(){return t},always:function(){return o.done(arguments).fail(arguments),this},then:function(){var n=arguments;return on.Deferred(function(t){on.each(e,function(e,a){var i=on.isFunction(n[e])&&n[e];o[a[1]](function(){var n=i&&i.apply(this,arguments);n&&on.isFunction(n.promise)?n.promise().done(t.resolve).fail(t.reject).progress(t.notify):t[a[0]+"With"](this===r?t.promise():this,i?[n]:arguments)})}),n=null}).promise()},promise:function(n){return null!=n?on.extend(n,r):r}},o={};return r.pipe=r.then,on.each(e,function(n,a){var i=a[2],u=a[3];r[a[1]]=i.add,u&&i.add(function(){t=u},e[1^n][2].disable,e[2][2].lock),o[a[0]]=function(){return o[a[0]+"With"](this===o?r:this,arguments),this},o[a[0]+"With"]=i.fireWith}),r.promise(o),n&&n.call(o,o),o},when:function(n){var e,t,r,o=0,a=Z.call(arguments),i=a.length,u=1!==i||n&&on.isFunction(n.promise)?i:0,c=1===u?n:on.Deferred(),l=function(n,t,r){return function(o){t[n]=this,r[n]=arguments.length>1?Z.call(arguments):o,r===e?c.notifyWith(t,r):--u||c.resolveWith(t,r)}};if(i>1)for(e=new Array(i),t=new Array(i),r=new Array(i);i>o;o++)a[o]&&on.isFunction(a[o].promise)?a[o].promise().done(l(o,r,a)).fail(c.reject).progress(l(o,t,e)):--u;return u||c.resolveWith(r,a),c.promise()}});var yn;on.fn.ready=function(n){return on.ready.promise().done(n),this},on.extend({isReady:!1,readyWait:1,holdReady:function(n){n?on.readyWait++:on.ready(!0)},ready:function(n){if(n===!0?!--on.readyWait:!on.isReady){if(!hn.body)return setTimeout(on.ready);on.isReady=!0,n!==!0&&--on.readyWait>0||(yn.resolveWith(hn,[on]),on.fn.triggerHandler&&(on(hn).triggerHandler("ready"),on(hn).off("ready")))}}}),on.ready.promise=function(e){if(!yn)if(yn=on.Deferred(),"complete"===hn.readyState)setTimeout(on.ready);else if(hn.addEventListener)hn.addEventListener("DOMContentLoaded",u,!1),n.addEventListener("load",u,!1);else{hn.attachEvent("onreadystatechange",u),n.attachEvent("onload",u);var t=!1;try{t=null==n.frameElement&&hn.documentElement}catch(r){}t&&t.doScroll&&!function o(){if(!on.isReady){try{t.doScroll("left")}catch(n){return setTimeout(o,50)}i(),on.ready()}}()}return yn.promise(e)};var Tn,bn="undefined";for(Tn in on(tn))break;tn.ownLast="0"!==Tn,tn.inlineBlockNeedsLayout=!1,on(function(){var n,e,t,r;t=hn.getElementsByTagName("body")[0],t&&t.style&&(e=hn.createElement("div"),r=hn.createElement("div"),r.style.cssText="position:absolute;border:0;width:0;height:0;top:0;left:-9999px",t.appendChild(r).appendChild(e),typeof e.style.zoom!==bn&&(e.style.cssText="display:inline;margin:0;border:0;padding:1px;width:1px;zoom:1",tn.inlineBlockNeedsLayout=n=3===e.offsetWidth,n&&(t.style.zoom=1)),t.removeChild(r))}),function(){var n=hn.createElement("div");if(null==tn.deleteExpando){tn.deleteExpando=!0;try{delete n.test}catch(e){tn.deleteExpando=!1}}n=null}(),on.acceptData=function(n){var e=on.noData[(n.nodeName+" ").toLowerCase()],t=+n.nodeType||1;return 1!==t&&9!==t?!1:!e||e!==!0&&n.getAttribute("classid")===e};var En=/^(?:\{[\w\W]*\}|\[[\w\W]*\])$/,xn=/([A-Z])/g;on.extend({cache:{},noData:{"applet ":!0,"embed ":!0,"object ":"clsid:D27CDB6E-AE6D-11cf-96B8-444553540000"},hasData:function(n){return n=n.nodeType?on.cache[n[on.expando]]:n[on.expando],!!n&&!l(n)},data:function(n,e,t){return s(n,e,t)},removeData:function(n,e){return f(n,e)},_data:function(n,e,t){return s(n,e,t,!0)},_removeData:function(n,e){return f(n,e,!0)}}),on.fn.extend({data:function(n,e){var t,r,o,a=this[0],i=a&&a.attributes;if(void 0===n){if(this.length&&(o=on.data(a),1===a.nodeType&&!on._data(a,"parsedAttrs"))){for(t=i.length;t--;)i[t]&&(r=i[t].name,0===r.indexOf("data-")&&(r=on.camelCase(r.slice(5)),c(a,r,o[r])));on._data(a,"parsedAttrs",!0)}return o}return"object"==typeof n?this.each(function(){on.data(this,n)}):arguments.length>1?this.each(function(){on.data(this,n,e)}):a?c(a,n,on.data(a,n)):void 0},removeData:function(n){return this.each(function(){on.removeData(this,n)})}}),on.extend({queue:function(n,e,t){var r;return n?(e=(e||"fx")+"queue",r=on._data(n,e),t&&(!r||on.isArray(t)?r=on._data(n,e,on.makeArray(t)):r.push(t)),r||[]):void 0},dequeue:function(n,e){e=e||"fx";var t=on.queue(n,e),r=t.length,o=t.shift(),a=on._queueHooks(n,e),i=function(){on.dequeue(n,e)};"inprogress"===o&&(o=t.shift(),r--),o&&("fx"===e&&t.unshift("inprogress"),delete a.stop,o.call(n,i,a)),!r&&a&&a.empty.fire()},_queueHooks:function(n,e){var t=e+"queueHooks";return on._data(n,t)||on._data(n,t,{empty:on.Callbacks("once memory").add(function(){on._removeData(n,e+"queue"),on._removeData(n,t)})})}}),on.fn.extend({queue:function(n,e){var t=2;return"string"!=typeof n&&(e=n,n="fx",t--),arguments.length<t?on.queue(this[0],n):void 0===e?this:this.each(function(){var t=on.queue(this,n,e);on._queueHooks(this,n),"fx"===n&&"inprogress"!==t[0]&&on.dequeue(this,n)})},dequeue:function(n){return this.each(function(){on.dequeue(this,n)})},clearQueue:function(n){return this.queue(n||"fx",[])},promise:function(n,e){var t,r=1,o=on.Deferred(),a=this,i=this.length,u=function(){--r||o.resolveWith(a,[a])};for("string"!=typeof n&&(e=n,n=void 0),n=n||"fx";i--;)t=on._data(a[i],n+"queueHooks"),t&&t.empty&&(r++,t.empty.add(u));return u(),o.promise(e)}});var Fn=/[+-]?(?:\d*\.|)\d+(?:[eE][+-]?\d+|)/.source,An=["Top","Right","Bottom","Left"],Nn=function(n,e){return n=e||n,"none"===on.css(n,"display")||!on.contains(n.ownerDocument,n)},_n=on.access=function(n,e,t,r,o,a,i){var u=0,c=n.length,l=null==t;if("object"===on.type(t)){o=!0;for(u in t)on.access(n,e,u,t[u],!0,a,i)}else if(void 0!==r&&(o=!0,on.isFunction(r)||(i=!0),l&&(i?(e.call(n,r),e=null):(l=e,e=function(n,e,t){return l.call(on(n),t)})),e))for(;c>u;u++)e(n[u],t,i?r:r.call(n[u],u,e(n[u],t)));return o?n:l?e.call(n):c?e(n[0],t):a},Dn=/^(?:checkbox|radio)$/i;!function(){var n=hn.createElement("input"),e=hn.createElement("div"),t=hn.createDocumentFragment();if(e.innerHTML="  <link/><table></table><a href='/a'>a</a><input type='checkbox'/>",tn.leadingWhitespace=3===e.firstChild.nodeType,tn.tbody=!e.getElementsByTagName("tbody").length,tn.htmlSerialize=!!e.getElementsByTagName("link").length,tn.html5Clone="<:nav></:nav>"!==hn.createElement("nav").cloneNode(!0).outerHTML,n.type="checkbox",n.checked=!0,t.appendChild(n),tn.appendChecked=n.checked,e.innerHTML="<textarea>x</textarea>",tn.noCloneChecked=!!e.cloneNode(!0).lastChild.defaultValue,t.appendChild(e),e.innerHTML="<input type='radio' checked='checked' name='t'/>",tn.checkClone=e.cloneNode(!0).cloneNode(!0).lastChild.checked,tn.noCloneEvent=!0,e.attachEvent&&(e.attachEvent("onclick",function(){tn.noCloneEvent=!1}),e.cloneNode(!0).click()),null==tn.deleteExpando){tn.deleteExpando=!0;try{delete e.test}catch(r){tn.deleteExpando=!1}}}(),function(){var e,t,r=hn.createElement("div");for(e in{submit:!0,change:!0,focusin:!0})t="on"+e,(tn[e+"Bubbles"]=t in n)||(r.setAttribute(t,"t"),tn[e+"Bubbles"]=r.attributes[t].expando===!1);r=null}();var Mn=/^(?:input|select|textarea)$/i,Ln=/^key/,In=/^(?:mouse|pointer|contextmenu)|click/,On=/^(?:focusinfocus|focusoutblur)$/,Rn=/^([^.]*)(?:\.(.+)|)$/;on.event={global:{},add:function(n,e,t,r,o){var a,i,u,c,l,s,f,d,v,m,h,p=on._data(n);if(p){for(t.handler&&(c=t,t=c.handler,o=c.selector),t.guid||(t.guid=on.guid++),(i=p.events)||(i=p.events={}),(s=p.handle)||(s=p.handle=function(n){return typeof on===bn||n&&on.event.triggered===n.type?void 0:on.event.dispatch.apply(s.elem,arguments)},s.elem=n),e=(e||"").match(Sn)||[""],u=e.length;u--;)a=Rn.exec(e[u])||[],v=h=a[1],m=(a[2]||"").split(".").sort(),v&&(l=on.event.special[v]||{},v=(o?l.delegateType:l.bindType)||v,l=on.event.special[v]||{},f=on.extend({type:v,origType:h,data:r,handler:t,guid:t.guid,selector:o,needsContext:o&&on.expr.match.needsContext.test(o),namespace:m.join(".")},c),(d=i[v])||(d=i[v]=[],d.delegateCount=0,l.setup&&l.setup.call(n,r,m,s)!==!1||(n.addEventListener?n.addEventListener(v,s,!1):n.attachEvent&&n.attachEvent("on"+v,s))),l.add&&(l.add.call(n,f),f.handler.guid||(f.handler.guid=t.guid)),o?d.splice(d.delegateCount++,0,f):d.push(f),on.event.global[v]=!0);n=null}},remove:function(n,e,t,r,o){var a,i,u,c,l,s,f,d,v,m,h,p=on.hasData(n)&&on._data(n);if(p&&(s=p.events)){for(e=(e||"").match(Sn)||[""],l=e.length;l--;)if(u=Rn.exec(e[l])||[],v=h=u[1],m=(u[2]||"").split(".").sort(),v){for(f=on.event.special[v]||{},v=(r?f.delegateType:f.bindType)||v,d=s[v]||[],u=u[2]&&new RegExp("(^|\\.)"+m.join("\\.(?:.*\\.|)")+"(\\.|$)"),c=a=d.length;a--;)i=d[a],!o&&h!==i.origType||t&&t.guid!==i.guid||u&&!u.test(i.namespace)||r&&r!==i.selector&&("**"!==r||!i.selector)||(d.splice(a,1),i.selector&&d.delegateCount--,f.remove&&f.remove.call(n,i));c&&!d.length&&(f.teardown&&f.teardown.call(n,m,p.handle)!==!1||on.removeEvent(n,v,p.handle),delete s[v])}else for(v in s)on.event.remove(n,v+e[l],t,r,!0);on.isEmptyObject(s)&&(delete p.handle,on._removeData(n,"events"))}},trigger:function(e,t,r,o){var a,i,u,c,l,s,f,d=[r||hn],v=en.call(e,"type")?e.type:e,m=en.call(e,"namespace")?e.namespace.split("."):[];if(u=s=r=r||hn,3!==r.nodeType&&8!==r.nodeType&&!On.test(v+on.event.triggered)&&(v.indexOf(".")>=0&&(m=v.split("."),v=m.shift(),m.sort()),i=v.indexOf(":")<0&&"on"+v,e=e[on.expando]?e:new on.Event(v,"object"==typeof e&&e),e.isTrigger=o?2:3,e.namespace=m.join("."),e.namespace_re=e.namespace?new RegExp("(^|\\.)"+m.join("\\.(?:.*\\.|)")+"(\\.|$)"):null,e.result=void 0,e.target||(e.target=r),t=null==t?[e]:on.makeArray(t,[e]),l=on.event.special[v]||{},o||!l.trigger||l.trigger.apply(r,t)!==!1)){if(!o&&!l.noBubble&&!on.isWindow(r)){for(c=l.delegateType||v,On.test(c+v)||(u=u.parentNode);u;u=u.parentNode)d.push(u),s=u;s===(r.ownerDocument||hn)&&d.push(s.defaultView||s.parentWindow||n)}for(f=0;(u=d[f++])&&!e.isPropagationStopped();)e.type=f>1?c:l.bindType||v,a=(on._data(u,"events")||{})[e.type]&&on._data(u,"handle"),a&&a.apply(u,t),a=i&&u[i],a&&a.apply&&on.acceptData(u)&&(e.result=a.apply(u,t),e.result===!1&&e.preventDefault());if(e.type=v,!o&&!e.isDefaultPrevented()&&(!l._default||l._default.apply(d.pop(),t)===!1)&&on.acceptData(r)&&i&&r[v]&&!on.isWindow(r)){s=r[i],s&&(r[i]=null),on.event.triggered=v;try{r[v]()}catch(h){}on.event.triggered=void 0,s&&(r[i]=s)}return e.result}},dispatch:function(n){n=on.event.fix(n);var e,t,r,o,a,i=[],u=Z.call(arguments),c=(on._data(this,"events")||{})[n.type]||[],l=on.event.special[n.type]||{};if(u[0]=n,n.delegateTarget=this,!l.preDispatch||l.preDispatch.call(this,n)!==!1){for(i=on.event.handlers.call(this,n,c),e=0;(o=i[e++])&&!n.isPropagationStopped();)for(n.currentTarget=o.elem,a=0;(r=o.handlers[a++])&&!n.isImmediatePropagationStopped();)n.namespace_re&&!n.namespace_re.test(r.namespace)||(n.handleObj=r,n.data=r.data,t=((on.event.special[r.origType]||{}).handle||r.handler).apply(o.elem,u),void 0!==t&&(n.result=t)===!1&&(n.preventDefault(),n.stopPropagation()));return l.postDispatch&&l.postDispatch.call(this,n),n.result}},handlers:function(n,e){var t,r,o,a,i=[],u=e.delegateCount,c=n.target;if(u&&c.nodeType&&(!n.button||"click"!==n.type))for(;c!=this;c=c.parentNode||this)if(1===c.nodeType&&(c.disabled!==!0||"click"!==n.type)){for(o=[],a=0;u>a;a++)r=e[a],t=r.selector+" ",void 0===o[t]&&(o[t]=r.needsContext?on(t,this).index(c)>=0:on.find(t,this,null,[c]).length),o[t]&&o.push(r);o.length&&i.push({elem:c,handlers:o})}return u<e.length&&i.push({elem:this,handlers:e.slice(u)}),i},fix:function(n){if(n[on.expando])return n;var e,t,r,o=n.type,a=n,i=this.fixHooks[o];for(i||(this.fixHooks[o]=i=In.test(o)?this.mouseHooks:Ln.test(o)?this.keyHooks:{}),r=i.props?this.props.concat(i.props):this.props,n=new on.Event(a),e=r.length;e--;)t=r[e],n[t]=a[t];return n.target||(n.target=a.srcElement||hn),3===n.target.nodeType&&(n.target=n.target.parentNode),n.metaKey=!!n.metaKey,i.filter?i.filter(n,a):n},props:"altKey bubbles cancelable ctrlKey currentTarget eventPhase metaKey relatedTarget shiftKey target timeStamp view which".split(" "),fixHooks:{},keyHooks:{props:"char charCode key keyCode".split(" "),filter:function(n,e){return null==n.which&&(n.which=null!=e.charCode?e.charCode:e.keyCode),n}},mouseHooks:{props:"button buttons clientX clientY fromElement offsetX offsetY pageX pageY screenX screenY toElement".split(" "),filter:function(n,e){var t,r,o,a=e.button,i=e.fromElement;return null==n.pageX&&null!=e.clientX&&(r=n.target.ownerDocument||hn,o=r.documentElement,t=r.body,n.pageX=e.clientX+(o&&o.scrollLeft||t&&t.scrollLeft||0)-(o&&o.clientLeft||t&&t.clientLeft||0),n.pageY=e.clientY+(o&&o.scrollTop||t&&t.scrollTop||0)-(o&&o.clientTop||t&&t.clientTop||0)),!n.relatedTarget&&i&&(n.relatedTarget=i===n.target?e.toElement:i),n.which||void 0===a||(n.which=1&a?1:2&a?3:4&a?2:0),n}},special:{load:{noBubble:!0},focus:{trigger:function(){if(this!==m()&&this.focus)try{return this.focus(),!1}catch(n){}},delegateType:"focusin"},blur:{trigger:function(){return this===m()&&this.blur?(this.blur(),!1):void 0},delegateType:"focusout"},click:{trigger:function(){return on.nodeName(this,"input")&&"checkbox"===this.type&&this.click?(this.click(),!1):void 0},_default:function(n){return on.nodeName(n.target,"a")}},beforeunload:{postDispatch:function(n){void 0!==n.result&&n.originalEvent&&(n.originalEvent.returnValue=n.result)}}},simulate:function(n,e,t,r){var o=on.extend(new on.Event,t,{type:n,isSimulated:!0,originalEvent:{}});r?on.event.trigger(o,null,e):on.event.dispatch.call(e,o),o.isDefaultPrevented()&&t.preventDefault()}},on.removeEvent=hn.removeEventListener?function(n,e,t){n.removeEventListener&&n.removeEventListener(e,t,!1)}:function(n,e,t){var r="on"+e;n.detachEvent&&(typeof n[r]===bn&&(n[r]=null),n.detachEvent(r,t))},on.Event=function(n,e){return this instanceof on.Event?(n&&n.type?(this.originalEvent=n,this.type=n.type,this.isDefaultPrevented=n.defaultPrevented||void 0===n.defaultPrevented&&n.returnValue===!1?d:v):this.type=n,e&&on.extend(this,e),this.timeStamp=n&&n.timeStamp||on.now(),void(this[on.expando]=!0)):new on.Event(n,e)},on.Event.prototype={isDefaultPrevented:v,isPropagationStopped:v,isImmediatePropagationStopped:v,preventDefault:function(){var n=this.originalEvent;this.isDefaultPrevented=d,n&&(n.preventDefault?n.preventDefault():n.returnValue=!1)},stopPropagation:function(){var n=this.originalEvent;this.isPropagationStopped=d,n&&(n.stopPropagation&&n.stopPropagation(),n.cancelBubble=!0)},stopImmediatePropagation:function(){var n=this.originalEvent;this.isImmediatePropagationStopped=d,n&&n.stopImmediatePropagation&&n.stopImmediatePropagation(),this.stopPropagation()}},on.each({mouseenter:"mouseover",mouseleave:"mouseout",pointerenter:"pointerover",pointerleave:"pointerout"},function(n,e){on.event.special[n]={delegateType:e,bindType:e,handle:function(n){var t,r=this,o=n.relatedTarget,a=n.handleObj;return o&&(o===r||on.contains(r,o))||(n.type=a.origType,t=a.handler.apply(this,arguments),n.type=e),t}}}),tn.submitBubbles||(on.event.special.submit={setup:function(){return on.nodeName(this,"form")?!1:void on.event.add(this,"click._submit keypress._submit",function(n){var e=n.target,t=on.nodeName(e,"input")||on.nodeName(e,"button")?e.form:void 0;t&&!on._data(t,"submitBubbles")&&(on.event.add(t,"submit._submit",function(n){n._submit_bubble=!0}),on._data(t,"submitBubbles",!0))})},postDispatch:function(n){n._submit_bubble&&(delete n._submit_bubble,this.parentNode&&!n.isTrigger&&on.event.simulate("submit",this.parentNode,n,!0))},teardown:function(){return on.nodeName(this,"form")?!1:void on.event.remove(this,"._submit")}}),tn.changeBubbles||(on.event.special.change={setup:function(){return Mn.test(this.nodeName)?("checkbox"!==this.type&&"radio"!==this.type||(on.event.add(this,"propertychange._change",function(n){"checked"===n.originalEvent.propertyName&&(this._just_changed=!0)}),on.event.add(this,"click._change",function(n){this._just_changed&&!n.isTrigger&&(this._just_changed=!1),on.event.simulate("change",this,n,!0)})),!1):void on.event.add(this,"beforeactivate._change",function(n){var e=n.target;Mn.test(e.nodeName)&&!on._data(e,"changeBubbles")&&(on.event.add(e,"change._change",function(n){!this.parentNode||n.isSimulated||n.isTrigger||on.event.simulate("change",this.parentNode,n,!0)}),on._data(e,"changeBubbles",!0))})},handle:function(n){var e=n.target;return this!==e||n.isSimulated||n.isTrigger||"radio"!==e.type&&"checkbox"!==e.type?n.handleObj.handler.apply(this,arguments):void 0},teardown:function(){return on.event.remove(this,"._change"),!Mn.test(this.nodeName)}}),tn.focusinBubbles||on.each({focus:"focusin",blur:"focusout"},function(n,e){var t=function(n){on.event.simulate(e,n.target,on.event.fix(n),!0)};on.event.special[e]={setup:function(){var r=this.ownerDocument||this,o=on._data(r,e);o||r.addEventListener(n,t,!0),on._data(r,e,(o||0)+1)},teardown:function(){var r=this.ownerDocument||this,o=on._data(r,e)-1;o?on._data(r,e,o):(r.removeEventListener(n,t,!0),on._removeData(r,e))}}}),on.fn.extend({on:function(n,e,t,r,o){var a,i;if("object"==typeof n){"string"!=typeof e&&(t=t||e,e=void 0);for(a in n)this.on(a,e,t,n[a],o);return this}if(null==t&&null==r?(r=e,t=e=void 0):null==r&&("string"==typeof e?(r=t,t=void 0):(r=t,t=e,e=void 0)),r===!1)r=v;else if(!r)return this;return 1===o&&(i=r,r=function(n){return on().off(n),i.apply(this,arguments)},r.guid=i.guid||(i.guid=on.guid++)),this.each(function(){on.event.add(this,n,r,t,e)})},one:function(n,e,t,r){return this.on(n,e,t,r,1)},off:function(n,e,t){var r,o;if(n&&n.preventDefault&&n.handleObj)return r=n.handleObj,on(n.delegateTarget).off(r.namespace?r.origType+"."+r.namespace:r.origType,r.selector,r.handler),this;if("object"==typeof n){for(o in n)this.off(o,e,n[o]);return this}return e!==!1&&"function"!=typeof e||(t=e,e=void 0),t===!1&&(t=v),this.each(function(){on.event.remove(this,n,t,e)})},trigger:function(n,e){return this.each(function(){on.event.trigger(n,e,this)})},triggerHandler:function(n,e){var t=this[0];return t?on.event.trigger(n,e,t,!0):void 0}});var kn="abbr|article|aside|audio|bdi|canvas|data|datalist|details|figcaption|figure|footer|header|hgroup|mark|meter|nav|output|progress|section|summary|time|video",Un=/ jQuery\d+="(?:null|\d+)"/g,Gn=new RegExp("<(?:"+kn+")[\\s/>]","i"),Bn=/^\s+/,Jn=/<(?!area|br|col|embed|hr|img|input|link|meta|param)(([\w:]+)[^>]*)\/>/gi,$n=/<([\w:]+)/,Hn=/<tbody/i,zn=/<|&#?\w+;/,Wn=/<(?:script|style|link)/i,jn=/checked\s*(?:[^=]|=\s*.checked.)/i,Vn=/^$|\/(?:java|ecma)script/i,qn=/^true\/(.*)/,Zn=/^\s*<!(?:\[CDATA\[|--)|(?:\]\]|--)>\s*$/g,Kn={option:[1,"<select multiple='multiple'>","</select>"],legend:[1,"<fieldset>","</fieldset>"],area:[1,"<map>","</map>"],param:[1,"<object>","</object>"],thead:[1,"<table>","</table>"],tr:[2,"<table><tbody>","</tbody></table>"],col:[2,"<table><tbody></tbody><colgroup>","</colgroup></table>"],td:[3,"<table><tbody><tr>","</tr></tbody></table>"],_default:tn.htmlSerialize?[0,"",""]:[1,"X<div>","</div>"]},Xn=h(hn),Yn=Xn.appendChild(hn.createElement("div"));Kn.optgroup=Kn.option,Kn.tbody=Kn.tfoot=Kn.colgroup=Kn.caption=Kn.thead,Kn.th=Kn.td,on.extend({clone:function(n,e,t){var r,o,a,i,u,c=on.contains(n.ownerDocument,n);if(tn.html5Clone||on.isXMLDoc(n)||!Gn.test("<"+n.nodeName+">")?a=n.cloneNode(!0):(Yn.innerHTML=n.outerHTML,Yn.removeChild(a=Yn.firstChild)),!(tn.noCloneEvent&&tn.noCloneChecked||1!==n.nodeType&&11!==n.nodeType||on.isXMLDoc(n)))for(r=p(a),u=p(n),i=0;null!=(o=u[i]);++i)r[i]&&T(o,r[i]);if(e)if(t)for(u=u||p(n),r=r||p(a),i=0;null!=(o=u[i]);i++)y(o,r[i]);else y(n,a);return r=p(a,"script"),r.length>0&&P(r,!c&&p(n,"script")),r=u=o=null,a},buildFragment:function(n,e,t,r){for(var o,a,i,u,c,l,s,f=n.length,d=h(e),v=[],m=0;f>m;m++)if(a=n[m],a||0===a)if("object"===on.type(a))on.merge(v,a.nodeType?[a]:a);else if(zn.test(a)){for(u=u||d.appendChild(e.createElement("div")),c=($n.exec(a)||["",""])[1].toLowerCase(),s=Kn[c]||Kn._default,u.innerHTML=s[1]+a.replace(Jn,"<$1></$2>")+s[2],o=s[0];o--;)u=u.lastChild;if(!tn.leadingWhitespace&&Bn.test(a)&&v.push(e.createTextNode(Bn.exec(a)[0])),!tn.tbody)for(a="table"!==c||Hn.test(a)?"<table>"!==s[1]||Hn.test(a)?0:u:u.firstChild,o=a&&a.childNodes.length;o--;)on.nodeName(l=a.childNodes[o],"tbody")&&!l.childNodes.length&&a.removeChild(l);for(on.merge(v,u.childNodes),u.textContent="";u.firstChild;)u.removeChild(u.firstChild);u=d.lastChild}else v.push(e.createTextNode(a));for(u&&d.removeChild(u),tn.appendChecked||on.grep(p(v,"input"),w),m=0;a=v[m++];)if((!r||-1===on.inArray(a,r))&&(i=on.contains(a.ownerDocument,a),u=p(d.appendChild(a),"script"),i&&P(u),t))for(o=0;a=u[o++];)Vn.test(a.type||"")&&t.push(a);return u=null,d},cleanData:function(n,e){for(var t,r,o,a,i=0,u=on.expando,c=on.cache,l=tn.deleteExpando,s=on.event.special;null!=(t=n[i]);i++)if((e||on.acceptData(t))&&(o=t[u],a=o&&c[o])){if(a.events)for(r in a.events)s[r]?on.event.remove(t,r):on.removeEvent(t,r,a.handle);c[o]&&(delete c[o],l?delete t[u]:typeof t.removeAttribute!==bn?t.removeAttribute(u):t[u]=null,q.push(o))}}}),on.fn.extend({text:function(n){return _n(this,function(n){return void 0===n?on.text(this):this.empty().append((this[0]&&this[0].ownerDocument||hn).createTextNode(n))},null,n,arguments.length)},append:function(){return this.domManip(arguments,function(n){if(1===this.nodeType||11===this.nodeType||9===this.nodeType){var e=g(this,n);e.appendChild(n)}})},prepend:function(){return this.domManip(arguments,function(n){if(1===this.nodeType||11===this.nodeType||9===this.nodeType){var e=g(this,n);e.insertBefore(n,e.firstChild)}})},before:function(){return this.domManip(arguments,function(n){this.parentNode&&this.parentNode.insertBefore(n,this)})},after:function(){return this.domManip(arguments,function(n){this.parentNode&&this.parentNode.insertBefore(n,this.nextSibling)})},remove:function(n,e){for(var t,r=n?on.filter(n,this):this,o=0;null!=(t=r[o]);o++)e||1!==t.nodeType||on.cleanData(p(t)),t.parentNode&&(e&&on.contains(t.ownerDocument,t)&&P(p(t,"script")),t.parentNode.removeChild(t));return this},empty:function(){for(var n,e=0;null!=(n=this[e]);e++){for(1===n.nodeType&&on.cleanData(p(n,!1));n.firstChild;)n.removeChild(n.firstChild);n.options&&on.nodeName(n,"select")&&(n.options.length=0)}return this},clone:function(n,e){return n=null==n?!1:n,e=null==e?n:e,this.map(function(){return on.clone(this,n,e)})},html:function(n){return _n(this,function(n){var e=this[0]||{},t=0,r=this.length;if(void 0===n)return 1===e.nodeType?e.innerHTML.replace(Un,""):void 0;if("string"==typeof n&&!Wn.test(n)&&(tn.htmlSerialize||!Gn.test(n))&&(tn.leadingWhitespace||!Bn.test(n))&&!Kn[($n.exec(n)||["",""])[1].toLowerCase()]){n=n.replace(Jn,"<$1></$2>");try{for(;r>t;t++)e=this[t]||{},1===e.nodeType&&(on.cleanData(p(e,!1)),e.innerHTML=n);e=0}catch(o){}}e&&this.empty().append(n);
},null,n,arguments.length)},replaceWith:function(){var n=arguments[0];return this.domManip(arguments,function(e){n=this.parentNode,on.cleanData(p(this)),n&&n.replaceChild(e,this)}),n&&(n.length||n.nodeType)?this:this.remove()},detach:function(n){return this.remove(n,!0)},domManip:function(n,e){n=K.apply([],n);var t,r,o,a,i,u,c=0,l=this.length,s=this,f=l-1,d=n[0],v=on.isFunction(d);if(v||l>1&&"string"==typeof d&&!tn.checkClone&&jn.test(d))return this.each(function(t){var r=s.eq(t);v&&(n[0]=d.call(this,t,r.html())),r.domManip(n,e)});if(l&&(u=on.buildFragment(n,this[0].ownerDocument,!1,this),t=u.firstChild,1===u.childNodes.length&&(u=t),t)){for(a=on.map(p(u,"script"),C),o=a.length;l>c;c++)r=u,c!==f&&(r=on.clone(r,!0,!0),o&&on.merge(a,p(r,"script"))),e.call(this[c],r,c);if(o)for(i=a[a.length-1].ownerDocument,on.map(a,S),c=0;o>c;c++)r=a[c],Vn.test(r.type||"")&&!on._data(r,"globalEval")&&on.contains(i,r)&&(r.src?on._evalUrl&&on._evalUrl(r.src):on.globalEval((r.text||r.textContent||r.innerHTML||"").replace(Zn,"")));u=t=null}return this}}),on.each({appendTo:"append",prependTo:"prepend",insertBefore:"before",insertAfter:"after",replaceAll:"replaceWith"},function(n,e){on.fn[n]=function(n){for(var t,r=0,o=[],a=on(n),i=a.length-1;i>=r;r++)t=r===i?this:this.clone(!0),on(a[r])[e](t),X.apply(o,t.get());return this.pushStack(o)}});var Qn,ne={};!function(){var n;tn.shrinkWrapBlocks=function(){if(null!=n)return n;n=!1;var e,t,r;return t=hn.getElementsByTagName("body")[0],t&&t.style?(e=hn.createElement("div"),r=hn.createElement("div"),r.style.cssText="position:absolute;border:0;width:0;height:0;top:0;left:-9999px",t.appendChild(r).appendChild(e),typeof e.style.zoom!==bn&&(e.style.cssText="-webkit-box-sizing:content-box;-moz-box-sizing:content-box;box-sizing:content-box;display:block;margin:0;border:0;padding:1px;width:1px;zoom:1",e.appendChild(hn.createElement("div")).style.width="5px",n=3!==e.offsetWidth),t.removeChild(r),n):void 0}}();var ee,te,re=/^margin/,oe=new RegExp("^("+Fn+")(?!px)[a-z%]+$","i"),ae=/^(top|right|bottom|left)$/;n.getComputedStyle?(ee=function(e){return e.ownerDocument.defaultView.opener?e.ownerDocument.defaultView.getComputedStyle(e,null):n.getComputedStyle(e,null)},te=function(n,e,t){var r,o,a,i,u=n.style;return t=t||ee(n),i=t?t.getPropertyValue(e)||t[e]:void 0,t&&(""!==i||on.contains(n.ownerDocument,n)||(i=on.style(n,e)),oe.test(i)&&re.test(e)&&(r=u.width,o=u.minWidth,a=u.maxWidth,u.minWidth=u.maxWidth=u.width=i,i=t.width,u.width=r,u.minWidth=o,u.maxWidth=a)),void 0===i?i:i+""}):hn.documentElement.currentStyle&&(ee=function(n){return n.currentStyle},te=function(n,e,t){var r,o,a,i,u=n.style;return t=t||ee(n),i=t?t[e]:void 0,null==i&&u&&u[e]&&(i=u[e]),oe.test(i)&&!ae.test(e)&&(r=u.left,o=n.runtimeStyle,a=o&&o.left,a&&(o.left=n.currentStyle.left),u.left="fontSize"===e?"1em":i,i=u.pixelLeft+"px",u.left=r,a&&(o.left=a)),void 0===i?i:i+""||"auto"}),function(){function e(){var e,t,r,o;t=hn.getElementsByTagName("body")[0],t&&t.style&&(e=hn.createElement("div"),r=hn.createElement("div"),r.style.cssText="position:absolute;border:0;width:0;height:0;top:0;left:-9999px",t.appendChild(r).appendChild(e),e.style.cssText="-webkit-box-sizing:border-box;-moz-box-sizing:border-box;box-sizing:border-box;display:block;margin-top:1%;top:1%;border:1px;padding:1px;width:4px;position:absolute",a=i=!1,c=!0,n.getComputedStyle&&(a="1%"!==(n.getComputedStyle(e,null)||{}).top,i="4px"===(n.getComputedStyle(e,null)||{width:"4px"}).width,o=e.appendChild(hn.createElement("div")),o.style.cssText=e.style.cssText="-webkit-box-sizing:content-box;-moz-box-sizing:content-box;box-sizing:content-box;display:block;margin:0;border:0;padding:0",o.style.marginRight=o.style.width="0",e.style.width="1px",c=!parseFloat((n.getComputedStyle(o,null)||{}).marginRight),e.removeChild(o)),e.innerHTML="<table><tr><td></td><td>t</td></tr></table>",o=e.getElementsByTagName("td"),o[0].style.cssText="margin:0;border:0;padding:0;display:none",u=0===o[0].offsetHeight,u&&(o[0].style.display="",o[1].style.display="none",u=0===o[0].offsetHeight),t.removeChild(r))}var t,r,o,a,i,u,c;t=hn.createElement("div"),t.innerHTML="  <link/><table></table><a href='/a'>a</a><input type='checkbox'/>",o=t.getElementsByTagName("a")[0],r=o&&o.style,r&&(r.cssText="float:left;opacity:.5",tn.opacity="0.5"===r.opacity,tn.cssFloat=!!r.cssFloat,t.style.backgroundClip="content-box",t.cloneNode(!0).style.backgroundClip="",tn.clearCloneStyle="content-box"===t.style.backgroundClip,tn.boxSizing=""===r.boxSizing||""===r.MozBoxSizing||""===r.WebkitBoxSizing,on.extend(tn,{reliableHiddenOffsets:function(){return null==u&&e(),u},boxSizingReliable:function(){return null==i&&e(),i},pixelPosition:function(){return null==a&&e(),a},reliableMarginRight:function(){return null==c&&e(),c}}))}(),on.swap=function(n,e,t,r){var o,a,i={};for(a in e)i[a]=n.style[a],n.style[a]=e[a];o=t.apply(n,r||[]);for(a in e)n.style[a]=i[a];return o};var ie=/alpha\([^)]*\)/i,ue=/opacity\s*=\s*([^)]*)/,ce=/^(none|table(?!-c[ea]).+)/,le=new RegExp("^("+Fn+")(.*)$","i"),se=new RegExp("^([+-])=("+Fn+")","i"),fe={position:"absolute",visibility:"hidden",display:"block"},de={letterSpacing:"0",fontWeight:"400"},ve=["Webkit","O","Moz","ms"];on.extend({cssHooks:{opacity:{get:function(n,e){if(e){var t=te(n,"opacity");return""===t?"1":t}}}},cssNumber:{columnCount:!0,fillOpacity:!0,flexGrow:!0,flexShrink:!0,fontWeight:!0,lineHeight:!0,opacity:!0,order:!0,orphans:!0,widows:!0,zIndex:!0,zoom:!0},cssProps:{"float":tn.cssFloat?"cssFloat":"styleFloat"},style:function(n,e,t,r){if(n&&3!==n.nodeType&&8!==n.nodeType&&n.style){var o,a,i,u=on.camelCase(e),c=n.style;if(e=on.cssProps[u]||(on.cssProps[u]=F(c,u)),i=on.cssHooks[e]||on.cssHooks[u],void 0===t)return i&&"get"in i&&void 0!==(o=i.get(n,!1,r))?o:c[e];if(a=typeof t,"string"===a&&(o=se.exec(t))&&(t=(o[1]+1)*o[2]+parseFloat(on.css(n,e)),a="number"),null!=t&&t===t&&("number"!==a||on.cssNumber[u]||(t+="px"),tn.clearCloneStyle||""!==t||0!==e.indexOf("background")||(c[e]="inherit"),!(i&&"set"in i&&void 0===(t=i.set(n,t,r)))))try{c[e]=t}catch(l){}}},css:function(n,e,t,r){var o,a,i,u=on.camelCase(e);return e=on.cssProps[u]||(on.cssProps[u]=F(n.style,u)),i=on.cssHooks[e]||on.cssHooks[u],i&&"get"in i&&(a=i.get(n,!0,t)),void 0===a&&(a=te(n,e,r)),"normal"===a&&e in de&&(a=de[e]),""===t||t?(o=parseFloat(a),t===!0||on.isNumeric(o)?o||0:a):a}}),on.each(["height","width"],function(n,e){on.cssHooks[e]={get:function(n,t,r){return t?ce.test(on.css(n,"display"))&&0===n.offsetWidth?on.swap(n,fe,function(){return D(n,e,r)}):D(n,e,r):void 0},set:function(n,t,r){var o=r&&ee(n);return N(n,t,r?_(n,e,r,tn.boxSizing&&"border-box"===on.css(n,"boxSizing",!1,o),o):0)}}}),tn.opacity||(on.cssHooks.opacity={get:function(n,e){return ue.test((e&&n.currentStyle?n.currentStyle.filter:n.style.filter)||"")?.01*parseFloat(RegExp.$1)+"":e?"1":""},set:function(n,e){var t=n.style,r=n.currentStyle,o=on.isNumeric(e)?"alpha(opacity="+100*e+")":"",a=r&&r.filter||t.filter||"";t.zoom=1,(e>=1||""===e)&&""===on.trim(a.replace(ie,""))&&t.removeAttribute&&(t.removeAttribute("filter"),""===e||r&&!r.filter)||(t.filter=ie.test(a)?a.replace(ie,o):a+" "+o)}}),on.cssHooks.marginRight=x(tn.reliableMarginRight,function(n,e){return e?on.swap(n,{display:"inline-block"},te,[n,"marginRight"]):void 0}),on.each({margin:"",padding:"",border:"Width"},function(n,e){on.cssHooks[n+e]={expand:function(t){for(var r=0,o={},a="string"==typeof t?t.split(" "):[t];4>r;r++)o[n+An[r]+e]=a[r]||a[r-2]||a[0];return o}},re.test(n)||(on.cssHooks[n+e].set=N)}),on.fn.extend({css:function(n,e){return _n(this,function(n,e,t){var r,o,a={},i=0;if(on.isArray(e)){for(r=ee(n),o=e.length;o>i;i++)a[e[i]]=on.css(n,e[i],!1,r);return a}return void 0!==t?on.style(n,e,t):on.css(n,e)},n,e,arguments.length>1)},show:function(){return A(this,!0)},hide:function(){return A(this)},toggle:function(n){return"boolean"==typeof n?n?this.show():this.hide():this.each(function(){Nn(this)?on(this).show():on(this).hide()})}}),on.Tween=M,M.prototype={constructor:M,init:function(n,e,t,r,o,a){this.elem=n,this.prop=t,this.easing=o||"swing",this.options=e,this.start=this.now=this.cur(),this.end=r,this.unit=a||(on.cssNumber[t]?"":"px")},cur:function(){var n=M.propHooks[this.prop];return n&&n.get?n.get(this):M.propHooks._default.get(this)},run:function(n){var e,t=M.propHooks[this.prop];return this.options.duration?this.pos=e=on.easing[this.easing](n,this.options.duration*n,0,1,this.options.duration):this.pos=e=n,this.now=(this.end-this.start)*e+this.start,this.options.step&&this.options.step.call(this.elem,this.now,this),t&&t.set?t.set(this):M.propHooks._default.set(this),this}},M.prototype.init.prototype=M.prototype,M.propHooks={_default:{get:function(n){var e;return null==n.elem[n.prop]||n.elem.style&&null!=n.elem.style[n.prop]?(e=on.css(n.elem,n.prop,""),e&&"auto"!==e?e:0):n.elem[n.prop]},set:function(n){on.fx.step[n.prop]?on.fx.step[n.prop](n):n.elem.style&&(null!=n.elem.style[on.cssProps[n.prop]]||on.cssHooks[n.prop])?on.style(n.elem,n.prop,n.now+n.unit):n.elem[n.prop]=n.now}}},M.propHooks.scrollTop=M.propHooks.scrollLeft={set:function(n){n.elem.nodeType&&n.elem.parentNode&&(n.elem[n.prop]=n.now)}},on.easing={linear:function(n){return n},swing:function(n){return.5-Math.cos(n*Math.PI)/2}},on.fx=M.prototype.init,on.fx.step={};var me,he,pe=/^(?:toggle|show|hide)$/,we=new RegExp("^(?:([+-])=|)("+Fn+")([a-z%]*)$","i"),ge=/queueHooks$/,Ce=[R],Se={"*":[function(n,e){var t=this.createTween(n,e),r=t.cur(),o=we.exec(e),a=o&&o[3]||(on.cssNumber[n]?"":"px"),i=(on.cssNumber[n]||"px"!==a&&+r)&&we.exec(on.css(t.elem,n)),u=1,c=20;if(i&&i[3]!==a){a=a||i[3],o=o||[],i=+r||1;do u=u||".5",i/=u,on.style(t.elem,n,i+a);while(u!==(u=t.cur()/r)&&1!==u&&--c)}return o&&(i=t.start=+i||+r||0,t.unit=a,t.end=o[1]?i+(o[1]+1)*o[2]:+o[2]),t}]};on.Animation=on.extend(U,{tweener:function(n,e){on.isFunction(n)?(e=n,n=["*"]):n=n.split(" ");for(var t,r=0,o=n.length;o>r;r++)t=n[r],Se[t]=Se[t]||[],Se[t].unshift(e)},prefilter:function(n,e){e?Ce.unshift(n):Ce.push(n)}}),on.speed=function(n,e,t){var r=n&&"object"==typeof n?on.extend({},n):{complete:t||!t&&e||on.isFunction(n)&&n,duration:n,easing:t&&e||e&&!on.isFunction(e)&&e};return r.duration=on.fx.off?0:"number"==typeof r.duration?r.duration:r.duration in on.fx.speeds?on.fx.speeds[r.duration]:on.fx.speeds._default,null!=r.queue&&r.queue!==!0||(r.queue="fx"),r.old=r.complete,r.complete=function(){on.isFunction(r.old)&&r.old.call(this),r.queue&&on.dequeue(this,r.queue)},r},on.fn.extend({fadeTo:function(n,e,t,r){return this.filter(Nn).css("opacity",0).show().end().animate({opacity:e},n,t,r)},animate:function(n,e,t,r){var o=on.isEmptyObject(n),a=on.speed(e,t,r),i=function(){var e=U(this,on.extend({},n),a);(o||on._data(this,"finish"))&&e.stop(!0)};return i.finish=i,o||a.queue===!1?this.each(i):this.queue(a.queue,i)},stop:function(n,e,t){var r=function(n){var e=n.stop;delete n.stop,e(t)};return"string"!=typeof n&&(t=e,e=n,n=void 0),e&&n!==!1&&this.queue(n||"fx",[]),this.each(function(){var e=!0,o=null!=n&&n+"queueHooks",a=on.timers,i=on._data(this);if(o)i[o]&&i[o].stop&&r(i[o]);else for(o in i)i[o]&&i[o].stop&&ge.test(o)&&r(i[o]);for(o=a.length;o--;)a[o].elem!==this||null!=n&&a[o].queue!==n||(a[o].anim.stop(t),e=!1,a.splice(o,1));!e&&t||on.dequeue(this,n)})},finish:function(n){return n!==!1&&(n=n||"fx"),this.each(function(){var e,t=on._data(this),r=t[n+"queue"],o=t[n+"queueHooks"],a=on.timers,i=r?r.length:0;for(t.finish=!0,on.queue(this,n,[]),o&&o.stop&&o.stop.call(this,!0),e=a.length;e--;)a[e].elem===this&&a[e].queue===n&&(a[e].anim.stop(!0),a.splice(e,1));for(e=0;i>e;e++)r[e]&&r[e].finish&&r[e].finish.call(this);delete t.finish})}}),on.each(["toggle","show","hide"],function(n,e){var t=on.fn[e];on.fn[e]=function(n,r,o){return null==n||"boolean"==typeof n?t.apply(this,arguments):this.animate(I(e,!0),n,r,o)}}),on.each({slideDown:I("show"),slideUp:I("hide"),slideToggle:I("toggle"),fadeIn:{opacity:"show"},fadeOut:{opacity:"hide"},fadeToggle:{opacity:"toggle"}},function(n,e){on.fn[n]=function(n,t,r){return this.animate(e,n,t,r)}}),on.timers=[],on.fx.tick=function(){var n,e=on.timers,t=0;for(me=on.now();t<e.length;t++)n=e[t],n()||e[t]!==n||e.splice(t--,1);e.length||on.fx.stop(),me=void 0},on.fx.timer=function(n){on.timers.push(n),n()?on.fx.start():on.timers.pop()},on.fx.interval=13,on.fx.start=function(){he||(he=setInterval(on.fx.tick,on.fx.interval))},on.fx.stop=function(){clearInterval(he),he=null},on.fx.speeds={slow:600,fast:200,_default:400},on.fn.delay=function(n,e){return n=on.fx?on.fx.speeds[n]||n:n,e=e||"fx",this.queue(e,function(e,t){var r=setTimeout(e,n);t.stop=function(){clearTimeout(r)}})},function(){var n,e,t,r,o;e=hn.createElement("div"),e.setAttribute("className","t"),e.innerHTML="  <link/><table></table><a href='/a'>a</a><input type='checkbox'/>",r=e.getElementsByTagName("a")[0],t=hn.createElement("select"),o=t.appendChild(hn.createElement("option")),n=e.getElementsByTagName("input")[0],r.style.cssText="top:1px",tn.getSetAttribute="t"!==e.className,tn.style=/top/.test(r.getAttribute("style")),tn.hrefNormalized="/a"===r.getAttribute("href"),tn.checkOn=!!n.value,tn.optSelected=o.selected,tn.enctype=!!hn.createElement("form").enctype,t.disabled=!0,tn.optDisabled=!o.disabled,n=hn.createElement("input"),n.setAttribute("value",""),tn.input=""===n.getAttribute("value"),n.value="t",n.setAttribute("type","radio"),tn.radioValue="t"===n.value}();var Pe=/\r/g;on.fn.extend({val:function(n){var e,t,r,o=this[0];{if(arguments.length)return r=on.isFunction(n),this.each(function(t){var o;1===this.nodeType&&(o=r?n.call(this,t,on(this).val()):n,null==o?o="":"number"==typeof o?o+="":on.isArray(o)&&(o=on.map(o,function(n){return null==n?"":n+""})),e=on.valHooks[this.type]||on.valHooks[this.nodeName.toLowerCase()],e&&"set"in e&&void 0!==e.set(this,o,"value")||(this.value=o))});if(o)return e=on.valHooks[o.type]||on.valHooks[o.nodeName.toLowerCase()],e&&"get"in e&&void 0!==(t=e.get(o,"value"))?t:(t=o.value,"string"==typeof t?t.replace(Pe,""):null==t?"":t)}}}),on.extend({valHooks:{option:{get:function(n){var e=on.find.attr(n,"value");return null!=e?e:on.trim(on.text(n))}},select:{get:function(n){for(var e,t,r=n.options,o=n.selectedIndex,a="select-one"===n.type||0>o,i=a?null:[],u=a?o+1:r.length,c=0>o?u:a?o:0;u>c;c++)if(t=r[c],(t.selected||c===o)&&(tn.optDisabled?!t.disabled:null===t.getAttribute("disabled"))&&(!t.parentNode.disabled||!on.nodeName(t.parentNode,"optgroup"))){if(e=on(t).val(),a)return e;i.push(e)}return i},set:function(n,e){for(var t,r,o=n.options,a=on.makeArray(e),i=o.length;i--;)if(r=o[i],on.inArray(on.valHooks.option.get(r),a)>=0)try{r.selected=t=!0}catch(u){r.scrollHeight}else r.selected=!1;return t||(n.selectedIndex=-1),o}}}}),on.each(["radio","checkbox"],function(){on.valHooks[this]={set:function(n,e){return on.isArray(e)?n.checked=on.inArray(on(n).val(),e)>=0:void 0}},tn.checkOn||(on.valHooks[this].get=function(n){return null===n.getAttribute("value")?"on":n.value})});var ye,Te,be=on.expr.attrHandle,Ee=/^(?:checked|selected)$/i,xe=tn.getSetAttribute,Fe=tn.input;on.fn.extend({attr:function(n,e){return _n(this,on.attr,n,e,arguments.length>1)},removeAttr:function(n){return this.each(function(){on.removeAttr(this,n)})}}),on.extend({attr:function(n,e,t){var r,o,a=n.nodeType;if(n&&3!==a&&8!==a&&2!==a)return typeof n.getAttribute===bn?on.prop(n,e,t):(1===a&&on.isXMLDoc(n)||(e=e.toLowerCase(),r=on.attrHooks[e]||(on.expr.match.bool.test(e)?Te:ye)),void 0===t?r&&"get"in r&&null!==(o=r.get(n,e))?o:(o=on.find.attr(n,e),null==o?void 0:o):null!==t?r&&"set"in r&&void 0!==(o=r.set(n,t,e))?o:(n.setAttribute(e,t+""),t):void on.removeAttr(n,e))},removeAttr:function(n,e){var t,r,o=0,a=e&&e.match(Sn);if(a&&1===n.nodeType)for(;t=a[o++];)r=on.propFix[t]||t,on.expr.match.bool.test(t)?Fe&&xe||!Ee.test(t)?n[r]=!1:n[on.camelCase("default-"+t)]=n[r]=!1:on.attr(n,t,""),n.removeAttribute(xe?t:r)},attrHooks:{type:{set:function(n,e){if(!tn.radioValue&&"radio"===e&&on.nodeName(n,"input")){var t=n.value;return n.setAttribute("type",e),t&&(n.value=t),e}}}}}),Te={set:function(n,e,t){return e===!1?on.removeAttr(n,t):Fe&&xe||!Ee.test(t)?n.setAttribute(!xe&&on.propFix[t]||t,t):n[on.camelCase("default-"+t)]=n[t]=!0,t}},on.each(on.expr.match.bool.source.match(/\w+/g),function(n,e){var t=be[e]||on.find.attr;be[e]=Fe&&xe||!Ee.test(e)?function(n,e,r){var o,a;return r||(a=be[e],be[e]=o,o=null!=t(n,e,r)?e.toLowerCase():null,be[e]=a),o}:function(n,e,t){return t?void 0:n[on.camelCase("default-"+e)]?e.toLowerCase():null}}),Fe&&xe||(on.attrHooks.value={set:function(n,e,t){return on.nodeName(n,"input")?void(n.defaultValue=e):ye&&ye.set(n,e,t)}}),xe||(ye={set:function(n,e,t){var r=n.getAttributeNode(t);return r||n.setAttributeNode(r=n.ownerDocument.createAttribute(t)),r.value=e+="","value"===t||e===n.getAttribute(t)?e:void 0}},be.id=be.name=be.coords=function(n,e,t){var r;return t?void 0:(r=n.getAttributeNode(e))&&""!==r.value?r.value:null},on.valHooks.button={get:function(n,e){var t=n.getAttributeNode(e);return t&&t.specified?t.value:void 0},set:ye.set},on.attrHooks.contenteditable={set:function(n,e,t){ye.set(n,""===e?!1:e,t)}},on.each(["width","height"],function(n,e){on.attrHooks[e]={set:function(n,t){return""===t?(n.setAttribute(e,"auto"),t):void 0}}})),tn.style||(on.attrHooks.style={get:function(n){return n.style.cssText||void 0},set:function(n,e){return n.style.cssText=e+""}});var Ae=/^(?:input|select|textarea|button|object)$/i,Ne=/^(?:a|area)$/i;on.fn.extend({prop:function(n,e){return _n(this,on.prop,n,e,arguments.length>1)},removeProp:function(n){return n=on.propFix[n]||n,this.each(function(){try{this[n]=void 0,delete this[n]}catch(e){}})}}),on.extend({propFix:{"for":"htmlFor","class":"className"},prop:function(n,e,t){var r,o,a,i=n.nodeType;if(n&&3!==i&&8!==i&&2!==i)return a=1!==i||!on.isXMLDoc(n),a&&(e=on.propFix[e]||e,o=on.propHooks[e]),void 0!==t?o&&"set"in o&&void 0!==(r=o.set(n,t,e))?r:n[e]=t:o&&"get"in o&&null!==(r=o.get(n,e))?r:n[e]},propHooks:{tabIndex:{get:function(n){var e=on.find.attr(n,"tabindex");return e?parseInt(e,10):Ae.test(n.nodeName)||Ne.test(n.nodeName)&&n.href?0:-1}}}}),tn.hrefNormalized||on.each(["href","src"],function(n,e){on.propHooks[e]={get:function(n){return n.getAttribute(e,4)}}}),tn.optSelected||(on.propHooks.selected={get:function(n){var e=n.parentNode;return e&&(e.selectedIndex,e.parentNode&&e.parentNode.selectedIndex),null}}),on.each(["tabIndex","readOnly","maxLength","cellSpacing","cellPadding","rowSpan","colSpan","useMap","frameBorder","contentEditable"],function(){on.propFix[this.toLowerCase()]=this}),tn.enctype||(on.propFix.enctype="encoding");var _e=/[\t\r\n\f]/g;on.fn.extend({addClass:function(n){var e,t,r,o,a,i,u=0,c=this.length,l="string"==typeof n&&n;if(on.isFunction(n))return this.each(function(e){on(this).addClass(n.call(this,e,this.className))});if(l)for(e=(n||"").match(Sn)||[];c>u;u++)if(t=this[u],r=1===t.nodeType&&(t.className?(" "+t.className+" ").replace(_e," "):" ")){for(a=0;o=e[a++];)r.indexOf(" "+o+" ")<0&&(r+=o+" ");i=on.trim(r),t.className!==i&&(t.className=i)}return this},removeClass:function(n){var e,t,r,o,a,i,u=0,c=this.length,l=0===arguments.length||"string"==typeof n&&n;if(on.isFunction(n))return this.each(function(e){on(this).removeClass(n.call(this,e,this.className))});if(l)for(e=(n||"").match(Sn)||[];c>u;u++)if(t=this[u],r=1===t.nodeType&&(t.className?(" "+t.className+" ").replace(_e," "):"")){for(a=0;o=e[a++];)for(;r.indexOf(" "+o+" ")>=0;)r=r.replace(" "+o+" "," ");i=n?on.trim(r):"",t.className!==i&&(t.className=i)}return this},toggleClass:function(n,e){var t=typeof n;return"boolean"==typeof e&&"string"===t?e?this.addClass(n):this.removeClass(n):on.isFunction(n)?this.each(function(t){on(this).toggleClass(n.call(this,t,this.className,e),e)}):this.each(function(){if("string"===t)for(var e,r=0,o=on(this),a=n.match(Sn)||[];e=a[r++];)o.hasClass(e)?o.removeClass(e):o.addClass(e);else t!==bn&&"boolean"!==t||(this.className&&on._data(this,"__className__",this.className),this.className=this.className||n===!1?"":on._data(this,"__className__")||"")})},hasClass:function(n){for(var e=" "+n+" ",t=0,r=this.length;r>t;t++)if(1===this[t].nodeType&&(" "+this[t].className+" ").replace(_e," ").indexOf(e)>=0)return!0;return!1}}),on.each("blur focus focusin focusout load resize scroll unload click dblclick mousedown mouseup mousemove mouseover mouseout mouseenter mouseleave change select submit keydown keypress keyup error contextmenu".split(" "),function(n,e){on.fn[e]=function(n,t){return arguments.length>0?this.on(e,null,n,t):this.trigger(e)}}),on.fn.extend({hover:function(n,e){return this.mouseenter(n).mouseleave(e||n)},bind:function(n,e,t){return this.on(n,null,e,t)},unbind:function(n,e){return this.off(n,null,e)},delegate:function(n,e,t,r){return this.on(e,n,t,r)},undelegate:function(n,e,t){return 1===arguments.length?this.off(n,"**"):this.off(e,n||"**",t)}});var De=on.now(),Me=/\?/,Le=/(,)|(\[|{)|(}|])|"(?:[^"\\\r\n]|\\["\\\/bfnrt]|\\u[\da-fA-F]{4})*"\s*:?|true|false|null|-?(?!0\d)\d+(?:\.\d+|)(?:[eE][+-]?\d+|)/g;on.parseJSON=function(e){if(n.JSON&&n.JSON.parse)return n.JSON.parse(e+"");var t,r=null,o=on.trim(e+"");return o&&!on.trim(o.replace(Le,function(n,e,o,a){return t&&e&&(r=0),0===r?n:(t=o||e,r+=!a-!o,"")}))?Function("return "+o)():on.error("Invalid JSON: "+e)},on.parseXML=function(e){var t,r;if(!e||"string"!=typeof e)return null;try{n.DOMParser?(r=new DOMParser,t=r.parseFromString(e,"text/xml")):(t=new ActiveXObject("Microsoft.XMLDOM"),t.async="false",t.loadXML(e))}catch(o){t=void 0}return t&&t.documentElement&&!t.getElementsByTagName("parsererror").length||on.error("Invalid XML: "+e),t};var Ie,Oe,Re=/#.*$/,ke=/([?&])_=[^&]*/,Ue=/^(.*?):[ \t]*([^\r\n]*)\r?$/gm,Ge=/^(?:about|app|app-storage|.+-extension|file|res|widget):$/,Be=/^(?:GET|HEAD)$/,Je=/^\/\//,$e=/^([\w.+-]+:)(?:\/\/(?:[^\/?#]*@|)([^\/?#:]*)(?::(\d+)|)|)/,He={},ze={},We="*/".concat("*");try{Oe=location.href}catch(je){Oe=hn.createElement("a"),Oe.href="",Oe=Oe.href}Ie=$e.exec(Oe.toLowerCase())||[],on.extend({active:0,lastModified:{},etag:{},ajaxSettings:{url:Oe,type:"GET",isLocal:Ge.test(Ie[1]),global:!0,processData:!0,async:!0,contentType:"application/x-www-form-urlencoded; charset=UTF-8",accepts:{"*":We,text:"text/plain",html:"text/html",xml:"application/xml, text/xml",json:"application/json, text/javascript"},contents:{xml:/xml/,html:/html/,json:/json/},responseFields:{xml:"responseXML",text:"responseText",json:"responseJSON"},converters:{"* text":String,"text html":!0,"text json":on.parseJSON,"text xml":on.parseXML},flatOptions:{url:!0,context:!0}},ajaxSetup:function(n,e){return e?J(J(n,on.ajaxSettings),e):J(on.ajaxSettings,n)},ajaxPrefilter:G(He),ajaxTransport:G(ze),ajax:function(n,e){function t(n,e,t,r){var o,s,w,g,S,y=e;2!==C&&(C=2,u&&clearTimeout(u),l=void 0,i=r||"",P.readyState=n>0?4:0,o=n>=200&&300>n||304===n,t&&(g=$(f,P,t)),g=H(f,g,P,o),o?(f.ifModified&&(S=P.getResponseHeader("Last-Modified"),S&&(on.lastModified[a]=S),S=P.getResponseHeader("etag"),S&&(on.etag[a]=S)),204===n||"HEAD"===f.type?y="nocontent":304===n?y="notmodified":(y=g.state,s=g.data,w=g.error,o=!w)):(w=y,!n&&y||(y="error",0>n&&(n=0))),P.status=n,P.statusText=(e||y)+"",o?m.resolveWith(d,[s,y,P]):m.rejectWith(d,[P,y,w]),P.statusCode(p),p=void 0,c&&v.trigger(o?"ajaxSuccess":"ajaxError",[P,f,o?s:w]),h.fireWith(d,[P,y]),c&&(v.trigger("ajaxComplete",[P,f]),--on.active||on.event.trigger("ajaxStop")))}"object"==typeof n&&(e=n,n=void 0),e=e||{};var r,o,a,i,u,c,l,s,f=on.ajaxSetup({},e),d=f.context||f,v=f.context&&(d.nodeType||d.jquery)?on(d):on.event,m=on.Deferred(),h=on.Callbacks("once memory"),p=f.statusCode||{},w={},g={},C=0,S="canceled",P={readyState:0,getResponseHeader:function(n){var e;if(2===C){if(!s)for(s={};e=Ue.exec(i);)s[e[1].toLowerCase()]=e[2];e=s[n.toLowerCase()]}return null==e?null:e},getAllResponseHeaders:function(){return 2===C?i:null},setRequestHeader:function(n,e){var t=n.toLowerCase();return C||(n=g[t]=g[t]||n,w[n]=e),this},overrideMimeType:function(n){return C||(f.mimeType=n),this},statusCode:function(n){var e;if(n)if(2>C)for(e in n)p[e]=[p[e],n[e]];else P.always(n[P.status]);return this},abort:function(n){var e=n||S;return l&&l.abort(e),t(0,e),this}};if(m.promise(P).complete=h.add,P.success=P.done,P.error=P.fail,f.url=((n||f.url||Oe)+"").replace(Re,"").replace(Je,Ie[1]+"//"),f.type=e.method||e.type||f.method||f.type,f.dataTypes=on.trim(f.dataType||"*").toLowerCase().match(Sn)||[""],null==f.crossDomain&&(r=$e.exec(f.url.toLowerCase()),f.crossDomain=!(!r||r[1]===Ie[1]&&r[2]===Ie[2]&&(r[3]||("http:"===r[1]?"80":"443"))===(Ie[3]||("http:"===Ie[1]?"80":"443")))),f.data&&f.processData&&"string"!=typeof f.data&&(f.data=on.param(f.data,f.traditional)),B(He,f,e,P),2===C)return P;c=on.event&&f.global,c&&0===on.active++&&on.event.trigger("ajaxStart"),f.type=f.type.toUpperCase(),f.hasContent=!Be.test(f.type),a=f.url,f.hasContent||(f.data&&(a=f.url+=(Me.test(a)?"&":"?")+f.data,delete f.data),f.cache===!1&&(f.url=ke.test(a)?a.replace(ke,"$1_="+De++):a+(Me.test(a)?"&":"?")+"_="+De++)),f.ifModified&&(on.lastModified[a]&&P.setRequestHeader("If-Modified-Since",on.lastModified[a]),on.etag[a]&&P.setRequestHeader("If-None-Match",on.etag[a])),(f.data&&f.hasContent&&f.contentType!==!1||e.contentType)&&P.setRequestHeader("Content-Type",f.contentType),P.setRequestHeader("Accept",f.dataTypes[0]&&f.accepts[f.dataTypes[0]]?f.accepts[f.dataTypes[0]]+("*"!==f.dataTypes[0]?", "+We+"; q=0.01":""):f.accepts["*"]);for(o in f.headers)P.setRequestHeader(o,f.headers[o]);if(f.beforeSend&&(f.beforeSend.call(d,P,f)===!1||2===C))return P.abort();S="abort";for(o in{success:1,error:1,complete:1})P[o](f[o]);if(l=B(ze,f,e,P)){P.readyState=1,c&&v.trigger("ajaxSend",[P,f]),f.async&&f.timeout>0&&(u=setTimeout(function(){P.abort("timeout")},f.timeout));try{C=1,l.send(w,t)}catch(y){if(!(2>C))throw y;t(-1,y)}}else t(-1,"No Transport");return P},getJSON:function(n,e,t){return on.get(n,e,t,"json")},getScript:function(n,e){return on.get(n,void 0,e,"script")}}),on.each(["get","post"],function(n,e){on[e]=function(n,t,r,o){return on.isFunction(t)&&(o=o||r,r=t,t=void 0),on.ajax({url:n,type:e,dataType:o,data:t,success:r})}}),on._evalUrl=function(n){return on.ajax({url:n,type:"GET",dataType:"script",async:!1,global:!1,"throws":!0})},on.fn.extend({wrapAll:function(n){if(on.isFunction(n))return this.each(function(e){on(this).wrapAll(n.call(this,e))});if(this[0]){var e=on(n,this[0].ownerDocument).eq(0).clone(!0);this[0].parentNode&&e.insertBefore(this[0]),e.map(function(){for(var n=this;n.firstChild&&1===n.firstChild.nodeType;)n=n.firstChild;return n}).append(this)}return this},wrapInner:function(n){return on.isFunction(n)?this.each(function(e){on(this).wrapInner(n.call(this,e))}):this.each(function(){var e=on(this),t=e.contents();t.length?t.wrapAll(n):e.append(n)})},wrap:function(n){var e=on.isFunction(n);return this.each(function(t){on(this).wrapAll(e?n.call(this,t):n)})},unwrap:function(){return this.parent().each(function(){on.nodeName(this,"body")||on(this).replaceWith(this.childNodes)}).end()}}),on.expr.filters.hidden=function(n){return n.offsetWidth<=0&&n.offsetHeight<=0||!tn.reliableHiddenOffsets()&&"none"===(n.style&&n.style.display||on.css(n,"display"))},on.expr.filters.visible=function(n){return!on.expr.filters.hidden(n)};var Ve=/%20/g,qe=/\[\]$/,Ze=/\r?\n/g,Ke=/^(?:submit|button|image|reset|file)$/i,Xe=/^(?:input|select|textarea|keygen)/i;on.param=function(n,e){var t,r=[],o=function(n,e){e=on.isFunction(e)?e():null==e?"":e,r[r.length]=encodeURIComponent(n)+"="+encodeURIComponent(e)};if(void 0===e&&(e=on.ajaxSettings&&on.ajaxSettings.traditional),on.isArray(n)||n.jquery&&!on.isPlainObject(n))on.each(n,function(){o(this.name,this.value)});else for(t in n)z(t,n[t],e,o);return r.join("&").replace(Ve,"+")},on.fn.extend({serialize:function(){return on.param(this.serializeArray())},serializeArray:function(){return this.map(function(){var n=on.prop(this,"elements");return n?on.makeArray(n):this}).filter(function(){var n=this.type;return this.name&&!on(this).is(":disabled")&&Xe.test(this.nodeName)&&!Ke.test(n)&&(this.checked||!Dn.test(n))}).map(function(n,e){var t=on(this).val();return null==t?null:on.isArray(t)?on.map(t,function(n){return{name:e.name,value:n.replace(Ze,"\r\n")}}):{name:e.name,value:t.replace(Ze,"\r\n")}}).get()}}),on.ajaxSettings.xhr=void 0!==n.ActiveXObject?function(){return!this.isLocal&&/^(get|post|head|put|delete|options)$/i.test(this.type)&&W()||j()}:W;var Ye=0,Qe={},nt=on.ajaxSettings.xhr();n.attachEvent&&n.attachEvent("onunload",function(){for(var n in Qe)Qe[n](void 0,!0)}),tn.cors=!!nt&&"withCredentials"in nt,nt=tn.ajax=!!nt,nt&&on.ajaxTransport(function(n){if(!n.crossDomain||tn.cors){var e;return{send:function(t,r){var o,a=n.xhr(),i=++Ye;if(a.open(n.type,n.url,n.async,n.username,n.password),n.xhrFields)for(o in n.xhrFields)a[o]=n.xhrFields[o];n.mimeType&&a.overrideMimeType&&a.overrideMimeType(n.mimeType),n.crossDomain||t["X-Requested-With"]||(t["X-Requested-With"]="XMLHttpRequest");for(o in t)void 0!==t[o]&&a.setRequestHeader(o,t[o]+"");a.send(n.hasContent&&n.data||null),e=function(t,o){var u,c,l;if(e&&(o||4===a.readyState))if(delete Qe[i],e=void 0,a.onreadystatechange=on.noop,o)4!==a.readyState&&a.abort();else{l={},u=a.status,"string"==typeof a.responseText&&(l.text=a.responseText);try{c=a.statusText}catch(s){c=""}u||!n.isLocal||n.crossDomain?1223===u&&(u=204):u=l.text?200:404}l&&r(u,c,l,a.getAllResponseHeaders())},n.async?4===a.readyState?setTimeout(e):a.onreadystatechange=Qe[i]=e:e()},abort:function(){e&&e(void 0,!0)}}}}),on.ajaxSetup({accepts:{script:"text/javascript, application/javascript, application/ecmascript, application/x-ecmascript"},contents:{script:/(?:java|ecma)script/},converters:{"text script":function(n){return on.globalEval(n),n}}}),on.ajaxPrefilter("script",function(n){void 0===n.cache&&(n.cache=!1),n.crossDomain&&(n.type="GET",n.global=!1)}),on.ajaxTransport("script",function(n){if(n.crossDomain){var e,t=hn.head||on("head")[0]||hn.documentElement;return{send:function(r,o){e=hn.createElement("script"),e.async=!0,n.scriptCharset&&(e.charset=n.scriptCharset),e.src=n.url,e.onload=e.onreadystatechange=function(n,t){(t||!e.readyState||/loaded|complete/.test(e.readyState))&&(e.onload=e.onreadystatechange=null,e.parentNode&&e.parentNode.removeChild(e),e=null,t||o(200,"success"))},t.insertBefore(e,t.firstChild)},abort:function(){e&&e.onload(void 0,!0)}}}});var et=[],tt=/(=)\?(?=&|$)|\?\?/;on.ajaxSetup({jsonp:"callback",jsonpCallback:function(){var n=et.pop()||on.expando+"_"+De++;return this[n]=!0,n}}),on.ajaxPrefilter("json jsonp",function(e,t,r){var o,a,i,u=e.jsonp!==!1&&(tt.test(e.url)?"url":"string"==typeof e.data&&!(e.contentType||"").indexOf("application/x-www-form-urlencoded")&&tt.test(e.data)&&"data");return u||"jsonp"===e.dataTypes[0]?(o=e.jsonpCallback=on.isFunction(e.jsonpCallback)?e.jsonpCallback():e.jsonpCallback,u?e[u]=e[u].replace(tt,"$1"+o):e.jsonp!==!1&&(e.url+=(Me.test(e.url)?"&":"?")+e.jsonp+"="+o),e.converters["script json"]=function(){return i||on.error(o+" was not called"),i[0]},e.dataTypes[0]="json",a=n[o],n[o]=function(){i=arguments},r.always(function(){n[o]=a,e[o]&&(e.jsonpCallback=t.jsonpCallback,et.push(o)),i&&on.isFunction(a)&&a(i[0]),i=a=void 0}),"script"):void 0}),on.parseHTML=function(n,e,t){if(!n||"string"!=typeof n)return null;"boolean"==typeof e&&(t=e,e=!1),e=e||hn;var r=dn.exec(n),o=!t&&[];return r?[e.createElement(r[1])]:(r=on.buildFragment([n],e,o),o&&o.length&&on(o).remove(),on.merge([],r.childNodes))};var rt=on.fn.load;on.fn.load=function(n,e,t){if("string"!=typeof n&&rt)return rt.apply(this,arguments);var r,o,a,i=this,u=n.indexOf(" ");return u>=0&&(r=on.trim(n.slice(u,n.length)),n=n.slice(0,u)),on.isFunction(e)?(t=e,e=void 0):e&&"object"==typeof e&&(a="POST"),i.length>0&&on.ajax({url:n,type:a,dataType:"html",data:e}).done(function(n){o=arguments,i.html(r?on("<div>").append(on.parseHTML(n)).find(r):n)}).complete(t&&function(n,e){i.each(t,o||[n.responseText,e,n])}),this},on.each(["ajaxStart","ajaxStop","ajaxComplete","ajaxError","ajaxSuccess","ajaxSend"],function(n,e){
on.fn[e]=function(n){return this.on(e,n)}}),on.expr.filters.animated=function(n){return on.grep(on.timers,function(e){return n===e.elem}).length};var ot=n.document.documentElement;on.offset={setOffset:function(n,e,t){var r,o,a,i,u,c,l,s=on.css(n,"position"),f=on(n),d={};"static"===s&&(n.style.position="relative"),u=f.offset(),a=on.css(n,"top"),c=on.css(n,"left"),l=("absolute"===s||"fixed"===s)&&on.inArray("auto",[a,c])>-1,l?(r=f.position(),i=r.top,o=r.left):(i=parseFloat(a)||0,o=parseFloat(c)||0),on.isFunction(e)&&(e=e.call(n,t,u)),null!=e.top&&(d.top=e.top-u.top+i),null!=e.left&&(d.left=e.left-u.left+o),"using"in e?e.using.call(n,d):f.css(d)}},on.fn.extend({offset:function(n){if(arguments.length)return void 0===n?this:this.each(function(e){on.offset.setOffset(this,n,e)});var e,t,r={top:0,left:0},o=this[0],a=o&&o.ownerDocument;if(a)return e=a.documentElement,on.contains(e,o)?(typeof o.getBoundingClientRect!==bn&&(r=o.getBoundingClientRect()),t=V(a),{top:r.top+(t.pageYOffset||e.scrollTop)-(e.clientTop||0),left:r.left+(t.pageXOffset||e.scrollLeft)-(e.clientLeft||0)}):r},position:function(){if(this[0]){var n,e,t={top:0,left:0},r=this[0];return"fixed"===on.css(r,"position")?e=r.getBoundingClientRect():(n=this.offsetParent(),e=this.offset(),on.nodeName(n[0],"html")||(t=n.offset()),t.top+=on.css(n[0],"borderTopWidth",!0),t.left+=on.css(n[0],"borderLeftWidth",!0)),{top:e.top-t.top-on.css(r,"marginTop",!0),left:e.left-t.left-on.css(r,"marginLeft",!0)}}},offsetParent:function(){return this.map(function(){for(var n=this.offsetParent||ot;n&&!on.nodeName(n,"html")&&"static"===on.css(n,"position");)n=n.offsetParent;return n||ot})}}),on.each({scrollLeft:"pageXOffset",scrollTop:"pageYOffset"},function(n,e){var t=/Y/.test(e);on.fn[n]=function(r){return _n(this,function(n,r,o){var a=V(n);return void 0===o?a?e in a?a[e]:a.document.documentElement[r]:n[r]:void(a?a.scrollTo(t?on(a).scrollLeft():o,t?o:on(a).scrollTop()):n[r]=o)},n,r,arguments.length,null)}}),on.each(["top","left"],function(n,e){on.cssHooks[e]=x(tn.pixelPosition,function(n,t){return t?(t=te(n,e),oe.test(t)?on(n).position()[e]+"px":t):void 0})}),on.each({Height:"height",Width:"width"},function(n,e){on.each({padding:"inner"+n,content:e,"":"outer"+n},function(t,r){on.fn[r]=function(r,o){var a=arguments.length&&(t||"boolean"!=typeof r),i=t||(r===!0||o===!0?"margin":"border");return _n(this,function(e,t,r){var o;return on.isWindow(e)?e.document.documentElement["client"+n]:9===e.nodeType?(o=e.documentElement,Math.max(e.body["scroll"+n],o["scroll"+n],e.body["offset"+n],o["offset"+n],o["client"+n])):void 0===r?on.css(e,t,i):on.style(e,t,r,i)},e,a?r:void 0,a,null)}})}),on.fn.size=function(){return this.length},on.fn.andSelf=on.fn.addBack,"function"==typeof define&&define.amd&&define("jquery",[],function(){return on});var at=n.jQuery,it=n.$;return on.noConflict=function(e){return n.$===on&&(n.$=it),e&&n.jQuery===on&&(n.jQuery=at),on},typeof e===bn&&(n.jQuery=n.$=on),on});var PS={};!function(n){"use strict";n.arrayMap=function(n){return function(e){for(var t=e.length,r=new Array(t),o=0;t>o;o++)r[o]=n(e[o]);return r}},n.arrayBind=function(n){return function(e){for(var t=[],r=0,o=n.length;o>r;r++)Array.prototype.push.apply(t,e(n[r]));return t}},n.concatArray=function(n){return function(e){return n.concat(e)}},n.intAdd=function(n){return function(e){return n+e|0}},n.intMul=function(n){return function(e){return n*e|0}},n.numAdd=function(n){return function(e){return n+e}},n.numMul=function(n){return function(e){return n*e}},n.intDiv=function(n){return function(e){return n/e|0}},n.intMod=function(n){return function(e){return n%e}},n.numDiv=function(n){return function(e){return n/e}},n.numSub=function(n){return function(e){return n-e}},n.refEq=function(n){return function(e){return n===e}},n.unsafeCompareImpl=function(n){return function(e){return function(t){return function(r){return function(o){return o>r?n:r>o?t:e}}}}},n.topInt=2147483647,n.bottomInt=-2147483648,n.boolOr=function(n){return function(e){return n||e}},n.boolAnd=function(n){return function(e){return n&&e}},n.boolNot=function(n){return!n},n.showIntImpl=function(n){return n.toString()},n.showNumberImpl=function(n){return n===(0|n)?n+".0":n.toString()},n.showCharImpl=function(n){var e=n.charCodeAt(0);if(32>e||127===e){switch(n){case"":return"'\\a'";case"\b":return"'\\b'";case"\f":return"'\\f'";case"\n":return"'\\n'";case"\r":return"'\\r'";case"	":return"'\\t'";case"\x0B":return"'\\v'"}return"'\\"+e.toString(10)+"'"}return"'"===n||"\\"===n?"'\\"+n+"'":"'"+n+"'"},n.showStringImpl=function(n){var e=n.length;return'"'+n.replace(/[\0-\x1F\x7F"\\]/g,function(t,r){switch(t){case'"':case"\\":return"\\"+t;case"":return"\\a";case"\b":return"\\b";case"\f":return"\\f";case"\n":return"\\n";case"\r":return"\\r";case"	":return"\\t";case"\x0B":return"\\v"}var o=r+1,a=e>o&&n[o]>="0"&&n[o]<="9"?"\\&":"";return"\\"+t.charCodeAt(0).toString(10)+a})+'"'},n.showArrayImpl=function(n){return function(e){for(var t=[],r=0,o=e.length;o>r;r++)t[r]=n(e[r]);return"["+t.join(",")+"]"}}}(PS.Prelude=PS.Prelude||{}),function(n){"use strict";var e=PS.Prelude,t=function(){function n(){}return n.value=new n,n}(),r=function(){function n(){}return n.value=new n,n}(),o=function(){function n(){}return n.value=new n,n}(),a=function(n){this.compose=n},i=function(n,e){this["__superclass_Prelude.Semigroupoid_0"]=n,this.id=e},u=function(n){this.map=n},c=function(n,e){this["__superclass_Prelude.Functor_0"]=n,this.apply=e},l=function(n,e){this["__superclass_Prelude.Apply_0"]=n,this.pure=e},s=function(n,e){this["__superclass_Prelude.Apply_0"]=n,this.bind=e},f=function(n,e){this["__superclass_Prelude.Applicative_0"]=n,this["__superclass_Prelude.Bind_1"]=e},d=function(n){this.append=n},v=function(n,e,t,r){this.add=n,this.mul=e,this.one=t,this.zero=r},m=function(n,e){this["__superclass_Prelude.Semiring_0"]=n,this.sub=e},h=function(n,e,t){this["__superclass_Prelude.Semiring_0"]=n,this.div=e,this.mod=t},p=function(n,e){this["__superclass_Prelude.ModuloSemiring_1"]=n,this["__superclass_Prelude.Ring_0"]=e},w=function(n){this["__superclass_Prelude.DivisionRing_0"]=n},g=function(n){this.eq=n},C=function(n,e){this["__superclass_Prelude.Eq_0"]=n,this.compare=e},S=function(n,e){this.bottom=n,this.top=e},P=function(n,e,t,r){this["__superclass_Prelude.Bounded_0"]=n,this.conj=e,this.disj=t,this.not=r},y=function(n){this.show=n},T=function(n){return n.zero},b=e.unsafeCompareImpl(t.value)(o.value)(r.value),E={},x=function(n){return n.top},F=function(n){return n.sub},A=function(n){return F(n)},N=new y(e.showStringImpl),_=new y(e.showNumberImpl),D=new y(e.showIntImpl),M=new y(e.showCharImpl),L=new y(function(n){if(n)return"true";if(!n)return"false";throw new Error("Failed pattern match at Prelude line 842, column 3 - line 843, column 3: "+[n.constructor.name])}),I=function(n){return n.show},O=function(n){return new y(e.showArrayImpl(I(n)))},R=new v(e.numAdd,e.numMul,1,0),k=new v(e.intAdd,e.intMul,1,0),U=new a(function(n){return function(e){return function(t){return n(e(t))}}}),G=new d(e.concatArray),B=new m(function(){return R},e.numSub),J=function(n){return n.pure},$=function(n){return J(n)},H=!0,z=function(n){return n.one},W=function(n){return n.not},j=function(n){return n.mul},V=function(n){return j(n)},q=new h(function(){return R},e.numDiv,function(n){return function(n){return 0}}),Z=new h(function(){return k},e.intDiv,e.intMod),K=function(n){return n.mod},X=function(n){return n.map},Y=function(n){return X(n)},Q=function(n){return n.id},nn=new u(e.arrayMap),en=function(n){return function(e){return function(t){return n(t)(e)}}},tn=new g(e.refEq),rn=new C(function(){return tn},b),on=new g(e.refEq),an=new C(function(){return on},b),un=function(n){return n.eq},cn=function(n){return un(n)},ln=new p(function(){return q},function(){return B}),sn=new w(function(){return ln}),fn=function(n){return n.div},dn=function(n){return n.disj},vn=function(n){return function(e){return n}},mn=function(n){return n.conj},hn=function(n){return n.compose},pn=function(n){return n.compare},wn=function(n){return function(e){return function(r){var o=pn(n)(e)(r);return o instanceof t}}},gn=new i(function(){return U},function(n){return n}),Cn=new S(e.bottomInt,e.topInt),Sn=new S(!1,!0),Pn=function(n){return n.bottom},yn=new P(function(){return Sn},e.boolAnd,e.boolOr,e.boolNot),Tn=function(n){return function(e){return function(t){return W(yn)(cn(n)(e)(t))}}},bn=function(n){return n.bind},En=function(n){return function(e){return function(t){return bn(n["__superclass_Prelude.Bind_1"]())(t)(function(t){return $(n["__superclass_Prelude.Applicative_0"]())(e(t))})}}},xn=function(n){return bn(n)},Fn=function(n){return n.apply},An=function(n){return Fn(n)},Nn=function(n){return function(e){return function(t){return An(n["__superclass_Prelude.Apply_0"]())(J(n)(e))(t)}}},_n=function(n){return n.append},Dn=function(n){return _n(n)},Mn=function(n){return _n(n)},Ln=function(n){return function(e){return function(t){return bn(n["__superclass_Prelude.Bind_1"]())(e)(function(e){return bn(n["__superclass_Prelude.Bind_1"]())(t)(function(t){return $(n["__superclass_Prelude.Applicative_0"]())(e(t))})})}}},In=new f(function(){return kn},function(){return On}),On=new s(function(){return Rn},e.arrayBind),Rn=new c(function(){return nn},Ln(In)),kn=new l(function(){return Rn},function(n){return[n]}),Un=function(n){return n.add},Gn=function(n){return Un(n)};n.LT=t,n.GT=r,n.EQ=o,n.Show=y,n.BooleanAlgebra=P,n.Bounded=S,n.Ord=C,n.Eq=g,n.DivisionRing=p,n.Num=w,n.Ring=m,n.ModuloSemiring=h,n.Semiring=v,n.Semigroup=d,n.Monad=f,n.Bind=s,n.Applicative=l,n.Apply=c,n.Functor=u,n.Category=i,n.Semigroupoid=a,n.show=I,n.not=W,n.disj=dn,n.conj=mn,n.bottom=Pn,n.top=x,n.unsafeCompare=b,n["<"]=wn,n.compare=pn,n["/="]=Tn,n["=="]=cn,n.eq=un,n["-"]=A,n.sub=F,n.mod=K,n.div=fn,n["*"]=V,n["+"]=Gn,n.one=z,n.mul=j,n.zero=T,n.add=Un,n["++"]=Dn,n["<>"]=Mn,n.append=_n,n.ap=Ln,n.liftM1=En,n["return"]=$,n[">>="]=xn,n.bind=bn,n.liftA1=Nn,n.pure=J,n["<*>"]=An,n.apply=Fn,n["<$>"]=Y,n.map=X,n.id=Q,n.compose=hn,n.otherwise=H,n["const"]=vn,n.flip=en,n.unit=E,n.semigroupoidFn=U,n.categoryFn=gn,n.functorArray=nn,n.applyArray=Rn,n.applicativeArray=kn,n.bindArray=On,n.monadArray=In,n.semigroupArray=G,n.semiringInt=k,n.semiringNumber=R,n.ringNumber=B,n.moduloSemiringInt=Z,n.moduloSemiringNumber=q,n.divisionRingNumber=ln,n.numNumber=sn,n.eqInt=on,n.eqNumber=tn,n.ordInt=an,n.ordNumber=rn,n.boundedBoolean=Sn,n.boundedInt=Cn,n.booleanAlgebraBoolean=yn,n.showBoolean=L,n.showInt=D,n.showNumber=_,n.showChar=M,n.showString=N,n.showArray=O}(PS.Prelude=PS.Prelude||{}),function(n){"use strict";var e=(PS.Prelude,function(n,e){this["__superclass_Prelude.Semigroup_0"]=n,this.mempty=e}),t=function(n){return n.mempty};n.Monoid=e,n.mempty=t}(PS["Data.Monoid"]=PS["Data.Monoid"]||{}),function(n){"use strict";var e=PS.Prelude,t=(PS["Control.Alt"],PS["Control.Alternative"],PS["Control.Extend"],PS["Control.MonadPlus"],PS["Control.Plus"],PS["Data.Functor.Invariant"],PS["Data.Monoid"],function(){function n(){}return n.value=new n,n}()),r=function(){function n(n){this.value0=n}return n.create=function(e){return new n(e)},n}(),o=function(n){return new e.Show(function(o){if(o instanceof r)return"Just ("+(e.show(n)(o.value0)+")");if(o instanceof t)return"Nothing";throw new Error("Failed pattern match at Data.Maybe line 290, column 3 - line 291, column 3: "+[o.constructor.name])})},a=function(n){return function(e){return function(o){if(o instanceof t)return n;if(o instanceof r)return e(o.value0);throw new Error("Failed pattern match at Data.Maybe line 27, column 1 - line 28, column 1: "+[n.constructor.name,e.constructor.name,o.constructor.name])}}},i=a(!1)(e["const"](!0)),u=new e.Functor(function(n){return function(e){return e instanceof r?new r(n(e.value0)):t.value}}),c=function(n){return a(n)(e.id(e.categoryFn))},l=new e.Apply(function(){return u},function(n){return function(o){if(n instanceof r)return e["<$>"](u)(n.value0)(o);if(n instanceof t)return t.value;throw new Error("Failed pattern match at Data.Maybe line 122, column 3 - line 123, column 3: "+[n.constructor.name,o.constructor.name])}});n.Nothing=t,n.Just=r,n.isJust=i,n.fromMaybe=c,n.maybe=a,n.functorMaybe=u,n.applyMaybe=l,n.showMaybe=o}(PS["Data.Maybe"]=PS["Data.Maybe"]||{}),function(n){"use strict";n.fail=function(n){throw new Error(n)},n.undef=function(){throw new Error("Encountered undefined")},n.unsafeCoerce=function(n){return n},n.mapE=function(n){return function(e){return function(){for(var t=new Array(e.length),r=0;r<e.length;r++)t[r]=n(e[r])();return t}}},n.mapE_=function(n){return function(e){return function(){for(var t=0;t<e.length;t++)n(e[t])()}}},n.mapEBreak_=function(n){return function(e){return function(t){return function(){for(var r=0;r<t.length;r++){n(t[r])();var o=e(r)();if(o)break}}}}},n.alert=function(n){return function(){return window.alert(n),{}}}}(PS.Extensions=PS.Extensions||{}),function(n){"use strict";n.traverseArrayImpl=function(){function n(n){this.fn=n}function e(n){return function(e){return new o(n,e)}}function t(n){for(var e=[];n!==r;)e.push(n.head),n=n.tail;return e}var r={},o=function(n,e){this.head=n,this.tail=e};return function(o){return function(a){return function(i){return function(u){var c=function(n,t){return o(a(e)(u(n)))(t)},l=function(e,t,r){if(0===t)return e;var o=r[t-1];return new n(function(){return l(c(o,e),t-1,r)})};return function(e){for(var o=l(i(r),e.length,e);o instanceof n;)o=o.fn();return a(t)(o)}}}}}}()}(PS["Data.Traversable"]=PS["Data.Traversable"]||{}),function(n){"use strict";n.foldrArray=function(n){return function(e){return function(t){for(var r=e,o=t.length,a=o-1;a>=0;a--)r=n(t[a])(r);return r}}},n.foldlArray=function(n){return function(e){return function(t){for(var r=e,o=t.length,a=0;o>a;a++)r=n(r)(t[a]);return r}}}}(PS["Data.Foldable"]=PS["Data.Foldable"]||{}),function(n){"use strict";var e=PS.Prelude,t=function(n){return function(t){return function(r){return e["<*>"](n)(e["<$>"](n["__superclass_Prelude.Functor_0"]())(e["const"](e.id(e.categoryFn)))(t))(r)}}},r=function(n){return function(t){return function(r){return function(o){return e["<*>"](n)(e["<$>"](n["__superclass_Prelude.Functor_0"]())(t)(r))(o)}}}};n.lift2=r,n["*>"]=t}(PS["Control.Apply"]=PS["Control.Apply"]||{}),function(n){"use strict";var e=PS.Prelude,t=(PS["Control.Comonad"],PS["Control.Extend"],PS["Data.Monoid"]),r=function(n){return n},o=function(n){return new e.Semigroup(function(t){return function(r){return e.disj(n)(t)(r)}})},a=function(n){return n},i=function(n){return new t.Monoid(function(){return o(n)},e.bottom(n["__superclass_Prelude.Bounded_0"]()))};n.Disj=r,n.runDisj=a,n.semigroupDisj=o,n.monoidDisj=i}(PS["Data.Monoid.Disj"]=PS["Data.Monoid.Disj"]||{}),function(n){"use strict";var e=PS["Data.Foldable"],t=PS.Prelude,r=(PS["Control.Apply"],PS["Data.Maybe"],PS["Data.Maybe.First"],PS["Data.Maybe.Last"],PS["Data.Monoid"]),o=(PS["Data.Monoid.Additive"],PS["Data.Monoid.Conj"],PS["Data.Monoid.Disj"]),a=(PS["Data.Monoid.Dual"],PS["Data.Monoid.Endo"],PS["Data.Monoid.Multiplicative"],function(n,e,t){this.foldMap=n,this.foldl=e,this.foldr=t}),i=function(n){return n.foldr},u=function(n){return n.foldl},c=function(n){return function(e){return u(n)(t["+"](e))(t.zero(e))}},l=function(n){return function(e){return function(o){return function(a){return i(n)(function(n){return function(r){return t["<>"](e["__superclass_Prelude.Semigroup_0"]())(o(n))(r)}})(r.mempty(e))(a)}}}},s=new a(function(n){return l(s)(n)},e.foldlArray,e.foldrArray),f=function(n){return n.foldMap},d=function(n){return function(e){return function(t){return function(r){return o.runDisj(f(n)(o.monoidDisj(e))(function(n){return o.Disj(t(n))})(r))}}}},v=function(n){return function(e){return function(r){return d(n)(t.booleanAlgebraBoolean)(t["=="](e)(r))}}};n.Foldable=a,n.elem=v,n.sum=c,n.any=d,n.foldMapDefaultR=l,n.foldMap=f,n.foldl=u,n.foldr=i,n.foldableArray=s}(PS["Data.Foldable"]=PS["Data.Foldable"]||{}),function(n){"use strict";var e=PS["Data.Traversable"],t=PS.Prelude,r=PS["Data.Foldable"],o=(PS["Data.Maybe"],PS["Data.Maybe.First"],PS["Data.Maybe.Last"],PS["Data.Monoid.Additive"],PS["Data.Monoid.Conj"],PS["Data.Monoid.Disj"],PS["Data.Monoid.Dual"],PS["Data.Monoid.Multiplicative"],function(n,e,t,r){this["__superclass_Data.Foldable.Foldable_1"]=n,this["__superclass_Prelude.Functor_0"]=e,this.sequence=t,this.traverse=r}),a=function(n){return n.traverse},i=function(n){return function(e){return function(r){return a(n)(e)(t.id(t.categoryFn))(r)}}},u=new o(function(){return r.foldableArray},function(){return t.functorArray},function(n){return i(u)(n)},function(n){return e.traverseArrayImpl(t.apply(n["__superclass_Prelude.Apply_0"]()))(t.map(n["__superclass_Prelude.Apply_0"]()["__superclass_Prelude.Functor_0"]()))(t.pure(n))}),c=function(n){return n.sequence};n.Traversable=o,n.sequenceDefault=i,n.sequence=c,n.traverse=a,n.traversableArray=u}(PS["Data.Traversable"]=PS["Data.Traversable"]||{}),function(n){"use strict";n.returnE=function(n){return function(){return n}},n.bindE=function(n){return function(e){return function(){return e(n())()}}},n.runPure=function(n){return n()}}(PS["Control.Monad.Eff"]=PS["Control.Monad.Eff"]||{}),function(n){"use strict";var e=PS["Control.Monad.Eff"],t=PS.Prelude,r=new t.Monad(function(){return i},function(){return o}),o=new t.Bind(function(){return a},e.bindE),a=new t.Apply(function(){return u},t.ap(r)),i=new t.Applicative(function(){return a},e.returnE),u=new t.Functor(t.liftA1(i));n.functorEff=u,n.applyEff=a,n.applicativeEff=i,n.bindEff=o,n.monadEff=r,n.runPure=e.runPure}(PS["Control.Monad.Eff"]=PS["Control.Monad.Eff"]||{}),function(n){"use strict";n.range=function(n){return function(e){for(var t=n>e?-1:1,r=[],o=n,a=0;o!==e;o+=t)r[a++]=o;return r[a]=o,r}},n.replicate=function(n){return function(e){if(1>n)return[];for(var t=new Array(n),r=0;n>r;r++)t[r]=e;return t}},n.length=function(n){return n.length},n.cons=function(n){return function(e){return[n].concat(e)}},n["uncons'"]=function(n){return function(e){return function(t){return 0===t.length?n({}):e(t[0])(t.slice(1))}}},n.concat=function(n){for(var e=[],t=0,r=n.length;r>t;t++)for(var o=n[t],a=0,i=o.length;i>a;a++)e.push(o[a]);return e},n.filter=function(n){return function(e){return e.filter(n)}},n.sortImpl=function(n){return function(e){return e.slice().sort(function(e,t){return n(e)(t)})}},n.slice=function(n){return function(e){return function(t){return t.slice(n,e)}}},n.zipWith=function(n){return function(e){return function(t){for(var r=e.length<t.length?e.length:t.length,o=new Array(r),a=0;r>a;a++)o[a]=n(e[a])(t[a]);return o}}}}(PS["Data.Array"]=PS["Data.Array"]||{}),function(n){"use strict";var e=PS.Prelude,t=(PS["Control.Biapplicative"],PS["Control.Biapply"],PS["Control.Comonad"],PS["Control.Extend"],PS["Control.Lazy"],PS["Data.Bifoldable"],PS["Data.Bifunctor"],PS["Data.Bitraversable"],PS["Data.Foldable"]),r=(PS["Data.Functor.Invariant"],PS["Data.Maybe"],PS["Data.Maybe.First"],PS["Data.Monoid"],PS["Data.Traversable"]),o=function(){function n(n,e){this.value0=n,this.value1=e}return n.create=function(e){return function(t){return new n(e,t)}},n}(),a=function(n){return function(e){return n(e.value0)(e.value1)}},i=new e.Functor(function(n){return function(e){return new o(e.value0,n(e.value1))}}),u=new t.Foldable(function(n){return function(n){return function(e){return n(e.value1)}}},function(n){return function(e){return function(t){return n(e)(t.value1)}}},function(n){return function(e){return function(t){return n(t.value1)(e)}}}),c=new r.Traversable(function(){return u},function(){return i},function(n){return function(t){return e["<$>"](n["__superclass_Prelude.Apply_0"]()["__superclass_Prelude.Functor_0"]())(o.create(t.value0))(t.value1)}},function(n){return function(t){return function(r){return e["<$>"](n["__superclass_Prelude.Apply_0"]()["__superclass_Prelude.Functor_0"]())(o.create(r.value0))(t(r.value1))}}});n.Tuple=o,n.uncurry=a,n.functorTuple=i,n.foldableTuple=u,n.traversableTuple=c}(PS["Data.Tuple"]=PS["Data.Tuple"]||{}),function(n){"use strict";n.unsafeThrow=function(n){throw new Error(n)}}(PS["Data.Maybe.Unsafe"]=PS["Data.Maybe.Unsafe"]||{}),function(n){"use strict";var e=PS["Data.Maybe.Unsafe"],t=(PS.Prelude,PS["Data.Maybe"]),r=function(n){if(n instanceof t.Just)return n.value0;if(n instanceof t.Nothing)return e.unsafeThrow("Data.Maybe.Unsafe.fromJust called on Nothing");throw new Error("Failed pattern match at Data.Maybe.Unsafe line 11, column 1 - line 12, column 1: "+[n.constructor.name])};n.fromJust=r,n.unsafeThrow=e.unsafeThrow}(PS["Data.Maybe.Unsafe"]=PS["Data.Maybe.Unsafe"]||{}),function(n){"use strict";var e=PS["Data.Array"],t=PS.Prelude,r=(PS["Control.Alt"],PS["Control.Alternative"],PS["Control.Lazy"],PS["Control.MonadPlus"],PS["Control.Plus"],PS["Data.Foldable"],PS["Data.Functor.Invariant"],PS["Data.Maybe"]),o=(PS["Data.Monoid"],PS["Data.Traversable"],PS["Data.Tuple"],PS["Data.Maybe.Unsafe"],e.cons),a=e.range,i=e["uncons'"](t["const"](r.Nothing.value))(function(n){return function(e){return new r.Just({head:n,tail:e})}}),u=function(n){return function(r){var o=function(e){return function(r){var o=n(e)(r);if(o instanceof t.GT)return 1;if(o instanceof t.EQ)return 0;if(o instanceof t.LT)return-1;throw new Error("Failed pattern match at Data.Array line 417, column 15 - line 422, column 1: "+[o.constructor.name])}};return e.sortImpl(o)(r)}},c=function(n){return[n]},l=function(n){return 0===e.length(n)},s=function(n){return function(r){return function(o){return e["uncons'"](function(e){return t["return"](n["__superclass_Prelude.Applicative_0"]())(o)})(function(e){return function(a){return t[">>="](n["__superclass_Prelude.Bind_1"]())(r(o)(e))(function(e){return s(n)(r)(e)(a)})}})}}},f=t.flip(t.bind(t.bindArray)),d=function(n){return f(function(e){return r.maybe([])(c)(n(e))})};n.foldM=s,n.sortBy=u,n.mapMaybe=d,n.concatMap=f,n.uncons=i,n[":"]=o,n["null"]=l,n[".."]=a,n.singleton=c,n.zipWith=e.zipWith,n.slice=e.slice,n.filter=e.filter,n.concat=e.concat,n.length=e.length,n.replicate=e.replicate,n.range=e.range}(PS["Data.Array"]=PS["Data.Array"]||{}),function(n){"use strict";n.abs=Math.abs,n.atan2=function(n){return function(e){return Math.atan2(n,e)}},n.cos=Math.cos,n.floor=Math.floor,n.max=function(n){return function(e){return Math.max(n,e)}},n.min=function(n){return function(e){return Math.min(n,e)}},n.round=Math.round,n.sin=Math.sin,n.sqrt=Math.sqrt,n.pi=Math.PI}(PS.Math=PS.Math||{}),function(n){"use strict";var e=PS.Math;n.pi=e.pi,n.sqrt=e.sqrt,n.sin=e.sin,n.round=e.round,n.min=e.min,n.max=e.max,n.floor=e.floor,n.cos=e.cos,n.atan2=e.atan2,n.abs=e.abs}(PS.Math=PS.Math||{}),function(n){"use strict";var e=PS.Extensions,t=PS.Prelude,r=PS["Data.Traversable"],o=(PS["Control.Monad.Eff"],PS["Data.Array"]),a=PS.Math,i=function(n){if(n>0)return 1;if(0>n)return-1;if(t.otherwise)return 0;throw new Error("Failed pattern match at Extensions line 35, column 1 - line 36, column 1: "+[n.constructor.name])},u=function(n){return function(e){var t=n%e,r=i(t)===-i(e);if(r)return t+e|0;if(!r)return t;throw new Error("Failed pattern match at Extensions line 31, column 18 - line 32, column 21: "+[r.constructor.name])}},c=function(n){return function(e){return n-a.floor(n/e)*e}},l=function(n){return function(e){return function(o){return r.sequence(r.traversableArray)(n["__superclass_Prelude.Applicative_0"]())(t.map(t.functorArray)(e)(o))}}},s=function(n){return function(e){var t=n>e;if(t)return[];if(!t)return o.range(n)(e);throw new Error("Failed pattern match at Extensions line 27, column 14 - line 30, column 1: "+[t.constructor.name])}},f=function(n){return function(e){return function(r){return t[">>="](n)(e)(t["const"](r))}}};n.mapM=l,n.modFloat=c,n.signum=i,n.modInt=u,n.hRange=s,n.bindConst=f,n.alert=e.alert,n.mapEBreak_=e.mapEBreak_,n.mapE_=e.mapE_,n.mapE=e.mapE,n.unsafeCoerce=e.unsafeCoerce,n.undef=e.undef,n.fail=e.fail}(PS.Extensions=PS.Extensions||{}),function(n){"use strict";n.parseJSONImpl=function(n,e,t){try{return e(JSON.parse(t))}catch(r){return n(r.toString())}},n.unsafeFromForeign=function(n){return n},n.typeOf=function(n){return typeof n},n.tagOf=function(n){return Object.prototype.toString.call(n).slice(8,-1)},n.isNull=function(n){return null===n},n.isUndefined=function(n){return void 0===n},n.isArray=Array.isArray||function(n){return"[object Array]"===Object.prototype.toString.call(n)}}(PS["Data.Foreign"]=PS["Data.Foreign"]||{}),function(n){"use strict";var e=PS.Prelude,t=(PS["Control.Alt"],PS["Control.Extend"],PS["Data.Bifoldable"],PS["Data.Bifunctor"],PS["Data.Bitraversable"],PS["Data.Foldable"],PS["Data.Monoid"],PS["Data.Traversable"],function(){function n(n){this.value0=n}return n.create=function(e){return new n(e)},n}()),r=function(){function n(n){this.value0=n}return n.create=function(e){return new n(e)},n}(),o=new e.Functor(function(n){return function(e){if(e instanceof t)return new t(e.value0);if(e instanceof r)return new r(n(e.value0));throw new Error("Failed pattern match at Data.Either line 53, column 3 - line 54, column 3: "+[n.constructor.name,e.constructor.name])}}),a=function(n){return function(e){return function(o){if(o instanceof t)return n(o.value0);if(o instanceof r)return e(o.value0);throw new Error("Failed pattern match at Data.Either line 29, column 1 - line 30, column 1: "+[n.constructor.name,e.constructor.name,o.constructor.name])}}},i=new e.Apply(function(){return o},function(n){return function(a){if(n instanceof t)return new t(n.value0);if(n instanceof r)return e["<$>"](o)(n.value0)(a);throw new Error("Failed pattern match at Data.Either line 93, column 3 - line 94, column 3: "+[n.constructor.name,a.constructor.name])}}),u=new e.Bind(function(){return i},a(function(n){return function(e){return new t(n)}})(function(n){return function(e){return e(n)}})),c=new e.Applicative(function(){return i},r.create),l=new e.Monad(function(){return c},function(){return u});n.Left=t,n.Right=r,n.either=a,n.functorEither=o,n.applyEither=i,n.applicativeEither=c,n.bindEither=u,n.monadEither=l}(PS["Data.Either"]=PS["Data.Either"]||{}),function(n){"use strict";n.runFn1=function(n){return function(e){return n(e)}},n.runFn2=function(n){return function(e){return function(t){return n(e,t)}}},n.runFn4=function(n){return function(e){return function(t){return function(r){return function(o){return n(e,t,r,o)}}}}}}(PS["Data.Function"]=PS["Data.Function"]||{}),function(n){"use strict";var e=PS["Data.Function"];PS.Prelude;n.runFn4=e.runFn4,n.runFn2=e.runFn2,n.runFn1=e.runFn1}(PS["Data.Function"]=PS["Data.Function"]||{}),function(n){"use strict";n.fromNumberImpl=function(n){return function(e){return function(t){return(0|t)===t?n(t):e}}},n.toNumber=function(n){return n}}(PS["Data.Int"]=PS["Data.Int"]||{}),function(n){"use strict";n.orImpl=function(n){return function(e){return n|e}}}(PS["Data.Int.Bits"]=PS["Data.Int.Bits"]||{}),function(n){"use strict";var e=PS["Data.Int.Bits"],t=e.orImpl;n[".|."]=t}(PS["Data.Int.Bits"]=PS["Data.Int.Bits"]||{}),function(n){"use strict";var e=PS["Data.Int"],t=PS.Prelude,r=(PS["Data.Int.Bits"],PS["Data.Maybe"]),o=PS["Data.Maybe.Unsafe"],a=PS.Math,i=e.fromNumberImpl(r.Just.create)(r.Nothing.value),u=function(n){if(n>=e.toNumber(t.top(t.boundedInt)))return t.top(t.boundedInt);if(n<=e.toNumber(t.bottom(t.boundedInt)))return t.bottom(t.boundedInt);if(t.otherwise)return o.fromJust(i(n));throw new Error("Failed pattern match at Data.Int line 49, column 1 - line 56, column 1: "+[n.constructor.name])},c=function(n){return u(a.round(n))},l=function(n){return u(a.floor(n))};n.round=c,n.floor=l,n.fromNumber=i,n.toNumber=e.toNumber}(PS["Data.Int"]=PS["Data.Int"]||{}),function(n){"use strict";n._indexOf=function(n){return function(e){return function(t){return function(r){var o=r.indexOf(t);return-1===o?e:n(o)}}}},n.length=function(n){return n.length},n.take=function(n){return function(e){return e.substr(0,n)}},n.trim=function(n){return n.trim()},n.joinWith=function(n){return function(e){return e.join(n)}}}(PS["Data.String"]=PS["Data.String"]||{}),function(n){"use strict";var e=PS["Data.String"],t=(PS.Prelude,PS["Data.Char"],PS["Data.Maybe"]),r=(PS["Data.Monoid"],PS["Data.String.Unsafe"],function(n){return 0===e.length(n)}),o=e._indexOf(t.Just.create)(t.Nothing.value),a=function(n){return function(e){return t.isJust(o(n)(e))}};n["null"]=r,n.indexOf=o,n.contains=a,n.joinWith=e.joinWith,n.trim=e.trim,n.take=e.take,n.length=e.length}(PS["Data.String"]=PS["Data.String"]||{}),function(n){"use strict";var e=PS["Data.Foreign"],t=PS.Prelude,r=PS["Data.Either"],o=PS["Data.Maybe"],a=(PS["Data.Function"],PS["Data.Int"]),a=PS["Data.Int"],i=(PS["Data.String"],function(){function n(n,e){this.value0=n,this.value1=e}return n.create=function(e){return function(t){return new n(e,t)}},n}()),u=function(){function n(n,e){this.value0=n,this.value1=e}return n.create=function(e){return function(t){return new n(e,t)}},n}(),c=function(){function n(n,e){this.value0=n,this.value1=e}return n.create=function(e){return function(t){return new n(e,t)}},n}(),l=function(){function n(n){this.value0=n}return n.create=function(e){return new n(e)},n}(),s=function(n){return function(o){return e.tagOf(o)===n?t.pure(r.applicativeEither)(e.unsafeFromForeign(o)):new r.Left(new i(n,e.tagOf(o)))}},f=new t.Show(function(n){if(n instanceof i)return"Type mismatch: expected "+(n.value0+(", found "+n.value1));if(n instanceof u)return"Error at array index "+(t.show(t.showInt)(n.value0)+(": "+t.show(f)(n.value1)));if(n instanceof c)return"Error at property "+(t.show(t.showString)(n.value0)+(": "+t.show(f)(n.value1)));if(n instanceof l)return"JSON error: "+n.value0;throw new Error("Failed pattern match at Data.Foreign line 54, column 3 - line 55, column 3: "+[n.constructor.name])}),d=s("String"),v=s("Number"),m=function(n){var u=r.Left.create(new i("Int",e.tagOf(n))),c=function(n){return o.maybe(u)(t.pure(r.applicativeEither))(a.fromNumber(n))};return r.either(t["const"](u))(c)(v(n))},h=s("Boolean"),p=function(n){return e.isArray(n)?t.pure(r.applicativeEither)(e.unsafeFromForeign(n)):new r.Left(new i("array",e.tagOf(n)))},w=function(n){return e.parseJSONImpl(function(n){return r.Left.create(l.create(n))},r.Right.create,n)};n.TypeMismatch=i,n.ErrorAtIndex=u,n.ErrorAtProperty=c,n.JSONError=l,n.readArray=p,n.readInt=m,n.readNumber=v,n.readBoolean=h,n.readString=d,n.unsafeReadTagged=s,n.parseJSON=w,n.showForeignError=f,n.isUndefined=e.isUndefined,n.isNull=e.isNull,n.tagOf=e.tagOf,n.typeOf=e.typeOf}(PS["Data.Foreign"]=PS["Data.Foreign"]||{}),function(n){"use strict";n.unsafeReadPropImpl=function(n,e,t,r){return null==r?n:e(r[t])},n.unsafeHasOwnProperty=function(n,e){return Object.prototype.hasOwnProperty.call(e,n)},n.unsafeHasProperty=function(n,e){return n in e}}(PS["Data.Foreign.Index"]=PS["Data.Foreign.Index"]||{}),function(n){"use strict";var e=PS["Data.Foreign.Index"],t=PS.Prelude,r=PS["Data.Either"],o=PS["Data.Foreign"],a=(PS["Data.Function"],PS["Data.Int"],function(n,e,t,r){this.errorAt=n,this.hasOwnProperty=e,this.hasProperty=t,this.ix=r}),i=function(n){return function(a){return e.unsafeReadPropImpl(new r.Left(new o.TypeMismatch("object",o.typeOf(a))),t.pure(r.applicativeEither),n,a)}},u=i,c=function(n){return n.ix},l=function(n){return c(n)},s=function(n){return function(t){return o.isNull(t)?!1:o.isUndefined(t)?!1:"object"===o.typeOf(t)||"function"===o.typeOf(t)?e.unsafeHasProperty(n,t):!1}},f=function(n){return n.hasProperty},d=function(n){return function(t){return o.isNull(t)?!1:o.isUndefined(t)?!1:"object"===o.typeOf(t)||"function"===o.typeOf(t)?e.unsafeHasOwnProperty(n,t):!1}},v=new a(o.ErrorAtProperty.create,d,s,t.flip(u)),m=function(n){return n.hasOwnProperty},h=function(n){return n.errorAt};n.Index=a,n.errorAt=h,n.hasOwnProperty=m,n.hasProperty=f,n["!"]=l,n.ix=c,n.prop=u,n.indexString=v}(PS["Data.Foreign.Index"]=PS["Data.Foreign.Index"]||{}),function(n){"use strict";var e=PS.Prelude,t=PS["Data.Maybe"],r=PS["Data.Foreign"],o=PS["Data.Either"],a=function(n){return n},i=function(n){return n;
},u=function(n){return function(i){return r.isNull(i)||r.isUndefined(i)?e.pure(o.applicativeEither)(t.Nothing.value):e["<$>"](o.functorEither)(function(n){return a(t.Just.create(n))})(n(i))}};n.NullOrUndefined=a,n.readNullOrUndefined=u,n.runNullOrUndefined=i}(PS["Data.Foreign.NullOrUndefined"]=PS["Data.Foreign.NullOrUndefined"]||{}),function(n){"use strict";var e=PS.Prelude,t=PS["Data.Array"],r=PS["Data.Either"],o=PS["Data.Foreign"],a=PS["Data.Foreign.Index"],i=(PS["Data.Foreign.Null"],PS["Data.Foreign.NullOrUndefined"]),u=(PS["Data.Foreign.Undefined"],PS["Data.Int"],PS["Data.Traversable"]),c=function(n){this.read=n},l=new c(o.readString),s=function(n){return n.read},f=function(n){return function(t){return e[">>="](r.bindEither)(o.parseJSON(t))(s(n))}},d=function(n){return function(e){return function(t){return r.either(function(n){return r.Left.create(e(n))})(r.Right.create)(s(n)(t))}}},v=function(n){return function(t){return function(o){return function(i){return e[">>="](r.bindEither)(a["!"](t)(i)(o))(d(n)(a.errorAt(t)(o)))}}}},m=new c(o.readNumber),h=function(n){return new c(i.readNullOrUndefined(s(n)))},p=new c(o.readInt),w=new c(function(n){return e["return"](r.applicativeEither)(n)}),g=new c(o.readBoolean),C=function(n){return new c(function(a){var i=function(e){return function(t){return d(n)(o.ErrorAtIndex.create(e))(t)}},c=function(n){return u.sequence(u.traversableArray)(r.applicativeEither)(t.zipWith(i)(t.range(0)(t.length(n)))(n))};return e[">>="](r.bindEither)(o.readArray(a))(c)})};n.IsForeign=c,n.readProp=v,n.readWith=d,n.readJSON=f,n.read=s,n.foreignIsForeign=w,n.stringIsForeign=l,n.booleanIsForeign=g,n.numberIsForeign=m,n.intIsForeign=p,n.arrayIsForeign=C,n.nullOrUndefinedIsForeign=h}(PS["Data.Foreign.Class"]=PS["Data.Foreign.Class"]||{}),function(n){"use strict";n.readInt=function(n){return function(e){return parseInt(e,n)}}}(PS.Global=PS.Global||{}),function(n){"use strict";var e=PS.Global;n.readInt=e.readInt}(PS.Global=PS.Global||{}),function(n){"use strict";var e=PS.Prelude,t=PS["Data.Maybe"],r=PS.Extensions,o=PS["Data.Foreign"],a=PS["Data.Foreign.Class"],i=PS["Data.Either"],u=(PS["Data.Int.Bits"],PS["Data.Int"]),c=(PS["Data.Maybe.Unsafe"],PS.Math,PS.Global),l=PS["Data.Foreign.Index"],s=function(){function n(n,e,t,r){this.value0=n,this.value1=e,this.value2=t,this.value3=r}return n.create=function(e){return function(t){return function(r){return function(o){return new n(e,t,r,o)}}}},n}(),f=function(){function n(n,e,t,r){this.value0=n,this.value1=e,this.value2=t,this.value3=r}return n.create=function(e){return function(t){return function(r){return function(o){return new n(e,t,r,o)}}}},n}(),d=function(){function n(n,e,t){this.value0=n,this.value1=e,this.value2=t}return n.create=function(e){return function(t){return function(r){return new n(e,t,r)}}},n}(),v=function(){function n(n,e,t){this.value0=n,this.value1=e,this.value2=t}return n.create=function(e){return function(t){return function(r){return new n(e,t,r)}}},n}(),m=new e.Show(function(n){return"Color4I "+(e.show(e.showInt)(n.value0)+(" "+(e.show(e.showInt)(n.value1)+(" "+(e.show(e.showInt)(n.value2)+(" "+e.show(e.showNumber)(n.value3)))))))}),h=function(n){var r=i.Left.create(new o.TypeMismatch("Color3I",o.tagOf(n))),a=function(n){var o=c.readInt(16)(n),a=u.fromNumber(o);if(a instanceof t.Nothing)return r;if(a instanceof t.Just){var l=new d(a.value0>>16&255,a.value0>>8&255,255&a.value0);return e["return"](i.applicativeEither)(l)}throw new Error("Failed pattern match at ConeCanvas.Color line 53, column 8 - line 57, column 3: "+[a.constructor.name])};return i.either(e["const"](r))(a)(o.readString(n))},p=function(n){return[n.value0,n.value1,n.value2,n.value3]},w=function(n){if(4===n.length){var e=u.toNumber(n[3])/255;return new s(n[0],n[1],n[2],e)}return r.fail("ConeModel>>color4IfromArray: Wrong array size")},g=function(n){return"rgba("+(e.show(e.showInt)(n.value0)+(", "+(e.show(e.showInt)(n.value1)+(", "+(e.show(e.showInt)(n.value2)+(", "+(e.show(e.showNumber)(n.value3)+")")))))))},C=function(n){var e=function(n){return function(n){return n/255}(u.toNumber(n))};return new f(e(n.value0),e(n.value1),e(n.value2),n.value3)},S=function(n){return 3===n.length?new v(n[0],n[1],n[2]):r.fail("ConeModel>>color3fromArray: Wrong array size")},P=new a.IsForeign(h),y=function(n){i.Left.create(new o.TypeMismatch("Color4I",o.tagOf(n)));return e.bind(i.bindEither)(a.readProp(P)(l.indexString)("rgb")(n))(function(t){return e.bind(i.bindEither)(a.readProp(a.numberIsForeign)(l.indexString)("ambiance")(n))(function(n){return e["return"](i.applicativeEither)(new s(t.value0,t.value1,t.value2,n))})})},T=new a.IsForeign(y),b=new a.IsForeign(function(n){return e["<$>"](i.functorEither)(C)(y(n))});n.Color4=f,n.Color4I=s,n.Color3=v,n.Color3I=d,n.color4IToColor4=C,n.color4toArray=p,n.color4IasFillStyle=g,n.readColor4I=y,n.color4IfromArray=w,n.color3fromArray=S,n.readColor3I=h,n.color3IIsForeign=P,n.showColor4I=m,n.color4IIsForeign=T,n.color4IsForeign=b}(PS["ConeCanvas.Color"]=PS["ConeCanvas.Color"]||{}),function(n){"use strict";n.newSTRef=function(n){return function(){return{value:n}}},n.readSTRef=function(n){return function(){return n.value}},n.modifySTRef=function(n){return function(e){return function(){return n.value=e(n.value)}}},n.writeSTRef=function(n){return function(e){return function(){return n.value=e}}}}(PS["Control.Monad.ST"]=PS["Control.Monad.ST"]||{}),function(n){"use strict";var e=PS["Control.Monad.ST"];PS.Prelude,PS["Control.Monad.Eff"];n.writeSTRef=e.writeSTRef,n.modifySTRef=e.modifySTRef,n.readSTRef=e.readSTRef,n.newSTRef=e.newSTRef}(PS["Control.Monad.ST"]=PS["Control.Monad.ST"]||{}),function(n){"use strict";n.error=function(n){return new Error(n)},n.throwException=function(n){return function(){throw n}}}(PS["Control.Monad.Eff.Exception"]=PS["Control.Monad.Eff.Exception"]||{}),function(n){"use strict";var e=PS["Control.Monad.Eff.Exception"];PS.Prelude,PS["Data.Maybe"],PS["Control.Monad.Eff"];n.throwException=e.throwException,n.error=e.error}(PS["Control.Monad.Eff.Exception"]=PS["Control.Monad.Eff.Exception"]||{}),function(n){"use strict";var e=PS.Prelude,t=function(n){return function(t){return function(r){if(t)return r;if(!t)return e["return"](n["__superclass_Prelude.Applicative_0"]())(e.unit);throw new Error("Failed pattern match at Control.Monad line 9, column 1 - line 10, column 1: "+[t.constructor.name,r.constructor.name])}}};n.when=t}(PS["Control.Monad"]=PS["Control.Monad"]||{}),function(n){"use strict";n.random=Math.random}(PS["Control.Monad.Eff.Random"]=PS["Control.Monad.Eff.Random"]||{}),function(n){"use strict";var e=PS["Control.Monad.Eff.Random"],t=(PS.Prelude,PS["Control.Monad.Eff"],PS["Data.Int"]),r=function(n){return function(r){return function(){var o=e.random(),a=(t.toNumber(r)-t.toNumber(n)+1)*o+t.toNumber(n);return t.floor(a)}}};n.randomInt=r}(PS["Control.Monad.Eff.Random"]=PS["Control.Monad.Eff.Random"]||{}),function(n){"use strict";n.nowImpl=function(n){return function(){return n(new Date)}},n.jsDateMethod=function(n,e){return e[n]()}}(PS["Data.Date"]=PS["Data.Date"]||{}),function(n){"use strict";var e=PS["Data.Date"],t=(PS.Prelude,PS["Control.Monad.Eff"],PS["Data.Enum"],PS["Data.Function"],PS["Data.Maybe"],PS["Data.Time"],PS.Global,function(n){return n}),r=function(n){return e.jsDateMethod("getTime",n)},o=e.nowImpl(t);n.now=o,n.toEpochMilliseconds=r}(PS["Data.Date"]=PS["Data.Date"]||{}),function(n){"use strict";n.unsafeIndex=function(n){return function(e){return n[e]}}}(PS["Data.Array.Unsafe"]=PS["Data.Array.Unsafe"]||{}),function(n){"use strict";var e=PS["Data.Array.Unsafe"],t=(PS.Prelude,PS["Data.Array"]),r=function(n){return t.slice(1)(t.length(n))(n)},o=function(n){return e.unsafeIndex(n)(0)};n.tail=r,n.head=o}(PS["Data.Array.Unsafe"]=PS["Data.Array.Unsafe"]||{}),function(n){"use strict";n.runSTArray=function(n){return n},n.emptySTArray=function(){return[]},n.pushAllSTArray=function(n){return function(e){return function(){return n.push.apply(n,e)}}}}(PS["Data.Array.ST"]=PS["Data.Array.ST"]||{}),function(n){"use strict";var e=PS["Data.Array.ST"],t=(PS.Prelude,PS["Control.Monad.Eff"],PS["Control.Monad.ST"],PS["Data.Maybe"],function(n){return function(t){return e.pushAllSTArray(n)([t])}});n.pushSTArray=t,n.emptySTArray=e.emptySTArray,n.runSTArray=e.runSTArray}(PS["Data.Array.ST"]=PS["Data.Array.ST"]||{}),function(n){"use strict";var e=(PS.Prelude,PS["Data.Maybe"]),t=(PS["Data.Tuple"],PS["Data.Array.ST"]),r=(PS["Data.Traversable"],PS["Control.Monad.Eff"]),o=PS["Control.Monad.ST"],a=function(n){this.unfoldr=n},i=function(n){return n.unfoldr},u=new a(function(n){return function(a){return r.runPure(t.runSTArray(function(){var r=t.emptySTArray(),i=o.newSTRef(a)();return function(){for(;!function(){var a=o.readSTRef(i)(),u=n(a);if(u instanceof e.Nothing)return!0;if(u instanceof e.Just)return t.pushSTArray(r)(u.value0.value0)(),o.writeSTRef(i)(u.value0.value1)(),!1;throw new Error("Failed pattern match at Data.Unfoldable line 35, column 7 - line 41, column 5: "+[u.constructor.name])}(););return{}}(),r}))}});n.Unfoldable=a,n.unfoldr=i,n.unfoldableArray=u}(PS["Data.Unfoldable"]=PS["Data.Unfoldable"]||{}),function(n){"use strict";var e=PS.Prelude,t=(PS["Control.Alt"],PS["Control.Alternative"],PS["Control.Lazy"],PS["Control.MonadPlus"],PS["Control.Plus"],PS["Data.Foldable"]),r=PS["Data.Maybe"],o=PS["Data.Monoid"],a=PS["Data.Traversable"],i=PS["Data.Tuple"],u=PS["Data.Unfoldable"],c=function(){function n(){}return n.value=new n,n}(),l=function(){function n(n,e){this.value0=n,this.value1=e}return n.create=function(e){return function(t){return new n(e,t)}},n}(),s=l.create,f=function(n){if(n instanceof c)return r.Nothing.value;if(n instanceof l)return new r.Just({head:n.value0,tail:n.value1});throw new Error("Failed pattern match at Data.List line 273, column 1 - line 274, column 1: "+[n.constructor.name])},d=function(n){return u.unfoldr(n)(function(n){return e["<$>"](r.functorMaybe)(function(n){return new i.Tuple(n.head,n.tail)})(f(n))})},v=function(n){if(n instanceof c)return r.Nothing.value;if(n instanceof l)return new r.Just(n.value1);throw new Error("Failed pattern match at Data.List line 254, column 1 - line 255, column 1: "+[n.constructor.name])},m=function(n){return new l(n,c.value)},h=function(n){return new e.Show(function(t){if(t instanceof c)return"Nil";if(t instanceof l)return"Cons ("+(e.show(n)(t.value0)+(") ("+(e.show(h(n))(t.value1)+")")));throw new Error("Failed pattern match at Data.List line 727, column 3 - line 728, column 3: "+[t.constructor.name])})},p=new e.Semigroup(function(n){return function(t){if(n instanceof c)return t;if(n instanceof l)return new l(n.value0,e["<>"](p)(n.value1)(t));throw new Error("Failed pattern match at Data.List line 751, column 3 - line 752, column 3: "+[n.constructor.name,t.constructor.name])}}),w=function(){var n=function(n){return function(e){for(var t=n,r=e;;){if(r instanceof c)return t;{if(!(r instanceof l))throw new Error("Failed pattern match at Data.List line 371, column 1 - line 379, column 1: "+[t.constructor.name,r.constructor.name]);var o=new l(r.value0,t),a=r.value1;t=o,r=a}}}};return n(c.value)}(),g=function(){var n=function(n){return function(e){return function(t){for(var r=n,o=e,a=t;;){if(0===o)return w(r);if(a instanceof c)return w(r);{if(!(a instanceof l))throw new Error("Failed pattern match at Data.List line 493, column 1 - line 502, column 1: "+[r.constructor.name,o.constructor.name,a.constructor.name]);var i=new l(a.value0,r),u=o-1,s=a.value1;r=i,o=u,a=s}}}}};return n(c.value)}(),C=function(n){return function(t){var r=function(n){return function(r){for(var o=n,a=r;;){if(0>=o)return a;{if(!e.otherwise)throw new Error("Failed pattern match at Data.List line 151, column 1 - line 157, column 1: "+[o.constructor.name,a.constructor.name]);var i=o-1,u=new l(t,a);o=i,a=u}}}};return r(n)(c.value)}},S=function(n){return n instanceof c},P=function(n){for(var e=n;;){if(e instanceof l&&e.value1 instanceof c)return new r.Just(e.value0);{if(!(e instanceof l))return r.Nothing.value;var t=e.value1;e=t}}},y=function(n){return function(e){for(var t=n,o=e;;){if(t instanceof c)return r.Nothing.value;if(t instanceof l&&0===o)return new r.Just(t.value0);{if(!(t instanceof l))throw new Error("Failed pattern match at Data.List line 284, column 1 - line 285, column 1: "+[t.constructor.name,o.constructor.name]);var a=t.value1,i=o-1;t=a,o=i}}}},T=y,b=function(n){if(n instanceof c)return r.Nothing.value;if(n instanceof l)return new r.Just(n.value0);throw new Error("Failed pattern match at Data.List line 239, column 1 - line 240, column 1: "+[n.constructor.name])},E=new e.Functor(function(n){return function(e){var t=function(e){return function(t){for(var r=e,o=t;;){if(r instanceof c)return o;{if(!(r instanceof l))throw new Error("Failed pattern match at Data.List line 758, column 3 - line 764, column 1: "+[r.constructor.name,o.constructor.name]);var a=r.value1,i=new l(n(r.value0),o);r=a,o=i}}}};return w(t(e)(c.value))}}),x=function(n){return d(n)},F=function(n){return t.foldr(n)(l.create)(c.value)},A=function(n){return F(n)},N=new t.Foldable(function(n){return function(r){return t.foldl(N)(function(t){return function(o){return e.append(n["__superclass_Prelude.Semigroup_0"]())(t)(r(o))}})(o.mempty(n))}},function(){var n=function(n){return function(e){return function(t){for(var r=n,o=e,a=t;;){if(a instanceof c)return o;{if(!(a instanceof l))throw new Error("Failed pattern match at Data.List line 767, column 3 - line 771, column 3: "+[r.constructor.name,o.constructor.name,a.constructor.name]);var i=r,u=r(o)(a.value0),s=a.value1;r=i,o=u,a=s}}}}};return n}(),function(n){return function(e){return function(r){if(r instanceof c)return e;if(r instanceof l)return n(r.value0)(t.foldr(N)(n)(e)(r.value1));throw new Error("Failed pattern match at Data.List line 765, column 3 - line 766, column 3: "+[n.constructor.name,e.constructor.name,r.constructor.name])}}}),_=t.foldl(N)(function(n){return function(e){return n+1|0}})(0),D=new a.Traversable(function(){return N},function(){return E},function(n){return function(t){if(t instanceof c)return e.pure(n)(c.value);if(t instanceof l)return e["<*>"](n["__superclass_Prelude.Apply_0"]())(e["<$>"](n["__superclass_Prelude.Apply_0"]()["__superclass_Prelude.Functor_0"]())(l.create)(t.value0))(a.sequence(D)(n)(t.value1));throw new Error("Failed pattern match at Data.List line 784, column 3 - line 785, column 3: "+[t.constructor.name])}},function(n){return function(t){return function(r){if(r instanceof c)return e.pure(n)(c.value);if(r instanceof l)return e["<*>"](n["__superclass_Prelude.Apply_0"]())(e["<$>"](n["__superclass_Prelude.Apply_0"]()["__superclass_Prelude.Functor_0"]())(l.create)(t(r.value0)))(a.traverse(D)(n)(t)(r.value1));throw new Error("Failed pattern match at Data.List line 782, column 3 - line 783, column 3: "+[t.constructor.name,r.constructor.name])}}}),M=function(n){return new e.Eq(function(t){return function(r){var o=function(t){return function(r){return function(o){for(var a=t,i=r,u=o;;){if(!u)return!1;if(a instanceof c&&i instanceof c)return u;{if(!(a instanceof l&&i instanceof l))return!1;var s=a.value1,f=i.value1,d=u&&e["=="](n)(i.value0)(a.value0);a=s,i=f,u=d}}}}};return o(t)(r)(!0)}})},L=function(n){return function(e){for(var t=n,r=e;;){if(0===t)return r;if(r instanceof c)return c.value;{if(!(r instanceof l))throw new Error("Failed pattern match at Data.List line 512, column 1 - line 513, column 1: "+[t.constructor.name,r.constructor.name]);var o=t-1,a=r.value1;t=o,r=a}}}},I=function(n){return function(t){if(t instanceof c)return c.value;if(t instanceof l)return e["<>"](p)(n(t.value0))(I(n)(t.value1));throw new Error("Failed pattern match at Data.List line 387, column 1 - line 388, column 1: "+[n.constructor.name,t.constructor.name])}},O=new e.Apply(function(){return E},function(n){return function(t){if(n instanceof c)return c.value;if(n instanceof l)return e["<>"](p)(e["<$>"](E)(n.value0)(t))(e["<*>"](O)(n.value1)(t));throw new Error("Failed pattern match at Data.List line 788, column 3 - line 789, column 3: "+[n.constructor.name,t.constructor.name])}}),R=new e.Bind(function(){return O},e.flip(I)),k=function(n){return e[">>="](R)(n)(e.id(e.categoryFn))},U=new e.Applicative(function(){return O},function(n){return new l(n,c.value)});n.Nil=c,n.Cons=l,n.fromList=x,n.toList=A,n.drop=L,n.take=g,n.concatMap=I,n.concat=k,n.reverse=w,n.index=y,n["!!"]=T,n.uncons=f,n.tail=v,n.last=P,n.head=b,n[":"]=s,n.length=_,n["null"]=S,n.replicate=C,n.singleton=m,n.fromFoldable=F,n.toUnfoldable=d,n.showList=h,n.eqList=M,n.semigroupList=p,n.functorList=E,n.foldableList=N,n.traversableList=D,n.applyList=O,n.applicativeList=U,n.bindList=R}(PS["Data.List"]=PS["Data.List"]||{}),function(n){"use strict";var e="undefined"==typeof module?void 0:module.require,t=void 0===e?void 0:e("util");n.traceAny=function(n){return function(e){return void 0!==t?console.log(t.inspect(n,{depth:null,colors:!0})):console.log(n),e({})}}}(PS["Debug.Trace"]=PS["Debug.Trace"]||{}),function(n){"use strict";var e=PS["Debug.Trace"],t=PS.Prelude,r=function(n){return function(r){return e.traceAny(r)(function(e){return t.pure(n)(t.unit)})}},o=function(n){return r(n)},a=e.traceAny;n.traceA=o,n.traceAnyA=r,n.trace=a,n.traceAny=e.traceAny}(PS["Debug.Trace"]=PS["Debug.Trace"]||{}),function(n){"use strict";n.getCanvasElementByIdImpl=function(n,e,t){return function(){var r=document.getElementById(n);return r&&r instanceof HTMLCanvasElement?e(r):t}},n.getContext2D=function(n){return function(){return n.getContext("2d")}},n.getCanvasWidth=function(n){return function(){return n.width}},n.getCanvasHeight=function(n){return function(){return n.height}},n.setFillStyle=function(n){return function(e){return function(){return e.fillStyle=n,e}}},n.clearRect=function(n){return function(e){return function(){return n.clearRect(e.x,e.y,e.w,e.h),n}}},n.setTextAlignImpl=function(n){return function(e){return function(){return n.textAlign=e,n}}},n.font=function(n){return function(){return n.font}},n.setFont=function(n){return function(e){return function(){return e.font=n,e}}},n.drawImage=function(n){return function(e){return function(t){return function(r){return function(){return n.drawImage(e,t,r),n}}}}},n.drawImageScale=function(n){return function(e){return function(t){return function(r){return function(o){return function(a){return function(){return n.drawImage(e,t,r,o,a),n}}}}}}}}(PS["Graphics.Canvas"]=PS["Graphics.Canvas"]||{}),function(n){"use strict";var e=PS["Graphics.Canvas"],t=PS.Prelude,r=(PS["Data.ArrayBuffer.Types"],PS["Data.Function"],PS["Data.Maybe"]),o=(PS["Control.Monad.Eff"],PS["Control.Monad.Eff.Exception.Unsafe"],function(){function n(){}return n.value=new n,n}()),a=function(){function n(){}return n.value=new n,n}(),i=function(){function n(){}return n.value=new n,n}(),u=function(){function n(){}return n.value=new n,n}(),c=function(){function n(){}return n.value=new n,n}(),l=new t.Show(function(n){if(n instanceof o)return"left";if(n instanceof a)return"right";if(n instanceof i)return"center";if(n instanceof u)return"start";if(n instanceof c)return"end";throw new Error("Failed pattern match at Graphics.Canvas line 383, column 3 - line 384, column 3: "+[n.constructor.name])}),s=function(n){return function(r){return e.setTextAlignImpl(n)(t.show(l)(r))}},f=function(n){return e.getCanvasElementByIdImpl(n,r.Just.create,r.Nothing.value)};n.AlignLeft=o,n.AlignRight=a,n.AlignCenter=i,n.AlignStart=u,n.AlignEnd=c,n.setTextAlign=s,n.getCanvasElementById=f,n.showTextAlign=l,n.drawImageScale=e.drawImageScale,n.setFont=e.setFont,n.clearRect=e.clearRect,n.setFillStyle=e.setFillStyle,n.getCanvasHeight=e.getCanvasHeight,n.getCanvasWidth=e.getCanvasWidth,n.getContext2D=e.getContext2D}(PS["Graphics.Canvas"]=PS["Graphics.Canvas"]||{}),function(n){"use strict";var e=PS.Prelude,t=PS["Data.Maybe"],r=PS["Data.Either"],o=(PS["Data.ArrayBuffer.Types"],PS["Control.Monad.Eff"]),a=(PS["Control.Monad.Eff.Exception"],PS["Control.Monad.Eff.Random"],PS["Control.Monad.ST"],PS["Data.Date"],PS["Data.List"]),i=(PS["Data.Foreign"],PS["Data.Foreign.Class"]),u=PS["Data.Foreign.NullOrUndefined"],c=(PS.DOM,PS["ConeCanvas.Color"],PS["Graphics.Canvas"],PS["Data.Foreign.Index"]),l=PS["Data.Foldable"],s=function(){function n(){}return n.value=new n,n}(),f=function(){function n(){}return n.value=new n,n}(),d=function(){function n(){}return n.value=new n,n}(),v=function(){function n(){}return n.value=new n,n}(),m=function(){function n(){}return n.value=new n,n}(),h=function(){function n(n){this.value0=n}return n.create=function(e){return new n(e)},n}(),p=function(){function n(n){this.value0=n}return n.create=function(e){return new n(e)},n}(),w=function(){function n(n){this.value0=n}return n.create=function(e){return new n(e)},n}(),g=function(){function n(n){this.value0=n}return n.create=function(e){return new n(e)},n}(),C=function(){function n(n){this.value0=n}return n.create=function(e){return new n(e)},n}(),S=function(){function n(){}return n.value=new n,n}(),P=function(){function n(){}return n.value=new n,n}(),y=function(){function n(){}return n.value=new n,n}(),T=function(){function n(n){this.value0=n}return n.create=function(e){return new n(e)},n}(),b=function(){function n(n){this.value0=n}return n.create=function(e){return new n(e)},n}(),E=function(){function n(n){this.value0=n}return n.create=function(e){return new n(e)},n}(),x=function(){function n(n){this.value0=n}return n.create=function(e){return new n(e)},n}(),F=function(){function n(n){this.value0=n}return n.create=function(e){return new n(e)},n}(),A=function(){function n(n,e,t){this.value0=n,this.value1=e,this.value2=t}return n.create=function(e){return function(t){return function(r){return new n(e,t,r)}}},n}(),N=function(){function n(n,e){this.value0=n,this.value1=e}return n.create=function(e){return function(t){return new n(e,t)}},n}(),_=function(){function n(n){this.value0=n}return n.create=function(e){return new n(e)},n}(),D=function(){function n(n){this.value0=n}return n.create=function(e){return new n(e)},n}(),M=function(){function n(){}return n.value=new n,n}(),L=function(){function n(){}return n.value=new n,n}(),I=function(){function n(){}return n.value=new n,n}(),O=function(){function n(n){this.value0=n}return n.create=function(e){return new n(e)},n}(),R=function(){function n(n){this.value0=n}return n.create=function(e){return new n(e)},n}(),k=function(){function n(n){this.value0=n}return n.create=function(e){return new n(e)},n}(),U=function(){function n(){}return n.value=new n,n}(),G=function(){function n(){}return n.value=new n,n}(),B=function(n,e,t,r,o,a,i,u,c,l,s,f,d,v,m,h,p){this["__superclass_Data.Foreign.Class.IsForeign_2"]=n,this["__superclass_Prelude.Eq_0"]=e,this["__superclass_Prelude.Show_1"]=t,this.actions=r,this.color=o,this.comment=a,this.entryId=i,this.hidden=u,this.iconName=c,this.isLeaf=l,this.label=s,this.makeHiddenLeaf=f,this.makeHiddenNode=d,this.parentActions=v,this.primaryLink=m,this.stlName=h,this.targetUri=p},J=function(n){return n.targetUri},$=function(n){return n.stlName},H=function(n){return function(n){return n}},z=function(n){return function(n){return n.value0}},W=function(n){return n.primaryLink},j=function(n){return n.parentActions},V=function(n){return n.makeHiddenNode},q=function(n){return n.makeHiddenLeaf},Z=function(n){return n.label},K=function(n){return n.isLeaf},X=function(n){return function(e){return K(n)(e.value0.entry)}},Y=function(n){return function(t){if(X(n)(t))return e["return"](o.applicativeEff)(a.Nil.value);if(t.value0.children instanceof r.Right)return e["return"](o.applicativeEff)(t.value0.children.value0);if(t.value0.children instanceof r.Left)return t.value0.children.value0(t.value0.nodeId);throw new Error("Failed pattern match at ConeCanvas.ConeModel line 207, column 55 - line 212, column 1: "+[t.value0.children.constructor.name])}},Q=function(n){return new i.IsForeign(function(s){return e.bind(r.bindEither)(i.read(n["__superclass_Data.Foreign.Class.IsForeign_2"]())(s))(function(f){return e.bind(r.bindEither)(e["<$>"](r.functorEither)(u.runNullOrUndefined)(i.readProp(i.nullOrUndefinedIsForeign(i.intIsForeign))(c.indexString)("nodeId")(s)))(function(d){return e.bind(r.bindEither)(e["<$>"](r.functorEither)(u.runNullOrUndefined)(i.readProp(i.nullOrUndefinedIsForeign(i.intIsForeign))(c.indexString)("firstInd")(s)))(function(v){return e.bind(r.bindEither)(e["<$>"](r.functorEither)(u.runNullOrUndefined)(i.readProp(i.nullOrUndefinedIsForeign(i.arrayIsForeign(Q(n))))(c.indexString)("children")(s)))(function(n){var i=function(){if(n instanceof t.Nothing)return new r.Left(function(n){return e["return"](o.applicativeEff)(a.toList(l.foldableArray)([]))});if(n instanceof t.Just)return new r.Right(a.toList(l.foldableArray)(n.value0));throw new Error("Failed pattern match at ConeCanvas.ConeModel line 219, column 17 - line 221, column 48: "+[n.constructor.name])}();return e["return"](r.applicativeEither)(new h({entry:f,nodeId:function(){if(d instanceof t.Nothing)return 0;if(d instanceof t.Just)return d.value0;throw new Error("Failed pattern match at ConeCanvas.ConeModel line 225, column 27 - line 228, column 13: "+[d.constructor.name])}(),firstInd:function(){if(v instanceof t.Nothing)return 0;if(v instanceof t.Just)return v.value0;throw new Error("Failed pattern match at ConeCanvas.ConeModel line 228, column 27 - line 231, column 13: "+[v.constructor.name])}(),children:i}))})})})})})},nn=function(n){return n.iconName},en=function(n){return n.hidden},tn=function(n){return new e.Eq(function(t){return function(r){return e["=="](n)(t.content)(r.content)}})},rn=function(n){return new e.Eq(function(t){return function(r){var o=0!==t.value0.nodeId||0!==r.value0.nodeId;if(o)return t.value0.nodeId===r.value0.nodeId;if(!o)return e["=="](n)(t.value0.entry)(r.value0.entry);throw new Error("Failed pattern match at ConeCanvas.ConeModel line 236, column 9 - line 240, column 1: "+[o.constructor.name])}})},on=function(n){return n.entryId},an=function(n){return n.comment},un=function(n){return n.color},cn=function(n){return n.actions};n.TDClockwise=s,n.TDAntiClockwise=f,n.TDShortest=d,n.AnimMoveLeft=g,n.AnimMoveRight=C,n.AnimTurnToFirst=S,n.AnimMoveUp=P,n.AnimMoveDown=y,n.AnimClockwork=T,n.AnimTransformLeft=b,n.AnimTransformRight=E,n.AnimTransformUp=x,n.AnimTransformDown=F,n.AnimTransformIntro=A,n.AnimTransformExtro=N,n.AnimTransformShiftToZero=_,n.AnimTransformReplace=D,n.AnimCut=M,n.AnimCopy=L,n.AnimPaste=I,n.AnimGlobalView=O,n.AnimZoom=R,n.AnimPause=k,n.AnimNull=U,n.OSCurrent=p,n.OSParent=w,n.ConeNode=h,n.PrimaryLinkAction=G,n.OuterLabel=v,n.Browser=m,n.ConeEntry=B,n.runConeZip=H,n.nodeGetChildren=Y,n.nodeIsLeaf=X,n.runConeNode=z,n.makeHiddenNode=V,n.makeHiddenLeaf=q,n.hidden=en,n.parentActions=j,n.actions=cn,n.isLeaf=K,n.primaryLink=W,n.color=un,n.stlName=$,n.iconName=nn,n.comment=an,n.targetUri=J,n.label=Z,n.entryId=on,n.isForeignConeNode=Q,n.eqConeNode=rn,n.eqConeZip=tn}(PS["ConeCanvas.ConeModel"]=PS["ConeCanvas.ConeModel"]||{}),function(n){"use strict";var e=PS.Prelude,t=PS["Data.Maybe"],r=PS["Data.Either"],o=PS["Data.List"],a=PS["Data.Traversable"],i=PS["Data.Foldable"],u=PS["Data.Array"],c=PS["ConeCanvas.ConeModel"],l=PS["Control.Monad.Eff"],s=function(n){return function(e){return c.runConeNode(n)(e.content)}},f=function(n){return n.content},d=function(n){var e={};for(var t in n)n.hasOwnProperty(t)&&(e[t]=n[t]);return e.content=new c.ConeNode(function(){var e={};for(var t in n.content.value0)n.content.value0.hasOwnProperty(t)&&(e[t]=n.content.value0[t]);return e.children=function(){if(n.content.value0.children instanceof r.Left)return new r.Right(o.Nil.value);if(n.content.value0.children instanceof r.Right)return new r.Right(o.Nil.value);throw new Error("Failed pattern match at ConeCanvas.ConeZipper line 490, column 40 - line 492, column 65: "+[n.content.value0.children.constructor.name])}(),e}()),e},v=function(n){var e=o.tail(n);return e instanceof t.Just?e.value0:o.Nil.value},m=function(n){return function(n){if(n instanceof c.OSCurrent)return n.value0;if(n instanceof c.OSParent)return n.value0;throw new Error("Failed pattern match at ConeCanvas.ConeZipper line 581, column 1 - line 582, column 1: "+[n.constructor.name])}},h=function(n){return function(t){if(0>n)return n+t|0;if(n>=t)return n-t;if(e.otherwise)return n;throw new Error("Failed pattern match at ConeCanvas.ConeZipper line 663, column 1 - line 666, column 27: "+[n.constructor.name,t.constructor.name])}},p=function(n){return n.value0.entry},w=function(n){return p(f(n))},g=function(n){if(n instanceof c.OSCurrent)return w(n.value0);if(n instanceof c.OSParent)return w(n.value0);throw new Error("Failed pattern match at ConeCanvas.ConeZipper line 614, column 1 - line 615, column 1: "+[n.constructor.name])},C=function(n){return function(n){return{content:n,before:o.Nil.value,after:o.Nil.value,parents:o.Nil.value}}},S=function(n){var e=o.uncons(n);return e instanceof t.Just?new o.Cons(e.value0.head,o.Nil.value):o.Nil.value},P=function(n){var t=o["null"](n.before);if(t)return n;if(!t){var r={};for(var a in n)n.hasOwnProperty(a)&&(r[a]=n[a]);return r.before=o.Nil.value,r.after=e["++"](o.semigroupList)(n.after)(o.reverse(n.before)),r}throw new Error("Failed pattern match at ConeCanvas.ConeZipper line 148, column 3 - line 153, column 1: "+[t.constructor.name])},y=function(n){if(n instanceof c.OSCurrent)return new c.OSCurrent(P(n.value0));if(n instanceof c.OSParent)return new c.OSParent(P(n.value0));throw new Error("Failed pattern match at ConeCanvas.ConeZipper line 593, column 1 - line 594, column 1: "+[n.constructor.name])},T=function(n){return function(r){var a=e["++"](o.semigroupList)(o.reverse(n.before))(e["++"](o.semigroupList)(new o.Cons(n.content,o.Nil.value))(n.after)),i=r>=0&&o.length(a)>r;if(i){var u=o.length(n.before)===r;if(u)return new t.Just(n);if(!u){var c=o["!!"](a)(r);if(c instanceof t.Nothing)return t.Nothing.value;if(c instanceof t.Just)return new t.Just(function(){var e={};for(var t in n)n.hasOwnProperty(t)&&(e[t]=n[t]);return e.content=c.value0,e.before=o.reverse(o.take(r)(a)),e.after=o.take(o.length(a)-(r+1|0))(o.drop(r+1|0)(a)),e}());throw new Error("Failed pattern match at ConeCanvas.ConeZipper line 196, column 22 - line 201, column 104: "+[c.constructor.name])}throw new Error("Failed pattern match at ConeCanvas.ConeZipper line 194, column 15 - line 201, column 104: "+[u.constructor.name])}if(!i)return t.Nothing.value;throw new Error("Failed pattern match at ConeCanvas.ConeZipper line 193, column 5 - line 203, column 3: "+[i.constructor.name])}},b=function(n){return function(e){if(n instanceof c.OSCurrent){var r=T(n.value0)(e);if(r instanceof t.Just)return new t.Just(new c.OSCurrent(r.value0));if(r instanceof t.Nothing)return t.Nothing.value;throw new Error("Failed pattern match at ConeCanvas.ConeZipper line 586, column 38 - line 589, column 1: "+[r.constructor.name])}return t.Nothing.value}},E=function(n){return(o.length(n.before)+1|0)+o.length(n.after)|0},x=function(n){if(0===E(n))return new c.OSParent(n);if(e.otherwise)return new c.OSCurrent(n);throw new Error("Failed pattern match at ConeCanvas.ConeZipper line 566, column 1 - line 570, column 1: "+[n.constructor.name])},F=function(n){return n instanceof c.OSCurrent?E(n.value0):0},A=function(n){var e=o.uncons(n.after);return e instanceof t.Just?t.Just.create(function(){var t={};for(var r in n)n.hasOwnProperty(r)&&(t[r]=n[r]);return t.content=e.value0.head,t.before=o[":"](n.content)(n.before),t.after=e.value0.tail,t}()):t.Nothing.value},N=function(n){if(E(n)<=2)return t.Nothing.value;var r=o.reverse(n.before),a=e["++"](o.semigroupList)(n.after)(S(r)),i=o.uncons(a);return i instanceof t.Just?t.Just.create(function(){var t=o["null"](n.before);if(t){var u={};for(var c in n)n.hasOwnProperty(c)&&(u[c]=n[c]);return u.before=o.Nil.value,u.after=e["++"](o.semigroupList)(i.value0.tail)(S(a)),u}if(!t){var l={};for(var s in n)n.hasOwnProperty(s)&&(l[s]=n[s]);return l.before=o[":"](i.value0.head)(o.reverse(v(r))),l.after=i.value0.tail,
l}throw new Error("Failed pattern match at ConeCanvas.ConeZipper line 442, column 44 - line 446, column 53: "+[t.constructor.name])}()):t.Nothing.value},_=function(n){return o["null"](n.parents)},D=function(n){if(_(n)||E(n)<=2)return t.Nothing.value;var r=o.reverse(n.after),a=e["++"](o.semigroupList)(n.before)(S(r)),i=o.uncons(a);return i instanceof t.Just?new t.Just(function(){var t=o["null"](n.after);if(t){var u={};for(var c in n)n.hasOwnProperty(c)&&(u[c]=n[c]);return u.before=e["++"](o.semigroupList)(i.value0.tail)(S(a)),u.after=o.Nil.value,u}if(!t){var l={};for(var s in n)n.hasOwnProperty(s)&&(l[s]=n[s]);return l.before=i.value0.tail,l.after=o[":"](i.value0.head)(o.reverse(v(r))),l}throw new Error("Failed pattern match at ConeCanvas.ConeZipper line 427, column 42 - line 431, column 90: "+[t.constructor.name])}()):t.Nothing.value},M=function(n){return function(e){return c.nodeIsLeaf(n)(e.content)}},L=function(n){return function(e){return function(r){return M(n)(r)?t.Nothing.value:t.Just.create({content:e,before:o.Nil.value,after:o.Nil.value,parents:o[":"]({left:r.before,center:p(r.content),centerNodeId:c.runConeNode(n)(r.content).nodeId,right:r.after})(r.parents)})}}},I=function(n){return function(e){return _(e)?t.Nothing.value:e.before instanceof o.Nil?t.Just.create(function(){var t={};for(var r in e)e.hasOwnProperty(r)&&(t[r]=e[r]);return t.content=n,t.before=o.reverse(o[":"](e.content)(e.after)),t.after=o.Nil.value,t}()):t.Just.create(function(){var t={};for(var r in e)e.hasOwnProperty(r)&&(t[r]=e[r]);return t.content=n,t.before=e.before,t.after=o[":"](e.content)(e.after),t}())}},O=function(n){return function(e){return _(e)?t.Nothing.value:t.Just.create(function(){var t={};for(var r in e)e.hasOwnProperty(r)&&(t[r]=e[r]);return t.content=n,t.before=o[":"](e.content)(e.before),t.after=e.after,t}())}},R=function(n){return o.length(n.before)},k=function(n){var a=o.uncons(n.parents);if(a instanceof t.Just){var i=e["++"](o.semigroupList)(o.reverse(n.before))(e["++"](o.semigroupList)(new o.Cons(n.content,o.Nil.value))(n.after));return t.Just.create({content:new c.ConeNode({entry:a.value0.head.center,nodeId:a.value0.head.centerNodeId,firstInd:R(n),children:new r.Right(i)}),before:a.value0.head.left,after:a.value0.head.right,parents:a.value0.tail})}return t.Nothing.value},U=function(n){return t.maybe(n)(U)(k(n))},G=function(n){if(n instanceof c.OSCurrent){var e=k(n.value0);if(e instanceof t.Just)return new t.Just(new c.OSCurrent(e.value0));if(e instanceof t.Nothing)return t.Nothing.value;throw new Error("Failed pattern match at ConeCanvas.ConeZipper line 599, column 28 - line 602, column 1: "+[e.constructor.name])}if(n instanceof c.OSParent)return new t.Just(new c.OSCurrent(n.value0));throw new Error("Failed pattern match at ConeCanvas.ConeZipper line 599, column 1 - line 602, column 1: "+[n.constructor.name])},B=function(n){return n instanceof c.OSCurrent?R(n.value0):0},J=function(n){var r=function(n){var a=o.length(n.before);return t.maybe(new o.Cons(a,o.Nil.value))(function(n){return e["++"](o.semigroupList)(r(n))(o.singleton(a))})(k(n))},a=o.tail(r(n));if(a instanceof t.Just)return a.value0;if(a instanceof t.Nothing)return o.Nil.value;throw new Error("Failed pattern match at ConeCanvas.ConeZipper line 512, column 29 - line 515, column 3: "+[a.constructor.name])},$=function(n){if(n instanceof c.OSCurrent)return J(n.value0);if(n instanceof c.OSParent)return J(n.value0);throw new Error("Failed pattern match at ConeCanvas.ConeZipper line 658, column 1 - line 659, column 1: "+[n.constructor.name])},H=function(n){return n.content.value0.firstInd},z=function(n){var r=e["++"](o.semigroupList)(o.reverse(n.before))(e["++"](o.semigroupList)(new o.Cons(n.content,o.Nil.value))(n.after)),a=o.uncons(r);if(a instanceof t.Just){var i={};for(var u in n)n.hasOwnProperty(u)&&(i[u]=n[u]);return i.content=a.value0.head,i.before=o.Nil.value,i.after=a.value0.tail,i}return n},W=function(n){return t.fromMaybe(z(n))(A(n))},j=function(n){return function(n){var e=E(n),r=function(n){return function(e){var r=u.uncons(n);return r instanceof t.Just?u[":"](W(r.value0.head))(n):n}};return i.foldl(i.foldableArray)(r)([n])(u[".."](0)(e-1))}},V=function(n){return function(e){var r=function(r){return function(a){if(r>=0&&o.length(a)>r){var i=o["!!"](a)(r);if(i instanceof t.Just)return t.Just.create({content:i.value0,before:o.reverse(o.take(r)(a)),after:o.take(o.length(a)-(r+1|0))(o.drop(r+1|0)(a)),parents:o[":"]({left:e.before,center:w(e),centerNodeId:c.runConeNode(n)(e.content).nodeId,right:e.after})(e.parents)});if(i instanceof t.Nothing)return t.Nothing.value;throw new Error("Failed pattern match at ConeCanvas.ConeZipper line 239, column 9 - line 250, column 7: "+[i.constructor.name])}return t.Nothing.value}};return function(){var t=c.nodeGetChildren(n)(e.content)(),o=s(n)(e).firstInd;return r(o)(t)}}},q=function(n){return function(r){return function(a){if(a instanceof o.Nil)return e["return"](l.applicativeEff)(new t.Just(U(r)));var i=function(r){return function(a){if(r instanceof t.Nothing)return e["return"](l.applicativeEff)(t.Nothing.value);if(r instanceof t.Just){var u=o.uncons(a);if(u instanceof t.Just&&u.value0.tail instanceof o.Nil)return e["return"](l.applicativeEff)(T(r.value0)(u.value0.head));if(u instanceof t.Just){var c=T(r.value0)(u.value0.head);if(c instanceof t.Nothing)return e["return"](l.applicativeEff)(t.Nothing.value);if(c instanceof t.Just)return function(){var e=V(n)(c.value0)();return i(e)(u.value0.tail)()};throw new Error("Failed pattern match at ConeCanvas.ConeZipper line 536, column 17 - line 541, column 13: "+[c.constructor.name])}if(u instanceof t.Nothing)return e["return"](l.applicativeEff)(t.Nothing.value);throw new Error("Failed pattern match at ConeCanvas.ConeZipper line 532, column 9 - line 543, column 1: "+[u.constructor.name])}throw new Error("Failed pattern match at ConeCanvas.ConeZipper line 525, column 1 - line 526, column 1: "+[r.constructor.name,a.constructor.name])}};return function(){var e=V(n)(U(r))();return i(e)(a)()}}}},Z=function(n){return function(r){var o=function(r){return function(r){return function(){var u=V(n)(r)(),c=function(){if(u instanceof t.Nothing)return[];if(u instanceof t.Just)return j(n)(u.value0);throw new Error("Failed pattern match at ConeCanvas.ConeZipper line 86, column 22 - line 89, column 7: "+[u.constructor.name])}(),s=a.traverse(a.traversableArray)(l.applicativeEff)(o(n))(c)();return 1+i.sum(i.foldableArray)(e.semiringInt)(s)|0}}},u=U(r);return o(n)(u)}},K=function(n){return function(o){return function(a){var i=function(o){return function(a){if(0>a)return e["return"](l.applicativeEff)(new r.Right(a));if(0===a)return e["return"](l.applicativeEff)(new r.Left(o));if(e.otherwise){var c=function(n){return function(t){if(n instanceof r.Left)return e["return"](l.applicativeEff)(new r.Left(n.value0));if(n instanceof r.Right){if(0===n.value0)return e["return"](l.applicativeEff)(new r.Left(t));if(e.otherwise)return i(t)(n.value0)}throw new Error("Failed pattern match at ConeCanvas.ConeZipper line 113, column 13 - line 114, column 13: "+[n.constructor.name,t.constructor.name])}};return function(){var e=V(n)(o)(),i=function(){if(e instanceof t.Nothing)return[];if(e instanceof t.Just)return j(n)(e.value0);throw new Error("Failed pattern match at ConeCanvas.ConeZipper line 108, column 24 - line 111, column 9: "+[e.constructor.name])}();return u.foldM(l.monadEff)(c)(new r.Right(a-1))(i)()}}throw new Error("Failed pattern match at ConeCanvas.ConeZipper line 94, column 1 - line 117, column 1: "+[o.constructor.name,a.constructor.name])}},c=U(o);return function(){var n=i(c)(a-1)();if(n instanceof r.Right)return t.Nothing.value;if(n instanceof r.Left)return new t.Just(n.value0);throw new Error("Failed pattern match at ConeCanvas.ConeZipper line 98, column 7 - line 101, column 3: "+[n.constructor.name])}}}},X=function(n){return function(r){return r instanceof c.OSCurrent?function(){var e=V(n)(r.value0)();if(e instanceof t.Just)return new t.Just(new c.OSCurrent(e.value0));if(e instanceof t.Nothing){var o=M(n)(r.value0);if(o)return t.Nothing.value;if(!o)return new t.Just(new c.OSParent(r.value0));throw new Error("Failed pattern match at ConeCanvas.ConeZipper line 610, column 52 - line 610, column 113: "+[o.constructor.name])}throw new Error("Failed pattern match at ConeCanvas.ConeZipper line 608, column 29 - line 611, column 1: "+[e.constructor.name])}:e["return"](l.applicativeEff)(t.Nothing.value)}},Y=function(n){var r=e["++"](o.semigroupList)(o.reverse(n.before))(n.after),a=h(R(n))(o.length(r)),i=!o["null"](r);if(i){var u=a>=0;if(u){var c=o["!!"](r)(a);if(c instanceof t.Nothing)return t.Nothing.value;if(c instanceof t.Just)return t.Just.create(function(){var e={};for(var t in n)n.hasOwnProperty(t)&&(e[t]=n[t]);return e.content=c.value0,e.before=o.reverse(o.take(a)(r)),e.after=o.take(o.length(r)-(a+1|0))(o.drop(a+1|0)(r)),e}());throw new Error("Failed pattern match at ConeCanvas.ConeZipper line 366, column 22 - line 373, column 17: "+[c.constructor.name])}if(!u){var l=o["!!"](r)(o.length(r)-1);if(l instanceof t.Nothing)return t.Nothing.value;if(l instanceof t.Just)return t.Just.create(function(){var e={};for(var t in n)n.hasOwnProperty(t)&&(e[t]=n[t]);return e.content=l.value0,e.before=o.reverse(o.take(o.length(r)-1)(r)),e.after=o.Nil.value,e}());throw new Error("Failed pattern match at ConeCanvas.ConeZipper line 373, column 22 - line 380, column 9: "+[l.constructor.name])}throw new Error("Failed pattern match at ConeCanvas.ConeZipper line 365, column 13 - line 380, column 9: "+[u.constructor.name])}if(!i)return t.Nothing.value;throw new Error("Failed pattern match at ConeCanvas.ConeZipper line 363, column 5 - line 381, column 3: "+[i.constructor.name])},Q=function(n){if(n instanceof c.OSCurrent){var e=Y(n.value0);if(e instanceof t.Just)return new t.Just(new c.OSCurrent(e.value0));if(e instanceof t.Nothing){var r=k(n.value0);if(r instanceof t.Just)return new t.Just(new c.OSParent(d(r.value0)));if(r instanceof t.Nothing)return t.Nothing.value;throw new Error("Failed pattern match at ConeCanvas.ConeZipper line 651, column 21 - line 654, column 1: "+[r.constructor.name])}throw new Error("Failed pattern match at ConeCanvas.ConeZipper line 648, column 5 - line 654, column 1: "+[e.constructor.name])}if(n instanceof c.OSParent)return t.Nothing.value;throw new Error("Failed pattern match at ConeCanvas.ConeZipper line 647, column 1 - line 654, column 1: "+[n.constructor.name])},nn=function(n){var r=e["++"](o.semigroupList)(o.reverse(n.before))(n.after),a=R(n),i=a-1,u=!o["null"](r);if(u){var c=i>=0;if(c){var l=o["!!"](r)(i);if(l instanceof t.Nothing)return t.Nothing.value;if(l instanceof t.Just)return t.Just.create(function(){var e={};for(var t in n)n.hasOwnProperty(t)&&(e[t]=n[t]);return e.content=l.value0,e.before=o.reverse(o.take(i)(r)),e.after=o.take(o.length(r)-(i+1|0))(o.drop(i+1|0)(r)),e}());throw new Error("Failed pattern match at ConeCanvas.ConeZipper line 338, column 22 - line 345, column 17: "+[l.constructor.name])}if(!c){var s=o["!!"](r)(o.length(r)-1);if(s instanceof t.Nothing)return t.Nothing.value;if(s instanceof t.Just)return t.Just.create(function(){var e={};for(var t in n)n.hasOwnProperty(t)&&(e[t]=n[t]);return e.content=s.value0,e.before=o.reverse(o.take(o.length(r)-1)(r)),e.after=o.Nil.value,e}());throw new Error("Failed pattern match at ConeCanvas.ConeZipper line 345, column 22 - line 352, column 9: "+[s.constructor.name])}throw new Error("Failed pattern match at ConeCanvas.ConeZipper line 337, column 13 - line 352, column 9: "+[c.constructor.name])}if(!u)return t.Nothing.value;throw new Error("Failed pattern match at ConeCanvas.ConeZipper line 335, column 5 - line 353, column 3: "+[u.constructor.name])},en=function(n){return function(r){var a=E(r)<2||c.nodeIsLeaf(n)(f(W(r)));if(a)return e["return"](l.applicativeEff)(t.Nothing.value);if(!a){var i=f(r),u=nn(r);if(u instanceof t.Nothing)return e["return"](l.applicativeEff)(t.Nothing.value);if(u instanceof t.Just){var s=W(u.value0);return function(){var e=c.nodeGetChildren(n)(f(s))(),r=o["null"](e);if(r)return L(n)(i)(s);if(!r){var a=V(n)(s)();if(a instanceof t.Nothing)return t.Nothing.value;if(a instanceof t.Just)return O(i)(a.value0);throw new Error("Failed pattern match at ConeCanvas.ConeZipper line 465, column 29 - line 471, column 1: "+[a.constructor.name])}throw new Error("Failed pattern match at ConeCanvas.ConeZipper line 461, column 21 - line 471, column 1: "+[r.constructor.name])}}throw new Error("Failed pattern match at ConeCanvas.ConeZipper line 456, column 17 - line 471, column 1: "+[u.constructor.name])}throw new Error("Failed pattern match at ConeCanvas.ConeZipper line 453, column 5 - line 471, column 1: "+[a.constructor.name])}},tn=function(n){var e=k(n);if(e instanceof t.Nothing)return t.Nothing.value;if(e instanceof t.Just){var r=_(e.value0);if(r)return t.Nothing.value;if(!r){var o=f(n),a=nn(n);if(a instanceof t.Nothing)return I(o)(d(e.value0));if(a instanceof t.Just){var i=k(a.value0);if(i instanceof t.Nothing)return t.Nothing.value;if(i instanceof t.Just)return I(o)(i.value0);throw new Error("Failed pattern match at ConeCanvas.ConeZipper line 482, column 37 - line 486, column 1: "+[i.constructor.name])}throw new Error("Failed pattern match at ConeCanvas.ConeZipper line 480, column 20 - line 486, column 1: "+[a.constructor.name])}throw new Error("Failed pattern match at ConeCanvas.ConeZipper line 476, column 11 - line 486, column 1: "+[r.constructor.name])}throw new Error("Failed pattern match at ConeCanvas.ConeZipper line 473, column 5 - line 486, column 1: "+[e.constructor.name])},rn=function(n){if(n instanceof c.OSCurrent){var e=nn(n.value0);if(e instanceof t.Just)return new t.Just(new c.OSCurrent(e.value0));if(e instanceof t.Nothing){var r=k(n.value0);if(r instanceof t.Just)return new t.Just(new c.OSParent(d(r.value0)));if(r instanceof t.Nothing)return t.Nothing.value;throw new Error("Failed pattern match at ConeCanvas.ConeZipper line 641, column 25 - line 644, column 1: "+[r.constructor.name])}throw new Error("Failed pattern match at ConeCanvas.ConeZipper line 638, column 5 - line 644, column 1: "+[e.constructor.name])}if(n instanceof c.OSParent)return t.Nothing.value;throw new Error("Failed pattern match at ConeCanvas.ConeZipper line 637, column 1 - line 644, column 1: "+[n.constructor.name])};n.normalizePos=h,n.selGetPath=$,n.selDeleteFillFromRight=Q,n.selDeleteFillFromLeft=rn,n.selGetEntry=g,n.selDown=X,n.selUp=G,n.selShiftToZero=y,n.selSetSel=b,n.selGetPos=m,n.selGetPosition=B,n.selNumLevel=F,n.selFromPos=x,n.coneSetPath=q,n.coneGetPath=J,n.tailList=v,n.headList=S,n.withEmptyChildren=d,n.coneMoveUp=tn,n.coneMoveDown=en,n.coneMoveRight=N,n.coneMoveLeft=D,n.coneDeleteFillFromRight=Y,n.coneDeleteFillFromLeft=nn,n.coneInsertBelow=L,n.coneInsertBefore=I,n.coneInsertAfter=O,n.coneNumLevel=E,n.coneIsLeaf=M,n.coneGetFirstBelow=H,n.coneIsRoot=_,n.coneDown=V,n.coneRoot=U,n.coneUp=k,n.coneSetPos=T,n.coneGetPosition=R,n.coneRight=W,n.coneFirst=z,n.coneShiftToZero=P,n.coneNext=A,n.getChildren=j,n.getZipFromIndex=K,n.countAllPositions=Z,n.nodeGetEntry=p,n.zipGetEntry=w,n.zipGetNodeRec=s,n.zipGetNode=f,n.makeZipper=C}(PS["ConeCanvas.ConeZipper"]=PS["ConeCanvas.ConeZipper"]||{}),function(n){"use strict";var e=PS.Prelude,t=(PS["Data.Function"],PS["Data.Monoid"],function(n){return function(t){return function(r){var o=e.compare(n)(t)(r);if(o instanceof e.LT)return t;if(o instanceof e.EQ)return t;if(o instanceof e.GT)return r;throw new Error("Failed pattern match at Data.Ord line 60, column 3 - line 67, column 1: "+[o.constructor.name])}}});n.min=t}(PS["Data.Ord"]=PS["Data.Ord"]||{}),function(n){"use strict";var e=function(){function n(){}return n.value=new n,n}();n.Proxy=e}(PS["Type.Proxy"]=PS["Type.Proxy"]||{}),function(n){"use strict";var e=(PS["Type.Proxy"],function(n){this.sized=n}),t=function(n){return n.sized},r=new e(function(n){return 4});n.Sized=e,n.sized=t,n.s4=r}(PS["Data.TypeNat"]=PS["Data.TypeNat"]||{}),function(n){"use strict";var e=PS.Prelude,t=PS["Data.Array"],r=PS["Data.Monoid"],o=PS["Data.Foldable"],a=(PS["Data.TypeNat"],PS["Control.Apply"]),i=PS.Math,u=(PS["Type.Proxy"],PS.Extensions,function(n){return n}),c=new e.Functor(function(n){return function(t){return e.map(e.functorArray)(n)(t)}}),l=new o.Foldable(function(n){return function(t){return function(a){return o.foldr(l)(function(r){return function(o){return e["<>"](n["__superclass_Prelude.Semigroup_0"]())(t(r))(o)}})(r.mempty(n))(a)}}},function(n){return function(e){return function(t){return o.foldl(o.foldableArray)(n)(e)(t)}}},function(n){return function(e){return function(t){return o.foldr(o.foldableArray)(n)(e)(t)}}}),s=function(n){return o.foldl(l)(e["+"](e.semiringNumber))(0)(e["<$>"](c)(function(n){return n*n})(n))},f=function(n){return i.sqrt(s(n))},d=function(n){var t=1/f(n);return e["<$>"](c)(function(n){return n*t})(n)},v=new e.Apply(function(){return c},function(n){return function(e){return t.zipWith(function(n){return function(e){return n(e)}})(n)(e)}}),m=function(n){return a.lift2(v)(e["-"](n["__superclass_Prelude.DivisionRing_0"]()["__superclass_Prelude.Ring_0"]()))},h=function(n){return function(t){return d(m(e.numNumber)(n)(t))}};n.normalize=d,n.vlength=f,n.vlengthSquared=s,n.direction=h,n.vSub=m,n.toArray=u,n.functorVec=c,n.applyVec=v,n.foldableVector=l}(PS["Data.Vector"]=PS["Data.Vector"]||{}),function(n){"use strict";var e=PS.Prelude,t=(PS["Data.Vector"],PS["Data.TypeNat"],PS["Data.Array"]),r=(PS["Data.Array.Unsafe"],PS["Data.Maybe.Unsafe"],PS.Extensions),o=function(n){if(3===t.length(n))return n;if(e.otherwise)return r.fail("Vector3>>vec3': wrong array length!");throw new Error("Failed pattern match at Data.Vector3 line 31, column 1 - line 34, column 1: "+[n.constructor.name])},a=function(n){return function(e){return function(t){return[n,e,t]}}},i=function(n){return n[2]},u=function(n){return n[1]},c=function(n){return n[0]},l=function(n){return function(t){return function(o){return 3===t.length&&3===o.length?[e["-"](n["__superclass_Prelude.DivisionRing_0"]()["__superclass_Prelude.Ring_0"]())(e["*"](n["__superclass_Prelude.DivisionRing_0"]()["__superclass_Prelude.ModuloSemiring_1"]()["__superclass_Prelude.Semiring_0"]())(t[1])(o[2]))(e["*"](n["__superclass_Prelude.DivisionRing_0"]()["__superclass_Prelude.ModuloSemiring_1"]()["__superclass_Prelude.Semiring_0"]())(t[2])(o[1])),e["-"](n["__superclass_Prelude.DivisionRing_0"]()["__superclass_Prelude.Ring_0"]())(e["*"](n["__superclass_Prelude.DivisionRing_0"]()["__superclass_Prelude.ModuloSemiring_1"]()["__superclass_Prelude.Semiring_0"]())(t[2])(o[0]))(e["*"](n["__superclass_Prelude.DivisionRing_0"]()["__superclass_Prelude.ModuloSemiring_1"]()["__superclass_Prelude.Semiring_0"]())(t[0])(o[2])),e["-"](n["__superclass_Prelude.DivisionRing_0"]()["__superclass_Prelude.Ring_0"]())(e["*"](n["__superclass_Prelude.DivisionRing_0"]()["__superclass_Prelude.ModuloSemiring_1"]()["__superclass_Prelude.Semiring_0"]())(t[0])(o[1]))(e["*"](n["__superclass_Prelude.DivisionRing_0"]()["__superclass_Prelude.ModuloSemiring_1"]()["__superclass_Prelude.Semiring_0"]())(t[1])(o[0]))]:r.fail("Vector3>>cross: impossible!")}}};n.cross=l,n.get3Z=i,n.get3Y=u,n.get3X=c,n["vec3'"]=o,n.vec3=a}(PS["Data.Vector3"]=PS["Data.Vector3"]||{}),function(n){"use strict";var e=PS.Prelude,t=(PS["Data.Foreign"],PS["Data.Foreign.Class"]),r=PS["Data.Foreign.Index"],o=PS["Data.Array"],a=(PS["Data.Vector"],PS["Data.Vector3"]),i=(PS["Data.TypeNat"],PS["ConeCanvas.ConeModel"],PS["ConeCanvas.Color"]),u=PS["Data.Either"],c={prefsName:"standardPrefs",backColor:new i.Color4(1,1,1,1),textColor:new i.Color4I(0,0,0,1),textureFrameColor:new i.Color4(0,0,0,.3),fontStyle:"bold 40px sans-serif",massiveColor:new i.Color4(.9,.9,1,1),rectColor:new i.Color4(.9,.9,1,1),labelTextBackground:!0,alwaysGreyTextBack:!1,labelIconBackground:!1,lightDirection:[-.5,-1,-.3],lightAmbient:new i.Color4(.2,.2,.2,1),lightDiffuse:new i.Color4(.5,.7,.7,1),lightDiffuseEdit:new i.Color4(1,.5,.5,1),lightSpecular:new i.Color4(1,1,1,1),materialAmbient:new i.Color4(1,1,1,1),materialDiffuse:new i.Color4(46/256,99/256,191/256,1),materialSpecular:new i.Color4(1,1,1,1),shininess:16,maxTextLength:40,angleSelectFactor:10,angleSelectAddX:0,angleSelectAddY:0,desiredZoomHint:5.5,aniTimeLR:500,aniTimeUD:600,aniTimeT:1500,aniTimeF:4e3,fixedFrameTime:0,windowsRatio:.6666666,labelRatio:1.5,cameraDistZ:10,coneHeight:2.5,upperOffset:0,controlAreaInitialVisible:!0,cursorKeys:!0},l=function(n){return function(c){var l=[{selector:"backColor",setter:function(n){return function(r){return e[">>="](u.bindEither)(t.read(i.color4IsForeign)(n))(function(n){return e["return"](u.applicativeEither)(function(){var e={};for(var t in r)r.hasOwnProperty(t)&&(e[t]=r[t]);return e.backColor=n,e}())})}}},{selector:"textColor",setter:function(n){return function(r){return e[">>="](u.bindEither)(t.read(i.color4IIsForeign)(n))(function(n){return e["return"](u.applicativeEither)(function(){var e={};for(var t in r)r.hasOwnProperty(t)&&(e[t]=r[t]);return e.textColor=n,e}())})}}},{selector:"textureFrameColor",setter:function(n){return function(r){return e[">>="](u.bindEither)(t.read(i.color4IsForeign)(n))(function(n){return e["return"](u.applicativeEither)(function(){var e={};for(var t in r)r.hasOwnProperty(t)&&(e[t]=r[t]);return e.textureFrameColor=n,e}())})}}},{selector:"fontStyle",setter:function(n){return function(r){return e[">>="](u.bindEither)(t.read(t.stringIsForeign)(n))(function(n){return e["return"](u.applicativeEither)(function(){var e={};for(var t in r)r.hasOwnProperty(t)&&(e[t]=r[t]);return e.fontStyle=n,e}())})}}},{selector:"massiveColor",setter:function(n){return function(r){return e[">>="](u.bindEither)(t.read(i.color4IsForeign)(n))(function(n){return e["return"](u.applicativeEither)(function(){var e={};for(var t in r)r.hasOwnProperty(t)&&(e[t]=r[t]);return e.massiveColor=n,e}())})}}},{selector:"rectColor",setter:function(n){return function(r){return e[">>="](u.bindEither)(t.read(i.color4IsForeign)(n))(function(n){return e["return"](u.applicativeEither)(function(){var e={};for(var t in r)r.hasOwnProperty(t)&&(e[t]=r[t]);return e.rectColor=n,e}())})}}},{selector:"labelTextBackground",setter:function(n){return function(r){return e[">>="](u.bindEither)(t.read(t.booleanIsForeign)(n))(function(n){return e["return"](u.applicativeEither)(function(){var e={};for(var t in r)r.hasOwnProperty(t)&&(e[t]=r[t]);return e.labelTextBackground=n,e}())})}}},{selector:"alwaysGreyTextBack",setter:function(n){return function(r){return e[">>="](u.bindEither)(t.read(t.booleanIsForeign)(n))(function(n){return e["return"](u.applicativeEither)(function(){var e={};for(var t in r)r.hasOwnProperty(t)&&(e[t]=r[t]);return e.alwaysGreyTextBack=n,e}())})}}},{selector:"labelIconBackground",setter:function(n){return function(r){return e[">>="](u.bindEither)(t.read(t.booleanIsForeign)(n))(function(n){return e["return"](u.applicativeEither)(function(){var e={};for(var t in r)r.hasOwnProperty(t)&&(e[t]=r[t]);return e.labelIconBackground=n,e}())})}}},{selector:"lightDirection",setter:function(n){return function(r){return e[">>="](u.bindEither)(t.read(t.arrayIsForeign(t.numberIsForeign))(n))(function(n){return e["return"](u.applicativeEither)(function(){var e={};for(var t in r)r.hasOwnProperty(t)&&(e[t]=r[t]);return e.lightDirection=a["vec3'"](n),e}())})}}},{selector:"lightAmbient",setter:function(n){return function(r){return e[">>="](u.bindEither)(t.read(i.color4IsForeign)(n))(function(n){return e["return"](u.applicativeEither)(function(){var e={};for(var t in r)r.hasOwnProperty(t)&&(e[t]=r[t]);return e.lightAmbient=n,e}())})}}},{selector:"lightDiffuse",setter:function(n){return function(r){return e[">>="](u.bindEither)(t.read(i.color4IsForeign)(n))(function(n){return e["return"](u.applicativeEither)(function(){var e={};for(var t in r)r.hasOwnProperty(t)&&(e[t]=r[t]);return e.lightDiffuse=n,e}())})}}},{selector:"lightDiffuseEdit",setter:function(n){return function(r){return e[">>="](u.bindEither)(t.read(i.color4IsForeign)(n))(function(n){return e["return"](u.applicativeEither)(function(){var e={};for(var t in r)r.hasOwnProperty(t)&&(e[t]=r[t]);return e.lightDiffuseEdit=n,e}())})}}},{selector:"lightSpecular",setter:function(n){return function(r){return e[">>="](u.bindEither)(t.read(i.color4IsForeign)(n))(function(n){return e["return"](u.applicativeEither)(function(){var e={};for(var t in r)r.hasOwnProperty(t)&&(e[t]=r[t]);return e.lightSpecular=n,e}())})}}},{selector:"materialAmbient",setter:function(n){return function(r){return e[">>="](u.bindEither)(t.read(i.color4IsForeign)(n))(function(n){return e["return"](u.applicativeEither)(function(){var e={};for(var t in r)r.hasOwnProperty(t)&&(e[t]=r[t]);return e.materialAmbient=n,e}())})}}},{selector:"materialDiffuse",setter:function(n){return function(r){return e[">>="](u.bindEither)(t.read(i.color4IsForeign)(n))(function(n){return e["return"](u.applicativeEither)(function(){var e={};for(var t in r)r.hasOwnProperty(t)&&(e[t]=r[t]);return e.materialDiffuse=n,e}())})}}},{selector:"materialSpecular",setter:function(n){return function(r){return e[">>="](u.bindEither)(t.read(i.color4IsForeign)(n))(function(n){return e["return"](u.applicativeEither)(function(){var e={};for(var t in r)r.hasOwnProperty(t)&&(e[t]=r[t]);return e.materialSpecular=n,e}())})}}},{selector:"shininess",setter:function(n){return function(r){return e[">>="](u.bindEither)(t.read(t.numberIsForeign)(n))(function(n){return e["return"](u.applicativeEither)(function(){var e={};for(var t in r)r.hasOwnProperty(t)&&(e[t]=r[t]);return e.shininess=n,e}())})}}},{selector:"maxTextLength",setter:function(n){return function(r){return e[">>="](u.bindEither)(t.read(t.intIsForeign)(n))(function(n){return e["return"](u.applicativeEither)(function(){var e={};for(var t in r)r.hasOwnProperty(t)&&(e[t]=r[t]);return e.maxTextLength=n,e}())})}}},{selector:"angleSelectFactor",setter:function(n){return function(r){return e[">>="](u.bindEither)(t.read(t.numberIsForeign)(n))(function(n){return e["return"](u.applicativeEither)(function(){var e={};for(var t in r)r.hasOwnProperty(t)&&(e[t]=r[t]);return e.angleSelectFactor=n,e}())})}}},{selector:"angleSelectAddX",setter:function(n){return function(r){return e[">>="](u.bindEither)(t.read(t.numberIsForeign)(n))(function(n){return e["return"](u.applicativeEither)(function(){var e={};for(var t in r)r.hasOwnProperty(t)&&(e[t]=r[t]);return e.angleSelectAddX=n,e}())})}}},{selector:"angleSelectAddY",setter:function(n){return function(r){return e[">>="](u.bindEither)(t.read(t.numberIsForeign)(n))(function(n){return e["return"](u.applicativeEither)(function(){var e={};for(var t in r)r.hasOwnProperty(t)&&(e[t]=r[t]);return e.angleSelectAddY=n,e}())})}}},{selector:"desiredZoomHint",setter:function(n){return function(r){return e[">>="](u.bindEither)(t.read(t.numberIsForeign)(n))(function(n){return e["return"](u.applicativeEither)(function(){var e={};for(var t in r)r.hasOwnProperty(t)&&(e[t]=r[t]);return e.desiredZoomHint=n,e}())})}}},{selector:"aniTimeLR",setter:function(n){return function(r){return e[">>="](u.bindEither)(t.read(t.numberIsForeign)(n))(function(n){return e["return"](u.applicativeEither)(function(){var e={};for(var t in r)r.hasOwnProperty(t)&&(e[t]=r[t]);return e.aniTimeLR=n,e}())})}}},{selector:"aniTimeUD",setter:function(n){return function(r){return e[">>="](u.bindEither)(t.read(t.numberIsForeign)(n))(function(n){return e["return"](u.applicativeEither)(function(){var e={};for(var t in r)r.hasOwnProperty(t)&&(e[t]=r[t]);return e.aniTimeUD=n,e}())})}}},{selector:"aniTimeT",setter:function(n){return function(r){return e[">>="](u.bindEither)(t.read(t.numberIsForeign)(n))(function(n){return e["return"](u.applicativeEither)(function(){var e={};for(var t in r)r.hasOwnProperty(t)&&(e[t]=r[t]);return e.aniTimeT=n,e}())})}}},{selector:"aniTimeF",setter:function(n){return function(r){return e[">>="](u.bindEither)(t.read(t.numberIsForeign)(n))(function(n){return e["return"](u.applicativeEither)(function(){var e={};for(var t in r)r.hasOwnProperty(t)&&(e[t]=r[t]);return e.aniTimeF=n,e}())})}}},{selector:"fixedFrameTime",setter:function(n){return function(r){return e[">>="](u.bindEither)(t.read(t.intIsForeign)(n))(function(n){return e["return"](u.applicativeEither)(function(){var e={};for(var t in r)r.hasOwnProperty(t)&&(e[t]=r[t]);return e.fixedFrameTime=n,e}())})}}},{selector:"windowsRatio",setter:function(n){return function(r){return e[">>="](u.bindEither)(t.read(t.numberIsForeign)(n))(function(n){return e["return"](u.applicativeEither)(function(){var e={};for(var t in r)r.hasOwnProperty(t)&&(e[t]=r[t]);return e.windowsRatio=n,e}())})}}},{selector:"labelRatio",setter:function(n){return function(r){return e[">>="](u.bindEither)(t.read(t.numberIsForeign)(n))(function(n){return e["return"](u.applicativeEither)(function(){var e={};for(var t in r)r.hasOwnProperty(t)&&(e[t]=r[t]);return e.labelRatio=n,e}())})}}},{selector:"cameraDistZ",setter:function(n){return function(r){return e[">>="](u.bindEither)(t.read(t.numberIsForeign)(n))(function(n){return e["return"](u.applicativeEither)(function(){var e={};for(var t in r)r.hasOwnProperty(t)&&(e[t]=r[t]);return e.cameraDistZ=n,e}())})}}},{selector:"coneHeight",setter:function(n){return function(r){return e[">>="](u.bindEither)(t.read(t.numberIsForeign)(n))(function(n){return e["return"](u.applicativeEither)(function(){var e={};for(var t in r)r.hasOwnProperty(t)&&(e[t]=r[t]);return e.coneHeight=n,e}())})}}},{selector:"upperOffset",setter:function(n){return function(r){return e[">>="](u.bindEither)(t.read(t.numberIsForeign)(n))(function(n){return e["return"](u.applicativeEither)(function(){var e={};for(var t in r)r.hasOwnProperty(t)&&(e[t]=r[t]);return e.upperOffset=n,e}())})}}},{selector:"cursorKeys",setter:function(n){return function(r){return e[">>="](u.bindEither)(t.read(t.booleanIsForeign)(n))(function(n){return e["return"](u.applicativeEither)(function(){var e={};for(var t in r)r.hasOwnProperty(t)&&(e[t]=r[t]);return e.cursorKeys=n,e}())})}}},{selector:"controlAreaInitialVisible",setter:function(n){return function(r){return e[">>="](u.bindEither)(t.read(t.booleanIsForeign)(n))(function(n){return e["return"](u.applicativeEither)(function(){var e={};for(var t in r)r.hasOwnProperty(t)&&(e[t]=r[t]);return e.controlAreaInitialVisible=n,e}())})}}}],s=e.map(e.functorArray)(function(n){return function(t){return function(o){var a=r.hasProperty(r.indexString)(n.selector)(o);if(a)return e.bind(u.bindEither)(r.ix(r.indexString)(o)(n.selector))(function(e){return n.setter(e)(t)});if(!a)return e["return"](u.applicativeEither)(t);throw new Error("Failed pattern match at ConeCanvas.Preferences line 159, column 21 - line 163, column 40: "+[a.constructor.name])}}})(l);return e.bind(u.bindEither)(t.readJSON(t.foreignIsForeign)(n))(function(n){return e.bind(u.bindEither)(o.foldM(u.monadEither)(function(e){return function(t){return t(e)(n)}})(c)(s))(function(n){return e["return"](u.applicativeEither)(n)})})}};n.parsePrefs=l,n.standardPrefs=c}(PS["ConeCanvas.Preferences"]=PS["ConeCanvas.Preferences"]||{}),function(n){"use strict";var e=PS.Prelude,t=function(n){return new e.Show(function(t){return"{x: "+(e.show(n)(t.x)+(", y: "+(e.show(n)(t.y)+(", z: "+(e.show(n)(t.z)+"}")))))})},r=function(n){return new e.Show(function(r){return"{leftTopFront: "+(e.show(t(n))(r.leftTopFront)+(", rightBottomRear:"+(e.show(t(n))(r.rightBottomRear)+"};")))})},o=function(n){return new e.Eq(function(t){return function(r){return e["=="](n)(t.x)(r.x)&&e["=="](n)(t.y)(r.y)&&e["=="](n)(t.z)(r.z)}})},a=function(n){return new e.Ord(function(){return o(n["__superclass_Prelude.Eq_0"]())},function(t){return function(r){var o=e.compare(n)(t.x)(r.x);if(o instanceof e.GT)return e.GT.value;if(o instanceof e.LT)return e.LT.value;if(o instanceof e.EQ){var a=e.compare(n)(t.y)(r.y);if(a instanceof e.GT)return e.GT.value;if(a instanceof e.LT)return e.LT.value;if(a instanceof e.EQ){var i=e.compare(n)(t.z)(r.z);if(i instanceof e.GT)return e.GT.value;
if(i instanceof e.LT)return e.LT.value;if(i instanceof e.EQ)return e.EQ.value;throw new Error("Failed pattern match at ConeCanvas.GeometryTypes line 54, column 23 - line 59, column 1: "+[i.constructor.name])}throw new Error("Failed pattern match at ConeCanvas.GeometryTypes line 51, column 19 - line 59, column 1: "+[a.constructor.name])}throw new Error("Failed pattern match at ConeCanvas.GeometryTypes line 48, column 9 - line 59, column 1: "+[o.constructor.name])}})};n.showPoint3=t,n.eqPoint3=o,n.ordPoint3=a,n.showCuboid=r}(PS["ConeCanvas.GeometryTypes"]=PS["ConeCanvas.GeometryTypes"]||{}),function(n){"use strict";var e=PS.Prelude,t=PS["Control.Monad.Eff"],r=PS["Control.Monad.ST"],o=PS["Data.Maybe"],a=(PS["Graphics.Canvas"],PS["Debug.Trace"]),i=(PS["Data.ArrayBuffer.Types"],PS["ConeCanvas.ConeModel"],PS["ConeCanvas.Preferences"]),u=(PS["ConeCanvas.GeometryTypes"],PS["Data.List"],function(){function n(){}return n.value=new n,n}()),c=function(){function n(){}return n.value=new n,n}(),l=function(){function n(){}return n.value=new n,n}(),s=function(){function n(){}return n.value=new n,n}(),f=function(){function n(){}return n.value=new n,n}(),d=function(){function n(){}return n.value=new n,n}(),v=function(){function n(){}return n.value=new n,n}(),m=function(){function n(){}return n.value=new n,n}(),h=function(){function n(){}return n.value=new n,n}(),p=function(){function n(){}return n.value=new n,n}(),w=function(){function n(){}return n.value=new n,n}(),g=function(){function n(){}return n.value=new n,n}(),C=function(){function n(){}return n.value=new n,n}(),S=function(){function n(){}return n.value=new n,n}(),P=function(){function n(){}return n.value=new n,n}(),y=function(){function n(){}return n.value=new n,n}(),T=function(){function n(){}return n.value=new n,n}(),b=function(){function n(){}return n.value=new n,n}(),E=function(){function n(){}return n.value=new n,n}(),x=function(){function n(){}return n.value=new n,n}(),F=function(){function n(){}return n.value=new n,n}(),A=function(){function n(){}return n.value=new n,n}(),N=function(){function n(){}return n.value=new n,n}(),_=function(){function n(){}return n.value=new n,n}(),D=function(){function n(){}return n.value=new n,n}(),M=function(){function n(){}return n.value=new n,n}(),L=function(){function n(n){this.value0=n}return n.create=function(e){return new n(e)},n}(),I=function(){function n(){}return n.value=new n,n}(),O=function(){function n(n){this.value0=n}return n.create=function(e){return new n(e)},n}(),R=function(){function n(n){this.value0=n}return n.create=function(e){return new n(e)},n}(),k=function(){function n(){}return n.value=new n,n}(),U=function(){function n(n){this.value0=n}return n.create=function(e){return new n(e)},n}(),G=function(){function n(n){this.value0=n}return n.create=function(e){return new n(e)},n}(),B=function(){function n(n){this.value0=n}return n.create=function(e){return new n(e)},n}(),J=function(){function n(n){this.value0=n}return n.create=function(e){return new n(e)},n}(),$=function(){function n(n){this.value0=n}return n.create=function(e){return new n(e)},n}(),H=function(){function n(n,e,t){this.value0=n,this.value1=e,this.value2=t}return n.create=function(e){return function(t){return function(r){return new n(e,t,r)}}},n}(),z=function(){function n(n,e){this.value0=n,this.value1=e}return n.create=function(e){return function(t){return new n(e,t)}},n}(),W=function(){function n(n){this.value0=n}return n.create=function(e){return new n(e)},n}(),j=function(){function n(n){this.value0=n}return n.create=function(e){return new n(e)},n}(),V=function(){function n(n,e){this.value0=n,this.value1=e}return n.create=function(e){return function(t){return new n(e,t)}},n}(),q=function(){function n(n,e){this.value0=n,this.value1=e}return n.create=function(e){return function(t){return new n(e,t)}},n}(),Z=function(){function n(n,e){this.value0=n,this.value1=e}return n.create=function(e){return function(t){return new n(e,t)}},n}(),K=function(){function n(n){this.value0=n}return n.create=function(e){return new n(e)},n}(),X=function(){function n(n){this.value0=n}return n.create=function(e){return new n(e)},n}(),Y=function(){function n(n){this.value0=n}return n.create=function(e){return new n(e)},n}(),Q=function(){function n(n,e){this.value0=n,this.value1=e}return n.create=function(e){return function(t){return new n(e,t)}},n}(),nn=function(){function n(){}return n.value=new n,n}(),en=function(){function n(n,e){this.value0=n,this.value1=e}return n.create=function(e){return function(t){return new n(e,t)}},n}(),tn=function(){function n(n,e){this.value0=n,this.value1=e}return n.create=function(e){return function(t){return new n(e,t)}},n}(),rn=function(){function n(n,e,t){this.value0=n,this.value1=e,this.value2=t}return n.create=function(e){return function(t){return function(r){return new n(e,t,r)}}},n}(),on=function(){function n(n,e,t){this.value0=n,this.value1=e,this.value2=t}return n.create=function(e){return function(t){return function(r){return new n(e,t,r)}}},n}(),an=function(){function n(n,e){this.value0=n,this.value1=e}return n.create=function(e){return function(t){return new n(e,t)}},n}(),un=function(){function n(n,e,t,r,o,a){this.value0=n,this.value1=e,this.value2=t,this.value3=r,this.value4=o,this.value5=a}return n.create=function(e){return function(t){return function(r){return function(o){return function(a){return function(i){return new n(e,t,r,o,a,i)}}}}}},n}(),cn=function(){function n(n,e){this.value0=n,this.value1=e}return n.create=function(e){return function(t){return new n(e,t)}},n}(),ln=function(){function n(n,e,t){this.value0=n,this.value1=e,this.value2=t}return n.create=function(e){return function(t){return function(r){return new n(e,t,r)}}},n}(),sn=function(){function n(n){this.value0=n}return n.create=function(e){return new n(e)},n}(),fn=function(){function n(){}return n.value=new n,n}(),dn=function(){function n(){}return n.value=new n,n}(),vn=function(){function n(n,e,t){this.value0=n,this.value1=e,this.value2=t}return n.create=function(e){return function(t){return function(r){return new n(e,t,r)}}},n}(),mn=function(){function n(n){this.value0=n}return n.create=function(e){return new n(e)},n}(),hn=function(){function n(n,e){this.value0=n,this.value1=e}return n.create=function(e){return function(t){return new n(e,t)}},n}(),pn=function(){function n(n,e){this.value0=n,this.value1=e}return n.create=function(e){return function(t){return new n(e,t)}},n}(),wn=function(){function n(n){this.value0=n}return n.create=function(e){return new n(e)},n}(),gn=function(){function n(n){this.value0=n}return n.create=function(e){return new n(e)},n}(),Cn=function(n){return function(e){return(n-1)/e-1}},Sn=function(n){return function(n){return function(e){return r.writeSTRef(n.value0)(e)}}},Pn=function(n){return function(e){return(n+1)*e+1}},yn=function(n){return function(n){return r.readSTRef(n.value0)}},Tn=function(n){return function(n){return e["<$>"](t.functorEff)(gn.create)(r.newSTRef(n))}},bn=function(n){return function(n){return function(e){return r.modifySTRef(n.value0)(e)}}},En=function(n){return n.value0},xn=function(){var n=r.newSTRef(!1)();return{selectableHot:u.value,pressed:"",needRepaint:n,angleSelect:{x:0,y:0},zoomControl:-1,zoom:1,currentMaxZoom:7,showControl:!0,showIndex:!1,editMode:!1}},Fn=function(n){return function(n){return function(u){return function(c){return function(c){return function(l){return function(s){return function(f){return function(){var d=xn(),v=r.newSTRef(o.Nothing.value)();return{selectionModel:n,guiStyle:u,animateStartTime:0,animatePaintRef:v,canvas:o.Nothing.value,hasFocus:!1,iconNames:c,stlNames:l,labelSelection:[],state:dn.value,commandQueue:[],counter:0,prefs:i.standardPrefs,callback:e["return"](t.applicativeEff)(e.unit),keyCallback:function(n){return function(n){return function(n){return function(n){return function(n){return e["return"](t.applicativeEff)(!0)}}}}},cycleCallback:e["return"](t.applicativeEff)(e.unit),modelChangedCallback:o.Nothing.value,selectedChangedCallback:o.Nothing.value,loadIconCallback:function(n){return function(n){return e["return"](t.applicativeEff)(e.unit)}},loadSTLCallback:function(n){return function(n){return e["return"](t.applicativeEff)(e.unit)}},alertCallback:function(n){return a.trace("Alert: "+n)(function(n){return e["return"](t.applicativeEff)(e.unit)})},copySelection:I.value,controlState:d,isPainting:!1,windowSize:{x:0,y:0},bindings:s,frontend:f,benchmark:o.Nothing.value,demoMode:!1}}}}}}}}}};n.KLeft=c,n.KRight=l,n.KUp=s,n.KDown=f,n.KMoveLeft=d,n.KMoveRight=v,n.KMoveUp=m,n.KMoveDown=h,n.KFirst=p,n.KSetFirst=w,n.KCut=g,n.KCopy=C,n.KPaste=S,n.KLink=P,n.KClockwork=y,n.KGlobal=T,n.KUnglobal=b,n.KZoomNormal=E,n.KZoomOut=x,n.KBench=F,n.KToggleDemo=A,n.KToggleControl=N,n.KToggleIndex=_,n.KEditModeOn=D,n.KEditModeOff=M,n.CommandingTurn=Z,n.CommandingUpDown=K,n.CommandingTrans=X,n.CommandingClockwork=Y,n.CommandingGlobal=Q,n.CommandingNothing=nn,n.CILabel=O,n.CISuperLabel=R,n.CIMainLabel=k,n.CICard=U,n.CIAngel=G,n.CIZoom=B,n.CITurn=J,n.OSNormal=dn,n.OSTurnMouse=vn,n.OSAnimate=mn,n.OSAngle=hn,n.OSZoom=pn,n.SHNavigate=u,n.SingleSelection=L,n.NoSelection=I,n.TOFade=$,n.TOTurn=H,n.TOSizeChange=z,n.TPAim=W,n.TPIntro=j,n.TPLift=V,n.TPTransOp=q,n.AniMoveLeft=en,n.AniMoveRight=tn,n.AniMoveUp=rn,n.AniMoveDown=on,n.AniTransform=an,n.AniClockwork=un,n.AniGlobalView=cn,n.AniZoom=ln,n.AniPause=sn,n.AniNull=fn,n.ConeFront=wn,n.PaintRef=gn,n.emptyControlState=xn,n.zoomControl=Cn,n.realZoom=Pn,n.emptyPaintState=Fn,n.getConeFront=En,n.newPaintRef=Tn,n.writePaintRef=Sn,n.modifyPaintRef=bn,n.readPaintRef=yn}(PS["ConeCanvas.ConeControlTypes"]=PS["ConeCanvas.ConeControlTypes"]||{}),function(n){"use strict";var e=PS.Prelude,t=PS["Data.Array"],r=PS["Data.Maybe"],o=PS["Data.Either"],a=PS["Data.List"],i=PS["Data.Int"],u=PS["Data.Ord"],c=PS["Debug.Trace"],l=PS.Math,s=PS["ConeCanvas.ConeModel"],f=PS["ConeCanvas.ConeZipper"],d=PS["ConeCanvas.ConeControlTypes"],v=(PS["ConeCanvas.GeometryTypes"],PS.Extensions),m=PS["Control.Monad.Eff"],h=function(n){return function(n){return function(r){return function(o){return function(i){return function(u){return function(c){return function(l){return function(s){return function(m){var h=function(t){var r=f.normalizePos(t)(u),o=f.normalizePos(r+l|0)(c);return new d.TPTransOp(new d.TOTurn(s,{index:o,ngon:c},m),new d.TPAim(e["++"](a.semigroupList)(n)(new a.Cons(r,a.Nil.value))))},p=e["<$>"](e.functorArray)(h)(v.hRange(r+o|0)(((r+o|0)+i|0)-1)),w=u!==c;if(w)return t[":"](new d.TPTransOp(new d.TOSizeChange(c,s),new d.TPAim(n)))(p);if(!w)return p;throw new Error("Failed pattern match at ConeCanvas.ConeTransforms line 648, column 5 - line 653, column 3: "+[w.constructor.name])}}}}}}}}}},p=function(n){return function(i){return function(u){var c=function(u){return function(c){var l=f.coneGetPosition(i),v=f.coneNumLevel(i),m=f.coneNumLevel(u),p=m-1,w=v-1,g=f.zipGetNode(i),C=h(n)(a.Nil.value)(c)(0)(p-c)(p)(m)(1)(!0)(s.TDClockwise.value),S=h(n)(a.Nil.value)(c)(-c)(c)(p)(m)(0)(!0)(s.TDClockwise.value),P=s.makeHiddenNode(n)(f.nodeGetEntry(g)),y=s.makeHiddenLeaf(n)(f.nodeGetEntry(g)),T=new s.ConeNode({entry:y,nodeId:0,firstInd:0,children:new o.Right(a.Nil.value)}),b=new s.ConeNode({entry:P,nodeId:0,firstInd:0,children:new o.Right(a[":"](g)(a.replicate(v-1)(T)))}),E=new d.TPLift(!0,{path:a.Nil.value,pos:{index:0,ngon:v},model:b,transforms:[new d.TPTransOp(new d.TOSizeChange(m,!0),new d.TPAim(a.Nil.value))]}),x=new d.TPTransOp(new d.TOFade(r.Nothing.value),new d.TPAim(a[":"](c)(a[":"](l)(a.Nil.value)))),F=h(n)(a[":"](c)(a.Nil.value))(l)(1)(v-(l+1|0))(v)(w)(0)(!0)(s.TDClockwise.value),A=h(n)(a[":"](c)(a.Nil.value))(l)(-l)(l)(v)(w)(1)(!0)(s.TDClockwise.value),N=e["++"](e.semigroupArray)(t[":"](E)(t[":"](x)(A)))(e["++"](e.semigroupArray)(F)(e["++"](e.semigroupArray)(S)(C)));return N}},l=f.coneUp(i);if(l instanceof r.Nothing)return r.Nothing.value;if(l instanceof r.Just){var v=c(u)(f.coneGetPosition(l.value0));return new r.Just({transPrims:v,transAim:new s.OSCurrent(u)})}throw new Error("Failed pattern match at ConeCanvas.ConeTransforms line 584, column 5 - line 589, column 3: "+[l.constructor.name])}}},w=function(n){return function(t){if(t instanceof s.OSParent)return e["return"](m.applicativeEff)(r.Nothing.value);if(t instanceof s.OSCurrent)return c.trace("transformUp!")(function(o){return function(){var o=f.coneDown(n)(t.value0)();if(o instanceof r.Nothing)return c.trace("transformUp: target not found")(function(n){return e["return"](m.applicativeEff)(r.Nothing.value)})();if(o instanceof r.Just){var a=f.coneMoveUp(o.value0);if(a instanceof r.Just){var i=p(n)(o.value0)(a.value0);return c.traceAny(i)(function(n){return e["return"](m.applicativeEff)(i)})()}if(a instanceof r.Nothing)return c.trace("transformUp: aim not found")(function(n){return e["return"](m.applicativeEff)(r.Nothing.value)})();throw new Error("Failed pattern match at ConeCanvas.ConeTransforms line 576, column 13 - line 582, column 1: "+[a.constructor.name])}throw new Error("Failed pattern match at ConeCanvas.ConeTransforms line 573, column 5 - line 582, column 1: "+[o.constructor.name])}});throw new Error("Failed pattern match at ConeCanvas.ConeTransforms line 570, column 1 - line 571, column 1: "+[t.constructor.name])}},g=function(n){return function(i){return function(u){var c=function(u){var c=f.coneGetPosition(i),l=f.coneNumLevel(i),v=f.coneNumLevel(u),m=v-1,p=f.normalizePos(f.coneGetPosition(u)-1)(v),w=l-1,g=f.zipGetNode(i),C=f.normalizePos(c+1|0)(l),S=h(n)(a[":"](C)(a.Nil.value))(p)(-p)(p+1|0)(m)(v)(-1)(!0)(s.TDAntiClockwise.value),P=h(n)(a[":"](C)(a.Nil.value))(p)(1)(m-(p+1|0))(m)(v)(0)(!0)(s.TDAntiClockwise.value),y=s.makeHiddenNode(n)(f.nodeGetEntry(g)),T=s.makeHiddenLeaf(n)(f.nodeGetEntry(g)),b=new s.ConeNode({entry:T,nodeId:0,firstInd:0,children:new o.Right(a.Nil.value)}),E=new s.ConeNode({entry:y,nodeId:0,firstInd:0,children:new o.Right(a[":"](g)(a.replicate(l-1)(b)))}),x=new d.TPLift(!1,{path:a.Nil.value,pos:{index:0,ngon:l},model:E,transforms:[new d.TPTransOp(new d.TOSizeChange(v,!0),new d.TPAim(a.Nil.value))]}),F=new d.TPTransOp(new d.TOFade(r.Nothing.value),new d.TPAim(a[":"](c)(a.Nil.value))),A=h(n)(a.Nil.value)(c)(1)(l-(c+1|0))(l)(w)(-1)(!0)(s.TDAntiClockwise.value),N=h(n)(a.Nil.value)(c)(-c)(c)(l)(w)(0)(!0)(s.TDAntiClockwise.value);return e["++"](e.semigroupArray)(t[":"](x)(t[":"](F)(N)))(e["++"](e.semigroupArray)(A)(e["++"](e.semigroupArray)(S)(P)))},l=f.coneUp(u);if(l instanceof r.Just){var v=c(u);return new r.Just({transPrims:v,transAim:new s.OSCurrent(l.value0)})}if(l instanceof r.Nothing)return r.Nothing.value;throw new Error("Failed pattern match at ConeCanvas.ConeTransforms line 521, column 5 - line 527, column 3: "+[l.constructor.name])}}},C=function(n){return function(t){if(t instanceof s.OSParent)return e["return"](m.applicativeEff)(r.Nothing.value);if(t instanceof s.OSCurrent)return function(){var e=f.coneMoveDown(n)(t.value0)();if(e instanceof r.Nothing)return r.Nothing.value;if(e instanceof r.Just)return g(n)(t.value0)(e.value0);throw new Error("Failed pattern match at ConeCanvas.ConeTransforms line 515, column 5 - line 519, column 1: "+[e.constructor.name])};throw new Error("Failed pattern match at ConeCanvas.ConeTransforms line 512, column 1 - line 513, column 1: "+[t.constructor.name])}},S=function(n){return e["return"](m.applicativeEff)({condNewSelection:r.Nothing.value,newAnim:d.AniNull.value})},P=function(n){return function(t){for(var r=n,o=t;;){if(o instanceof d.TPAim&&o.value0 instanceof a.Cons&&o.value0.value1 instanceof a.Nil){if(o.value0.value0===r)return!0;if(e.otherwise)return!1}if(o instanceof d.TPAim)return!1;if(o instanceof d.TPIntro)return!1;if(o instanceof d.TPLift)return!1;{if(!(o instanceof d.TPTransOp))throw new Error("Failed pattern match at ConeCanvas.ConeTransforms line 788, column 1 - line 790, column 1: "+[r.constructor.name,o.constructor.name]);var i=r,u=o.value1;r=i,o=u}}}},y=function(n){for(var t=n;;){if(t instanceof d.TPAim){if(a["null"](t.value0))return!0;if(e.otherwise)return!1}if(t instanceof d.TPIntro)return!1;if(t instanceof d.TPLift)return!1;{if(!(t instanceof d.TPTransOp))throw new Error("Failed pattern match at ConeCanvas.ConeTransforms line 797, column 1 - line 799, column 1: "+[t.constructor.name]);var r=t.value1;t=r}}},T=function(n){return function(e){for(var t=n,o=e;;){if(o instanceof d.TPTransOp&&o.value0 instanceof d.TOTurn){var a=P(t)(o.value1);if(a)return new r.Just(new d.TOTurn(o.value0.value0,o.value0.value1,o.value0.value2));if(!a)return r.Nothing.value;throw new Error("Failed pattern match at ConeCanvas.ConeTransforms line 747, column 51 - line 750, column 1: "+[a.constructor.name])}{if(!(o instanceof d.TPTransOp))return r.Nothing.value;var i=t,u=o.value1;t=i,o=u}}}},b=function(n){for(var e=n;;){if(e instanceof d.TPTransOp&&e.value0 instanceof d.TOSizeChange){var t=y(e.value1);if(t)return new r.Just({l:e.value0.value0,r:e.value0.value1});if(!t)return r.Nothing.value;throw new Error("Failed pattern match at ConeCanvas.ConeTransforms line 779, column 51 - line 782, column 1: "+[t.constructor.name])}{if(!(e instanceof d.TPTransOp))return r.Nothing.value;var o=e.value1;e=o}}},E=function(n){return function(e){var t=f.coneGetPath(n),o=function(){var n=a.last(t);if(n instanceof r.Nothing)return[];if(n instanceof r.Just)return[new d.TPTransOp(new d.TOFade(new r.Just(!0)),new d.TPAim(a.singleton(n.value0)))];throw new Error("Failed pattern match at ConeCanvas.ConeTransforms line 475, column 23 - line 478, column 5: "+[n.constructor.name])}();return{transPrims:o,transAim:new s.OSParent(e)}}},x=function(n){for(var e=n;;){if(!(e instanceof d.TPTransOp)){if(e instanceof d.TPAim)return r.Nothing.value;if(e instanceof d.TPIntro)return r.Nothing.value;if(e instanceof d.TPLift)return new r.Just(e);throw new Error("Failed pattern match at ConeCanvas.ConeTransforms line 833, column 1 - line 834, column 1: "+[e.constructor.name])}var t=e.value1;e=t}},F=function(n){if(n instanceof d.TPTransOp){var t=F(n.value1);if(t instanceof r.Nothing)return r.Nothing.value;if(t instanceof r.Just)return new r.Just(new d.TPTransOp(n.value0,t.value0));throw new Error("Failed pattern match at ConeCanvas.ConeTransforms line 823, column 38 - line 826, column 1: "+[t.constructor.name])}if(n instanceof d.TPAim)return r.Nothing.value;if(n instanceof d.TPIntro)return r.Nothing.value;if(n instanceof d.TPLift){if(a["null"](n.value1.path))return new r.Just(n);if(e.otherwise)return r.Nothing.value}throw new Error("Failed pattern match at ConeCanvas.ConeTransforms line 823, column 1 - line 826, column 1: "+[n.constructor.name])},A=function(n){return{level:f.coneNumLevel(n),pos:f.coneGetPosition(n),path:f.coneGetPath(n)}},N=function(n){return function(e){return function(o){var i=A(e),u=function(){var n=a.last(f.coneGetPath(e));return n instanceof r.Just&&n.value0-1<0?i.level-1:n instanceof r.Just?n.value0-1:i.level-1}(),c=t[":"](new d.TPTransOp(new d.TOTurn(!0,{index:f.normalizePos(u+2|0)(i.level),ngon:i.level},s.TDClockwise.value),new d.TPAim(a.singleton(u))))(h(n)(a.Nil.value)(i.pos)(1)(i.level-1)(i.level)(i.level)(1)(!0)(s.TDClockwise.value));return{transPrims:c,transAim:new s.OSCurrent(o)}}}},_=function(n){return function(e){if(e instanceof s.OSParent)return r.Nothing.value;if(e instanceof s.OSCurrent){var t=f.coneMoveLeft(e.value0);if(t instanceof r.Nothing)return r.Nothing.value;if(t instanceof r.Just)return r.Just.create(N(n)(e.value0)(t.value0));throw new Error("Failed pattern match at ConeCanvas.ConeTransforms line 299, column 5 - line 303, column 1: "+[t.constructor.name])}throw new Error("Failed pattern match at ConeCanvas.ConeTransforms line 297, column 1 - line 298, column 1: "+[e.constructor.name])}},D=function(n){return function(e){return function(o){var i=A(e),u=function(){var n=a.last(f.coneGetPath(e));return n instanceof r.Just&&(n.value0+1|0)<i.level?n.value0+1|0:0}(),c=t[":"](new d.TPTransOp(new d.TOTurn(!0,{index:f.normalizePos(u-2)(i.level),ngon:i.level},s.TDAntiClockwise.value),new d.TPAim(a.singleton(u))))(h(n)(a.Nil.value)(i.pos)(1)(i.level-1)(i.level)(i.level)(-1)(!0)(s.TDAntiClockwise.value));return{transPrims:c,transAim:new s.OSCurrent(o)}}}},M=function(n){return function(e){if(e instanceof s.OSParent)return r.Nothing.value;if(e instanceof s.OSCurrent){var t=f.coneMoveRight(e.value0);if(t instanceof r.Nothing)return r.Nothing.value;if(t instanceof r.Just)return r.Just.create(D(n)(e.value0)(t.value0));throw new Error("Failed pattern match at ConeCanvas.ConeTransforms line 330, column 5 - line 334, column 1: "+[t.constructor.name])}throw new Error("Failed pattern match at ConeCanvas.ConeTransforms line 328, column 1 - line 329, column 1: "+[e.constructor.name])}},L=function(n){for(var e=n;;){if(!(e instanceof d.TPTransOp)){if(e instanceof d.TPAim)return r.Nothing.value;if(e instanceof d.TPLift)return r.Nothing.value;if(e instanceof d.TPIntro)return new r.Just(e);throw new Error("Failed pattern match at ConeCanvas.ConeTransforms line 816, column 1 - line 817, column 1: "+[e.constructor.name])}var t=e.value1;e=t}},I=function(n){if(n instanceof d.TPTransOp){var t=I(n.value1);if(t instanceof r.Nothing)return r.Nothing.value;if(t instanceof r.Just)return new r.Just(new d.TPTransOp(n.value0,t.value0));throw new Error("Failed pattern match at ConeCanvas.ConeTransforms line 805, column 34 - line 808, column 1: "+[t.constructor.name])}if(n instanceof d.TPAim)return r.Nothing.value;if(n instanceof d.TPLift)return r.Nothing.value;if(n instanceof d.TPIntro){if(a["null"](n.value0.path))return new r.Just(n);if(e.otherwise)return r.Nothing.value}throw new Error("Failed pattern match at ConeCanvas.ConeTransforms line 805, column 1 - line 808, column 1: "+[n.constructor.name])},O=function(n){return function(e){var t=f.coneNumLevel(n),o=new d.TPTransOp(new d.TOFade(new r.Just(!1)),new d.TPIntro({path:a.Nil.value,pos:{index:0,ngon:t+1|0},model:e,transforms:[]}));return{oldSize:t,newSize:t+1|0,position:f.coneGetPosition(n),trans:o}}},R=function(n){return function(o){return function(i){return function(u){if(o instanceof s.OSCurrent){var c=O(o.value0)(i),l=h(n)(a.Nil.value)(c.position)(-c.position)(c.position)(c.oldSize)(c.newSize)(0)(!0)(s.TDClockwise.value),f=h(n)(a.Nil.value)(c.position)(0)(c.oldSize-c.position)(c.oldSize)(c.newSize)(1)(!0)(s.TDClockwise.value);t[":"](c.trans)(e["++"](e.semigroupArray)(l)(f));return{transPrims:[c.trans],transAim:new s.OSCurrent(u)}}if(o instanceof s.OSParent){var v=new d.TPTransOp(new d.TOFade(new r.Just(!1)),new d.TPIntro({path:a.Nil.value,pos:{index:0,ngon:1},model:i,transforms:[]}));return{transPrims:[v],transAim:new s.OSCurrent(u)}}throw new Error("Failed pattern match at ConeCanvas.ConeTransforms line 411, column 1 - line 423, column 1: "+[o.constructor.name,i.constructor.name,u.constructor.name])}}}},k=function(n){return function(e){return function(t){if(e instanceof s.OSCurrent){var o=f.coneInsertBefore(t)(e.value0);if(o instanceof r.Nothing)return r.Nothing.value;if(o instanceof r.Just)return r.Just.create(R(n)(new s.OSCurrent(e.value0))(t)(o.value0));throw new Error("Failed pattern match at ConeCanvas.ConeTransforms line 402, column 5 - line 405, column 1: "+[o.constructor.name])}if(e instanceof s.OSParent){var a=f.coneInsertBelow(n)(t)(e.value0);if(a instanceof r.Nothing)return r.Nothing.value;if(a instanceof r.Just)return r.Just.create(R(n)(new s.OSParent(e.value0))(t)(a.value0));throw new Error("Failed pattern match at ConeCanvas.ConeTransforms line 406, column 5 - line 410, column 1: "+[a.constructor.name])}throw new Error("Failed pattern match at ConeCanvas.ConeTransforms line 401, column 1 - line 405, column 1: "+[e.constructor.name,t.constructor.name])}}},U=function(n){return function(o){return function(i){return function(u){if(o instanceof s.OSCurrent){var c=O(o.value0)(i),l=h(n)(a.Nil.value)(c.position)(-c.position)(c.position+1|0)(c.oldSize)(c.newSize)(-1)(!0)(s.TDAntiClockwise.value),f=h(n)(a.Nil.value)(c.position)(1)(c.oldSize-(c.position+1|0))(c.oldSize)(c.newSize)(0)(!0)(s.TDAntiClockwise.value),v=t[":"](c.trans)(e["++"](e.semigroupArray)(l)(f));return{transPrims:v,transAim:new s.OSCurrent(u)}}if(o instanceof s.OSParent){var m=new d.TPTransOp(new d.TOFade(new r.Just(!1)),new d.TPIntro({path:a.Nil.value,pos:{index:0,ngon:1},model:i,transforms:[]}));return{transPrims:[m],transAim:new s.OSCurrent(u)}}throw new Error("Failed pattern match at ConeCanvas.ConeTransforms line 363, column 1 - line 373, column 1: "+[o.constructor.name,i.constructor.name,u.constructor.name])}}}},G=function(n){return function(e){return function(t){if(e instanceof s.OSCurrent){var o=f.coneInsertAfter(t)(e.value0);if(o instanceof r.Nothing)return r.Nothing.value;if(o instanceof r.Just)return r.Just.create(U(n)(new s.OSCurrent(e.value0))(t)(o.value0));throw new Error("Failed pattern match at ConeCanvas.ConeTransforms line 354, column 5 - line 357, column 1: "+[o.constructor.name])}if(e instanceof s.OSParent){var a=f.coneInsertBelow(n)(t)(e.value0);if(a instanceof r.Nothing)return r.Nothing.value;if(a instanceof r.Just)return r.Just.create(U(n)(new s.OSParent(e.value0))(t)(a.value0));throw new Error("Failed pattern match at ConeCanvas.ConeTransforms line 358, column 5 - line 362, column 1: "+[a.constructor.name])}throw new Error("Failed pattern match at ConeCanvas.ConeTransforms line 353, column 1 - line 357, column 1: "+[e.constructor.name,t.constructor.name])}}},B=function(n){for(var e=n;;){if(e instanceof d.TPTransOp&&e.value0 instanceof d.TOFade)return new r.Just(new d.TOFade(e.value0.value0));{if(!(e instanceof d.TPTransOp))return r.Nothing.value;var t=e.value1;e=t}}},J=function(n){return function(e){for(var t=n,o=e;;){if(o instanceof d.TPTransOp&&o.value0 instanceof d.TOFade){var a=P(t)(o.value1);if(a)return new r.Just(new d.TOFade(o.value0.value0));if(!a)return r.Nothing.value;throw new Error("Failed pattern match at ConeCanvas.ConeTransforms line 755, column 53 - line 758, column 1: "+[a.constructor.name])}{if(!(o instanceof d.TPTransOp))return r.Nothing.value;var i=t,u=o.value1;t=i,o=u}}}},$=function(n){var e=f.coneGetPath(n),t=f.coneNumLevel(n),o=a.last(e);if(o instanceof r.Just)return{path:e,selected:f.coneGetPosition(n),oldSize:t,newSize:t-1,trans:new d.TPTransOp(new d.TOFade(new r.Just(!0)),new d.TPAim(a.singleton(o.value0)))};if(o instanceof r.Nothing)return v.fail("ConeTransforms>>getExtroParas: Empty path");throw new Error("Failed pattern match at ConeCanvas.ConeTransforms line 462, column 8 - line 472, column 1: "+[o.constructor.name])},H=function(n){return function(r){return function(o){if(o instanceof s.OSCurrent){var i=$(r),u=h(n)(a.Nil.value)(i.selected)(-i.selected)(i.selected)(i.oldSize)(i.newSize)(1)(!0)(s.TDClockwise.value),c=h(n)(a.Nil.value)(i.selected)(1)(i.oldSize-(i.selected+1|0))(i.oldSize)(i.newSize)(0)(!0)(s.TDClockwise.value),l=t[":"](i.trans)(e["++"](e.semigroupArray)(u)(c));return{transPrims:l,transAim:new s.OSCurrent(o.value0)}}if(o instanceof s.OSParent)return E(r)(o.value0);throw new Error("Failed pattern match at ConeCanvas.ConeTransforms line 444, column 1 - line 454, column 1: "+[r.constructor.name,o.constructor.name])}}},z=function(n){return function(e){if(e instanceof s.OSCurrent){var t=f.selDeleteFillFromLeft(e);if(t instanceof r.Nothing)return r.Nothing.value;if(t instanceof r.Just)return new r.Just(H(n)(e.value0)(t.value0));throw new Error("Failed pattern match at ConeCanvas.ConeTransforms line 438, column 5 - line 441, column 1: "+[t.constructor.name])}if(e instanceof s.OSParent)return r.Nothing.value;throw new Error("Failed pattern match at ConeCanvas.ConeTransforms line 437, column 1 - line 441, column 1: "+[e.constructor.name])}},W=function(n){return function(r){return function(o){if(o instanceof s.OSCurrent){var i=$(r),u=h(n)(a.Nil.value)(i.selected)(-i.selected)(i.selected)(i.oldSize)(i.newSize)(0)(!0)(s.TDAntiClockwise.value),c=h(n)(a.Nil.value)(i.selected)(1)(i.oldSize-(i.selected+1|0))(i.oldSize)(i.newSize)(-1)(!0)(s.TDAntiClockwise.value),l=t[":"](i.trans)(e["++"](e.semigroupArray)(u)(c));return{transPrims:l,transAim:new s.OSCurrent(o.value0)}}if(o instanceof s.OSParent)return E(r)(o.value0);throw new Error("Failed pattern match at ConeCanvas.ConeTransforms line 494, column 1 - line 504, column 1: "+[r.constructor.name,o.constructor.name])}}},j=function(n){return function(e){if(e instanceof s.OSCurrent){var t=f.selDeleteFillFromRight(e);if(t instanceof r.Nothing)return r.Nothing.value;if(t instanceof r.Just)return new r.Just(W(n)(e.value0)(t.value0));throw new Error("Failed pattern match at ConeCanvas.ConeTransforms line 488, column 5 - line 491, column 1: "+[t.constructor.name])}if(e instanceof s.OSParent)return r.Nothing.value;throw new Error("Failed pattern match at ConeCanvas.ConeTransforms line 487, column 1 - line 491, column 1: "+[e.constructor.name])}},V=function(n){return function(e){if(e instanceof d.TPAim){var t=a.uncons(e.value0);if(t instanceof r.Just){var o=t.value0.head===n;if(o)return new r.Just(new d.TPAim(t.value0.tail));if(!o)return r.Nothing.value;throw new Error("Failed pattern match at ConeCanvas.ConeTransforms line 729, column 74 - line 732, column 45: "+[o.constructor.name])}return r.Nothing.value}if(e instanceof d.TPIntro){var i=a.uncons(e.value0.path);if(i instanceof r.Just){var u=i.value0.head===n;if(u)return new r.Just(new d.TPIntro(function(){var n={};for(var t in e.value0)e.value0.hasOwnProperty(t)&&(n[t]=e.value0[t]);return n.path=i.value0.tail,n}()));if(!u)return r.Nothing.value;throw new Error("Failed pattern match at ConeCanvas.ConeTransforms line 734, column 82 - line 737, column 53: "+[u.constructor.name])}return r.Nothing.value}if(e instanceof d.TPTransOp){var c=V(n)(e.value1);if(c instanceof r.Nothing)return r.Nothing.value;if(c instanceof r.Just)return new r.Just(new d.TPTransOp(e.value0,c.value0));throw new Error("Failed pattern match at ConeCanvas.ConeTransforms line 738, column 44 - line 741, column 1: "+[c.constructor.name])}if(e instanceof d.TPLift){var l=a.uncons(e.value1.path);return l instanceof r.Just?new r.Just(new d.TPLift(e.value0,function(){var n={};for(var t in e.value1)e.value1.hasOwnProperty(t)&&(n[t]=e.value1[t]);return n.path=l.value0.tail,n}())):r.Nothing.value}throw new Error("Failed pattern match at ConeCanvas.ConeTransforms line 728, column 1 - line 733, column 1: "+[n.constructor.name,e.constructor.name])}},q=function(n){return function(e){return{progress:e.progress,transforms:t.mapMaybe(V(n))(e.transforms)}}},Z=function(n){return{progress:n,transforms:[]}},K=function(n){return function(t){return function(o){var i={l:a.uncons(t),r:a.uncons(o)};return i.l instanceof r.Just&&i.r instanceof r.Just&&e["=="](n)(i.l.value0.head)(i.r.value0.head)?a[":"](i.l.value0.head)(K(n)(i.l.value0.tail)(i.r.value0.tail)):a.Nil.value}}},X=function(n){return function(t){var o=e["=="](a.eqList(e.eqInt))(n)(t);if(o)return r.Nothing.value;if(!o){var i=K(e.eqInt)(n)(t);return r.Just.create(a.take(u.min(e.ordInt)(a.length(t))(a.length(i)+2|0))(n))}throw new Error("Failed pattern match at ConeCanvas.ConeTransforms line 281, column 5 - line 287, column 1: "+[o.constructor.name])}},Y=function(n){return function(t){var r=f.selNumLevel(n),o=l.max(1)(i.toNumber(r)/(2*t.prefs.desiredZoomHint)),a=u.min(e.ordNumber)(o)(t.controlState.currentMaxZoom);return{x:t.controlState.zoom,y:a}}},Q=function(n){return function(t){return function(o){if(o instanceof s.AnimMoveLeft){var i=f.selGetPosition(t.selectionModel),u=i-o.value0,v=f.selNumLevel(t.selectionModel),h=function(){if(0>u)return v+u|0;if(u>v-1)return u-v;if(e.otherwise)return u;throw new Error("Failed pattern match at ConeCanvas.ConeTransforms line 89, column 5 - line 96, column 1: "+[])}();return e["return"](m.applicativeEff)({condNewSelection:f.selSetSel(t.selectionModel)(h),newAnim:new d.AniMoveLeft(100,o.value0)})}if(o instanceof s.AnimMoveRight){var i=f.selGetPosition(t.selectionModel),u=i+o.value0|0,v=f.selNumLevel(t.selectionModel),h=function(){if(0>u)return v+u|0;if(u>v-1)return u-v;if(e.otherwise)return u;
throw new Error("Failed pattern match at ConeCanvas.ConeTransforms line 97, column 5 - line 104, column 1: "+[])}();return e["return"](m.applicativeEff)({condNewSelection:f.selSetSel(t.selectionModel)(h),newAnim:new d.AniMoveRight(100,o.value0)})}if(o instanceof s.AnimTurnToFirst){var P=f.selGetPosition(t.selectionModel),y=0===P;if(y)return S(n);if(!y){var v=f.selNumLevel(t.selectionModel),T=(v/2|0)>=P;if(T)return e["return"](m.applicativeEff)({condNewSelection:f.selSetSel(t.selectionModel)(0),newAnim:new d.AniMoveLeft(100,P)});if(!T)return e["return"](m.applicativeEff)({condNewSelection:f.selSetSel(t.selectionModel)(0),newAnim:new d.AniMoveRight(100,v-P)});throw new Error("Failed pattern match at ConeCanvas.ConeTransforms line 109, column 21 - line 112, column 1: "+[T.constructor.name])}throw new Error("Failed pattern match at ConeCanvas.ConeTransforms line 106, column 8 - line 112, column 1: "+[y.constructor.name])}if(o instanceof s.AnimMoveUp){var b=f.selUp(t.selectionModel);if(b instanceof r.Just){var E=Y(b.value0)(t);return e["return"](m.applicativeEff)({condNewSelection:new r.Just(b.value0),newAnim:new d.AniMoveUp(100,E.x,E.y)})}if(b instanceof r.Nothing)return S(n);throw new Error("Failed pattern match at ConeCanvas.ConeTransforms line 113, column 5 - line 119, column 1: "+[b.constructor.name])}if(o instanceof s.AnimMoveDown)return function(){var e=f.selDown(n)(t.selectionModel)();if(e instanceof r.Just){var o=Y(e.value0)(t);return{condNewSelection:new r.Just(e.value0),newAnim:new d.AniMoveDown(100,o.x,o.y)}}if(e instanceof r.Nothing)return S(n)();throw new Error("Failed pattern match at ConeCanvas.ConeTransforms line 121, column 5 - line 128, column 1: "+[e.constructor.name])};if(o instanceof s.AnimClockwork){var x=f.selGetPos(n)(t.selectionModel),F=f.coneGetPath(x);return function(){var e=f.coneSetPath(n)(x)(o.value0)();if(e instanceof r.Nothing)return S(n)();if(e instanceof r.Just){var a=f.selFromPos(e.value0),i=Y(a)(t),u=X(F)(o.value0);if(u instanceof r.Nothing)return S(n)();if(u instanceof r.Just)return{condNewSelection:new r.Just(t.selectionModel),newAnim:new d.AniClockwork(100,F,o.value0,u.value0,i.x,i.y)};throw new Error("Failed pattern match at ConeCanvas.ConeTransforms line 139, column 45 - line 143, column 1: "+[u.constructor.name])}throw new Error("Failed pattern match at ConeCanvas.ConeTransforms line 132, column 5 - line 143, column 1: "+[e.constructor.name])}}if(o instanceof s.AnimTransformLeft&&o.value0 instanceof r.Nothing){var A=_(n)(t.selectionModel);if(A instanceof r.Nothing)return S(n);if(A instanceof r.Just)return e["return"](m.applicativeEff)({condNewSelection:r.Nothing.value,newAnim:new d.AniTransform(100,A.value0)});throw new Error("Failed pattern match at ConeCanvas.ConeTransforms line 144, column 5 - line 147, column 1: "+[A.constructor.name])}if(o instanceof s.AnimTransformLeft&&o.value0 instanceof r.Just){if(t.selectionModel instanceof s.OSParent)return S(n);if(t.selectionModel instanceof s.OSCurrent)return e["return"](m.applicativeEff)({condNewSelection:r.Nothing.value,newAnim:new d.AniTransform(100,N(n)(t.selectionModel.value0)(o.value0.value0))});throw new Error("Failed pattern match at ConeCanvas.ConeTransforms line 148, column 5 - line 152, column 1: "+[t.selectionModel.constructor.name])}if(o instanceof s.AnimTransformRight&&o.value0 instanceof r.Nothing){var L=M(n)(t.selectionModel);if(L instanceof r.Nothing)return S(n);if(L instanceof r.Just)return e["return"](m.applicativeEff)({condNewSelection:r.Nothing.value,newAnim:new d.AniTransform(100,L.value0)});throw new Error("Failed pattern match at ConeCanvas.ConeTransforms line 153, column 5 - line 156, column 1: "+[L.constructor.name])}if(o instanceof s.AnimTransformRight&&o.value0 instanceof r.Just){if(t.selectionModel instanceof s.OSParent)return S(n);if(t.selectionModel instanceof s.OSCurrent)return e["return"](m.applicativeEff)({condNewSelection:r.Nothing.value,newAnim:new d.AniTransform(100,D(n)(t.selectionModel.value0)(o.value0.value0))});throw new Error("Failed pattern match at ConeCanvas.ConeTransforms line 157, column 5 - line 162, column 1: "+[t.selectionModel.constructor.name])}if(o instanceof s.AnimTransformIntro&&o.value2 instanceof r.Nothing){var I=f.zipGetNode(o.value1),O=function(){if(o.value0)return G(n)(t.selectionModel)(I);if(!o.value0)return k(n)(t.selectionModel)(I);throw new Error("Failed pattern match at ConeCanvas.ConeTransforms line 164, column 21 - line 167, column 5: "+[o.value0.constructor.name])}();if(O instanceof r.Nothing)return S(n);if(O instanceof r.Just)return e["return"](m.applicativeEff)({condNewSelection:r.Nothing.value,newAnim:new d.AniTransform(100,O.value0)});throw new Error("Failed pattern match at ConeCanvas.ConeTransforms line 167, column 8 - line 170, column 1: "+[O.constructor.name])}if(o instanceof s.AnimTransformIntro&&o.value2 instanceof r.Just){var I=f.zipGetNode(o.value1),B=function(){if(o.value0)return U(n)(t.selectionModel)(I)(o.value2.value0);if(!o.value0)return R(n)(t.selectionModel)(I)(o.value2.value0);throw new Error("Failed pattern match at ConeCanvas.ConeTransforms line 172, column 17 - line 175, column 5: "+[o.value0.constructor.name])}();return e["return"](m.applicativeEff)({condNewSelection:r.Nothing.value,newAnim:new d.AniTransform(100,B)})}if(o instanceof s.AnimTransformExtro&&o.value1 instanceof r.Nothing){var O=function(){if(o.value0)return z(n)(t.selectionModel);if(!o.value0)return j(n)(t.selectionModel);throw new Error("Failed pattern match at ConeCanvas.ConeTransforms line 178, column 21 - line 181, column 5: "+[o.value0.constructor.name])}();if(O instanceof r.Nothing)return S(n);if(O instanceof r.Just)return e["return"](m.applicativeEff)({condNewSelection:r.Nothing.value,newAnim:new d.AniTransform(100,O.value0)});throw new Error("Failed pattern match at ConeCanvas.ConeTransforms line 181, column 8 - line 184, column 1: "+[O.constructor.name])}if(o instanceof s.AnimTransformExtro&&o.value1 instanceof r.Just){if(t.selectionModel instanceof s.OSParent)return S(n);if(t.selectionModel instanceof s.OSCurrent){var B=function(){if(o.value0)return H(n)(t.selectionModel.value0)(o.value1.value0);if(!o.value0)return W(n)(t.selectionModel.value0)(o.value1.value0);throw new Error("Failed pattern match at ConeCanvas.ConeTransforms line 187, column 37 - line 190, column 25: "+[o.value0.constructor.name])}();return e["return"](m.applicativeEff)({condNewSelection:r.Nothing.value,newAnim:new d.AniTransform(100,B)})}throw new Error("Failed pattern match at ConeCanvas.ConeTransforms line 185, column 5 - line 192, column 1: "+[t.selectionModel.constructor.name])}if(o instanceof s.AnimGlobalView)return e["return"](m.applicativeEff)({condNewSelection:r.Nothing.value,newAnim:new d.AniGlobalView(100,o.value0)});if(o instanceof s.AnimZoom&&o.value0 instanceof r.Just){var J=Y(t.selectionModel)(t),$=l.abs(J.x-o.value0.value0)>.01;if($)return e["return"](m.applicativeEff)({condNewSelection:r.Nothing.value,newAnim:new d.AniZoom(100,J.x,o.value0.value0)});if(!$)return S(n);throw new Error("Failed pattern match at ConeCanvas.ConeTransforms line 196, column 13 - line 199, column 1: "+[$.constructor.name])}if(o instanceof s.AnimZoom&&o.value0 instanceof r.Nothing){var V=Y(t.selectionModel)(t),q=l.abs(V.x-V.y)>.01;if(q)return e["return"](m.applicativeEff)({condNewSelection:r.Nothing.value,newAnim:new d.AniZoom(100,V.x,V.y)});if(!q)return S(n);throw new Error("Failed pattern match at ConeCanvas.ConeTransforms line 202, column 13 - line 205, column 1: "+[q.constructor.name])}if(o instanceof s.AnimPause)return e["return"](m.applicativeEff)({condNewSelection:r.Nothing.value,newAnim:new d.AniPause(o.value0)});if(o instanceof s.AnimNull)return e["return"](m.applicativeEff)({condNewSelection:r.Nothing.value,newAnim:d.AniNull.value});if(o instanceof s.AnimCut){if(t.selectionModel instanceof s.OSCurrent){var Z=f.coneIsRoot(t.selectionModel.value0);if(Z)return S(n);if(!Z)return function(){var o=(e["<$>"](m.functorEff)(a.length)(s.nodeGetChildren(n)(f.zipGetNode(t.selectionModel.value0)))(),z(n)(t.selectionModel));if(o instanceof r.Just)return{condNewSelection:r.Nothing.value,newAnim:new d.AniTransform(100,o.value0)};if(o instanceof r.Nothing)return S(n)();throw new Error("Failed pattern match at ConeCanvas.ConeTransforms line 219, column 34 - line 222, column 29: "+[o.constructor.name])};throw new Error("Failed pattern match at ConeCanvas.ConeTransforms line 210, column 13 - line 223, column 9: "+[Z.constructor.name])}return S(n)}if(o instanceof s.AnimCopy)return S(n);if(o instanceof s.AnimPaste){if(t.copySelection instanceof d.NoSelection)return S(n);if(t.copySelection instanceof d.SingleSelection){var I=f.zipGetNode(f.selGetPos(n)(t.copySelection.value0)),K=G(n)(t.selectionModel)(I);if(K instanceof r.Just)return e["return"](m.applicativeEff)({condNewSelection:r.Nothing.value,newAnim:new d.AniTransform(100,K.value0)});if(K instanceof r.Nothing)return S(n);throw new Error("Failed pattern match at ConeCanvas.ConeTransforms line 230, column 16 - line 234, column 1: "+[K.constructor.name])}throw new Error("Failed pattern match at ConeCanvas.ConeTransforms line 226, column 5 - line 234, column 1: "+[t.copySelection.constructor.name])}if(o instanceof s.AnimTransformUp&&o.value0 instanceof r.Nothing)return function(){var e=w(n)(t.selectionModel)();if(e instanceof r.Nothing)return c.trace("toAnimate AnimTransformUp: transformUp returns Nothing")(function(e){return S(n)})();if(e instanceof r.Just)return{condNewSelection:r.Nothing.value,newAnim:new d.AniTransform(100,e.value0)};throw new Error("Failed pattern match at ConeCanvas.ConeTransforms line 236, column 5 - line 239, column 1: "+[e.constructor.name])};if(o instanceof s.AnimTransformUp&&o.value0 instanceof r.Just){if(t.selectionModel instanceof s.OSParent)return c.trace("toAnimate AnimTransformUp: parentSelection")(function(e){return S(n)});if(t.selectionModel instanceof s.OSCurrent){var Q=p(n)(t.selectionModel.value0)(o.value0.value0);if(Q instanceof r.Nothing)return c.trace("toAnimate AnimTransformUp: transformUp' returns Nothing")(function(e){return S(n)});if(Q instanceof r.Just)return e["return"](m.applicativeEff)({condNewSelection:r.Nothing.value,newAnim:new d.AniTransform(100,Q.value0)});throw new Error("Failed pattern match at ConeCanvas.ConeTransforms line 243, column 13 - line 246, column 1: "+[Q.constructor.name])}throw new Error("Failed pattern match at ConeCanvas.ConeTransforms line 240, column 5 - line 246, column 1: "+[t.selectionModel.constructor.name])}if(o instanceof s.AnimTransformDown&&o.value0 instanceof r.Nothing)return function(){var e=C(n)(t.selectionModel)();if(e instanceof r.Nothing)return S(n)();if(e instanceof r.Just)return{condNewSelection:r.Nothing.value,newAnim:new d.AniTransform(100,e.value0)};throw new Error("Failed pattern match at ConeCanvas.ConeTransforms line 248, column 5 - line 251, column 1: "+[e.constructor.name])};if(o instanceof s.AnimTransformDown&&o.value0 instanceof r.Just){if(t.selectionModel instanceof s.OSParent)return S(n);if(t.selectionModel instanceof s.OSCurrent){var nn=g(n)(t.selectionModel.value0)(o.value0.value0);if(nn instanceof r.Nothing)return S(n);if(nn instanceof r.Just)return e["return"](m.applicativeEff)({condNewSelection:r.Nothing.value,newAnim:new d.AniTransform(100,nn.value0)});throw new Error("Failed pattern match at ConeCanvas.ConeTransforms line 255, column 13 - line 259, column 1: "+[nn.constructor.name])}throw new Error("Failed pattern match at ConeCanvas.ConeTransforms line 252, column 5 - line 259, column 1: "+[t.selectionModel.constructor.name])}if(o instanceof s.AnimTransformReplace)return e["return"](m.applicativeEff)({condNewSelection:new r.Just(new s.OSCurrent(o.value0)),newAnim:d.AniNull.value});if(o instanceof s.AnimTransformShiftToZero&&o.value0 instanceof r.Nothing)return e["return"](m.applicativeEff)({condNewSelection:new r.Just(f.selShiftToZero(t.selectionModel)),newAnim:d.AniNull.value});if(o instanceof s.AnimTransformShiftToZero&&o.value0 instanceof r.Just)return e["return"](m.applicativeEff)({condNewSelection:new r.Just(new s.OSCurrent(o.value0.value0)),newAnim:d.AniNull.value});throw new Error("Failed pattern match at ConeCanvas.ConeTransforms line 88, column 1 - line 96, column 1: "+[t.constructor.name,o.constructor.name])}}},nn=function(n){return function(e){return{progress:n,transforms:e}}};n.commonPrefix=K,n.getLiftBase=x,n.getLift=F,n.getIntroBase=L,n.getIntro=I,n.isHeadAim=y,n.isIndexAim=P,n.getSizeChange=b,n["getFade'"]=B,n.getFade=J,n.getTurn=T,n.filterTransform=q,n.buildTransform=nn,n.emptyTransform=Z,n.turnMany=h,n.transformUp=w,n.transformDown=C,n.transformExtroR=j,n.transformIntroL=k,n.transformExtroL=z,n.transformIntroR=G,n.transformRight=M,n.transformLeft=_,n.toAnimate=Q}(PS["ConeCanvas.ConeTransforms"]=PS["ConeCanvas.ConeTransforms"]||{}),function(n){"use strict";var e=PS.Prelude,t=PS["Control.Monad.ST"],r=PS["Control.Monad.Eff.Exception"],o=PS["Control.Monad"],a=PS["Control.Monad.Eff.Random"],i=PS["Data.Date"],u=(PS["Data.Time"],PS["Data.Maybe"]),c=PS["Data.Array"],l=PS["Data.Array.Unsafe"],s=PS.Math,s=PS.Math,f=PS["Control.Apply"],d=PS["Data.Int"],v=PS["Data.List"],m=PS["Debug.Trace"],h=PS["ConeCanvas.ConeModel"],p=PS["ConeCanvas.ConeZipper"],w=PS["ConeCanvas.ConeTransforms"],g=PS["ConeCanvas.ConeControlTypes"],C=(PS["ConeCanvas.Preferences"],PS["ConeCanvas.GeometryTypes"]),S=PS.Extensions,P=PS["Control.Monad.Eff"],y=PS["Data.Foldable"],T=function(n){return function(e){var t=function(n){return s.min(s.max(n)(-.5))(.5)},r=n.rightBottomRear.y-n.leftTopFront.y,o=(e-n.leftTopFront.y)/r,a=o-.5;return 2*-t(a)}},b=40,E=function(n){var e=n/100,t=e*e*e*(10+e*(6*e-15));return 100*t},x=function(n){return function(t){return function(r){return function(a){return function(){var i=g.readPaintRef(n)(t)();return o.when(P.monadEff)(e["/="](v.eqList(e.eqInt))(p.selGetPath(a))(p.selGetPath(r)))(function(){if(i.selectedChangedCallback instanceof u.Nothing)return e["return"](P.applicativeEff)(e.unit);if(i.selectedChangedCallback instanceof u.Just)return i.selectedChangedCallback.value0(r);throw new Error("Failed pattern match at ConeCanvas.ConeControl line 168, column 5 - line 176, column 1: "+[i.selectedChangedCallback.constructor.name])}())()}}}}},F=function(n){return function(t){return function(r){return function(){var o=g.readPaintRef(n)(t)();if(o.isPainting)return e.unit;if(!o.isPainting)return g.modifyPaintRef(n)(t)(function(n){var e={};for(var t in n)n.hasOwnProperty(t)&&(e[t]=n[t]);return e.isPainting=!0,e})(),g.getConeFront(o.frontend).paintIt(t)(r)(),g.modifyPaintRef(n)(t)(function(n){var e={};for(var t in n)n.hasOwnProperty(t)&&(e[t]=n[t]);return e.isPainting=!1,e})(),e.unit;throw new Error("Failed pattern match at ConeCanvas.ConeControl line 533, column 5 - line 541, column 1: "+[o.isPainting.constructor.name])}}}},A=function(n){return function(e){return function(t){return function(){var r=g.readPaintRef(n)(e)();if(t){var o=r.controlState.zoomControl>=1;if(o)return!1;if(!o){var a=s.min(r.controlState.zoomControl+.02)(1);return g.modifyPaintRef(n)(e)(function(n){var e={};for(var t in n)n.hasOwnProperty(t)&&(e[t]=n[t]);return e.controlState=function(){var e={};for(var t in n.controlState)n.controlState.hasOwnProperty(t)&&(e[t]=n.controlState[t]);return e.zoomControl=a,e.zoom=g.realZoom(a)(n.controlState.currentMaxZoom),e}(),e})(),F(n)(e)(g.CommandingNothing.value)(),!0}throw new Error("Failed pattern match at ConeCanvas.ConeControl line 727, column 13 - line 738, column 9: "+[o.constructor.name])}if(!t){var i=r.controlState.zoomControl<=-1;if(i)return!1;if(!i){var a=s.max(r.controlState.zoomControl-.02)(-1);return g.modifyPaintRef(n)(e)(function(n){var e={};for(var t in n)n.hasOwnProperty(t)&&(e[t]=n[t]);return e.controlState=function(){var e={};for(var t in n.controlState)n.controlState.hasOwnProperty(t)&&(e[t]=n.controlState[t]);return e.zoomControl=a,e.zoom=g.realZoom(a)(n.controlState.currentMaxZoom),e}(),e})(),F(n)(e)(g.CommandingNothing.value)(),!0}throw new Error("Failed pattern match at ConeCanvas.ConeControl line 739, column 13 - line 751, column 1: "+[i.constructor.name])}throw new Error("Failed pattern match at ConeCanvas.ConeControl line 725, column 5 - line 751, column 1: "+[t.constructor.name])}}}},N=function(n){return function(t){return function(r){return function(){var o=g.readPaintRef(n)(t)();return function(){return o.state instanceof g.OSTurnMouse?g.modifyPaintRef(n)(t)(function(n){var e={};for(var t in n)n.hasOwnProperty(t)&&(e[t]=n[t]);return e.state=new g.OSTurnMouse(r,o.state.value1,o.state.value2),e}):o.state instanceof g.OSAngle?g.modifyPaintRef(n)(t)(function(n){var e={};for(var t in n)n.hasOwnProperty(t)&&(e[t]=n[t]);return e.state=new g.OSAngle(o.state.value0,r),e}):o.state instanceof g.OSZoom?g.modifyPaintRef(n)(t)(function(n){var e={};for(var t in n)n.hasOwnProperty(t)&&(e[t]=n[t]);return e.state=new g.OSZoom(o.state.value0,r.y),e}):e["return"](P.applicativeEff)(o)}()(),!0}}}},_=function(n){return function(r){return function(o){return function(i){var l=e["return"](P.applicativeEff)({ani:[],isHandled:!1}),s=e["return"](P.applicativeEff)({ani:[],isHandled:!0}),f=v.toList(y.foldableArray)([2,1,4,0]),d=v.toList(y.foldableArray)([0]),w=[h.AnimMoveDown.value,h.AnimMoveDown.value,new h.AnimMoveLeft(3),new h.AnimMoveRight(3),h.AnimMoveUp.value,h.AnimMoveUp.value,new h.AnimMoveLeft(1),new h.AnimMoveLeft(1),new h.AnimMoveRight(2),new h.AnimClockwork(f),new h.AnimClockwork(d),new h.AnimClockwork(f),new h.AnimClockwork(d),h.AnimMoveDown.value,h.AnimMoveDown.value,new h.AnimMoveLeft(3),new h.AnimMoveRight(3),h.AnimMoveUp.value,h.AnimMoveUp.value,new h.AnimMoveLeft(1),new h.AnimMoveLeft(1),new h.AnimMoveRight(2)];return function(){var f=g.readPaintRef(n)(o)(),d=function(){if(r instanceof g.KLeft){if(!f.prefs.cursorKeys)return e["return"](P.applicativeEff)({ani:[new h.AnimMoveLeft(1)],isHandled:!0});if(e.otherwise)return e["return"](P.applicativeEff)({ani:[new h.AnimMoveRight(1)],isHandled:!0})}if(r instanceof g.KRight){if(!f.prefs.cursorKeys)return e["return"](P.applicativeEff)({ani:[new h.AnimMoveRight(1)],isHandled:!0});if(e.otherwise)return e["return"](P.applicativeEff)({ani:[new h.AnimMoveLeft(1)],isHandled:!0})}if(r instanceof g.KMoveLeft){if(f.prefs.cursorKeys)return e["return"](P.applicativeEff)({ani:[new h.AnimTransformLeft(u.Nothing.value)],isHandled:!0});if(e.otherwise)return e["return"](P.applicativeEff)({ani:[new h.AnimTransformRight(u.Nothing.value)],isHandled:!0})}if(r instanceof g.KMoveRight){if(!f.prefs.cursorKeys)return e["return"](P.applicativeEff)({ani:[new h.AnimTransformLeft(u.Nothing.value)],isHandled:!0});if(e.otherwise)return e["return"](P.applicativeEff)({ani:[new h.AnimTransformRight(u.Nothing.value)],isHandled:!0})}if(r instanceof g.KUp){if(!f.prefs.cursorKeys)return e["return"](P.applicativeEff)({ani:[h.AnimMoveUp.value],isHandled:!0});if(e.otherwise)return e["return"](P.applicativeEff)({ani:[h.AnimMoveDown.value],isHandled:!0})}if(r instanceof g.KDown){if(f.prefs.cursorKeys)return e["return"](P.applicativeEff)({ani:[h.AnimMoveUp.value],isHandled:!0});if(e.otherwise)return e["return"](P.applicativeEff)({ani:[h.AnimMoveDown.value],isHandled:!0})}if(r instanceof g.KMoveUp)return e["return"](P.applicativeEff)({ani:[h.AnimMoveUp.value,new h.AnimTransformUp(u.Nothing.value)],isHandled:!0});if(r instanceof g.KMoveDown)return e["return"](P.applicativeEff)({ani:[new h.AnimTransformDown(u.Nothing.value),h.AnimMoveDown.value],isHandled:!0});if(r instanceof g.KFirst)return e["return"](P.applicativeEff)({ani:[h.AnimTurnToFirst.value],isHandled:!0});if(r instanceof g.KSetFirst)return e["return"](P.applicativeEff)({ani:[new h.AnimTransformShiftToZero(u.Nothing.value)],isHandled:!0});if(r instanceof g.KCut)return e["return"](P.applicativeEff)({ani:[h.AnimCut.value],isHandled:!0});if(r instanceof g.KCopy)return e["return"](P.applicativeEff)({ani:[h.AnimCopy.value],isHandled:!0});if(r instanceof g.KPaste)return e["return"](P.applicativeEff)({ani:[h.AnimPaste.value],isHandled:!0});if(r instanceof g.KLink){if(f.selectionModel instanceof h.OSParent)return s;if(f.selectionModel instanceof h.OSCurrent){var d=c.uncons(c.filter(function(n){return n.actionType instanceof h.PrimaryLinkAction})(h.actions(n)(p.zipGetEntry(f.selectionModel.value0))));if(d instanceof u.Nothing)return l;if(d instanceof u.Just)return function(){return d.value0.head.action(i)(),l()};throw new Error("Failed pattern match at ConeCanvas.ConeControl line 778, column 59 - line 787, column 15: "+[d.constructor.name])}throw new Error("Failed pattern match at ConeCanvas.ConeControl line 775, column 52 - line 787, column 15: "+[f.selectionModel.constructor.name])}if(r instanceof g.KClockwork){if(f.selectionModel instanceof h.OSParent)return s;if(f.selectionModel instanceof h.OSCurrent)return function(){var e=p.countAllPositions(n)(p.selGetPos(n)(f.selectionModel))(),t=a.randomInt(0)(e-1)(),r=p.getZipFromIndex(n)(p.selGetPos(n)(f.selectionModel))(t)();if(r instanceof u.Nothing)return m.traceA(P.applicativeEff)("ConeControl>>keyAction: KClockwork random index not found!")(),l();if(r instanceof u.Just){var o=p.coneGetPath(r.value0);return{ani:[new h.AnimClockwork(o)],isHandled:!0}}throw new Error("Failed pattern match at ConeCanvas.ConeControl line 793, column 59 - line 800, column 15: "+[r.constructor.name])};throw new Error("Failed pattern match at ConeCanvas.ConeControl line 787, column 53 - line 800, column 15: "+[f.selectionModel.constructor.name])}if(r instanceof g.KGlobal)return e["return"](P.applicativeEff)({ani:[new h.AnimGlobalView(!1)],isHandled:!0});if(r instanceof g.KUnglobal)return e["return"](P.applicativeEff)({ani:[new h.AnimGlobalView(!0)],isHandled:!0});if(r instanceof g.KZoomNormal)return e["return"](P.applicativeEff)({ani:[new h.AnimZoom(u.Nothing.value)],isHandled:!0});if(r instanceof g.KZoomOut)return e["return"](P.applicativeEff)({ani:[new h.AnimZoom(new u.Just(1))],isHandled:!0});if(r instanceof g.KBench)return function(){return g.modifyPaintRef(n)(o)(function(n){var e={};for(var t in n)n.hasOwnProperty(t)&&(e[t]=n[t]);return e.benchmark=new u.Just({runtime:0,cycles:0}),e})(),{ani:w,isHandled:!0}};if(r instanceof g.KToggleDemo)return function(){return g.modifyPaintRef(n)(o)(function(n){var e={};for(var t in n)n.hasOwnProperty(t)&&(e[t]=n[t]);return e.demoMode=!n.demoMode,e})(),{ani:[],isHandled:!0}};if(r instanceof g.KToggleControl)return function(){return g.modifyPaintRef(n)(o)(function(n){var e={};for(var t in n)n.hasOwnProperty(t)&&(e[t]=n[t]);return e.controlState=function(){var e={};for(var t in n.controlState)n.controlState.hasOwnProperty(t)&&(e[t]=n.controlState[t]);return e.showControl=!n.controlState.showControl,e}(),e})(),t.writeSTRef(f.controlState.needRepaint)(!0)(),{ani:[],isHandled:!0}};if(r instanceof g.KToggleIndex)return function(){return g.modifyPaintRef(n)(o)(function(n){var e={};for(var t in n)n.hasOwnProperty(t)&&(e[t]=n[t]);return e.controlState=function(){var e={};for(var t in n.controlState)n.controlState.hasOwnProperty(t)&&(e[t]=n.controlState[t]);return e.showIndex=!n.controlState.showIndex,e}(),e})(),t.writeSTRef(f.controlState.needRepaint)(!0)(),{ani:[],isHandled:!0}};if(r instanceof g.KEditModeOn)return function(){return g.modifyPaintRef(n)(o)(function(n){var e={};for(var t in n)n.hasOwnProperty(t)&&(e[t]=n[t]);return e.controlState=function(){var e={};for(var t in n.controlState)n.controlState.hasOwnProperty(t)&&(e[t]=n.controlState[t]);return e.editMode=!0,e}(),e})(),t.writeSTRef(f.controlState.needRepaint)(!0)(),s()};if(r instanceof g.KEditModeOff)return function(){return g.modifyPaintRef(n)(o)(function(n){var e={};for(var t in n)n.hasOwnProperty(t)&&(e[t]=n[t]);return e.controlState=function(){var e={};for(var t in n.controlState)n.controlState.hasOwnProperty(t)&&(e[t]=n.controlState[t]);return e.editMode=!1,e}(),e})(),t.writeSTRef(f.controlState.needRepaint)(!0)(),s()};throw new Error("Failed pattern match at ConeCanvas.ConeControl line 755, column 12 - line 838, column 5: "+[r.constructor.name])}()();return function(){var t=c.uncons(d.ani);if(t instanceof u.Just)return function(){return g.modifyPaintRef(n)(o)(function(n){var t={};for(var r in n)n.hasOwnProperty(r)&&(t[r]=n[r]);return t.commandQueue=e["++"](e.semigroupArray)(n.commandQueue)(d.ani),t})(),e.unit};if(t instanceof u.Nothing)return e["return"](P.applicativeEff)(e.unit);throw new Error("Failed pattern match at ConeCanvas.ConeControl line 838, column 5 - line 845, column 5: "+[t.constructor.name])}()(),d.isHandled}}}}},D=function(n){return function(t){return function(r){if(n===t)return u.Nothing.value;if(e.otherwise){var o=n-t,a=function(){var n=s.abs(d.toNumber(o))>d.toNumber(r)/2;if(n){var e=o>0;if(e)return-(r-o);if(!e)return r+o|0;throw new Error("Failed pattern match at ConeCanvas.ConeControl line 660, column 25 - line 663, column 21: "+[e.constructor.name])}if(!n)return o;throw new Error("Failed pattern match at ConeCanvas.ConeControl line 658, column 20 - line 664, column 9: "+[n.constructor.name])}();return new u.Just(function(){var n=0>a;if(n)return new h.AnimMoveRight(-a);if(!n)return new h.AnimMoveLeft(a);throw new Error("Failed pattern match at ConeCanvas.ConeControl line 664, column 18 - line 666, column 48: "+[n.constructor.name])}())}throw new Error("Failed pattern match at ConeCanvas.ConeControl line 654, column 1 - line 669, column 1: "+[n.constructor.name,t.constructor.name,r.constructor.name])}}},M=function(){var n=i.now(),e=i.toEpochMilliseconds(n);return e},L=function(n){return function(t){return function(o){var a=function(t){return function(r){var o=v.uncons(r);if(o instanceof u.Nothing)return e["return"](P.applicativeEff)([]);if(o instanceof u.Just)return function(){var e=p.coneDown(n)(t)();if(e instanceof u.Nothing)return[];if(e instanceof u.Just){var r=p.coneSetPos(e.value0)(o.value0.head);if(r instanceof u.Nothing)return[];if(r instanceof u.Just){var i=p.coneGetFirstBelow(t),l=p.coneNumLevel(r.value0),s=D(i)(o.value0.head)(l),f=a(r.value0)(o.value0.tail)();if(s instanceof u.Just){var d=v["null"](o.value0.tail);if(d)return[s.value0];if(!d)return c[":"](s.value0)(c[":"](h.AnimMoveDown.value)(f));throw new Error("Failed pattern match at ConeCanvas.ConeControl line 645, column 47 - line 647, column 85: "+[d.constructor.name])}if(s instanceof u.Nothing){var m=v["null"](o.value0.tail);if(m)return[];if(!m)return c[":"](h.AnimMoveDown.value)(f);throw new Error("Failed pattern match at ConeCanvas.ConeControl line 649, column 48 - line 651, column 81: "+[m.constructor.name])}throw new Error("Failed pattern match at ConeCanvas.ConeControl line 643, column 29 - line 653, column 1: "+[s.constructor.name])}throw new Error("Failed pattern match at ConeCanvas.ConeControl line 636, column 21 - line 653, column 1: "+[r.constructor.name])}throw new Error("Failed pattern match at ConeCanvas.ConeControl line 633, column 13 - line 653, column 1: "+[e.constructor.name])};throw new Error("Failed pattern match at ConeCanvas.ConeControl line 629, column 32 - line 653, column 1: "+[o.constructor.name])}},i=p.coneGetPath(t),l=v.drop(v.length(i))(o),s=v.take(v.length(i))(o),f=e["/="](v.eqList(e.eqInt))(s)(i);if(f)return r.throwException(r.error("ConeControl*>getAnimationTo_ pathes don't match! superPath: "+(e.show(v.showList(e.showInt))(i)+(" initialPath: "+e.show(v.showList(e.showInt))(s)))));if(!f)return a(t)(l);throw new Error("Failed pattern match at ConeCanvas.ConeControl line 624, column 8 - line 628, column 3: "+[f.constructor.name])}}},I=function(n){return function(t){return function(o){return function(o){return function(a){return function(){var i=g.readPaintRef(n)(t)();if(i.state instanceof g.OSAnimate)return!0;if(o instanceof u.Just&&o.value0 instanceof g.CILabel){var l=p.selNumLevel(i.selectionModel),s=p.selGetPosition(i.selectionModel),f=D(s)(o.value0.value0)(l);return f instanceof u.Just?(g.modifyPaintRef(n)(t)(function(n){var t={};for(var r in n)n.hasOwnProperty(r)&&(t[r]=n[r]);return t.commandQueue=e["++"](e.semigroupArray)(n.commandQueue)([f.value0]),t})(),!0):!0}if(o instanceof u.Just&&o.value0 instanceof g.CIMainLabel)return!0;if(o instanceof u.Just&&o.value0 instanceof g.CISuperLabel)return g.modifyPaintRef(n)(t)(function(n){var t={};for(var r in n)n.hasOwnProperty(r)&&(t[r]=n[r]);return t.commandQueue=e["++"](e.semigroupArray)(n.commandQueue)(c.replicate(o.value0.value0)(h.AnimMoveUp.value)),t})(),!0;if(o instanceof u.Just&&o.value0 instanceof g.CICard){var d=p.selUp(i.selectionModel);m.traceA(P.applicativeEff)("CICard pathTo:"+e.show(v.showList(e.showInt))(o.value0.value0))();var w=function(){if(d instanceof u.Just&&d.value0 instanceof h.OSCurrent)return L(n)(d.value0.value0)(o.value0.value0);if(d instanceof u.Just&&d.value0 instanceof h.OSParent)return r.throwException(r.error("ConeControl*>pressedButton: impossible"));if(d instanceof u.Nothing)return function(){var e=L(n)(p.selGetPos(n)(i.selectionModel))(o.value0.value0)();return c[":"](h.AnimMoveDown.value)(e)};throw new Error("Failed pattern match at ConeCanvas.ConeControl line 582, column 37 - line 590, column 29: "+[d.constructor.name])}()();return g.modifyPaintRef(n)(t)(function(n){var t={};for(var r in n)n.hasOwnProperty(r)&&(t[r]=n[r]);return t.commandQueue=e["++"](e.semigroupArray)(n.commandQueue)(w),t})(),!0}if(o instanceof u.Just&&o.value0 instanceof g.CIZoom)return g.modifyPaintRef(n)(t)(function(n){var e={};for(var t in n)n.hasOwnProperty(t)&&(e[t]=n[t]);return e.state=new g.OSZoom(o.value0.value0,a.y),e})(),m.traceA(P.applicativeEff)("buttonPressed CIZoom y: "+(e.show(e.showNumber)(a.y)+(" rect: "+e.show(C.showCuboid(e.showNumber))(o.value0.value0))))(),!0;if(o instanceof u.Just&&o.value0 instanceof g.CIAngel)return g.modifyPaintRef(n)(t)(function(n){var e={};for(var t in n)n.hasOwnProperty(t)&&(e[t]=n[t]);return e.state=new g.OSAngle(o.value0.value0,{x:a.x,y:a.y}),e})(),m.traceA(P.applicativeEff)("buttonPressed CIAngel x: "+(e.show(e.showNumber)(a.x)+(" y: "+(e.show(e.showNumber)(a.y)+(" rect: "+e.show(C.showCuboid(e.showNumber))(o.value0.value0))))))(),!0;if(o instanceof u.Just&&o.value0 instanceof g.CITurn){var S={x:o.value0.value0.leftTopFront.x+(o.value0.value0.rightBottomRear.x-o.value0.value0.leftTopFront.x)/2,y:o.value0.value0.rightBottomRear.y+(o.value0.value0.leftTopFront.y-o.value0.value0.rightBottomRear.y)/2};return g.modifyPaintRef(n)(t)(function(n){var e={};for(var t in n)n.hasOwnProperty(t)&&(e[t]=n[t]);return e.state=new g.OSTurnMouse({x:a.x,y:a.y},{x:a.x,y:a.y},S),e})(),m.traceA(P.applicativeEff)("buttonPressed CITurn x: "+(e.show(e.showNumber)(a.x)+(" y: "+(e.show(e.showNumber)(a.y)+(" rect: "+e.show(C.showCuboid(e.showNumber))(o.value0.value0))))))(),!0}return!0}}}}}},O=function(n){return function(t){return function(r){if(t&&r)return{p1:function(){var e=60>n;if(e)return 100;if(!e)return 2.5*(40-(n-60));throw new Error("Failed pattern match at ConeCanvas.ConeControl line 460, column 13 - line 460, column 66: "+[e.constructor.name])}(),p2:function(){var e=n>70;if(e)return 0;if(!e){var t=30>n;if(t)return 100;if(!t)return 2.5*(40-(n-30));throw new Error("Failed pattern match at ConeCanvas.ConeControl line 462, column 9 - line 462, column 62: "+[t.constructor.name])}throw new Error("Failed pattern match at ConeCanvas.ConeControl line 461, column 13 - line 462, column 62: "+[e.constructor.name])}(),p3:function(){var e=n>40;if(e)return 0;if(!e)return 2.5*(40-n);throw new Error("Failed pattern match at ConeCanvas.ConeControl line 463, column 14 - line 463, column 56: "+[e.constructor.name])}()};if(t&&!r)return{p1:function(){var e=40>n;if(e)return 100;if(!e)return 1.6*(60-(n-40));throw new Error("Failed pattern match at ConeCanvas.ConeControl line 465, column 13 - line 465, column 66: "+[e.constructor.name])}(),p2:function(){var e=n>60;if(e)return 0;if(!e)return 1.6*(60-n);throw new Error("Failed pattern match at ConeCanvas.ConeControl line 466, column 13 - line 466, column 55: "+[e.constructor.name])}(),p3:0};if(!t&&r)return{p1:100,p2:function(){
var e=40>n;if(e)return 100;if(!e)return 1.6*(60-(n-40));throw new Error("Failed pattern match at ConeCanvas.ConeControl line 470, column 13 - line 470, column 66: "+[e.constructor.name])}(),p3:function(){var e=n>60;if(e)return 0;if(!e)return 1.6*(60-n);throw new Error("Failed pattern match at ConeCanvas.ConeControl line 471, column 13 - line 471, column 55: "+[e.constructor.name])}()};if(e.otherwise)return{p1:100,p2:100-n,p3:0};throw new Error("Failed pattern match at ConeCanvas.ConeControl line 458, column 1 - line 474, column 1: "+[n.constructor.name,t.constructor.name,r.constructor.name])}}},R=function(n){return function(e){return function(t){var r=s.atan2(e.x)(e.y),o=s.atan2(n.x)(n.y),a=r-o,i=-(100*a*d.toNumber(t))/(2*s.pi);return i}}},k=function(n){return function(e){return function(t){var r=100-100*(e-t)/n;return r}}},U=function(n){return k(n.aniTimeT)},G=function(n){return k(n.aniTimeUD)},B=function(n){return function(e){return k(n.aniTimeLR*d.toNumber(e))}},J=function(n){return function(e){return k(n.aniTimeLR*(e/100))}},$=function(n){return k(n.aniTimeF)},H=function(n){return function(e){var t=function(n){return s.min(s.max(n)(-.5))(.5)},r=n.rightBottomRear.y-n.leftTopFront.y,o=(e.y-n.leftTopFront.y)/r,a=o-.5,i=n.rightBottomRear.x-n.leftTopFront.x,u=(e.x-n.leftTopFront.x)/i,c=u-.5;return{x:2*t(c),y:2*-t(a)}}},z=function(n){return function(e){var t=s.atan2(e.x)(e.y),r=s.atan2(n.x)(n.y);return t-r}},W=function(n){return function(e){return function(t){var r=p.selGetPosition(t),o=p.selNumLevel(t),a=z(n)(e),i=a/(2*s.pi)*d.toNumber(o),u=i-s.round(i),c=function(){var n=u>0;if(n)return 1;if(!n)return-1;throw new Error("Failed pattern match at ConeCanvas.ConeControl line 495, column 22 - line 496, column 5: "+[n.constructor.name])}(),l=100*s.abs(u),f=r+d.round(i)|0,v=S.modInt(f)(o);return{selectedIndex:v,percentage:l,direction:c}}}},j=function(n){return function(r){return function(a){return function(a){return function(){var i=g.readPaintRef(n)(r)();return function(){if(i.state instanceof g.OSTurnMouse){var c=W({x:a.x-i.state.value2.x,y:-(a.y-i.state.value2.y)})({x:i.state.value1.x-i.state.value2.x,y:-(i.state.value1.y-i.state.value2.y)})(i.selectionModel),l=p.selSetSel(i.selectionModel)(c.selectedIndex);if(l instanceof u.Just)return function(){var e=M();return g.modifyPaintRef(n)(r)(function(n){var t={};for(var r in n)n.hasOwnProperty(r)&&(t[r]=n[r]);return t.selectionModel=l.value0,t.state=function(){var n=c.direction>0;if(n)return new g.OSAnimate(new g.AniMoveLeft(c.percentage,1));if(!n)return new g.OSAnimate(new g.AniMoveRight(c.percentage,1));throw new Error("Failed pattern match at ConeCanvas.ConeControl line 682, column 56 - line 684, column 88: "+[n.constructor.name])}(),t.animateStartTime=e,t})(),x(n)(r)(l.value0)(i.selectionModel)()};if(l instanceof u.Nothing)return function(){return g.modifyPaintRef(n)(r)(function(n){var e={};for(var t in n)n.hasOwnProperty(t)&&(e[t]=n[t]);return e.state=g.OSNormal.value,e})(),e.unit};throw new Error("Failed pattern match at ConeCanvas.ConeControl line 676, column 17 - line 690, column 7: "+[l.constructor.name])}return i.state instanceof g.OSAngle?f["*>"](P.applyEff)(g.modifyPaintRef(n)(r)(function(n){var e={};for(var t in n)n.hasOwnProperty(t)&&(e[t]=n[t]);return e.state=g.OSNormal.value,e}))(e["return"](P.applicativeEff)(e.unit)):i.state instanceof g.OSZoom?f["*>"](P.applyEff)(g.modifyPaintRef(n)(r)(function(n){var e={};for(var t in n)n.hasOwnProperty(t)&&(e[t]=n[t]);return e.state=g.OSNormal.value,e}))(e["return"](P.applicativeEff)(e.unit)):o.when(P.monadEff)(""!==i.controlState.pressed)(function(){return t.writeSTRef(i.controlState.needRepaint)(!0)(),g.modifyPaintRef(n)(r)(function(n){var e={};for(var t in n)n.hasOwnProperty(t)&&(e[t]=n[t]);return e.controlState=function(){var e={};for(var t in n.controlState)n.controlState.hasOwnProperty(t)&&(e[t]=n.controlState[t]);return e.pressed="",e}(),e})(),e.unit})}()(),!0}}}}},V=function(n){return function(r){return function(a){return function(i){var f=function(e){return function(){return g.modifyPaintRef(n)(r)(function(n){var e={};for(var t in n)n.hasOwnProperty(t)&&(e[t]=n[t]);return e.state=g.OSNormal.value,e})(),t.writeSTRef(e.animatePaintRef)(u.Nothing.value)(),F(n)(r)(g.CommandingNothing.value)()}};return function(){var C=g.readPaintRef(n)(r)();return t.writeSTRef(C.animatePaintRef)(new u.Just(a))(),function(){if(C.state instanceof g.OSTurnMouse){var y=R({x:C.state.value0.x-C.state.value2.x,y:-(C.state.value0.y-C.state.value2.y)})({x:C.state.value1.x-C.state.value2.x,y:-(C.state.value1.y-C.state.value2.y)})(p.selNumLevel(C.selectionModel));return function(){return g.modifyPaintRef(n)(r)(function(n){var e={};for(var t in n)n.hasOwnProperty(t)&&(e[t]=n[t]);return e.state=new g.OSTurnMouse({x:C.state.value0.x,y:C.state.value0.y},{x:C.state.value1.x,y:C.state.value1.y},{x:C.state.value2.x,y:C.state.value2.y}),e})(),F(n)(r)(new g.CommandingTurn(y,-1))()}}if(C.state instanceof g.OSAngle){var b=H(C.state.value0)(C.state.value1);return o.when(P.monadEff)(s.abs(b.x-C.controlState.angleSelect.x)>.01||s.abs(b.y-C.controlState.angleSelect.y)>.01)(function(){return g.modifyPaintRef(n)(r)(function(n){var e={};for(var t in n)n.hasOwnProperty(t)&&(e[t]=n[t]);return e.controlState=function(){var e={};for(var t in n.controlState)n.controlState.hasOwnProperty(t)&&(e[t]=n.controlState[t]);return e.angleSelect=b,e}(),e})(),F(n)(r)(g.CommandingNothing.value)()})}if(C.state instanceof g.OSZoom){var A=T(C.state.value0)(C.state.value1);return o.when(P.monadEff)(s.abs(C.controlState.zoomControl-A)>.01)(function(){return g.modifyPaintRef(n)(r)(function(n){var e={};for(var t in n)n.hasOwnProperty(t)&&(e[t]=n[t]);return e.controlState=function(){var e={};for(var t in n.controlState)n.controlState.hasOwnProperty(t)&&(e[t]=n.controlState[t]);return e.zoom=g.realZoom(A)(n.controlState.currentMaxZoom),e.zoomControl=A,e}(),e})(),F(n)(r)(g.CommandingNothing.value)()})}if(C.state instanceof g.OSAnimate&&C.state.value0 instanceof g.AniMoveLeft){var N=B(C.prefs)(C.state.value0.value1)(a)(C.animateStartTime),_=0>=N;if(_)return f(C);if(!_)return function(){return g.modifyPaintRef(n)(r)(function(n){var e={};for(var t in n)n.hasOwnProperty(t)&&(e[t]=n[t]);return e.state=new g.OSAnimate(new g.AniMoveLeft(N,C.state.value0.value1)),e})(),F(n)(r)(new g.CommandingTurn(-E(N)*d.toNumber(C.state.value0.value1),C.state.value0.value1))()};throw new Error("Failed pattern match at ConeCanvas.ConeControl line 214, column 13 - line 220, column 9: "+[_.constructor.name])}if(C.state instanceof g.OSAnimate&&C.state.value0 instanceof g.AniMoveRight){var N=B(C.prefs)(C.state.value0.value1)(a)(C.animateStartTime),D=0>=N;if(D)return f(C);if(!D)return function(){return g.modifyPaintRef(n)(r)(function(n){var e={};for(var t in n)n.hasOwnProperty(t)&&(e[t]=n[t]);return e.state=new g.OSAnimate(new g.AniMoveRight(N,C.state.value0.value1)),e})(),F(n)(r)(new g.CommandingTurn(E(N)*d.toNumber(C.state.value0.value1),C.state.value0.value1))()};throw new Error("Failed pattern match at ConeCanvas.ConeControl line 222, column 13 - line 228, column 9: "+[D.constructor.name])}if(C.state instanceof g.OSAnimate&&C.state.value0 instanceof g.AniMoveUp){var N=G(C.prefs)(a)(C.animateStartTime),M=0>=N;if(M)return function(){return g.modifyPaintRef(n)(r)(function(n){var e={};for(var t in n)n.hasOwnProperty(t)&&(e[t]=n[t]);return e.state=g.OSNormal.value,e.controlState=function(){var e={};for(var t in n.controlState)n.controlState.hasOwnProperty(t)&&(e[t]=n.controlState[t]);return e.zoom=C.state.value0.value2,e.zoomControl=g.zoomControl(C.state.value0.value2)(n.controlState.currentMaxZoom),e}(),e})(),t.writeSTRef(C.animatePaintRef)(u.Nothing.value)(),F(n)(r)(g.CommandingNothing.value)()};if(!M){var L=E(N),I=C.state.value0.value1+(C.state.value0.value1-C.state.value0.value2)*-(100-L)/100;return function(){return g.modifyPaintRef(n)(r)(function(n){var e={};for(var t in n)n.hasOwnProperty(t)&&(e[t]=n[t]);return e.state=new g.OSAnimate(new g.AniMoveUp(N,C.state.value0.value1,C.state.value0.value2)),e.controlState=function(){var e={};for(var t in n.controlState)n.controlState.hasOwnProperty(t)&&(e[t]=n.controlState[t]);return e.zoom=I,e.zoomControl=g.zoomControl(I)(n.controlState.currentMaxZoom),e}(),e})(),F(n)(r)(new g.CommandingUpDown(-L))()}}throw new Error("Failed pattern match at ConeCanvas.ConeControl line 230, column 13 - line 250, column 9: "+[M.constructor.name])}if(C.state instanceof g.OSAnimate&&C.state.value0 instanceof g.AniMoveDown){var N=G(C.prefs)(a)(C.animateStartTime),k=0>=N;if(k)return function(){return g.modifyPaintRef(n)(r)(function(n){var e={};for(var t in n)n.hasOwnProperty(t)&&(e[t]=n[t]);return e.state=g.OSNormal.value,e.controlState=function(){var e={};for(var t in n.controlState)n.controlState.hasOwnProperty(t)&&(e[t]=n.controlState[t]);return e.zoom=C.state.value0.value2,e.zoomControl=g.zoomControl(C.state.value0.value2)(n.controlState.currentMaxZoom),e}(),e})(),t.writeSTRef(C.animatePaintRef)(u.Nothing.value)(),F(n)(r)(g.CommandingNothing.value)()};if(!k){var L=E(N),I=C.state.value0.value1+(C.state.value0.value1-C.state.value0.value2)*-(100-L)/100;return function(){return g.modifyPaintRef(n)(r)(function(n){var e={};for(var t in n)n.hasOwnProperty(t)&&(e[t]=n[t]);return e.state=new g.OSAnimate(new g.AniMoveDown(N,C.state.value0.value1,C.state.value0.value2)),e.controlState=function(){var e={};for(var t in n.controlState)n.controlState.hasOwnProperty(t)&&(e[t]=n.controlState[t]);return e.zoom=I,e.zoomControl=g.zoomControl(I)(n.controlState.currentMaxZoom),e}(),e})(),F(n)(r)(new g.CommandingUpDown(L))()}}throw new Error("Failed pattern match at ConeCanvas.ConeControl line 252, column 12 - line 272, column 9: "+[k.constructor.name])}if(C.state instanceof g.OSAnimate&&C.state.value0 instanceof g.AniZoom){var N=G(C.prefs)(a)(C.animateStartTime),z=0>=N;if(z)return function(){return g.modifyPaintRef(n)(r)(function(n){var e={};for(var t in n)n.hasOwnProperty(t)&&(e[t]=n[t]);return e.state=g.OSNormal.value,e.controlState=function(){var e={};for(var t in n.controlState)n.controlState.hasOwnProperty(t)&&(e[t]=n.controlState[t]);return e.zoom=C.state.value0.value2,e.zoomControl=g.zoomControl(C.state.value0.value2)(n.controlState.currentMaxZoom),e}(),e})(),t.writeSTRef(C.animatePaintRef)(u.Nothing.value)(),F(n)(r)(g.CommandingNothing.value)()};if(!z){var I=C.state.value0.value1+(C.state.value0.value1-C.state.value0.value2)*-(100-C.state.value0.value0)/100;return function(){return g.modifyPaintRef(n)(r)(function(n){var e={};for(var t in n)n.hasOwnProperty(t)&&(e[t]=n[t]);return e.state=new g.OSAnimate(new g.AniZoom(N,C.state.value0.value1,C.state.value0.value2)),e.controlState=function(){var e={};for(var t in n.controlState)n.controlState.hasOwnProperty(t)&&(e[t]=n.controlState[t]);return e.zoom=I,e.zoomControl=g.zoomControl(I)(n.controlState.currentMaxZoom),e}(),e})(),F(n)(r)(g.CommandingNothing.value)()}}throw new Error("Failed pattern match at ConeCanvas.ConeControl line 274, column 13 - line 291, column 9: "+[z.constructor.name])}if(C.state instanceof g.OSAnimate&&C.state.value0 instanceof g.AniTransform){var N=U(C.prefs)(a)(C.animateStartTime),W=0>=N;if(W)return function(){return g.modifyPaintRef(n)(r)(function(n){var e={};for(var t in n)n.hasOwnProperty(t)&&(e[t]=n[t]);return e.state=g.OSNormal.value,e.selectionModel=C.state.value0.value1.transAim,e})(),t.writeSTRef(C.animatePaintRef)(u.Nothing.value)(),F(n)(r)(g.CommandingNothing.value)(),x(n)(r)(C.state.value0.value1.transAim)(C.selectionModel)(),C.callback()};if(!W)return function(){return g.modifyPaintRef(n)(r)(function(n){var e={};for(var t in n)n.hasOwnProperty(t)&&(e[t]=n[t]);return e.state=new g.OSAnimate(new g.AniTransform(N,C.state.value0.value1)),e})(),F(n)(r)(new g.CommandingTrans(w.buildTransform(E(N))(C.state.value0.value1.transPrims)))()};throw new Error("Failed pattern match at ConeCanvas.ConeControl line 293, column 13 - line 309, column 9: "+[W.constructor.name])}if(C.state instanceof g.OSAnimate&&C.state.value0 instanceof g.AniClockwork){var N=$(C.prefs)(a)(C.animateStartTime),j=0>=N;if(j){var V=p.selGetPos(n)(C.selectionModel);return function(){var o=p.coneSetPath(n)(V)(C.state.value0.value2)();if(o instanceof u.Nothing)return m.trace("AniClockwork finished but can't set path: "+e.show(v.showList(e.showInt))(C.state.value0.value2))(function(n){return f(C)})();if(o instanceof u.Just){var a=p.selFromPos(o.value0);return g.modifyPaintRef(n)(r)(function(n){var e={};for(var t in n)n.hasOwnProperty(t)&&(e[t]=n[t]);return e.state=g.OSNormal.value,e.selectionModel=a,e.controlState=function(){var e={};for(var t in n.controlState)n.controlState.hasOwnProperty(t)&&(e[t]=n.controlState[t]);return e.zoom=C.state.value0.value5,e.zoomControl=g.zoomControl(C.state.value0.value5)(n.controlState.currentMaxZoom),e}(),e})(),t.writeSTRef(C.animatePaintRef)(u.Nothing.value)(),x(n)(r)(a)(C.selectionModel)(),F(n)(r)(g.CommandingNothing.value)()}throw new Error("Failed pattern match at ConeCanvas.ConeControl line 315, column 21 - line 331, column 17: "+[o.constructor.name])}}if(!j){var L=E(N),I=C.state.value0.value4+(C.state.value0.value4-C.state.value0.value5)*-(100-L)/100,q=e["/="](v.eqList(e.eqInt))(C.state.value0.value2)(C.state.value0.value3),Z=e["/="](v.eqList(e.eqInt))(C.state.value0.value1)(C.state.value0.value3),K=O(N)(Z)(q);return function(){return g.modifyPaintRef(n)(r)(function(n){var e={};for(var t in n)n.hasOwnProperty(t)&&(e[t]=n[t]);return e.state=new g.OSAnimate(new g.AniClockwork(N,C.state.value0.value1,C.state.value0.value2,C.state.value0.value3,C.state.value0.value4,C.state.value0.value5)),e.controlState=function(){var e={};for(var t in n.controlState)n.controlState.hasOwnProperty(t)&&(e[t]=n.controlState[t]);return e.zoom=I,e.zoomControl=g.zoomControl(I)(n.controlState.currentMaxZoom),e}(),e})(),F(n)(r)(new g.CommandingClockwork({ccTotal:L,ccFirst:E(K.p1),ccSecond:E(K.p2),ccThird:E(K.p3),ccFrom:C.state.value0.value1,ccTo:C.state.value0.value2,ccUpper:C.state.value0.value3}))()}}throw new Error("Failed pattern match at ConeCanvas.ConeControl line 311, column 13 - line 350, column 9: "+[j.constructor.name])}if(C.state instanceof g.OSAnimate&&C.state.value0 instanceof g.AniGlobalView)return m.trace("AniGlobalView: "+e.show(e.showBoolean)(C.state.value0.value1))(function(t){var o=s.max(J(C.prefs)(C.state.value0.value0)(a)(C.animateStartTime))(0);return function(){return function(){var t=m.trace("newN: "+e.show(e.showNumber)(o))(function(n){return 0===o});if(t){if(C.state.value0.value1)return f(C);if(!C.state.value0.value1){var a=0===C.state.value0.value0;if(a)return e["return"](P.applicativeEff)(e.unit);if(!a)return function(){return F(n)(r)(new g.CommandingGlobal(E(100-o),C.state.value0.value1))(),e.unit};throw new Error("Failed pattern match at ConeCanvas.ConeControl line 355, column 30 - line 361, column 17: "+[a.constructor.name])}throw new Error("Failed pattern match at ConeCanvas.ConeControl line 353, column 22 - line 361, column 17: "+[C.state.value0.value1.constructor.name])}if(!t)return F(n)(r)(new g.CommandingGlobal(E(100-o),C.state.value0.value1));throw new Error("Failed pattern match at ConeCanvas.ConeControl line 352, column 13 - line 362, column 13: "+[t.constructor.name])}()(),function(){var t=c.uncons(C.commandQueue);return t instanceof u.Just&&t.value0.head instanceof h.AnimGlobalView&&t.value0.head.value0&&C.state.value0.value1===!1?function(){return g.modifyPaintRef(n)(r)(function(n){var e={};for(var t in n)n.hasOwnProperty(t)&&(e[t]=n[t]);return e.state=new g.OSAnimate(new g.AniGlobalView(100-o,!0)),e.animateStartTime=a,e.commandQueue=l.tail(C.commandQueue),e})(),e.unit}:t instanceof u.Just&&C.state.value0.value1===!1?function(){return g.modifyPaintRef(n)(r)(function(n){var e={};for(var t in n)n.hasOwnProperty(t)&&(e[t]=n[t]);return e.state=new g.OSAnimate(new g.AniGlobalView(100-o,!0)),e.animateStartTime=a,e})(),e.unit}:e["return"](P.applicativeEff)(e.unit)}()(),e.unit}});if(C.state instanceof g.OSAnimate&&C.state.value0 instanceof g.AniPause){var X=C.animateStartTime+C.state.value0.value0>a;if(X)return function(){return g.modifyPaintRef(n)(r)(function(n){var e={};for(var t in n)n.hasOwnProperty(t)&&(e[t]=n[t]);return e.state=g.OSNormal.value,e})(),t.writeSTRef(C.animatePaintRef)(u.Nothing.value)(),e.unit};if(!X)return e["return"](P.applicativeEff)(e.unit);throw new Error("Failed pattern match at ConeCanvas.ConeControl line 378, column 13 - line 386, column 9: "+[X.constructor.name])}if(C.state instanceof g.OSAnimate&&C.state.value0 instanceof g.AniNull)return f(C);if(C.state instanceof g.OSNormal)return function(){var s=t.readSTRef(C.controlState.needRepaint)();o.when(P.monadEff)(i||s)(function(){return t.writeSTRef(C.animatePaintRef)(u.Nothing.value)(),F(n)(r)(g.CommandingNothing.value)()})();var f=function(){var t=c.uncons(C.commandQueue);if(t instanceof u.Nothing)return e["return"](P.applicativeEff)(u.Nothing.value);if(t instanceof u.Just)return function(){!function(){return t.value0.head instanceof h.AnimCopy?S.bindConst(P.bindEff)(g.modifyPaintRef(n)(r)(function(n){var e={};for(var t in n)n.hasOwnProperty(t)&&(e[t]=n[t]);return e.copySelection=new g.SingleSelection(C.selectionModel),e}))(e["return"](P.applicativeEff)(e.unit)):t.value0.head instanceof h.AnimCut?S.bindConst(P.bindEff)(g.modifyPaintRef(n)(r)(function(n){var e={};for(var t in n)n.hasOwnProperty(t)&&(e[t]=n[t]);return e.copySelection=new g.SingleSelection(C.selectionModel),e}))(e["return"](P.applicativeEff)(e.unit)):e["return"](P.applicativeEff)(e.unit)}()();var o=w.toAnimate(n)(C)(t.value0.head)();return new u.Just(o)};throw new Error("Failed pattern match at ConeCanvas.ConeControl line 393, column 17 - line 402, column 13: "+[t.constructor.name])}()();if(f instanceof u.Just&&f.value0.condNewSelection instanceof u.Nothing&&f.value0.newAnim instanceof g.AniNull)return g.modifyPaintRef(n)(r)(function(n){var e={};for(var t in n)n.hasOwnProperty(t)&&(e[t]=n[t]);return e.commandQueue=l.tail(C.commandQueue),e})(),e.unit;if(f instanceof u.Just&&f.value0.condNewSelection instanceof u.Nothing)return g.modifyPaintRef(n)(r)(function(n){var e={};for(var t in n)n.hasOwnProperty(t)&&(e[t]=n[t]);return e.state=new g.OSAnimate(f.value0.newAnim),e.animateStartTime=a,e.commandQueue=l.tail(C.commandQueue),e})(),e.unit;if(f instanceof u.Just&&f.value0.condNewSelection instanceof u.Just)return g.modifyPaintRef(n)(r)(function(n){var e={};for(var t in n)n.hasOwnProperty(t)&&(e[t]=n[t]);return e.state=new g.OSAnimate(f.value0.newAnim),e.animateStartTime=a,e.selectionModel=f.value0.condNewSelection.value0,e.commandQueue=l.tail(C.commandQueue),e})(),x(n)(r)(f.value0.condNewSelection.value0)(C.selectionModel)();if(f instanceof u.Nothing)return e.unit;throw new Error("Failed pattern match at ConeCanvas.ConeControl line 402, column 13 - line 424, column 5: "+[f.constructor.name])};throw new Error("Failed pattern match at ConeCanvas.ConeControl line 187, column 5 - line 424, column 5: "+[C.state.constructor.name])}()(),e.unit}}}}},q=function(n){return function(t){return function(r){return function(o){return function(a){return function(i){return function(c){return function(l){return function(){var s=g.emptyPaintState(n)(t)(r)("ConeCanvas")(a)(i)(c)(l)(),d=g.newPaintRef(n)(s)(),v={startup:function(n){return g.getConeFront(l).startCanvas(d)(n)},setModel:function(t){return function(){var r=(g.readPaintRef(n)(d)(),[new h.AnimZoom(u.Nothing.value)]);g.modifyPaintRef(n)(d)(function(n){var o={};for(var a in n)n.hasOwnProperty(a)&&(o[a]=n[a]);return o.selectionModel=t,o.commandQueue=e["++"](e.semigroupArray)(n.commandQueue)(r),o})();var o=M();return V(n)(d)(o)(!0)(),e.unit}},getModel:function(){var e=g.readPaintRef(n)(d)();return e.selectionModel},selectPath:function(t){return function(){var r=g.readPaintRef(n)(d)();if(r.selectionModel instanceof h.OSParent)return!1;if(r.selectionModel instanceof h.OSCurrent){var o=p.coneSetPath(n)(r.selectionModel.value0)(t)();if(o instanceof u.Nothing)return!1;if(o instanceof u.Just)return g.modifyPaintRef(n)(d)(function(n){var o={};for(var a in n)n.hasOwnProperty(a)&&(o[a]=n[a]);return o.commandQueue=e["++"](e.semigroupArray)(r.commandQueue)([new h.AnimClockwork(t)]),o})(),!0;throw new Error("Failed pattern match at ConeCanvas.ConeControl line 117, column 35 - line 123, column 68: "+[o.constructor.name])}throw new Error("Failed pattern match at ConeCanvas.ConeControl line 113, column 27 - line 123, column 68: "+[r.selectionModel.constructor.name])}},selectedPath:function(){var e=g.readPaintRef(n)(d)();return p.coneGetPath(p.selGetPos(n)(e.selectionModel))},modelChanged:function(t){return function(){return g.modifyPaintRef(n)(d)(function(n){var e={};for(var r in n)n.hasOwnProperty(r)&&(e[r]=n[r]);return e.modelChangedCallback=new u.Just(t),e})(),e.unit}},selectedChanged:function(t){return function(){return g.modifyPaintRef(n)(d)(function(n){var e={};for(var r in n)n.hasOwnProperty(r)&&(e[r]=n[r]);return e.selectedChangedCallback=new u.Just(t),e})(),e.unit}},animate:function(t){return function(){g.modifyPaintRef(n)(d)(function(n){var r={};for(var o in n)n.hasOwnProperty(o)&&(r[o]=n[o]);return r.commandQueue=e["++"](e.semigroupArray)(n.commandQueue)(t),r})();var r=M();return V(n)(d)(r)(!0)(),e.unit}},animateFinishedCallback:function(t){return function(){return g.modifyPaintRef(n)(d)(function(n){var e={};for(var r in n)n.hasOwnProperty(r)&&(e[r]=n[r]);return e.callback=t,e})(),e.unit}},keyCallback:function(t){return function(){return g.modifyPaintRef(n)(d)(function(n){var e={};for(var r in n)n.hasOwnProperty(r)&&(e[r]=n[r]);return e.keyCallback=t,e})(),e.unit}},alertCallback:function(t){return function(){return g.modifyPaintRef(n)(d)(function(n){var e={};for(var r in n)n.hasOwnProperty(r)&&(e[r]=n[r]);return e.alertCallback=t,e})(),e.unit}},loadIconCallback:function(t){return f["*>"](P.applyEff)(g.modifyPaintRef(n)(d)(function(n){var e={};for(var r in n)n.hasOwnProperty(r)&&(e[r]=n[r]);return e.loadIconCallback=t,e}))(e["return"](P.applicativeEff)(e.unit))},loadSTLCallback:function(t){return f["*>"](P.applyEff)(g.modifyPaintRef(n)(d)(function(n){var e={};for(var r in n)n.hasOwnProperty(r)&&(e[r]=n[r]);return e.loadSTLCallback=t,e}))(e["return"](P.applicativeEff)(e.unit))},cycleCallback:function(t){return f["*>"](P.applyEff)(g.modifyPaintRef(n)(d)(function(n){var e={};for(var r in n)n.hasOwnProperty(r)&&(e[r]=n[r]);return e.cycleCallback=t,e}))(e["return"](P.applicativeEff)(e.unit))}};return function(){if(o instanceof u.Nothing)return e["return"](P.applicativeEff)(e.unit);if(o instanceof u.Just)return f["*>"](P.applyEff)(g.modifyPaintRef(n)(d)(function(n){var e={};for(var t in n)n.hasOwnProperty(t)&&(e[t]=n[t]);return e.prefs=o.value0,e}))(e["return"](P.applicativeEff)(e.unit));throw new Error("Failed pattern match at ConeCanvas.ConeControl line 158, column 5 - line 161, column 5: "+[o.constructor.name])}()(),g.modifyPaintRef(n)(d)(function(n){var e={};for(var t in n)n.hasOwnProperty(t)&&(e[t]=n[t]);return e.controlState=function(){var e={};for(var t in n.controlState)n.controlState.hasOwnProperty(t)&&(e[t]=n.controlState[t]);return e.showControl=n.prefs.controlAreaInitialVisible,e}(),e})(),v}}}}}}}}};n.getMillisecondsTime=M,n.stepTime=b,n.keyAction=_,n.scrollNotified=A,n.motionNotified=N,n.releasedButton=j,n.pressedButton=I,n.animateFunc=V,n.initConeCanvas=q}(PS["ConeCanvas.ConeControl"]=PS["ConeCanvas.ConeControl"]||{}),function(n){"use strict";var e=PS.Prelude,t=(PS["Data.Maybe"],PS["Data.Either"]),r=PS["Data.List"],o=PS["Data.Traversable"],a=PS["Data.String"],i=PS["ConeCanvas.ConeModel"],u=PS["Control.Monad.Eff"],c=PS["Data.Foldable"],l=function(n){return function(a){return function(s){return function(f){return function(){var d=i.nodeGetChildren(n)(f)(),v=o.sequence(r.traversableList)(u.applicativeEff)(e.map(r.functorList)(l(n)(a)(s))(d))(),m=r.concat(v),h=a(f.value0.entry)(s),p=r["null"](m);if(p)return r.toList(c.foldableArray)([new i.ConeNode({entry:f.value0.entry,nodeId:0,firstInd:0,children:new t.Right(r.Nil.value)})]);if(!p){var w=!h;if(w)return m;if(!w)return r.toList(c.foldableArray)([new i.ConeNode({entry:f.value0.entry,nodeId:0,firstInd:0,children:new t.Right(m)})]);throw new Error("Failed pattern match at ConeCanvas.ConeFilter line 32, column 13 - line 37, column 1: "+[w.constructor.name])}throw new Error("Failed pattern match at ConeCanvas.ConeFilter line 29, column 5 - line 37, column 1: "+[p.constructor.name])}}}}},s=function(n){return l(n)(function(e){return function(t){return a.contains(t)(i.label(n)(e))}})};n.filterContainsString=s,n.filterConeNode=l}(PS["ConeCanvas.ConeFilter"]=PS["ConeCanvas.ConeFilter"]||{}),function(n){"use strict";n.rotateSTX=function(n){return function(e){return function(){var t=Math.cos(n),r=Math.sin(n),o=e[4]*t+e[8]*r,a=e[5]*t+e[9]*r,i=e[6]*t+e[10]*r,u=e[7]*t+e[11]*r,c=e[4]*-r+e[8]*t,l=e[5]*-r+e[9]*t,s=e[6]*-r+e[10]*t,f=e[7]*-r+e[11]*t;e[4]=o,e[5]=a,e[6]=i,e[7]=u,e[8]=c,e[9]=l,e[10]=s,e[11]=f}}},n.rotateSTY=function(n){return function(e){return function(){var t=Math.cos(n),r=Math.sin(n),o=e[0]*t+e[8]*-r,a=e[1]*t+e[9]*-r,i=e[2]*t+e[10]*-r,u=e[3]*t+e[11]*-r,c=e[0]*r+e[8]*t,l=e[1]*r+e[9]*t,s=e[2]*r+e[10]*t,f=e[3]*r+e[11]*t;e[0]=o,e[1]=a,e[2]=i,e[3]=u,e[8]=c,e[9]=l,e[10]=s,e[11]=f}}},n.translateST=function(n){return function(e){return function(){for(var t=0;4>t;t++)e[t+12]+=e[t]*n[0]+e[t+4]*n[1]+e[t+8]*n[2]}}},n.scaleST3=function(n){return function(e){return function(t){return function(r){return function(){r[0]=r[0]*n,r[1]=r[1]*n,r[2]=r[2]*n,r[3]=r[3]*n,r[4]=r[4]*e,r[5]=r[5]*e,r[6]=r[6]*e,r[7]=r[7]*e,r[8]=r[8]*t,r[9]=r[9]*t,r[10]=r[10]*t,r[11]=r[11]*t}}}}}}(PS["Data.ST.Matrix4"]=PS["Data.ST.Matrix4"]||{}),function(n){"use strict";var e=PS.Prelude,t=PS["Data.TypeNat"],r=PS["Data.Array"],o=(PS["Data.Maybe.Unsafe"],PS["Type.Proxy"]),a=PS.Extensions,i=function(n){return n},u=function(n){return n},c=function(n){return function(a){var u=t.sized(n)(o.Proxy.value);return i(r.concat(e["<$>"](e.functorArray)(function(n){return e["<$>"](e.functorArray)(function(e){return a(n)(e)})(r.range(0)(u-1))})(r.range(0)(u-1))))}},l=function(n){return c(n)(function(n){return function(e){var t=n===e;if(t)return 1;if(!t)return 0;throw new Error("Failed pattern match at Data.Matrix line 85, column 31 - line 88, column 1: "+[t.constructor.name])}})},s=function(n){return function(i){var u=t.sized(n)(o.Proxy.value),c=u*u|0;if(c===r.length(i))return i;if(e.otherwise)return a.fail("Matrix>>fromArray: Wrong array length!");throw new Error("Failed pattern match at Data.Matrix line 107, column 6 - line 111, column 1: "+[c.constructor.name])}};n.Mat=i,n.toArray=u,n.fromArray=s,n["identity'"]=l,n.generate=c}(PS["Data.Matrix"]=PS["Data.Matrix"]||{}),function(n){"use strict";var e=PS.Prelude,t=(PS["Data.TypeNat"],PS["Data.Matrix"],PS["Data.Vector3"]),r=(PS["Data.Vector4"],PS["Data.Vector"]),o=PS["Data.Maybe"],a=(PS.Math,PS.Extensions),i=function(n){return function(e){return function(t){return function(r){if(3===n.length&&16===e.length&&16===t.length&&4===r.length){var i=[e[0]*n[0]+e[4]*n[1]+e[8]*n[2]+e[12],e[1]*n[0]+e[5]*n[1]+e[9]*n[2]+e[13],e[2]*n[0]+e[6]*n[1]+e[10]*n[2]+e[14],e[3]*n[0]+e[7]*n[1]+e[11]*n[2]+e[15]];if(4===i.length){var u=[t[0]*i[0]+t[4]*i[1]+t[8]*i[2]+t[12]*i[3],t[1]*i[0]+t[5]*i[1]+t[9]*i[2]+t[13]*i[3],t[2]*i[0]+t[6]*i[1]+t[10]*i[2]+t[14]*i[3],-i[2]];if(4===u.length){var c=0===u[3];if(c)return o.Nothing.value;if(!c){var l=1/u[3],s=u[2]*l,f=u[1]*l,d=u[0]*l;return new o.Just([(.5*d+.5)*r[2]+r[0],(.5*f+.5)*r[3]+r[1],.5*(1+s)])}throw new Error("Failed pattern match at Data.Matrix4 line 396, column 21 - line 410, column 17: "+[c.constructor.name])}return a.fail("Matrix4>>project: Impossible!")}return a.fail("Matrix4>>project: Impossible!")}return a.fail("Matrix4>>project: Impossible!")}}}},u=function(n){return function(e){return 16===n.length&&4===e.length?[n[0]*e[0]+n[4]*e[1]+n[8]*e[2]+n[12]*e[3],n[1]*e[0]+n[5]*e[1]+n[9]*e[2]+n[13]*e[3],n[2]*e[0]+n[6]*e[1]+n[10]*e[2]+n[14]*e[3],n[3]*e[0]+n[7]*e[1]+n[11]*e[2]+n[15]*e[3]]:a.fail("Matrix4>>mulMatVect: Impossible!")}},c=function(n){return function(e){return 16===n.length&&16===e.length?[n[0]*e[0]+n[4]*e[1]+n[8]*e[2]+n[12]*e[3],n[1]*e[0]+n[5]*e[1]+n[9]*e[2]+n[13]*e[3],n[2]*e[0]+n[6]*e[1]+n[10]*e[2]+n[14]*e[3],n[3]*e[0]+n[7]*e[1]+n[11]*e[2]+n[15]*e[3],n[0]*e[4]+n[4]*e[5]+n[8]*e[6]+n[12]*e[7],n[1]*e[4]+n[5]*e[5]+n[9]*e[6]+n[13]*e[7],n[2]*e[4]+n[6]*e[5]+n[10]*e[6]+n[14]*e[7],n[3]*e[4]+n[7]*e[5]+n[11]*e[6]+n[15]*e[7],n[0]*e[8]+n[4]*e[9]+n[8]*e[10]+n[12]*e[11],n[1]*e[8]+n[5]*e[9]+n[9]*e[10]+n[13]*e[11],n[2]*e[8]+n[6]*e[9]+n[10]*e[10]+n[14]*e[11],n[3]*e[8]+n[7]*e[9]+n[11]*e[10]+n[15]*e[11],n[0]*e[12]+n[4]*e[13]+n[8]*e[14]+n[12]*e[15],n[1]*e[12]+n[5]*e[13]+n[9]*e[14]+n[13]*e[15],n[2]*e[12]+n[6]*e[13]+n[10]*e[14]+n[14]*e[15],n[3]*e[12]+n[7]*e[13]+n[11]*e[14]+n[15]*e[15]]:a.fail("Matrix4>>mulM: Impossible!")}},l=function(n){return function(e){return function(t){return function(r){return function(o){return function(a){var i=-2/(a-o),u=2/(r-t),c=2/(e-n),l=-(a+o)/(a-o),s=-(r+t)/(r-t),f=-(e+n)/(e-n);return[c,0,0,0,0,u,0,0,0,0,i,0,f,s,l,1]}}}}}},s=function(n){return function(e){return function(t){return function(r){return l(n)(e)(t)(r)(-1)(1)}}}},f=function(n){return function(o){return function(i){if(3===n.length){var u=r.direction(n)(o);if(3===u.length){var l=r.normalize(t.cross(e.numNumber)(i)(u));if(3===l.length){var s=r.normalize(t.cross(e.numNumber)(u)(l));if(3===s.length){var f=[1,0,0,0,0,1,0,0,0,0,1,0,-n[0],-n[1],-n[2],1],d=[l[0],s[0],u[0],0,l[1],s[1],u[1],0,l[2],s[2],u[2],0,0,0,0,1];return c(d)(f)}return a.fail("Matrix4>>makeRotate: Impossible!")}return a.fail("Matrix4>>makeRotate: Impossible!")}return a.fail("Matrix4>>makeRotate: Impossible!")}return a.fail("Matrix4>>makeLookAt: Impossible!")}}},d=function(n){return function(e){return function(t){return function(r){return function(o){return function(a){return[2*o/(e-n),0,0,0,0,2*o/(r-t),0,0,(e+n)/(e-n),(r+t)/(r-t),-(a+o)/(a-o),-1,0,0,-2*a*o/(a-o),0]}}}}}},v=function(n){if(16===n.length){var e=n[10]*n[15]-n[11]*n[14],t=n[9]*n[15]-n[11]*n[13],r=n[9]*n[14]-n[10]*n[13],i=n[8]*n[15]-n[11]*n[12],u=n[8]*n[14]-n[10]*n[12],c=n[8]*n[13]-n[9]*n[12],l=n[2]*n[7]-n[3]*n[6],s=n[1]*n[7]-n[3]*n[5],f=n[1]*n[6]-n[2]*n[5],d=n[0]*n[7]-n[3]*n[4],v=n[0]*n[6]-n[2]*n[4],m=n[0]*n[5]-n[1]*n[4],h=m*e-v*t+d*r+f*i-s*u+l*c,p=0===h;if(p)return o.Nothing.value;if(!p){var w=1/h;return o.Just.create([(n[5]*e-n[6]*t+n[7]*r)*w,(-n[1]*e+n[2]*t-n[3]*r)*w,(n[13]*l-n[14]*s+n[15]*f)*w,(-n[9]*l+n[10]*s-n[11]*f)*w,(-n[4]*e+n[6]*i-n[7]*u)*w,(n[0]*e-n[2]*i+n[3]*u)*w,(-n[12]*l+n[14]*d-n[15]*v)*w,(n[8]*l-n[10]*d+n[11]*v)*w,(n[4]*t-n[5]*i+n[7]*c)*w,(-n[0]*t+n[1]*i-n[3]*c)*w,(n[12]*s-n[13]*d+n[15]*m)*w,(-n[8]*s+n[9]*d-n[11]*m)*w,(-n[4]*r+n[5]*u-n[6]*c)*w,(n[0]*r-n[1]*u+n[2]*c)*w,(-n[12]*f+n[13]*v-n[14]*m)*w,(n[8]*f-n[9]*v+n[10]*m)*w])}throw new Error("Failed pattern match at Data.Matrix4 line 85, column 8 - line 104, column 1: "+[p.constructor.name])}return a.fail("Matrix4>>inverse: Impossible!")},m=function(n){return function(e){return function(t){return function(r){if(3===n.length&&4===r.length){var i=c(t)(e),l=v(i);if(l instanceof o.Nothing)return o.Nothing.value;if(l instanceof o.Just){var s=[(n[0]-r[0])/r[2]*2-1,(n[1]-r[1])/r[3]*2-1,2*n[2]-1,1],f=u(l.value0)(s);if(4===f.length){var d=0===f[3];if(d)return o.Nothing.value;if(!d){var m=1/f[3];return new o.Just([f[0]*m,f[1]*m,f[2]*m])}throw new Error("Failed pattern match at Data.Matrix4 line 436, column 29 - line 440, column 25: "+[d.constructor.name])}return a.fail("Matrix4>>unProject: Impossible!")}throw new Error("Failed pattern match at Data.Matrix4 line 427, column 8 - line 441, column 1: "+[l.constructor.name])}return a.fail("Matrix4>>unProject: Impossible!")}}}},h=[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1];n.mulMatVect=u,n.unProject=m,n.project=i,n.makeLookAt=f,n.mulM=c,n.makeOrtho2D=s,n.makeOrtho=l,n.makeFrustum=d,n.inverse=v,n.identity=h}(PS["Data.Matrix4"]=PS["Data.Matrix4"]||{}),function(n){"use strict";
n.copyImpl=function(n){return function(){var e=n.slice();return e}},n.copyToSTMat=function(n){return function(e){return function(){for(var t=0;t<n.length;t++)e[t]=n[t];return{}}}}}(PS["Data.ST.Matrix"]=PS["Data.ST.Matrix"]||{}),function(n){"use strict";var e=PS["Data.ST.Matrix"],t=PS.Prelude,r=PS["Control.Monad.Eff"],o=(PS["Control.Monad.ST"],PS["Data.TypeNat"],PS["Data.Array.ST"],PS["Control.Apply"],PS["Data.Matrix"]),a=function(n){return n},i=e.copyImpl,u=function(n){var e=o["identity'"](n);return t["<$>"](r.functorEff)(a)(i(o.toArray(e)))},c=e.copyImpl,l=function(n){return function(e){return function(){var t=c(e)();return o.fromArray(n)(t)}}};n.STMat=a,n["identityST'"]=u,n.fromSTMat=l,n.thaw=i,n.freeze=c,n.copyToSTMat=e.copyToSTMat}(PS["Data.ST.Matrix"]=PS["Data.ST.Matrix"]||{}),function(n){"use strict";var e=PS["Data.ST.Matrix4"];PS.Prelude,PS["Data.TypeNat"],PS["Data.Matrix4"],PS["Data.ST.Matrix"],PS["Control.Monad.Eff"],PS["Control.Monad.ST"];n.scaleST3=e.scaleST3,n.translateST=e.translateST,n.rotateSTY=e.rotateSTY,n.rotateSTX=e.rotateSTX}(PS["Data.ST.Matrix4"]=PS["Data.ST.Matrix4"]||{}),function(n){"use strict";n.shaderBindings_=function(n){return function(){for(var e={},t=gl.getProgramParameter(n,gl.ACTIVE_UNIFORMS),r=0;t>r;r+=1){var o=gl.getActiveUniform(n,r),a=gl.getUniformLocation(n,o.name),i={};i.uLocation=a,i.uName=o.name,i.uType=o.type,e[o.name]=i}for(var u=gl.getProgramParameter(n,gl.ACTIVE_ATTRIBUTES),c=0;u>c;c+=1){var l=gl.getActiveAttrib(n,c),s=gl.getAttribLocation(n,l.name);gl.enableVertexAttribArray(s);var f={};switch(f.aLocation=s,f.aName=l.name,f.aItemType=l.type,l.type){case gl.FLOAT_VEC2:f.aItemSize=2;break;case gl.FLOAT_VEC3:f.aItemSize=3;break;case gl.FLOAT_VEC4:f.aItemSize=4;break;default:LOG("Unsupported attribute type: "+l.type),f.aItemSize=1}e[l.name]=f}return e}},n.initGL_=function(n,e){return function(){var t=document.getElementById(n);try{gl=t.getContext("webgl",e)||t.getContext("experimental-webgl",e)}catch(r){return!1}return gl?!0:(gl=null,!1)}},n.getCanvasWidth_=function(n){return function(){var e=document.getElementById(n);return e.width}},n.getCanvasHeight_=function(n){return function(){var e=document.getElementById(n);return e.height}},n.requestAnimationFrame_=function(n){if("undefined"==typeof e)var e=function(){return window.requestAnimationFrame||window.webkitRequestAnimationFrame||window.mozRequestAnimationFrame||function(n){window.setTimeout(n,1e3/60)}}();return function(){return e(n)}},n.bufferData__=function(n,e,t){return function(){gl.bufferData(n,e,t)}}}(PS["Graphics.WebGL"]=PS["Graphics.WebGL"]||{}),function(n){"use strict";n.runWebGl_=function(n){return n}}(PS["Control.Monad.Eff.WebGL"]=PS["Control.Monad.Eff.WebGL"]||{}),function(n){"use strict";var e=PS["Control.Monad.Eff.WebGL"];PS["Control.Monad.Eff"];n.runWebGl_=e.runWebGl_}(PS["Control.Monad.Eff.WebGL"]=PS["Control.Monad.Eff.WebGL"]||{}),function(n){"use strict";n.activeTexture_=function(n){return function(){gl.activeTexture(n)}},n.attachShader_=function(n,e){return function(){gl.attachShader(n,e)}},n.bindAttribLocation_=function(n,e,t){return function(){gl.bindAttribLocation(n,e,t)}},n.bindBuffer_=function(n,e){return function(){gl.bindBuffer(n,e)}},n.bindFramebuffer_=function(n,e){return function(){gl.bindFramebuffer(n,e)}},n.bindTexture_=function(n,e){return function(){gl.bindTexture(n,e)}},n.blendFunc_=function(n,e){return function(){gl.blendFunc(n,e)}},n.bufferSubData_=function(n,e,t){return function(){gl.bufferSubData(n,e,t)}},n.checkFramebufferStatus_=function(n){return function(){var e=gl.checkFramebufferStatus(n);if(void 0===e)throw"Undefined in  checkFramebufferStatus";return e}},n.clear_=function(n){return function(){gl.clear(n)}},n.clearColor_=function(n,e,t,r){return function(){gl.clearColor(n,e,t,r)}},n.clearDepth_=function(n){return function(){gl.clearDepth(n)}},n.colorMask_=function(n,e,t,r){return function(){gl.colorMask(n,e,t,r)}},n.compileShader_=function(n){return function(){gl.compileShader(n)}},n.createBuffer_=function(){return function(){var n=gl.createBuffer();if(void 0===n)throw"Undefined in  createBuffer";return n}},n.createFramebuffer_=function(){return function(){var n=gl.createFramebuffer();if(void 0===n)throw"Undefined in  createFramebuffer";return n}},n.createProgram_=function(){return function(){var n=gl.createProgram();if(void 0===n)throw"Undefined in  createProgram";return n}},n.createShader_=function(n){return function(){var e=gl.createShader(n);if(void 0===e)throw"Undefined in  createShader";return e}},n.createTexture_=function(){return function(){var n=gl.createTexture();if(void 0===n)throw"Undefined in  createTexture";return n}},n.depthFunc_=function(n){return function(){gl.depthFunc(n)}},n.disable_=function(n){return function(){gl.disable(n)}},n.disableVertexAttribArray_=function(n){return function(){gl.disableVertexAttribArray(n)}},n.drawArrays_=function(n,e,t){return function(){gl.drawArrays(n,e,t)}},n.drawElements_=function(n,e,t,r){return function(){gl.drawElements(n,e,t,r)}},n.enable_=function(n){return function(){gl.enable(n)}},n.enableVertexAttribArray_=function(n){return function(){gl.enableVertexAttribArray(n)}},n.framebufferTexture2D_=function(n,e,t,r,o){return function(){gl.framebufferTexture2D(n,e,t,r,o)}},n.generateMipmap_=function(n){return function(){gl.generateMipmap(n)}},n.getProgramParameter_=function(n,e){return function(){var t=gl.getProgramParameter(n,e);if(void 0===t)throw"Undefined in  getProgramParameter";return t}},n.getShaderParameter_=function(n,e){return function(){var t=gl.getShaderParameter(n,e);if(void 0===t)throw"Undefined in  getShaderParameter";return t}},n.getShaderInfoLog_=function(n){return function(){var e=gl.getShaderInfoLog(n);if(void 0===e)throw"Undefined in  getShaderInfoLog";return e}},n.linkProgram_=function(n){return function(){gl.linkProgram(n)}},n.pixelStorei_=function(n,e){return function(){gl.pixelStorei(n,e)}},n.shaderSource_=function(n,e){return function(){gl.shaderSource(n,e)}},n.texImage2D_=function(n,e,t,r,o,a,i,u,c){return function(){gl.texImage2D(n,e,t,r,o,a,i,u,c)}},n.texParameteri_=function(n,e,t){return function(){gl.texParameteri(n,e,t)}},n.uniform1f_=function(n,e){return function(){gl.uniform1f(n,e)}},n.uniform1i_=function(n,e){return function(){gl.uniform1i(n,e)}},n.uniform2fv_=function(n,e){return function(){gl.uniform2fv(n,e)}},n.uniform3fv_=function(n,e){return function(){gl.uniform3fv(n,e)}},n.uniform4fv_=function(n,e){return function(){gl.uniform4fv(n,e)}},n.uniformMatrix2fv_=function(n,e,t){return function(){gl.uniformMatrix2fv(n,e,t)}},n.uniformMatrix3fv_=function(n,e,t){return function(){gl.uniformMatrix3fv(n,e,t)}},n.uniformMatrix4fv_=function(n,e,t){return function(){gl.uniformMatrix4fv(n,e,t)}},n.useProgram_=function(n){return function(){gl.useProgram(n)}},n.vertexAttribPointer_=function(n,e,t,r,o,a){return function(){gl.vertexAttribPointer(n,e,t,r,o,a)}},n.viewport_=function(n,e,t,r){return function(){gl.viewport(n,e,t,r)}}}(PS["Graphics.WebGLRaw"]=PS["Graphics.WebGLRaw"]||{}),function(n){"use strict";var e=PS["Graphics.WebGLRaw"],t=(PS["Control.Monad.Eff"],PS["Control.Monad.Eff.WebGL"],PS["Data.ArrayBuffer.Types"],PS["Data.Function"],PS.Prelude,0),r=35633,o=33635,a=32820,i=32819,u=5123,c=5121,l=37441,s=37440,f=37443,d=3317,v=5,m=6,h=4,p=10243,w=10242,g=10241,C=10240,S=34073,P=34071,y=34069,T=34074,b=34072,E=34070,x=34067,F=3553,A=33984,N=1024,_=36128,D=35044,M=768,L=776,I=770,O=3089,R=6408,k=6407,U=32823,G=0,B=3333,J=769,$=771,H=775,z=773,W=32770,j=32772,V=1,q=517,Z=512,K=9728,X=35661,Y=6410,Q=6409,nn=35714,en=3,tn=2,rn=1,on=9985,an=9729,un=513,cn=515,ln=516,sn=518,fn=36160,dn=35632,vn=35666,mn=35665,hn=35664,pn=35676,wn=35675,gn=35674,Cn=5126,Sn=514,Pn=34963,yn=35048,Tn=774,bn=772,En=2929,xn=33306,Fn=256,An=36096,Nn=2884,_n=32769,Dn=32771,Mn=35713,Ln=16384,In=36064,On=33071,Rn=35670,kn=32969,Un=32971,Gn=32968,Bn=32970,Jn=32773,$n=3042,Hn=34962,zn=519,Wn=6406;n._UNPACK_COLORSPACE_CONVERSION_WEBGL=f,n._UNPACK_PREMULTIPLY_ALPHA_WEBGL=l,n._UNPACK_FLIP_Y_WEBGL=s,n._DEPTH_STENCIL_ATTACHMENT=xn,n._STENCIL_ATTACHMENT=_,n._DEPTH_ATTACHMENT=An,n._COLOR_ATTACHMENT0=In,n._FRAMEBUFFER=fn,n._COMPILE_STATUS=Mn,n._FLOAT_MAT4=pn,n._FLOAT_MAT3=wn,n._FLOAT_MAT2=gn,n._BOOL=Rn,n._FLOAT_VEC4=vn,n._FLOAT_VEC3=mn,n._FLOAT_VEC2=hn,n._CLAMP_TO_EDGE=On,n._TEXTURE0=A,n._TEXTURE_CUBE_MAP_NEGATIVE_Z=T,n._TEXTURE_CUBE_MAP_POSITIVE_Z=S,n._TEXTURE_CUBE_MAP_NEGATIVE_Y=b,n._TEXTURE_CUBE_MAP_POSITIVE_Y=P,n._TEXTURE_CUBE_MAP_NEGATIVE_X=E,n._TEXTURE_CUBE_MAP_POSITIVE_X=y,n._TEXTURE_CUBE_MAP=x,n._TEXTURE_WRAP_T=p,n._TEXTURE_WRAP_S=w,n._TEXTURE_MIN_FILTER=g,n._TEXTURE_MAG_FILTER=C,n._LINEAR_MIPMAP_NEAREST=on,n._LINEAR=an,n._NEAREST=K,n._ALWAYS=zn,n._GEQUAL=sn,n._NOTEQUAL=q,n._GREATER=ln,n._LEQUAL=cn,n._EQUAL=Sn,n._LESS=un,n._NEVER=Z,n._LINK_STATUS=nn,n._MAX_COMBINED_TEXTURE_IMAGE_UNITS=X,n._VERTEX_SHADER=r,n._FRAGMENT_SHADER=dn,n._UNSIGNED_SHORT_5_6_5=o,n._UNSIGNED_SHORT_5_5_5_1=a,n._UNSIGNED_SHORT_4_4_4_4=i,n._LUMINANCE_ALPHA=Y,n._LUMINANCE=Q,n._RGBA=R,n._RGB=k,n._ALPHA=Wn,n._FLOAT=Cn,n._UNSIGNED_SHORT=u,n._UNSIGNED_BYTE=c,n._PACK_ALIGNMENT=B,n._UNPACK_ALIGNMENT=d,n._POLYGON_OFFSET_FILL=U,n._SCISSOR_TEST=O,n._DEPTH_TEST=En,n._BLEND=$n,n._CULL_FACE=Nn,n._TEXTURE_2D=F,n._DYNAMIC_DRAW=yn,n._STATIC_DRAW=D,n._ELEMENT_ARRAY_BUFFER=Pn,n._ARRAY_BUFFER=Hn,n._BLEND_COLOR=Jn,n._ONE_MINUS_CONSTANT_ALPHA=j,n._CONSTANT_ALPHA=Dn,n._ONE_MINUS_CONSTANT_COLOR=W,n._CONSTANT_COLOR=_n,n._BLEND_SRC_ALPHA=Un,n._BLEND_DST_ALPHA=Bn,n._BLEND_SRC_RGB=kn,n._BLEND_DST_RGB=Gn,n._SRC_ALPHA_SATURATE=L,n._ONE_MINUS_DST_COLOR=H,n._DST_COLOR=Tn,n._ONE_MINUS_DST_ALPHA=z,n._DST_ALPHA=bn,n._ONE_MINUS_SRC_ALPHA=$,n._SRC_ALPHA=I,n._ONE_MINUS_SRC_COLOR=J,n._SRC_COLOR=M,n._ONE=V,n._ZERO=t,n._TRIANGLE_FAN=m,n._TRIANGLE_STRIP=v,n._TRIANGLES=h,n._LINE_STRIP=en,n._LINE_LOOP=tn,n._LINES=rn,n._POINTS=G,n._COLOR_BUFFER_BIT=Ln,n._STENCIL_BUFFER_BIT=N,n._DEPTH_BUFFER_BIT=Fn,n.viewport_=e.viewport_,n.vertexAttribPointer_=e.vertexAttribPointer_,n.useProgram_=e.useProgram_,n.uniformMatrix4fv_=e.uniformMatrix4fv_,n.uniformMatrix3fv_=e.uniformMatrix3fv_,n.uniformMatrix2fv_=e.uniformMatrix2fv_,n.uniform4fv_=e.uniform4fv_,n.uniform3fv_=e.uniform3fv_,n.uniform2fv_=e.uniform2fv_,n.uniform1i_=e.uniform1i_,n.uniform1f_=e.uniform1f_,n.texParameteri_=e.texParameteri_,n.texImage2D_=e.texImage2D_,n.shaderSource_=e.shaderSource_,n.pixelStorei_=e.pixelStorei_,n.linkProgram_=e.linkProgram_,n.getShaderInfoLog_=e.getShaderInfoLog_,n.getShaderParameter_=e.getShaderParameter_,n.getProgramParameter_=e.getProgramParameter_,n.generateMipmap_=e.generateMipmap_,n.framebufferTexture2D_=e.framebufferTexture2D_,n.enableVertexAttribArray_=e.enableVertexAttribArray_,n.enable_=e.enable_,n.drawElements_=e.drawElements_,n.drawArrays_=e.drawArrays_,n.disableVertexAttribArray_=e.disableVertexAttribArray_,n.disable_=e.disable_,n.depthFunc_=e.depthFunc_,n.createTexture_=e.createTexture_,n.createShader_=e.createShader_,n.createProgram_=e.createProgram_,n.createFramebuffer_=e.createFramebuffer_,n.createBuffer_=e.createBuffer_,n.compileShader_=e.compileShader_,n.colorMask_=e.colorMask_,n.clearDepth_=e.clearDepth_,n.clearColor_=e.clearColor_,n.clear_=e.clear_,n.checkFramebufferStatus_=e.checkFramebufferStatus_,n.bufferSubData_=e.bufferSubData_,n.blendFunc_=e.blendFunc_,n.bindTexture_=e.bindTexture_,n.bindFramebuffer_=e.bindFramebuffer_,n.bindBuffer_=e.bindBuffer_,n.bindAttribLocation_=e.bindAttribLocation_,n.attachShader_=e.attachShader_,n.activeTexture_=e.activeTexture_}(PS["Graphics.WebGLRaw"]=PS["Graphics.WebGLRaw"]||{}),function(n){"use strict";n.asUint8Array=function(n){var e=new Uint8Array(n);return e},n.asUint16Array=function(n){var e=new Uint16Array(n);return e},n.asFloat32Array=function(n){var e=new Float32Array(n);return e},n.newUint8Array=function(n){var e=new Uint8Array(n);return e},n.asArray=function(n){var e=Array.prototype.slice.call(n);return e},n.length=function(n){return n.length}}(PS["Data.TypedArray"]=PS["Data.TypedArray"]||{}),function(n){"use strict";var e=PS["Data.TypedArray"];PS["Data.ArrayBuffer.Types"],PS["Data.Maybe"],PS.Prelude;n.asArray=e.asArray,n.newUint8Array=e.newUint8Array,n.asFloat32Array=e.asFloat32Array,n.asUint16Array=e.asUint16Array,n.asUint8Array=e.asUint8Array}(PS["Data.TypedArray"]=PS["Data.TypedArray"]||{}),function(n){"use strict";var e=PS["Graphics.WebGL"],t=PS.Prelude,r=PS["Control.Monad.Eff.WebGL"],o=PS["Graphics.WebGLRaw"],a=(PS["Data.ArrayBuffer.Types"],PS["Data.TypedArray"]),i=(PS["Control.Monad.Eff"],PS["Data.Foldable"]),u=PS["Data.Maybe"],c=PS["Data.Array.Unsafe"],l=PS["Data.Array"],s=PS["Data.Either"],f=PS["Data.Int.Bits"],d=PS["Data.Function"],v=PS.Extensions,m=function(){function n(n,e){this.value0=n,this.value1=e}return n.create=function(e){return function(t){return new n(e,t)}},n}(),h=function(){function n(){}return n.value=new n,n}(),p=function(){function n(){}return n.value=new n,n}(),w=function(){function n(){}return n.value=new n,n}(),g=function(){function n(){}return n.value=new n,n}(),C=function(){function n(){}return n.value=new n,n}(),S=function(){function n(){}return n.value=new n,n}(),P=function(){function n(){}return n.value=new n,n}(),y=function(){function n(){}return n.value=new n,n}(),T=function(){function n(){}return n.value=new n,n}(),b=function(){function n(){}return n.value=new n,n}(),E=function(){function n(){}return n.value=new n,n}(),x=function(){function n(){}return n.value=new n,n}(),F=function(){function n(){}return n.value=new n,n}(),A=function(){function n(){}return n.value=new n,n}(),N=function(){function n(){}return n.value=new n,n}(),_=function(){function n(){}return n.value=new n,n}(),D=function(){function n(){}return n.value=new n,n}(),M=function(){function n(){}return n.value=new n,n}(),L=function(){function n(){}return n.value=new n,n}(),I=function(){function n(){}return n.value=new n,n}(),O=function(){function n(){}return n.value=new n,n}(),R=function(){function n(){}return n.value=new n,n}(),k=function(){function n(){}return n.value=new n,n}(),U=function(){function n(){}return n.value=new n,n}(),G=function(){function n(){}return n.value=new n,n}(),B=function(){function n(){}return n.value=new n,n}(),J=function(){function n(){}return n.value=new n,n}(),$=function(){function n(){}return n.value=new n,n}(),H=function(){function n(){}return n.value=new n,n}(),z=function(){function n(){}return n.value=new n,n}(),W=function(){function n(){}return n.value=new n,n}(),j=function(){function n(){}return n.value=new n,n}(),V=function(){function n(){}return n.value=new n,n}(),q=function(){function n(){}return n.value=new n,n}(),Z=function(){function n(){}return n.value=new n,n}(),K=function(){function n(){}return n.value=new n,n}(),X=function(){function n(){}return n.value=new n,n}(),Y=function(){function n(){}return n.value=new n,n}(),Q=function(){function n(){}return n.value=new n,n}(),nn=function(){function n(){}return n.value=new n,n}(),en=function(){function n(){}return n.value=new n,n}(),tn=function(){function n(){}return n.value=new n,n}(),rn=function(){function n(){}return n.value=new n,n}(),on=function(){function n(){}return n.value=new n,n}(),an=function(){function n(){}return n.value=new n,n}(),un=function(){function n(){}return n.value=new n,n}(),cn=function(){function n(){}return n.value=new n,n}(),ln=d.runFn4(o.viewport_),sn=function(n){return o.vertexAttribPointer_(n.aLocation,n.aItemSize,o._FLOAT,!1,0,0)},fn=function(n){return function(e){if(n.uType===o._BOOL){var r=function(n){if(n)return 1;if(!n)return 0;throw new Error("Failed pattern match at Graphics.WebGL line 282, column 7 - line 283, column 7: "+[n.constructor.name])};return o.uniform1i_(n.uLocation,r(e))}if(t.otherwise)return v.fail("WebGL>>setUniformBoolean: Called for not boolean uniform!");throw new Error("Failed pattern match at Graphics.WebGL line 279, column 1 - line 286, column 1: "+[n.constructor.name,e.constructor.name])}},dn=function(n){return function(t){return function(o){return function(a){var i={canvasName:n};return function(){var u=e.initGL_(n,t)();if(u)return r.runWebGl_(a(i))();if(!u)return o("Unable to initialize WebGL. Your browser may not support it.")();throw new Error("Failed pattern match at Graphics.WebGL line 140, column 3 - line 143, column 5: "+[u.constructor.name])}}}}},vn=d.runFn1(e.requestAnimationFrame_),mn=function(n){if(n instanceof w)return o._POINTS;if(n instanceof g)return o._LINES;if(n instanceof C)return o._LINE_STRIP;if(n instanceof S)return o._LINE_LOOP;if(n instanceof P)return o._TRIANGLES;if(n instanceof y)return o._TRIANGLE_STRIP;if(n instanceof T)return o._TRIANGLE_FAN;throw new Error("Failed pattern match at Graphics.WebGL line 479, column 1 - line 480, column 1: "+[n.constructor.name])},hn=function(n){if(n instanceof b)return o._DEPTH_BUFFER_BIT;if(n instanceof E)return o._STENCIL_BUFFER_BIT;if(n instanceof x)return o._COLOR_BUFFER_BIT;throw new Error("Failed pattern match at Graphics.WebGL line 458, column 1 - line 459, column 1: "+[n.constructor.name])},pn=function(n){return function(e){var t=function(){if(n instanceof h)return o._FRAGMENT_SHADER;if(n instanceof p)return o._VERTEX_SHADER;throw new Error("Failed pattern match at Graphics.WebGL line 401, column 25 - line 404, column 3: "+[n.constructor.name])}();return function(){var n=o.createShader_(t)();o.shaderSource_(n,e)(),o.compileShader_(n)();var r=o.getShaderParameter_(n,o._COMPILE_STATUS)();if(r)return new s.Left(n);if(!r){var a=o.getShaderInfoLog_(n)();return new s.Right(a)}throw new Error("Failed pattern match at Graphics.WebGL line 408, column 3 - line 414, column 1: "+[r.constructor.name])}}},wn=function(n){return function(t){return function(){var r=o.createBuffer_()();o.bindBuffer_(o._ARRAY_BUFFER,r)();var i=a.asFloat32Array(n);return e.bufferData__(o._ARRAY_BUFFER,i,t)(),{webGLBuffer:r,bufferType:o._ARRAY_BUFFER,bufferSize:l.length(n)}}}},gn=function(n){return wn(n)(o._DYNAMIC_DRAW)},Cn=function(n){return wn(n)(o._STATIC_DRAW)},Sn=function(n){return function(e){return function(){var t=o.createProgram_()();o.attachShader_(t,e)(),o.attachShader_(t,n)(),o.linkProgram_(t)();var r=o.getProgramParameter_(t,o._LINK_STATUS)();if(r)return o.useProgram_(t)(),new u.Just(t);if(!r)return u.Nothing.value;throw new Error("Failed pattern match at Graphics.WebGL line 421, column 3 - line 431, column 1: "+[r.constructor.name])}}},Pn=function(n){return function(t){return function(r){return function(){var o=pn(h.value)(n.value0)();if(o instanceof s.Right)return t("Can't compile fragment shader: "+o.value0)();if(o instanceof s.Left){var a=pn(p.value)(n.value1)();if(a instanceof s.Right)return t("Can't compile vertex shader: "+a.value0)();if(a instanceof s.Left){var i=Sn(o.value0)(a.value0)();if(i instanceof u.Nothing)return t("Can't init shaders")();if(i instanceof u.Just){var c=e.shaderBindings_(i.value0)();return r(function(){var n={};for(var e in c)c.hasOwnProperty(e)&&(n[e]=c[e]);return n.webGLProgram=i.value0,n}())()}throw new Error("Failed pattern match at Graphics.WebGL line 202, column 13 - line 210, column 1: "+[i.constructor.name])}throw new Error("Failed pattern match at Graphics.WebGL line 198, column 7 - line 210, column 1: "+[a.constructor.name])}throw new Error("Failed pattern match at Graphics.WebGL line 194, column 3 - line 210, column 1: "+[o.constructor.name])}}}},yn=function(n){return e.getCanvasWidth_(n.canvasName)},Tn=function(n){return e.getCanvasHeight_(n.canvasName)},bn=function(n){if(n instanceof F)return o._NEVER;if(n instanceof A)return o._ALWAYS;if(n instanceof N)return o._LESS;if(n instanceof _)return o._EQUAL;if(n instanceof D)return o._LEQUAL;if(n instanceof M)return o._GREATER;if(n instanceof L)return o._GEQUAL;if(n instanceof I)return o._NOTEQUAL;throw new Error("Failed pattern match at Graphics.WebGL line 338, column 1 - line 339, column 1: "+[n.constructor.name])},En=function(n){return function(e){return function(r){return function(){o.bindBuffer_(n.bufferType,n.webGLBuffer)();var i=a.asFloat32Array(r);return o.bufferSubData_(n.bufferType,e,i)(),t.unit}}}},xn=function(n){return o.enableVertexAttribArray_(n.aLocation)},Fn=function(n){return function(e){return o.drawElements_(mn(n),e,o._UNSIGNED_SHORT,0)}},An=function(n){return o.disableVertexAttribArray_(n.aLocation)},Nn=function(n){return o.depthFunc_(bn(n))},_n={alpha:!0,depth:!0,stencil:!1,antialias:!0,premultipliedAlpha:!0,preserveDrawingBuffer:!1,preferLowPowerToHighPerformance:!1,failIfMajorPerformanceCaveat:!1},Dn=d.runFn4(o.colorMask_),Mn=d.runFn1(o.clearDepth_),Ln=d.runFn4(o.clearColor_),In=function(n){return o.clear_(i.foldl(i.foldableArray)(f[".|."])(0)(t.map(t.functorArray)(hn)(n)))},On=function(n){if(n instanceof O)return o._BLEND;if(n instanceof R)return o._DEPTH_TEST;if(n instanceof k)return o._CULL_FACE;if(n instanceof U)return o._POLYGON_OFFSET_FILL;if(n instanceof G)return o._SCISSOR_TEST;throw new Error("Failed pattern match at Graphics.WebGL line 443, column 1 - line 444, column 1: "+[n.constructor.name])},Rn=function(n){return o.disable_(On(n))},kn=function(n){return o.enable_(On(n))},Un=function(n){if(n instanceof B)return o._ARRAY_BUFFER;if(n instanceof J)return o._ELEMENT_ARRAY_BUFFER;throw new Error("Failed pattern match at Graphics.WebGL line 492, column 1 - line 493, column 1: "+[n.constructor.name])},Gn=function(n){return function(n){return function(t){return function(r){return function(a){var i=Un(n);return function(){var n=o.createBuffer_()();o.bindBuffer_(i,n)();var u=t(r);return e.bufferData__(i,u,a)(),{webGLBuffer:n,bufferType:i,bufferSize:l.length(r)}}}}}}},Bn=function(n){return function(e){return function(t){return function(r){return Gn(n)(e)(t)(r)(o._STATIC_DRAW)}}}},Jn=function(n){if(n instanceof $)return o._ZERO;if(n instanceof H)return o._ONE;if(n instanceof z)return o._SRC_COLOR;if(n instanceof W)return o._ONE_MINUS_SRC_COLOR;if(n instanceof j)return o._DST_COLOR;if(n instanceof V)return o._ONE_MINUS_DST_COLOR;if(n instanceof q)return o._SRC_ALPHA;if(n instanceof Z)return o._ONE_MINUS_SRC_ALPHA;if(n instanceof K)return o._DST_ALPHA;if(n instanceof X)return o._ONE_MINUS_DST_ALPHA;if(n instanceof rn)return o._CONSTANT_COLOR;if(n instanceof on)return o._ONE_MINUS_CONSTANT_COLOR;if(n instanceof an)return o._CONSTANT_ALPHA;if(n instanceof un)return o._ONE_MINUS_CONSTANT_ALPHA;if(n instanceof Y)return o._SRC_ALPHA_SATURATE;if(n instanceof cn)return o._BLEND_COLOR;if(n instanceof Q)return o._BLEND_DST_RGB;if(n instanceof nn)return o._BLEND_SRC_RGB;if(n instanceof en)return o._BLEND_DST_ALPHA;if(n instanceof tn)return o._BLEND_SRC_ALPHA;throw new Error("Failed pattern match at Graphics.WebGL line 520, column 1 - line 521, column 1: "+[n.constructor.name])},$n=function(n){return function(e){return o.blendFunc_(Jn(n),Jn(e))}},Hn=function(n){return function(e){return function(){return o.bindBuffer_(n.bufferType,n.webGLBuffer)(),sn(e)()}}},zn=function(n){return function(e){return function(t){return function(){return Hn(e)(t)(),o.drawArrays_(mn(n),0,e.bufferSize/t.aItemSize|0)()}}}},Wn=function(n){return o.bindBuffer_(n.bufferType,n.webGLBuffer)},jn=function(n){return function(e){return function(t){return o.bindAttribLocation_(n,e,t)}}},Vn=a.asFloat32Array,qn=function(n){return function(e){if(n.uType===o._FLOAT)return o.uniform1f_(n.uLocation,c.head(e));if(n.uType===o._FLOAT_MAT4)return o.uniformMatrix4fv_(n.uLocation,!1,Vn(e));if(n.uType===o._FLOAT_MAT3)return o.uniformMatrix3fv_(n.uLocation,!1,Vn(e));if(n.uType===o._FLOAT_MAT2)return o.uniformMatrix2fv_(n.uLocation,!1,Vn(e));if(n.uType===o._FLOAT_VEC4)return o.uniform4fv_(n.uLocation,Vn(e));if(n.uType===o._FLOAT_VEC3)return o.uniform3fv_(n.uLocation,Vn(e));if(n.uType===o._FLOAT_VEC2)return o.uniform2fv_(n.uLocation,Vn(e));if(t.otherwise)return v.fail("WebGL>>setUniformFloats: Called for non float uniform!");throw new Error("Failed pattern match at Graphics.WebGL line 268, column 1 - line 278, column 1: "+[n.constructor.name,e.constructor.name])}};n.BLEND=O,n.DEPTH_TEST=R,n.CULL_FACE=k,n.POLYGON_OFFSET_FILL=U,n.SCISSOR_TEST=G,n.ZERO=$,n.ONE=H,n.SRC_COLOR=z,n.ONE_MINUS_SRC_COLOR=W,n.DST_COLOR=j,n.ONE_MINUS_DST_COLOR=V,n.SRC_ALPHA=q,n.ONE_MINUS_SRC_ALPHA=Z,n.DST_ALPHA=K,n.ONE_MINUS_DST_ALPHA=X,n.SRC_ALPHA_SATURATE=Y,n.BLEND_DST_RGB=Q,n.BLEND_SRC_RGB=nn,n.BLEND_DST_ALPHA=en,n.BLEND_SRC_ALPHA=tn,n.CONSTANT_COLOR=rn,n.ONE_MINUS_CONSTANT_COLOR=on,n.CONSTANT_ALPHA=an,n.ONE_MINUS_CONSTANT_ALPHA=un,n.BLEND_COLOR=cn,n.POINTS=w,n.LINES=g,n.LINE_STRIP=C,n.LINE_LOOP=S,n.TRIANGLES=P,n.TRIANGLE_STRIP=y,n.TRIANGLE_FAN=T,n.DEPTH_BUFFER_BIT=b,n.STENCIL_BUFFER_BIT=E,n.COLOR_BUFFER_BIT=x,n.NEVER=F,n.ALWAYS=A,n.LESS=N,n.EQUAL=_,n.LEQUAL=D,n.GREATER=M,n.GEQUAL=L,n.NOTEQUAL=I,n.ARRAY_BUFFER=B,n.ELEMENT_ARRAY_BUFFER=J,n.Shaders=m,n.requestAnimationFrame=vn,n.colorMask=Dn,n.clearDepth=Mn,n.clearColor=Ln,n.clear=In,n.enable=kn,n.disable=Rn,n.getCanvasHeight=Tn,n.getCanvasWidth=yn,n.viewport=ln,n.blendFunc=$n,n.depthFunc=Nn,n.drawElements=Fn,n.drawArr=zn,n.disableVertexAttribArray=An,n.enableVertexAttribArray=xn,n.vertexPointer=sn,n.bindAttribLocation=jn,n.bindBuf=Wn,n.bindBufAndSetVertexAttr=Hn,n.setUniformBoolean=fn,n.setUniformFloats=qn,n.fillBuffer=En,n.makeBufferFloatDyn=gn,n.makeBufferFloat=Cn,n.makeBuffer=Bn,n.withShaders=Pn,n.runWebGLAttr=dn,n.defContextAttributes=_n}(PS["Graphics.WebGL"]=PS["Graphics.WebGL"]||{}),function(n){"use strict";n.peekSTArrayImplUnsafe=function(n,e){return function(){return n[e]}},n.pokeSTArray=function(n,e,t){return function(){var r=e>=0&&e<n.length;return r&&(n[e]=t),r}},n.pokeAllSTArray=function(n,e,t){return function(){var r=t.length,o=e>=0&&e+t.length<=n.length;if(o)for(var a=0;r>a;a++)n[a+e]=t[a];return o}},n.pushAllSTArray=function(n,e){return function(){return n.push.apply(n,e)}},n.copyImpl=function(n){return function(){return n.slice()}}}(PS["Data.STSequence"]=PS["Data.STSequence"]||{}),function(n){"use strict";var e=PS["Data.STSequence"],t=PS.Prelude,r=PS["Control.Monad.ST"],o=PS["Data.Array"],a=PS["Control.Monad.Eff"],i=(PS["Data.Function"],PS["Data.Int"]),u=PS["Data.Maybe"],c=PS.Extensions,l=c.unsafeCoerce,s=function(n){return function(){var e=r.readSTRef(n.fillCounter)();return o.slice(0)(e)(l(n.buffer))}},f=e.copyImpl,d=function(n){return function(){var t=r.readSTRef(n.fillCounter)(),o=0===t;if(o)return u.Nothing.value;if(!o){var a=e.peekSTArrayImplUnsafe(n.buffer,t-1)();return e.pokeSTArray(n.buffer,t-1,c.undef)(),r.modifySTRef(n.fillCounter)(function(n){return n-1})(),new u.Just(a)}throw new Error("Failed pattern match at Data.STSequence line 172, column 5 - line 181, column 1: "+[o.constructor.name])}},v=function(n){return r.readSTRef(n.fillCounter)},m=function(n){return function(r){return function(){var o=v(n)(),i=r>=0&&o>r;if(i)return t.liftM1(a.monadEff)(u.Just.create)(e.peekSTArrayImplUnsafe(n.buffer,r))();if(!i)return u.Nothing.value;throw new Error("Failed pattern match at Data.STSequence line 214, column 5 - line 218, column 1: "+[i.constructor.name])}}},h=function(n){return function(t){return function(r){return function(){var o=v(n)(),a=t>=0&&o>t;if(a)return e.pokeSTArray(n.buffer,t,r)(),!0;if(!a)return!1;throw new Error("Failed pattern match at Data.STSequence line 231, column 5 - line 235, column 21: "+[a.constructor.name])}}}},p=function(n){return function(){var e=r.readSTRef(n.fillCounter)();return m(n)(e-1)()}},w=30,g=function(n){var e=i.round(.7*i.toNumber(o.length(n)));return function(){var a=f(t["++"](t.semigroupArray)(n)(o.replicate(e)(c.undef)))(),i=r.newSTRef(o.length(n))();return{buffer:a,fillCounter:i}}},C=function(n){return function(){var e=f(o.replicate(n)(c.undef))(),t=r.newSTRef(0)();return{buffer:e,fillCounter:t}}},S=function(){var n=f(o.replicate(w)(c.undef))(),e=r.newSTRef(0)();return{buffer:n,fillCounter:e}},P=function(n){return o.length(l(n.buffer))},y=function(n){return function(t){return function(){var a=r.readSTRef(n.fillCounter)(),u=P(n);return function(){var r=u>a;if(r)return e.pokeSTArray(n.buffer,a,t);if(!r){var l=i.round(.7*i.toNumber(u));return function(){return e.pushAllSTArray(n.buffer,o.replicate(l)(c.undef))(),e.pokeSTArray(n.buffer,a,t)()}}throw new Error("Failed pattern match at Data.STSequence line 158, column 5 - line 165, column 5: "+[r.constructor.name])}()(),r.modifySTRef(n.fillCounter)(function(n){return n+1|0})(),n}}},T=function(n){return function(t){return function(){var a=v(n)(),u=o.length(t),l=a+u|0;return function(){var r=P(n)>=l;if(r)return e.pokeAllSTArray(n.buffer,a,t);if(!r){var u=i.round(1.7*i.toNumber(l)),s=u-P(n);return function(){return e.pushAllSTArray(n.buffer,o.replicate(s)(c.undef))(),e.pokeAllSTArray(n.buffer,a,t)()}}throw new Error("Failed pattern match at Data.STSequence line 186, column 5 - line 194, column 5: "+[r.constructor.name])}()(),r.writeSTRef(n.fillCounter)(l)(),n}}};n.poke=h,n.last=p,n.peek=m,n.pushAll=T,n.pop=d,n.push=y,n.length=v,n.toArray=s,n.fromArray=g,n.emptyWithBufferSize=C,n.empty=S}(PS["Data.STSequence"]=PS["Data.STSequence"]||{}),function(n){"use strict";n._copyEff=function(n){return function(){var e={};for(var t in n)n.hasOwnProperty(t)&&(e[t]=n[t]);return e}},n.empty={},n.runST=function(n){return n},n._lookup=function(n,e,t,r){return t in r?e(r[t]):n}}(PS["Data.StrMap"]=PS["Data.StrMap"]||{}),function(n){"use strict";n.poke=function(n){return function(e){return function(t){return function(){return n[e]=t,n}}}}}(PS["Data.StrMap.ST"]=PS["Data.StrMap.ST"]||{}),function(n){"use strict";var e=PS["Data.StrMap.ST"];PS.Prelude,PS["Control.Monad.Eff"],PS["Control.Monad.ST"],PS["Data.Maybe"];n.poke=e.poke}(PS["Data.StrMap.ST"]=PS["Data.StrMap.ST"]||{}),function(n){"use strict";var e=PS["Data.StrMap"],t=(PS.Prelude,PS["Control.Monad.Eff"]),r=(PS["Data.Foldable"],PS["Data.Function"]),o=PS["Data.Maybe"],a=(PS["Data.Monoid"],PS["Data.Traversable"],PS["Data.Tuple"],PS["Data.List"],PS["Control.Monad.ST"],PS["Data.StrMap.ST"]),i=e._copyEff,u=function(n){return t.runPure(e.runST(n))},c=function(n){return function(e){return u(function(){var t=i(e)();return n(t)(),t})}},l=r.runFn4(e._lookup)(o.Nothing.value)(o.Just.create),s=function(n){return function(e){return c(function(t){return a.poke(t)(n)(e)})}};n.thawST=i,n.lookup=l,n.insert=s,n.empty=e.empty}(PS["Data.StrMap"]=PS["Data.StrMap"]||{}),function(n){"use strict";var e=PS["Graphics.WebGL"],t=new e.Shaders("precision mediump float;\n\n  varying vec4 vFinalColor;\n\n  varying vec2 vTextureCoord;\n  varying float fogFactor;\n\n  uniform float uTexAmbiance;\n  uniform sampler2D uSampler;\n\n  uniform bool uUseTexture;\n  uniform bool uSimple;\n  uniform bool uUseTextureFrame;\n  uniform vec4 uTextureFrameColor;\n\n  void main(void)\n  {\n        vec4 fog_color = vec4(1,1,1,0);\n        if (uSimple) {\n            gl_FragColor = vFinalColor;\n        } else {\n            if (uUseTexture) {\n                vec4 texel = texture2D (uSampler, vTextureCoord);\n                if (uUseTextureFrame && texel.a < 1.0) {\n                    vec4 texelColor = mix(uTextureFrameColor, texel, texel.a * uTexAmbiance);\n                    gl_FragColor = mix(fog_color, texelColor, fogFactor);\n                } else {\n                    vec4 texelColor = vec4(texel.r, texel.g, texel.b, texel.a * uTexAmbiance);\n                    gl_FragColor = mix(fog_color, texelColor, fogFactor);\n                }\n            } else {\n                vec4 frag_color = vFinalColor;\n                gl_FragColor = mix(fog_color, frag_color, fogFactor);\n            }\n        }\n  }\n  ","\n  precision mediump float;\n  attribute vec3 aVertexPosition;\n  attribute vec3 aVertexNormal;\n\n  attribute vec2 aTextureCoord;\n\n  uniform mat4 uMVMatrix;\n  uniform mat4 uPMatrix;\n  uniform mat3 uNMatrix;\n\n  uniform float uShininess;   //shininness\n  uniform vec3 uLightDirection;  //light direction\n\n  uniform vec4 uLightAmbient;      //light ambient property\n  uniform vec4 uLightDiffuse;      //light diffuse property\n  uniform vec4 uLightSpecular;     //light specular property\n\n  uniform vec4 uMaterialAmbient;  //object ambient property\n  uniform vec4 uMaterialDiffuse;   //object diffuse property\n  uniform vec4 uMaterialSpecular;  //object specular property\n\n  uniform float uScale;\n\n  varying vec4 vFinalColor;\n  varying vec2 vTextureCoord;\n  varying float fogFactor;\n\n  uniform bool uUseTexture;\n  uniform bool uSimple;\n\n\nvoid main(void) {\n\n    vec4 vertex = uMVMatrix * vec4(aVertexPosition, 1.0);\n    float distance = length(vertex);\n    fogFactor =  clamp ((18.0 - distance) / 9.0, 0.7, 1.0);\n        //fogFactor = (end - z) / (end - start)\n\n    gl_Position = uPMatrix * vertex;\n\n    if (uUseTexture) {\n      vTextureCoord = aTextureCoord;\n    }\n    else if (uSimple) {\n      vFinalColor = uMaterialAmbient;\n    }\n    else\n    {\n      //Transformed normal position\n      vec3 N = uNMatrix * aVertexNormal;\n\n      //Normalize light to calculate lambertTerm\n      vec3 L = normalize(uLightDirection);\n\n      //Lambert's cosine law\n      float lambertTerm = dot(N * uScale,-L);\n\n      //Ambient Term\n      vec4 Ia = uLightAmbient * uMaterialAmbient;\n\n      //Diffuse Term\n      vec4 Id = vec4(0.0,0.0,0.0,1.0);\n\n      //Specular Term\n      vec4 Is = vec4(0.0,0.0,0.0,1.0);\n\n      if(lambertTerm > 0.0) //only if lambertTerm is positive\n      {\n          Id = uLightDiffuse * uMaterialDiffuse * lambertTerm; //add diffuse term\n\n          vec3 eyeVec = -vec3(vertex.xyz);\n          vec3 E = normalize(eyeVec);\n          vec3 R = reflect(L, N * uScale);\n          float specular = pow(max(dot(R, E), 0.0), uShininess );\n\n          Is = uLightSpecular * uMaterialSpecular * specular; //add specular term\n      }\n\n      //Final color\n      vFinalColor = Ia + Id + Is;\n      vFinalColor.a = uMaterialAmbient.a;\n\n    }\n}\n  ");
n.shaders=t}(PS["ConeCanvas.Frontend.Shaders"]=PS["ConeCanvas.Frontend.Shaders"]||{}),function(n){"use strict";var e=PS.Prelude,t=PS["Data.Foldable"],r=PS["Data.List"],o=PS["Data.Maybe"],a=PS["Data.Maybe.Unsafe"],i=(PS["Data.Monoid"],PS["Data.Traversable"]),u=PS["Data.Tuple"],c=function(){function n(){}return n.value=new n,n}(),l=function(){function n(n,e,t,r){this.value0=n,this.value1=e,this.value2=t,this.value3=r}return n.create=function(e){return function(t){return function(r){return function(o){return new n(e,t,r,o)}}}},n}(),s=function(){function n(n,e,t,r,o,a,i){this.value0=n,this.value1=e,this.value2=t,this.value3=r,this.value4=o,this.value5=a,this.value6=i}return n.create=function(e){return function(t){return function(r){return function(o){return function(a){return function(i){return function(u){return new n(e,t,r,o,a,i,u)}}}}}}},n}(),f=function(){function n(n,e,t){this.value0=n,this.value1=e,this.value2=t}return n.create=function(e){return function(t){return function(r){return new n(e,t,r)}}},n}(),d=function(){function n(n,e,t){this.value0=n,this.value1=e,this.value2=t}return n.create=function(e){return function(t){return function(r){return new n(e,t,r)}}},n}(),v=function(){function n(n,e,t,r,o,a){this.value0=n,this.value1=e,this.value2=t,this.value3=r,this.value4=o,this.value5=a}return n.create=function(e){return function(t){return function(r){return function(o){return function(a){return function(i){return new n(e,t,r,o,a,i)}}}}}},n}(),m=function(){function n(n,e,t,r,o,a){this.value0=n,this.value1=e,this.value2=t,this.value3=r,this.value4=o,this.value5=a}return n.create=function(e){return function(t){return function(r){return function(o){return function(a){return function(i){return new n(e,t,r,o,a,i)}}}}}},n}(),h=function(){function n(n,e,t,r,o,a){this.value0=n,this.value1=e,this.value2=t,this.value3=r,this.value4=o,this.value5=a}return n.create=function(e){return function(t){return function(r){return function(o){return function(a){return function(i){return new n(e,t,r,o,a,i)}}}}}},n}(),p=function(){function n(n,e,t,r){this.value0=n,this.value1=e,this.value2=t,this.value3=r}return n.create=function(e){return function(t){return function(r){return function(o){return new n(e,t,r,o)}}}},n}(),w=function(n){if(n instanceof c)return r.Nil.value;if(n instanceof l)return e["++"](r.semigroupList)(w(n.value0))(e["++"](r.semigroupList)(e.pure(r.applicativeList)(n.value2))(w(n.value3)));if(n instanceof s)return e["++"](r.semigroupList)(w(n.value0))(e["++"](r.semigroupList)(e.pure(r.applicativeList)(n.value2))(e["++"](r.semigroupList)(w(n.value3))(e["++"](r.semigroupList)(e.pure(r.applicativeList)(n.value5))(w(n.value6)))));throw new Error("Failed pattern match at Data.Map line 311, column 1 - line 312, column 1: "+[n.constructor.name])},g=function(n){if(n instanceof c)return r.Nil.value;if(n instanceof l)return e["++"](r.semigroupList)(g(n.value0))(e["++"](r.semigroupList)(e.pure(r.applicativeList)(new u.Tuple(n.value1,n.value2)))(g(n.value3)));if(n instanceof s)return e["++"](r.semigroupList)(g(n.value0))(e["++"](r.semigroupList)(e.pure(r.applicativeList)(new u.Tuple(n.value1,n.value2)))(e["++"](r.semigroupList)(g(n.value3))(e["++"](r.semigroupList)(e.pure(r.applicativeList)(new u.Tuple(n.value4,n.value5)))(g(n.value6)))));throw new Error("Failed pattern match at Data.Map line 290, column 1 - line 291, column 1: "+[n.constructor.name])},C=function(n){return function(e){return new l(c.value,n,e,c.value)}},S=function(n){return function(t){return function(r){var a=n,i=t,u=r;n:for(;;){var f=e.compare(a);if(u instanceof c)return o.Nothing.value;if(u instanceof l){var d=f(i)(u.value1);if(d instanceof e.EQ)return new o.Just(u.value2);if(d instanceof e.LT){var v=a,m=i,h=u.value0;a=v,i=m,u=h;continue n}var v=a,m=i,h=u.value3;a=v,i=m,u=h}else{if(!(u instanceof s))throw new Error("Failed pattern match at Data.Map line 121, column 6 - line 143, column 1: "+[u.constructor.name]);var p=f(i)(u.value1);if(p instanceof e.EQ)return new o.Just(u.value2);var w=f(i)(u.value4);if(w instanceof e.EQ)return new o.Just(u.value5);if(p instanceof e.LT){var v=a,m=i,h=u.value0;a=v,i=m,u=h;continue n}if(w instanceof e.GT){var v=a,m=i,h=u.value6;a=v,i=m,u=h;continue n}var v=a,m=i,h=u.value3;a=v,i=m,u=h}}}}},P=function(n){return function(e){return function(t){return o.isJust(S(n)(e)(t))}}},y=new e.Functor(function(n){return function(t){if(t instanceof c)return c.value;if(t instanceof l)return new l(e.map(y)(n)(t.value0),t.value1,n(t.value2),e.map(y)(n)(t.value3));if(t instanceof s)return new s(e.map(y)(n)(t.value0),t.value1,n(t.value2),e.map(y)(n)(t.value3),t.value4,n(t.value5),e.map(y)(n)(t.value6));throw new Error("Failed pattern match at Data.Map line 62, column 3 - line 63, column 3: "+[n.constructor.name,t.constructor.name])}}),T=function(n){return function(e){return function(t){var o=n,a=e,i=t;n:for(;;){if(a instanceof r.Nil)return i;if(a instanceof r.Cons){if(a.value0 instanceof f){var u=o,c=a.value1,p=new l(i,a.value0.value0,a.value0.value1,a.value0.value2);o=u,a=c,i=p;continue n}if(a.value0 instanceof d){var u=o,c=a.value1,p=new l(a.value0.value0,a.value0.value1,a.value0.value2,i);o=u,a=c,i=p;continue n}if(a.value0 instanceof v){var u=o,c=a.value1,p=new s(i,a.value0.value0,a.value0.value1,a.value0.value2,a.value0.value3,a.value0.value4,a.value0.value5);o=u,a=c,i=p;continue n}if(a.value0 instanceof m){var u=o,c=a.value1,p=new s(a.value0.value0,a.value0.value1,a.value0.value2,i,a.value0.value3,a.value0.value4,a.value0.value5);o=u,a=c,i=p;continue n}if(a.value0 instanceof h){var u=o,c=a.value1,p=new s(a.value0.value0,a.value0.value1,a.value0.value2,a.value0.value3,a.value0.value4,a.value0.value5,i);o=u,a=c,i=p;continue n}throw new Error("Failed pattern match at Data.Map line 156, column 3 - line 163, column 1: "+[a.value0.constructor.name])}throw new Error("Failed pattern match at Data.Map line 154, column 1 - line 155, column 1: "+[a.constructor.name,i.constructor.name])}}}},b=function(n){var t=function(e){return function(t){var o=e,a=t;n:for(;;){if(o instanceof r.Nil)return new l(a.value0,a.value1,a.value2,a.value3);if(o instanceof r.Cons){if(o.value0 instanceof f)return T(n)(o.value1)(new s(a.value0,a.value1,a.value2,a.value3,o.value0.value0,o.value0.value1,o.value0.value2));if(o.value0 instanceof d)return T(n)(o.value1)(new s(o.value0.value0,o.value0.value1,o.value0.value2,a.value0,a.value1,a.value2,a.value3));if(o.value0 instanceof v){var i=o.value1,u=new p(new l(a.value0,a.value1,a.value2,a.value3),o.value0.value0,o.value0.value1,new l(o.value0.value2,o.value0.value3,o.value0.value4,o.value0.value5));o=i,a=u;continue n}if(o.value0 instanceof m){var i=o.value1,u=new p(new l(o.value0.value0,o.value0.value1,o.value0.value2,a.value0),a.value1,a.value2,new l(a.value3,o.value0.value3,o.value0.value4,o.value0.value5));o=i,a=u;continue n}if(o.value0 instanceof h){var i=o.value1,u=new p(new l(o.value0.value0,o.value0.value1,o.value0.value2,o.value0.value3),o.value0.value4,o.value0.value5,new l(a.value0,a.value1,a.value2,a.value3));o=i,a=u;continue n}throw new Error("Failed pattern match at Data.Map line 197, column 5 - line 205, column 1: "+[o.value0.constructor.name])}throw new Error("Failed pattern match at Data.Map line 195, column 3 - line 196, column 3: "+[o.constructor.name,a.constructor.name])}}},o=e.compare(n),a=function(a){return function(i){return function(u){return function(w){var g=a,C=i,S=u,P=w;n:for(;;){if(P instanceof c)return t(g)(new p(c.value,C,S,c.value));if(P instanceof l){var y=o(C)(P.value1);if(y instanceof e.EQ)return T(n)(g)(new l(P.value0,C,S,P.value3));if(y instanceof e.LT){var b=new r.Cons(new f(P.value1,P.value2,P.value3),g),E=C,x=S,F=P.value0;g=b,C=E,S=x,P=F;continue n}var b=new r.Cons(new d(P.value0,P.value1,P.value2),g),E=C,x=S,F=P.value3;g=b,C=E,S=x,P=F}else{if(!(P instanceof s))throw new Error("Failed pattern match at Data.Map line 173, column 3 - line 174, column 3: "+[g.constructor.name,C.constructor.name,S.constructor.name,P.constructor.name]);var A=o(C)(P.value1);if(A instanceof e.EQ)return T(n)(g)(new s(P.value0,C,S,P.value3,P.value4,P.value5,P.value6));var N=o(C)(P.value4);if(N instanceof e.EQ)return T(n)(g)(new s(P.value0,P.value1,P.value2,P.value3,C,S,P.value6));if(A instanceof e.LT){var b=new r.Cons(new v(P.value1,P.value2,P.value3,P.value4,P.value5,P.value6),g),E=C,x=S,F=P.value0;g=b,C=E,S=x,P=F;continue n}if(A instanceof e.GT){if(N instanceof e.LT){var b=new r.Cons(new m(P.value0,P.value1,P.value2,P.value4,P.value5,P.value6),g),E=C,x=S,F=P.value3;g=b,C=E,S=x,P=F;continue n}var b=new r.Cons(new h(P.value0,P.value1,P.value2,P.value3,P.value4,P.value5),g),E=C,x=S,F=P.value6;g=b,C=E,S=x,P=F;continue n}var b=new r.Cons(new h(P.value0,P.value1,P.value2,P.value3,P.value4,P.value5),g),E=C,x=S,F=P.value6;g=b,C=E,S=x,P=F}}}}}};return a(r.Nil.value)},E=new t.Foldable(function(n){return function(e){return function(o){return t.foldMap(r.foldableList)(n)(e)(w(o))}}},function(n){return function(e){return function(o){return t.foldl(r.foldableList)(n)(e)(w(o))}}},function(n){return function(e){return function(o){return t.foldr(r.foldableList)(n)(e)(w(o))}}}),x=c.value,F=function(n){var t=function(e){return function(t){for(var o=e,i=t;;){if(o instanceof r.Nil)return i;if(o instanceof r.Cons&&o.value0 instanceof f&&o.value0.value2 instanceof c&&i instanceof c)return T(n)(o.value1)(new l(c.value,o.value0.value0,o.value0.value1,c.value));if(o instanceof r.Cons&&o.value0 instanceof d&&o.value0.value0 instanceof c&&i instanceof c)return T(n)(o.value1)(new l(c.value,o.value0.value1,o.value0.value2,c.value));if(o instanceof r.Cons&&o.value0 instanceof f&&o.value0.value2 instanceof l){var u=o.value1,p=new s(i,o.value0.value0,o.value0.value1,o.value0.value2.value0,o.value0.value2.value1,o.value0.value2.value2,o.value0.value2.value3);o=u,i=p}else{if(!(o instanceof r.Cons&&o.value0 instanceof d&&o.value0.value0 instanceof l))return o instanceof r.Cons&&o.value0 instanceof f&&o.value0.value2 instanceof s?T(n)(o.value1)(new l(new l(i,o.value0.value0,o.value0.value1,o.value0.value2.value0),o.value0.value2.value1,o.value0.value2.value2,new l(o.value0.value2.value3,o.value0.value2.value4,o.value0.value2.value5,o.value0.value2.value6))):o instanceof r.Cons&&o.value0 instanceof d&&o.value0.value0 instanceof s?T(n)(o.value1)(new l(new l(o.value0.value0.value0,o.value0.value0.value1,o.value0.value0.value2,o.value0.value0.value3),o.value0.value0.value4,o.value0.value0.value5,new l(o.value0.value0.value6,o.value0.value1,o.value0.value2,i))):o instanceof r.Cons&&o.value0 instanceof v&&o.value0.value2 instanceof c&&o.value0.value5 instanceof c&&i instanceof c?T(n)(o.value1)(new s(c.value,o.value0.value0,o.value0.value1,c.value,o.value0.value3,o.value0.value4,c.value)):o instanceof r.Cons&&o.value0 instanceof m&&o.value0.value0 instanceof c&&o.value0.value5 instanceof c&&i instanceof c?T(n)(o.value1)(new s(c.value,o.value0.value1,o.value0.value2,c.value,o.value0.value3,o.value0.value4,c.value)):o instanceof r.Cons&&o.value0 instanceof h&&o.value0.value0 instanceof c&&o.value0.value3 instanceof c&&i instanceof c?T(n)(o.value1)(new s(c.value,o.value0.value1,o.value0.value2,c.value,o.value0.value4,o.value0.value5,c.value)):o instanceof r.Cons&&o.value0 instanceof v&&o.value0.value2 instanceof l?T(n)(o.value1)(new l(new s(i,o.value0.value0,o.value0.value1,o.value0.value2.value0,o.value0.value2.value1,o.value0.value2.value2,o.value0.value2.value3),o.value0.value3,o.value0.value4,o.value0.value5)):o instanceof r.Cons&&o.value0 instanceof m&&o.value0.value0 instanceof l?T(n)(o.value1)(new l(new s(o.value0.value0.value0,o.value0.value0.value1,o.value0.value0.value2,o.value0.value0.value3,o.value0.value1,o.value0.value2,i),o.value0.value3,o.value0.value4,o.value0.value5)):o instanceof r.Cons&&o.value0 instanceof m&&o.value0.value5 instanceof l?T(n)(o.value1)(new l(o.value0.value0,o.value0.value1,o.value0.value2,new s(i,o.value0.value3,o.value0.value4,o.value0.value5.value0,o.value0.value5.value1,o.value0.value5.value2,o.value0.value5.value3))):o instanceof r.Cons&&o.value0 instanceof h&&o.value0.value3 instanceof l?T(n)(o.value1)(new l(o.value0.value0,o.value0.value1,o.value0.value2,new s(o.value0.value3.value0,o.value0.value3.value1,o.value0.value3.value2,o.value0.value3.value3,o.value0.value4,o.value0.value5,i))):o instanceof r.Cons&&o.value0 instanceof v&&o.value0.value2 instanceof s?T(n)(o.value1)(new s(new l(i,o.value0.value0,o.value0.value1,o.value0.value2.value0),o.value0.value2.value1,o.value0.value2.value2,new l(o.value0.value2.value3,o.value0.value2.value4,o.value0.value2.value5,o.value0.value2.value6),o.value0.value3,o.value0.value4,o.value0.value5)):o instanceof r.Cons&&o.value0 instanceof m&&o.value0.value0 instanceof s?T(n)(o.value1)(new s(new l(o.value0.value0.value0,o.value0.value0.value1,o.value0.value0.value2,o.value0.value0.value3),o.value0.value0.value4,o.value0.value0.value5,new l(o.value0.value0.value6,o.value0.value1,o.value0.value2,i),o.value0.value3,o.value0.value4,o.value0.value5)):o instanceof r.Cons&&o.value0 instanceof m&&o.value0.value5 instanceof s?T(n)(o.value1)(new s(o.value0.value0,o.value0.value1,o.value0.value2,new l(i,o.value0.value3,o.value0.value4,o.value0.value5.value0),o.value0.value5.value1,o.value0.value5.value2,new l(o.value0.value5.value3,o.value0.value5.value4,o.value0.value5.value5,o.value0.value5.value6))):o instanceof r.Cons&&o.value0 instanceof h&&o.value0.value3 instanceof s?T(n)(o.value1)(new s(o.value0.value0,o.value0.value1,o.value0.value2,new l(o.value0.value3.value0,o.value0.value3.value1,o.value0.value3.value2,o.value0.value3.value3),o.value0.value3.value4,o.value0.value3.value5,new l(o.value0.value3.value6,o.value0.value4,o.value0.value5,i))):a.unsafeThrow("Impossible case in 'up'");var u=o.value1,p=new s(o.value0.value0.value0,o.value0.value0.value1,o.value0.value0.value2,o.value0.value0.value3,o.value0.value1,o.value0.value2,i);o=u,i=p}}}},o=function(n){return function(e){for(var o=n,i=e;;){if(i instanceof l&&i.value0 instanceof c&&i.value3 instanceof c)return t(o)(c.value);if(i instanceof l){var u=new r.Cons(new d(i.value0,i.value1,i.value2),o),f=i.value3;o=u,i=f}else{if(i instanceof s&&i.value0 instanceof c&&i.value3 instanceof c&&i.value6 instanceof c)return t(new r.Cons(new d(c.value,i.value1,i.value2),o))(c.value);if(!(i instanceof s)){if(i instanceof c)return a.unsafeThrow("Impossible case in 'removeMaxNode'");throw new Error("Failed pattern match at Data.Map line 259, column 3 - line 260, column 3: "+[o.constructor.name,i.constructor.name])}var u=new r.Cons(new h(i.value0,i.value1,i.value2,i.value3,i.value4,i.value5),o),f=i.value6;o=u,i=f}}}},i=function(n){for(var e=n;;){if(e instanceof l&&e.value3 instanceof c)return{key:e.value1,value:e.value2};if(e instanceof l){var t=e.value3;e=t}else{if(e instanceof s&&e.value6 instanceof c)return{key:e.value4,value:e.value5};if(!(e instanceof s)){if(e instanceof c)return a.unsafeThrow("Impossible case in 'maxNode'");throw new Error("Failed pattern match at Data.Map line 251, column 3 - line 252, column 3: "+[e.constructor.name])}var t=e.value6;e=t}}},u=function(a){return function(u){return function(p){var w=a,g=u,C=p;n:for(;;){if(C instanceof c)return T(n)(w)(c.value);if(C instanceof l&&C.value0 instanceof c&&C.value3 instanceof c&&e["=="](n["__superclass_Prelude.Eq_0"]())(g)(C.value1))return t(w)(c.value);if(C instanceof l){if(e["=="](n["__superclass_Prelude.Eq_0"]())(g)(C.value1)){var S=i(C.value0);return o(new r.Cons(new f(S.key,S.value,C.value3),w))(C.value0)}if(e["<"](n)(g)(C.value1)){var P=new r.Cons(new f(C.value1,C.value2,C.value3),w),y=g,b=C.value0;w=P,g=y,C=b;continue n}if(e.otherwise){var P=new r.Cons(new d(C.value0,C.value1,C.value2),w),y=g,b=C.value3;w=P,g=y,C=b;continue n}}if(C instanceof s&&C.value0 instanceof c&&C.value3 instanceof c&&C.value6 instanceof c){if(e["=="](n["__superclass_Prelude.Eq_0"]())(g)(C.value1))return T(n)(w)(new l(c.value,C.value4,C.value5,c.value));if(e["=="](n["__superclass_Prelude.Eq_0"]())(g)(C.value4))return T(n)(w)(new l(c.value,C.value1,C.value2,c.value))}if(C instanceof s){if(e["=="](n["__superclass_Prelude.Eq_0"]())(g)(C.value1)){var S=i(C.value0);return o(new r.Cons(new v(S.key,S.value,C.value3,C.value4,C.value5,C.value6),w))(C.value0)}if(e["=="](n["__superclass_Prelude.Eq_0"]())(g)(C.value4)){var S=i(C.value3);return o(new r.Cons(new m(C.value0,C.value1,C.value2,S.key,S.value,C.value6),w))(C.value3)}if(e["<"](n)(g)(C.value1)){var P=new r.Cons(new v(C.value1,C.value2,C.value3,C.value4,C.value5,C.value6),w),y=g,b=C.value0;w=P,g=y,C=b;continue n}if(e["<"](n)(C.value1)(g)&&e["<"](n)(g)(C.value4)){var P=new r.Cons(new m(C.value0,C.value1,C.value2,C.value4,C.value5,C.value6),w),y=g,b=C.value3;w=P,g=y,C=b;continue n}if(e.otherwise){var P=new r.Cons(new h(C.value0,C.value1,C.value2,C.value3,C.value4,C.value5),w),y=g,b=C.value6;w=P,g=y,C=b;continue n}}throw new Error("Failed pattern match at Data.Map line 209, column 3 - line 210, column 3: "+[w.constructor.name,g.constructor.name,C.constructor.name])}}}};return u(r.Nil.value)},A=function(n){return function(e){return function(t){return function(r){var a=e(S(n)(t)(r));if(a instanceof o.Nothing)return F(n)(t)(r);if(a instanceof o.Just)return b(n)(t)(a.value0)(r);throw new Error("Failed pattern match at Data.Map line 268, column 15 - line 273, column 1: "+[a.constructor.name])}}}},N=function(n){return function(e){return function(a){return function(i){var u=function(t){return function(r){return A(n)(function(n){return o.Just.create(o.maybe(r.value1)(e(r.value1))(n))})(r.value0)(t)}};return t.foldl(r.foldableList)(u)(i)(g(a))}}}},_=function(n){return N(n)(e["const"])},D=function(n){return new i.Traversable(function(){return E},function(){return y},function(t){return i.traverse(D(n))(t)(e.id(e.categoryFn))},function(o){return function(a){return function(c){return t.foldr(r.foldableList)(function(t){return function(r){return e["<*>"](o["__superclass_Prelude.Apply_0"]())(e["<$>"](o["__superclass_Prelude.Apply_0"]()["__superclass_Prelude.Functor_0"]())(_(n))(t))(r)}})(e.pure(o)(x))(e["<$>"](r.functorList)(e["<$>"](o["__superclass_Prelude.Apply_0"]()["__superclass_Prelude.Functor_0"]())(u.uncurry(C)))(e["<$>"](r.functorList)(i.traverse(u.traversableTuple)(o)(a))(g(c))))}}})},M=function(n){return function(e){return function(t){return function(r){return A(n)(o.maybe(o.Nothing.value)(e))(t)(r)}}}};n.unionWith=N,n.union=_,n.values=w,n.update=M,n.alter=A,n.member=P,n["delete"]=F,n.toList=g,n.lookup=S,n.insert=b,n.singleton=C,n.empty=x,n.functorMap=y,n.foldableMap=E,n.traversableMap=D}(PS["Data.Map"]=PS["Data.Map"]||{}),function(n){"use strict";var e=PS.Prelude,t=(PS["Data.Foldable"],PS["Data.List"],PS["Data.Monoid"],PS["Data.Map"]),r=(PS["Control.Monad.Eff"],PS["Control.Monad.ST"],PS["Control.Monad.Rec.Class"],PS["Data.Array"],PS["Data.Array.ST"],PS["Data.Array.Unsafe"],PS["Data.List"],PS["Data.Either"],PS["Data.Foldable"],PS["Data.Unfoldable"],function(){function n(n){this.value0=n}return n.create=function(e){return new n(e)},n}()),o=function(n){return function(e){return function(r){return t.member(n)(e)(r.value0)}}},a=function(n){return function(o){return function(a){return new r(t.insert(n)(o)(e.unit)(a.value0))}}},i=new r(t.empty),u=function(n){return function(e){return function(o){return new r(t["delete"](n)(e)(o.value0))}}};n["delete"]=u,n.member=o,n.insert=a,n.empty=i}(PS["Data.Set"]=PS["Data.Set"]||{}),function(n){"use strict";n.unbindFramebuffer_=function(n){return function(){gl.bindFramebuffer(n,null)}},n.readPixels__=function(n,e,t,r,o,a,i){return function(){gl.readPixels(n,e,t,r,o,a,i)}}}(PS["Graphics.WebGLFramebuffer"]=PS["Graphics.WebGLFramebuffer"]||{}),function(n){"use strict";n.asArrayBufferView_=function(n){return n},n.texImage2DNull_=function(n,e,t,r,o,a,i,u){return function(){gl.texImage2D(n,e,t,r,o,a,i,u,null)}},n.bindTexture__=function(n){return function(){gl.bindTexture(n,null)}},n.texSubImage2D__=function(n,e,t,r,o,a,i){return function(){gl.texSubImage2D(n,e,t,r,o,a,i)}}}(PS["Graphics.WebGLTexture"]=PS["Graphics.WebGLTexture"]||{}),function(n){"use strict";var e=PS["Graphics.WebGLTexture"],t=PS.Prelude,r=(PS["Control.Monad.Eff.WebGL"],PS["Graphics.WebGL"],PS["Graphics.WebGLRaw"]),o=(PS["Data.Int.Bits"],PS["Control.Monad.Eff"]),a=PS["Control.Monad"],i=PS.Extensions,u=(PS["Graphics.Canvas"],PS["Data.Function"]),c=PS["Data.TypedArray"],l=(PS["Data.ArrayBuffer.Types"],function(){function n(){}return n.value=new n,n}()),s=function(){function n(){}return n.value=new n,n}(),f=function(){function n(){}return n.value=new n,n}(),d=function(){function n(){}return n.value=new n,n}(),v=function(){function n(){}return n.value=new n,n}(),m=function(){function n(){}return n.value=new n,n}(),h=function(){function n(){}return n.value=new n,n}(),p=function(){function n(){}return n.value=new n,n}(),w=function(){function n(){}return n.value=new n,n}(),g=function(){function n(){}return n.value=new n,n}(),C=function(){function n(){}return n.value=new n,n}(),S=function(){function n(){}return n.value=new n,n}(),P=function(){function n(){}return n.value=new n,n}(),y=function(){function n(){}return n.value=new n,n}(),T=function(){function n(){}return n.value=new n,n}(),b=function(){function n(){}return n.value=new n,n}(),E=function(){function n(){}return n.value=new n,n}(),x=function(){function n(){}return n.value=new n,n}(),F=function(){function n(){}return n.value=new n,n}(),A=function(){function n(){}return n.value=new n,n}(),N=function(){function n(){}return n.value=new n,n}(),_=function(){function n(){}return n.value=new n,n}(),D=function(){function n(){}return n.value=new n,n}(),M=function(){function n(){}return n.value=new n,n}(),L=function(){function n(){}return n.value=new n,n}(),I=function(){function n(){}return n.value=new n,n}(),O=function(){function n(){}return n.value=new n,n}(),R=function(){function n(){}return n.value=new n,n}(),k=function(){function n(){}return n.value=new n,n}(),U=function(){function n(){}return n.value=new n,n}(),G=function(){function n(){}return n.value=new n,n}(),B=function(){function n(){}return n.value=new n,n}(),J=u.runFn2(r.uniform1i_),$=function(n){if(n instanceof l)return r._UNSIGNED_BYTE;if(n instanceof s)return r._RGBA;if(n instanceof f)return r._FLOAT;if(n instanceof d)return r._UNSIGNED_SHORT_5_6_5;if(n instanceof v)return r._UNSIGNED_SHORT_4_4_4_4;if(n instanceof m)return r._UNSIGNED_SHORT_5_5_5_1;throw new Error("Failed pattern match at Graphics.WebGLTexture line 102, column 1 - line 103, column 1: "+[n.constructor.name])},H=function(n){if(n instanceof h)return r._TEXTURE_2D;if(n instanceof p)return r._TEXTURE_CUBE_MAP;throw new Error("Failed pattern match at Graphics.WebGLTexture line 128, column 1 - line 129, column 1: "+[n.constructor.name])},z=function(n){if(n instanceof w)return r._TEXTURE_MIN_FILTER;if(n instanceof g)return r._TEXTURE_MAG_FILTER;if(n instanceof C)return r._TEXTURE_WRAP_S;if(n instanceof S)return r._TEXTURE_WRAP_T;throw new Error("Failed pattern match at Graphics.WebGLTexture line 139, column 1 - line 140, column 1: "+[n.constructor.name])},W=function(n){return function(e){return function(t){return r.texParameteri_(H(n),z(e),t)}}},j=function(n){if(n instanceof P)return r._NEAREST;if(n instanceof y)return r._LINEAR;if(n instanceof T)return r._LINEAR_MIPMAP_NEAREST;throw new Error("Failed pattern match at Graphics.WebGLTexture line 156, column 1 - line 157, column 1: "+[n.constructor.name])},V=function(n){if(n instanceof P)return r._NEAREST;if(n instanceof y)return r._LINEAR;if(n instanceof T)return r._LINEAR;throw new Error("Failed pattern match at Graphics.WebGLTexture line 151, column 1 - line 152, column 1: "+[n.constructor.name])},q=function(n){if(n instanceof b)return r._TEXTURE_2D;if(n instanceof E)return r._TEXTURE_CUBE_MAP_POSITIVE_X;if(n instanceof x)return r._TEXTURE_CUBE_MAP_NEGATIVE_X;if(n instanceof F)return r._TEXTURE_CUBE_MAP_POSITIVE_Y;if(n instanceof A)return r._TEXTURE_CUBE_MAP_NEGATIVE_Y;if(n instanceof N)return r._TEXTURE_CUBE_MAP_POSITIVE_Z;if(n instanceof _)return r._TEXTURE_CUBE_MAP_NEGATIVE_Z;throw new Error("Failed pattern match at Graphics.WebGLTexture line 71, column 1 - line 72, column 1: "+[n.constructor.name])},Z=function(n){return e.bindTexture__(q(n))},K=function(n){if(n instanceof D)return r._PACK_ALIGNMENT;if(n instanceof M)return r._UNPACK_ALIGNMENT;if(n instanceof L)return r._UNPACK_FLIP_Y_WEBGL;if(n instanceof I)return r._UNPACK_PREMULTIPLY_ALPHA_WEBGL;if(n instanceof O)return r._UNPACK_COLORSPACE_CONVERSION_WEBGL;throw new Error("Failed pattern match at Graphics.WebGLTexture line 117, column 1 - line 118, column 1: "+[n.constructor.name])},X=function(n){return function(e){return r.pixelStorei_(K(n),e)}},Y=function(n){if(n instanceof R)return r._ALPHA;if(n instanceof k)return r._LUMINANCE;if(n instanceof U)return r._LUMINANCE_ALPHA;if(n instanceof G)return r._RGB;if(n instanceof B)return r._RGBA;throw new Error("Failed pattern match at Graphics.WebGLTexture line 87, column 1 - line 88, column 1: "+[n.constructor.name])},Q=function(n){return function(t){return function(r){return function(o){return function(a){return function(i){return function(u){return e.texImage2DNull_(q(n),t,Y(r),o,a,0,Y(i),$(u))}}}}}}},nn=function(n){return function(e){return function(t){return function(o){return function(a){return function(i){return function(u){return function(c){return r.texImage2D_(q(n),e,Y(t),o,a,0,Y(i),$(u),c)}}}}}}}},en=function(n){return function(t){return function(r){return function(o){return function(a){return function(i){return function(u){return e.texSubImage2D__(q(n),t,r,o,Y(a),$(i),u)}}}}}}},tn=function(){var n=r.createTexture_()();return n},rn=function(n){return function(e){return r.bindTexture_(q(n),e)}},on=function(n){return function(e){return function(a){return function(i){return function(i){return function(i){return function(u){return function(){return rn(b.value)(n)(),W(h.value)(g.value)(V(i))(),W(h.value)(w.value)(j(i))(),X(L.value)(0)(),X(I.value)(0)(),en(b.value)(0)(e)(a)(B.value)(l.value)(u)(),function(){return i instanceof T?r.generateMipmap_(r._TEXTURE_2D):t["return"](o.applicativeEff)(t.unit)}()(),Z(b.value)()}}}}}}}},an=function(n){return function(e){return function(i){return function(){var u=tn();return rn(b.value)(u)(),W(h.value)(g.value)(V(i))(),W(h.value)(w.value)(j(i))(),a.when(o.monadEff)(1===(1&(n|e)))(function(){return W(h.value)(C.value)(r._CLAMP_TO_EDGE)(),W(h.value)(S.value)(r._CLAMP_TO_EDGE)()})(),Q(b.value)(0)(B.value)(n)(e)(B.value)(l.value)(),function(){return i instanceof T?r.generateMipmap_(r._TEXTURE_2D):t["return"](o.applicativeEff)(t.unit)}()(),Z(b.value)(),u}}}},un=function(n){return function(i){return function(u){return function(){var s=tn(),f=c.newUint8Array(4*(n*i|0)|0);return rn(b.value)(s)(),W(h.value)(g.value)(V(u))(),W(h.value)(w.value)(j(u))(),a.when(o.monadEff)(1===(1&(n|i)))(function(){return W(h.value)(C.value)(r._CLAMP_TO_EDGE)(),W(h.value)(S.value)(r._CLAMP_TO_EDGE)()})(),nn(b.value)(0)(B.value)(n)(i)(B.value)(l.value)(e.asArrayBufferView_(f))(),function(){return u instanceof T?r.generateMipmap_(r._TEXTURE_2D):t["return"](o.applicativeEff)(t.unit)}()(),Z(b.value)(),s}}}},cn=function(n){if(n<r._MAX_COMBINED_TEXTURE_IMAGE_UNITS)return r.activeTexture_(r._TEXTURE0+n|0);if(t.otherwise)return i.fail("WebGLTexture>>activeTexture: wrong argument!");throw new Error("Failed pattern match at Graphics.WebGLTexture line 274, column 1 - line 277, column 1: "+[n.constructor.name])},ln=function(n){return function(e){return function(t){return function(r){return function(o){return function(){return cn(e)(),rn(b.value)(n)(),J(t.uLocation)(r)(),o(),Z(b.value)()}}}}}};n.NEAREST=P,n.LINEAR=y,n.MIPMAP=T,n.TEXTURE_MIN_FILTER=w,n.TEXTURE_MAG_FILTER=g,n.TEXTURE_WRAP_S=C,n.TEXTURE_WRAP_T=S,n.TTEXTURE_2D=h,n.TTEXTURE_CUBE_MAP=p,n.PACK_ALIGNMENT=D,n.UNPACK_ALIGNMENT=M,n.UNPACK_FLIP_Y_WEBGL=L,n.UNPACK_PREMULTIPLY_ALPHA_WEBGL=I,n.UNPACK_COLORSPACE_CONVERSION_WEBGL=O,n.UNSIGNED_BYTE=l,n.RGBA=s,n.FLOAT=f,n.UNSIGNED_SHORT_5_6_5=d,n.UNSIGNED_SHORT_4_4_4_4=v,n.UNSIGNED_SHORT_5_5_5_1=m,n.IF_ALPHA=R,n.IF_LUMINANCE=k,n.IF_LUMINANCE_ALPHA=U,n.IF_RGB=G,n.IF_RGBA=B,n.TEXTURE_2D=b,n.TEXTURE_CUBE_MAP_POSITIVE_X=E,n.TEXTURE_CUBE_MAP_NEGATIVE_X=x,n.TEXTURE_CUBE_MAP_POSITIVE_Y=F,n.TEXTURE_CUBE_MAP_NEGATIVE_Y=A,n.TEXTURE_CUBE_MAP_POSITIVE_Z=N,n.TEXTURE_CUBE_MAP_NEGATIVE_Z=_,n.targetTypeToConst=q,n.newTextureInit=un,n.newTexture=an,n.createTexture=tn,n.handleSubLoad2D=on,n.unbindTexture=Z,n.bindTexture=rn,n.activeTexture=cn,n.withTexture2D=ln}(PS["Graphics.WebGLTexture"]=PS["Graphics.WebGLTexture"]||{}),function(n){"use strict";var e=PS["Graphics.WebGLFramebuffer"],t=(PS.Prelude,PS["Control.Monad.Eff.WebGL"],PS["Graphics.WebGLRaw"]),r=PS["Graphics.WebGLTexture"],o=(PS["Control.Monad.Eff"],PS["Data.ArrayBuffer.Types"],PS["Data.TypedArray"]),a=PS["Data.Function"],i=function(){function n(){}return n.value=new n,n}(),u=function(){function n(){}return n.value=new n,n}(),c=function(){function n(){}return n.value=new n,n}(),l=function(){function n(){}return n.value=new n,n}(),s=e.unbindFramebuffer_(t._FRAMEBUFFER),f=function(n){return function(r){return function(a){return function(i){return function(u){var c=o.asUint8Array(o.asArray(u));return function(){return e.readPixels__(n,r,a,i,t._RGBA,t._UNSIGNED_BYTE,c)(),c}}}}}},d=function(){var n=t.createFramebuffer_()();return n},v=a.runFn1(t.checkFramebufferStatus_),m=function(n){return t.bindFramebuffer_(t._FRAMEBUFFER,n)},h=function(n){if(n instanceof i)return t._COLOR_ATTACHMENT0;if(n instanceof u)return t._DEPTH_ATTACHMENT;if(n instanceof c)return t._STENCIL_ATTACHMENT;if(n instanceof l)return t._DEPTH_STENCIL_ATTACHMENT;throw new Error("Failed pattern match at Graphics.WebGLFramebuffer line 60, column 1 - line 61, column 1: "+[n.constructor.name])},p=function(n){return function(e){return function(o){return t.framebufferTexture2D_(t._FRAMEBUFFER,h(n),r.targetTypeToConst(e),o,0)}}};n.COLOR_ATTACHMENT0=i,n.DEPTH_ATTACHMENT=u,n.STENCIL_ATTACHMENT=c,n.DEPTH_STENCIL_ATTACHMENT=l,n.readPixels=f,n.framebufferTexture2D=p,n.unbindFramebuffer=s,n.bindFramebuffer=m,n.checkFramebufferStatus=v,n.createFramebuffer=d}(PS["Graphics.WebGLFramebuffer"]=PS["Graphics.WebGLFramebuffer"]||{}),function(n){"use strict";var e=(PS["Data.Generic"],PS.Prelude),t=(PS["Data.Either"],PS["Data.Maybe"]),r=(PS["Data.Tuple"],PS["Data.Traversable"],PS["Data.Foldable"],PS["Data.Array"]),o=PS["Data.String"],a=PS["Type.Proxy"],i=(PS["Data.Monoid"],function(){function n(n,e){this.value0=n,this.value1=e}return n.create=function(e){return function(t){return new n(e,t)}},n}()),u=function(){function n(n){this.value0=n}return n.create=function(e){return new n(e)},n}(),c=function(){function n(n){this.value0=n}return n.create=function(e){return new n(e)},n}(),l=function(){function n(n){this.value0=n}return n.create=function(e){return new n(e)},n}(),s=function(){function n(n){this.value0=n}return n.create=function(e){return new n(e)},n}(),f=function(){function n(n){this.value0=n}return n.create=function(e){return new n(e)},n}(),d=function(){function n(n){this.value0=n}return n.create=function(e){return new n(e)},n}(),v=function(){function n(n){this.value0=n}return n.create=function(e){return new n(e)},n}(),m=function(){function n(n,e){this.value0=n,this.value1=e}return n.create=function(e){return function(t){return new n(e,t)}},n}(),h=function(){function n(n){this.value0=n}return n.create=function(e){return new n(e)},n}(),p=function(){function n(){}return n.value=new n,n}(),w=function(){function n(){}return n.value=new n,n}(),g=function(n,e,t){this.fromSpine=n,this.toSignature=e,this.toSpine=t},C=function(n){return n.toSpine},S=function(n){return n.toSignature},P=function(n){return function(t){if(t instanceof i){var a=function(n){return function(e){if(!n)return e;if(n)return"("+(e+")");throw new Error("Failed pattern match at Data.Generic line 240, column 9 - line 241, column 9: "+[n.constructor.name,e.constructor.name])}},m=r["null"](t.value1);
if(m)return t.value0;if(!m)return a(n>10)(t.value0+(" "+o.joinWith(" ")(e.map(e.functorArray)(function(n){return P(11)(n(e.unit))})(t.value1))));throw new Error("Failed pattern match at Data.Generic line 237, column 5 - line 240, column 3: "+[m.constructor.name])}if(t instanceof u)return"{"+(o.joinWith(", ")(e.map(e.functorArray)(function(n){return n.recLabel+(": "+P(0)(n.recValue(e.unit)))})(t.value0))+"}");if(t instanceof l)return e.show(e.showBoolean)(t.value0);if(t instanceof s)return e.show(e.showInt)(t.value0);if(t instanceof c)return e.show(e.showNumber)(t.value0);if(t instanceof f)return e.show(e.showString)(t.value0);if(t instanceof d)return e.show(e.showChar)(t.value0);if(t instanceof v)return"["+(o.joinWith(", ")(e.map(e.functorArray)(function(n){return P(0)(n(e.unit))})(t.value0))+"]");throw new Error("Failed pattern match at Data.Generic line 236, column 1 - line 243, column 1: "+[n.constructor.name,t.constructor.name])}},y=new g(function(n){return n instanceof c?new t.Just(n.value0):t.Nothing.value},function(n){return p.value},function(n){return new c(n)}),T=new g(function(n){return n instanceof s?new t.Just(n.value0):t.Nothing.value},function(n){return w.value},function(n){return new s(n)}),b=function(n){return function(e){return P(0)(C(n)(e))}},E=function(n){return n.fromSpine};a.Proxy.value;n.SigProd=m,n.SigRecord=h,n.SigNumber=p,n.SigInt=w,n.SProd=i,n.SRecord=u,n.SNumber=c,n.SBoolean=l,n.SInt=s,n.SString=f,n.SChar=d,n.SArray=v,n.Generic=g,n.gShow=b,n.fromSpine=E,n.toSignature=S,n.toSpine=C,n.genericNumber=y,n.genericInt=T}(PS["Data.Generic"]=PS["Data.Generic"]||{}),function(n){"use strict";var e=PS.Prelude,t=(PS["Data.ArrayBuffer.Types"],PS["Data.ST.Matrix4"],PS["Data.STSequence"]),r=PS["Data.StrMap"],o=(PS.ConeCanvas,PS["ConeCanvas.ConeControlTypes"],PS["ConeCanvas.Frontend.Shaders"],PS["Control.Monad.Eff.WebGL"],PS["Control.Monad.ST"],PS["Data.Maybe"]),a=(PS["Data.Set"],PS["Graphics.Canvas"],PS["Graphics.WebGL"],PS["Graphics.WebGLFramebuffer"],PS["Graphics.WebGLTexture"],PS.Math),i=(PS["Control.Monad.Eff"],PS["Data.Generic"]),u=(PS["ConeCanvas.GeometryTypes"],function(n){return n}),c=function(){function n(){}return n.value=new n,n}(),l=function(){function n(){}return n.value=new n,n}(),s=function(){function n(){}return n.value=new n,n}(),f=function(){function n(){}return n.value=new n,n}(),d=function(){function n(){}return n.value=new n,n}(),v=function(){function n(){}return n.value=new n,n}(),m=1.5*a.pi,h=.3,p=function(n){return n},w=5,g=w/5,C={cacheIndex:-1,row:0,column:0},S=new i.Generic(function(n){return n instanceof i.SProd&&"ConeCanvas.Frontend.DrawTypes3d.TextureAdmin"===n.value0&&1===n.value1.length?e.apply(o.applyMaybe)(new o.Just(u))(function(n){return n instanceof i.SRecord&&8===n.value0.length?e.apply(o.applyMaybe)(e.apply(o.applyMaybe)(e.apply(o.applyMaybe)(e.apply(o.applyMaybe)(e.apply(o.applyMaybe)(e.apply(o.applyMaybe)(e.apply(o.applyMaybe)(e.apply(o.applyMaybe)(new o.Just(function(n){return function(e){return function(t){return function(r){return function(o){return function(a){return function(i){return function(u){return{iconLoadNum:n,iconLoadTimeMax:e,iconLoadTimeMin:t,iconLoadTimeSum:r,textTextureLoadNum:o,textTextureLoadTimeMax:a,textTextureLoadTimeMin:i,textTextureLoadTimeSum:u}}}}}}}}}))(i.fromSpine(i.genericInt)(n.value0[0].recValue(e.unit))))(i.fromSpine(i.genericNumber)(n.value0[1].recValue(e.unit))))(i.fromSpine(i.genericNumber)(n.value0[2].recValue(e.unit))))(i.fromSpine(i.genericNumber)(n.value0[3].recValue(e.unit))))(i.fromSpine(i.genericInt)(n.value0[4].recValue(e.unit))))(i.fromSpine(i.genericNumber)(n.value0[5].recValue(e.unit))))(i.fromSpine(i.genericNumber)(n.value0[6].recValue(e.unit))))(i.fromSpine(i.genericNumber)(n.value0[7].recValue(e.unit))):o.Nothing.value}(n.value1[0](e.unit))):o.Nothing.value},function(n){return new i.SigProd("ConeCanvas.Frontend.DrawTypes3d.TextureAdmin",[{sigConstructor:"ConeCanvas.Frontend.DrawTypes3d.TextureAdmin",sigValues:[function(n){return new i.SigRecord([{recLabel:"iconLoadNum",recValue:function(n){return i.toSignature(i.genericInt)(i.anyProxy)}},{recLabel:"iconLoadTimeMax",recValue:function(n){return i.toSignature(i.genericNumber)(i.anyProxy)}},{recLabel:"iconLoadTimeMin",recValue:function(n){return i.toSignature(i.genericNumber)(i.anyProxy)}},{recLabel:"iconLoadTimeSum",recValue:function(n){return i.toSignature(i.genericNumber)(i.anyProxy)}},{recLabel:"textTextureLoadNum",recValue:function(n){return i.toSignature(i.genericInt)(i.anyProxy)}},{recLabel:"textTextureLoadTimeMax",recValue:function(n){return i.toSignature(i.genericNumber)(i.anyProxy)}},{recLabel:"textTextureLoadTimeMin",recValue:function(n){return i.toSignature(i.genericNumber)(i.anyProxy)}},{recLabel:"textTextureLoadTimeSum",recValue:function(n){return i.toSignature(i.genericNumber)(i.anyProxy)}}])}]}])},function(n){return new i.SProd("ConeCanvas.Frontend.DrawTypes3d.TextureAdmin",[function(e){return new i.SRecord([{recLabel:"iconLoadNum",recValue:function(e){return i.toSpine(i.genericInt)(n.iconLoadNum)}},{recLabel:"iconLoadTimeMax",recValue:function(e){return i.toSpine(i.genericNumber)(n.iconLoadTimeMax)}},{recLabel:"iconLoadTimeMin",recValue:function(e){return i.toSpine(i.genericNumber)(n.iconLoadTimeMin)}},{recLabel:"iconLoadTimeSum",recValue:function(e){return i.toSpine(i.genericNumber)(n.iconLoadTimeSum)}},{recLabel:"textTextureLoadNum",recValue:function(e){return i.toSpine(i.genericInt)(n.textTextureLoadNum)}},{recLabel:"textTextureLoadTimeMax",recValue:function(e){return i.toSpine(i.genericNumber)(n.textTextureLoadTimeMax)}},{recLabel:"textTextureLoadTimeMin",recValue:function(e){return i.toSpine(i.genericNumber)(n.textTextureLoadTimeMin)}},{recLabel:"textTextureLoadTimeSum",recValue:function(e){return i.toSpine(i.genericNumber)(n.textTextureLoadTimeSum)}}])}])}),P=new e.Eq(function(n){return function(e){return n instanceof c&&e instanceof c?!0:n instanceof l&&e instanceof l?!0:n instanceof s&&e instanceof s}}),y=new e.Eq(function(n){return function(e){return n instanceof f&&e instanceof f?!0:n instanceof d&&e instanceof d?!0:n instanceof v&&e instanceof v}}),T={iconLoadTimeSum:0,iconLoadTimeMax:0,iconLoadTimeMin:0,iconLoadNum:0,textTextureLoadTimeSum:0,textTextureLoadTimeMax:0,textTextureLoadTimeMin:0,textTextureLoadNum:0},b=function(){var n=t.emptyWithBufferSize(1e3)(),e=t.emptyWithBufferSize(1e3)(),o=t.emptyWithBufferSize(1e3)(),a=t.emptyWithBufferSize(1e3)(),i=t.emptyWithBufferSize(1e3)(),u=t.emptyWithBufferSize(1e3)();return{iconCache:r.empty,iconTextures:n,lastIconTexture:C,iconLoad:e,iconPreload:o,iconTextureWidth:128,iconTextureHeight:128,iconCacheColumns:8,iconCacheRows:8,textTextures:a,textTextureCache:r.empty,lastTextTexture:C,textLoad:i,textPreload:u,textTextureWidth:320,textTextureWidthP2:512,textTextureHeight:64,textTextureHeightP2:64,textCacheColumns:2,textCacheRows:16,textureAdmin:T}},E={x:0,y:0,z:0},x=1;n.DTCone=f,n.DTLeaf=d,n.DTFloatLabel=v,n.InsideFrustum=c,n.OutsideFrustum=l,n.AboveFrustum=s,n.TextureAdmin=u,n.runTextureAdmin=p,n.emptyTextureAdmin=T,n.initialTexturePos=C,n.emptyTextureCache=b,n.labelHeightFactor=g,n.labelWidthFactor=w,n.coosTop=E,n.startAngleConst=m,n.sphereRadius=h,n.coneRadius=x,n.genericTextureAdimin=S,n.eqFrustumVerdict=P,n.eqDrawTag=y}(PS["ConeCanvas.Frontend.DrawTypes3d"]=PS["ConeCanvas.Frontend.DrawTypes3d"]||{}),function(n){"use strict";var e=(PS.Prelude,PS["Data.TypeNat"],PS["Data.Matrix"],PS["Data.Maybe"]),t=PS.Extensions,r=function(n){if(16===n.length){var r=n[10]*n[15]-n[11]*n[14],o=n[9]*n[15]-n[11]*n[13],a=n[9]*n[14]-n[10]*n[13],i=n[8]*n[15]-n[11]*n[12],u=n[8]*n[14]-n[10]*n[12],c=n[8]*n[13]-n[9]*n[12],l=n[2]*n[7]-n[3]*n[6],s=n[1]*n[7]-n[3]*n[5],f=n[1]*n[6]-n[2]*n[5],d=n[0]*n[7]-n[3]*n[4],v=n[0]*n[6]-n[2]*n[4],m=n[0]*n[5]-n[1]*n[4],h=m*r-v*o+d*a+f*i-s*u+l*c,p=0===h;if(p)return e.Nothing.value;if(!p){var w=1/h;return e.Just.create([(n[5]*r-n[6]*o+n[7]*a)*w,(n[6]*i-n[4]*r-n[7]*u)*w,(n[4]*o-n[5]*i+n[7]*c)*w,(n[2]*o-n[1]*r-n[3]*a)*w,(n[0]*r-n[2]*i+n[3]*u)*w,(n[1]*i-n[0]*o-n[3]*c)*w,(n[13]*l-n[14]*s+n[15]*f)*w,(n[14]*d-n[12]*l-n[15]*v)*w,(n[12]*s-n[13]*d+n[15]*m)*w])}throw new Error("Failed pattern match at Data.Matrix3 line 51, column 6 - line 66, column 1: "+[p.constructor.name])}return t.fail("Matrix4>>normalFromMat4: Impossible!")};n.normalFromMat4=r}(PS["Data.Matrix3"]=PS["Data.Matrix3"]||{}),function(n){"use strict";var e=(PS.Prelude,PS["Data.TypeNat"]),t=PS["Data.Vector3"],r=PS["Graphics.WebGL"],o=(PS.ConeCanvas,PS["ConeCanvas.ConeControlTypes"],PS["ConeCanvas.Frontend.DrawTypes3d"],PS["Control.Monad"]),a=PS["Data.Int"],i=PS["Data.Matrix"],u=PS["Data.Matrix3"],c=PS["Data.Matrix4"],l=PS["Data.Maybe"],s=PS["Data.ST.Matrix"],f=(PS["Data.ST.Matrix4"],PS.Extensions),d=PS.Math,v=PS["Control.Monad.Eff"],m=PS["ConeCanvas.ConeModel"],h=function(n){return function(n){return function(t){return function(a){return function(){var c=s.fromSTMat(e.s4)(n.bindings.mvMatrix)();return r.setUniformFloats(n.bindings.uMVMatrix)(i.toArray(c))(),o.when(v.monadEff)(a)(function(){var e=function(){var n=u.normalFromMat4(c);if(n instanceof l.Nothing)return f.fail("ConeView3D setMVMatrix: no inverse of MV matrix");if(n instanceof l.Just)return n.value0;throw new Error("Failed pattern match at ConeCanvas.Frontend.Matrix line 120, column 23 - line 123, column 9: "+[n.constructor.name])}();return r.setUniformFloats(n.bindings.uNMatrix)(i.toArray(e))}())(),r.setUniformFloats(n.bindings.uScale)([t])(),n.bindings.mvMatrix}}}}},p=function(n){return function(e){var t=c.makeOrtho2D(-2.5)(2.5)(-2.5)(2.5);return function(){return r.setUniformFloats(e.bindings.uPMatrix)(i.toArray(t))(),s.copyToSTMat(t)(e.bindings.pMatrix)(),r.setUniformFloats(e.bindings.uMVMatrix)(i.toArray(c.identity))(),s.copyToSTMat(c.identity)(e.bindings.mvMatrix)(),r.disable(r.DEPTH_TEST.value)(),h(n)(e)(1)(!0)(),e.bindings.mvMatrix}}},w=function(n){return function(n){return function(t){return function(){var r=s.fromSTMat(e.s4)(n.bindings.mvMatrix)(),o=t(n.bindings.mvMatrix)();return s.copyToSTMat(r)(n.bindings.mvMatrix)(),o}}}},g=function(n){var e=function(){return n.guiStyle instanceof m.OuterLabel?a.toNumber(n.windowSize.x)/a.toNumber(n.windowSize.y):n.prefs.labelRatio*(a.toNumber(n.windowSize.x)/a.toNumber(n.windowSize.y))}();return e},C=7.5,S=10,P=-5,y=function(n){return function(n){var e=P+2.5,r=c.makeLookAt(t.vec3(0)(P)(-n.prefs.cameraDistZ))(t.vec3(0)(e)(0))(t.vec3(0)(1)(0));return function(){return s.copyToSTMat(r)(n.bindings.mvMatrix)(),n.bindings.mvMatrix}}},T=function(n){return function(e){return function(t){var o=C*e.prefs.windowsRatio,a=d.sqrt(e.prefs.cameraDistZ*e.prefs.cameraDistZ+P*P),u=a+S/2,l=a-S/2,f=l/a*C,v=l/a*P+e.prefs.upperOffset,m=l/a*o,h=v+f,p={f1:-m/2,f2:m/2,f3:v,f4:h,f5:l,f6:u},w=c.makeFrustum(p.f1/e.controlState.zoom)(p.f2/e.controlState.zoom)(p.f3/e.controlState.zoom)(p.f4/e.controlState.zoom)(p.f5)(p.f6+t);return function(){r.setUniformFloats(e.bindings.uPMatrix)(i.toArray(w))(),s.copyToSTMat(w)(e.bindings.pMatrix)();var t=y(n)(e)();return r.enable(r.DEPTH_TEST.value)(),t}}}};n.setPerspectiveLabel=p,n.setMVMatrix=h,n.initialMVMatrix=y,n.setPerspective=T,n.getPerspectiveRatio=g,n.preservingMatrix=w}(PS["ConeCanvas.Frontend.Matrix"]=PS["ConeCanvas.Frontend.Matrix"]||{}),function(n){"use strict";var e=PS.Prelude,t=PS["Data.Maybe"],r=PS.Math,o=PS["Data.Int"],a=PS["Data.ST.Matrix4"],i=PS["Data.Vector"],u=PS["Graphics.WebGL"],c=(PS["Data.ArrayBuffer.Types"],PS.Extensions),l=(PS.ConeCanvas,PS["ConeCanvas.ConeControlTypes"],PS["ConeCanvas.Frontend.DrawTypes3d"],PS["ConeCanvas.Frontend.Matrix"]),s=PS["Data.STSequence"],f=PS["ConeCanvas.Color"],d=PS["Control.Monad.Eff"],v=[0,0,0],m=60,h=function(n){return function(r){return function(o){return function(i){return function(c){return function(s){return function(d){return function(d){return function(v){var m=function(){return o.condColor instanceof t.Just?[o.condColor.value0.value0,o.condColor.value0.value1,o.condColor.value0.value2,o.fade]:f.color4toArray(r.prefs.massiveColor)}();return l.preservingMatrix(n)(r)(function(t){return function(){return a.translateST([-i,-c,s])(r.bindings.mvMatrix)(),a.scaleST3(d)(d)(d)(r.bindings.mvMatrix)(),l.setMVMatrix(n)(r)(d*v)(!0)(),u.setUniformBoolean(r.bindings.uUseTexture)(!1)(),u.setUniformBoolean(r.bindings.uSimple)(!1)(),u.enableVertexAttribArray(r.bindings.aVertexNormal)(),u.disableVertexAttribArray(r.bindings.aTextureCoord)(),u.setUniformFloats(r.bindings.uMaterialAmbient)(m)(),u.setUniformFloats(r.bindings.uMaterialDiffuse)(m)(),u.setUniformFloats(r.bindings.uMaterialSpecular)(m)(),u.bindBufAndSetVertexAttr(r.bindings.nBufferCone)(r.bindings.aVertexNormal)(),u.drawArr(u.TRIANGLE_FAN.value)(r.bindings.vBufferCone)(r.bindings.aVertexPosition)(),e.unit}})}}}}}}}}},p=function(n){return function(e){return function(t){if(3===n.length&&3===e.length&&3===t.length){var r=t[2]-n[2],o=t[1]-n[1],a=t[0]-n[0],u=e[2]-n[2],l=e[1]-n[1],s=e[0]-n[0];return i.toArray(i.normalize([l*r-u*o,u*a-s*r,s*o-l*a]))}return c.fail("WebGLHelpers>>calcNormal: Wrong array size!")}}},w=function(n){var a=2*r.pi/o.toNumber(m),i=r.sin(a),c=r.cos(a),l=function(r){return function(o){return function(a){return function(u){return function(f){return function(h){if(a>m){var w=[-u,-n,f];if(h instanceof t.Just)return function(){return s.pushAll(o)(p(w)(v)(h.value0))(),e.unit};if(h instanceof t.Nothing)return e["return"](d.applicativeEff)(e.unit);throw new Error("Failed pattern match at ConeCanvas.Frontend.Cone line 97, column 13 - line 102, column 9: "+[h.constructor.name])}if(e.otherwise){var w=[-u,-n,f];return function(){return s.pushAll(r)(w)(),function(){if(h instanceof t.Just)return function(){return s.pushAll(o)(p(w)(v)(h.value0))(),e.unit};if(h instanceof t.Nothing)return e["return"](d.applicativeEff)(e.unit);throw new Error("Failed pattern match at ConeCanvas.Frontend.Cone line 105, column 13 - line 110, column 13: "+[h.constructor.name])}()(),l(r)(o)(a+1|0)(c*u-i*f)(i*u+c*f)(new t.Just(w))()}}throw new Error("Failed pattern match at ConeCanvas.Frontend.Cone line 94, column 5 - line 113, column 1: "+[r.constructor.name,o.constructor.name,a.constructor.name,u.constructor.name,f.constructor.name,h.constructor.name])}}}}}};return function(){var n=s.empty(),e=s.empty();s.pushAll(n)(v)(),s.pushAll(e)([0,0,0])(),l(n)(e)(0)(1)(0)(t.Nothing.value)();var r=s.toArray(n)(),o=s.toArray(e)(),a=u.makeBufferFloat(r)(),i=u.makeBufferFloat(o)();return{vBuffer:a,nBuffer:i}}};n.calcNormal=p,n.prepareConeXZ=w,n.drawConeXZ=h}(PS["ConeCanvas.Frontend.Cone"]=PS["ConeCanvas.Frontend.Cone"]||{}),function(n){"use strict";n.fillText2=function(n){return function(e){return function(t){return function(r){return function(o){return function(){return n.fillText(e,t,r,o),n}}}}}},n.setTextBaseline=function(n){return function(e){return function(){return e.textBaseline=n,e}}}}(PS["ConeCanvas.Frontend.Text"]=PS["ConeCanvas.Frontend.Text"]||{}),function(n){"use strict";var e=PS["ConeCanvas.Frontend.Text"],t=(PS.Prelude,PS.ConeCanvas,PS["ConeCanvas.ConeControlTypes"],PS["ConeCanvas.Frontend.DrawTypes3d"],PS["Control.Monad.Eff"],PS["Data.Maybe"]),r=PS.Extensions,o=PS["Graphics.Canvas"],a=PS["ConeCanvas.Color"],i=function(n){return function(n){return function(i){return function(){var u=o.getCanvasElementById("textureCanvas")();if(u instanceof t.Nothing)return r.fail("Card>>makeTextTexture: missing hidden canvas: textureCanvas")();if(u instanceof t.Just){var c=o.getContext2D(u.value0)(),l=o.getCanvasWidth(u.value0)(),s=o.getCanvasHeight(u.value0)();return e.setTextBaseline("bottom")(c)(),o.setTextAlign(c)(o.AlignCenter.value)(),o.setFont(n.prefs.fontStyle)(c)(),o.clearRect(c)({x:0,y:0,w:l,h:s})(),o.setFillStyle(a.color4IasFillStyle(n.prefs.textColor))(c)(),e.fillText2(c)(i)(l/2)(s-6)(l-6)(),u.value0}throw new Error("Failed pattern match at ConeCanvas.Frontend.Text line 35, column 3 - line 50, column 1: "+[u.constructor.name])}}}};n.makeText=i}(PS["ConeCanvas.Frontend.Text"]=PS["ConeCanvas.Frontend.Text"]||{}),function(n){"use strict";var e=PS.Prelude,t=PS["Data.ST.Matrix4"],r=PS["Data.STSequence"],o=PS["Data.StrMap"],a=(PS["Data.Vector"],PS["Graphics.WebGLAll"],PS.ConeCanvas,PS["ConeCanvas.ConeControlTypes"],PS["ConeCanvas.Frontend.DrawTypes3d"]),i=PS["ConeCanvas.Frontend.Matrix"],u=PS["ConeCanvas.Frontend.Text"],c=PS["Control.Monad"],l=PS["Control.Monad.ST"],s=(PS["Data.ArrayBuffer.Types"],PS["Data.Int"]),f=PS["Data.Maybe"],d=PS["Data.TypedArray"],v=PS.Extensions,m=PS.Math,h=PS["Graphics.Canvas"],p=PS["Debug.Trace"],w=PS["Control.Monad.Eff"],g=PS["Graphics.WebGL"],C=PS["Graphics.WebGLTexture"],S=PS["ConeCanvas.Color"],P=PS["ConeCanvas.ConeControl"],y=function(){var n=g.makeBufferFloatDyn([0,0,1,0,1,1,0,1])(),t=g.makeBuffer(e.moduloSemiringInt)(g.ELEMENT_ARRAY_BUFFER.value)(d.asUint16Array)([0,1,2,0,2,3])(),r=g.makeBufferFloat([0,0,0,1,0,0,1,1,0,0,1,0])();return{textureCoords:n,vertexIndices:t,vertexCoos:r}},T=function(n){return function(){var e=h.getCanvasElementById("iconCanvas")();if(e instanceof f.Nothing)return v.fail("Card>>makeIcon: missing hidden canvas: iconCanvas")();if(e instanceof f.Just){var t=h.getContext2D(e.value0)(),r=h.getCanvasWidth(e.value0)(),o=h.getCanvasHeight(e.value0)();return h.clearRect(t)({x:0,y:0,w:r,h:o})(),h.drawImageScale(t)(n)(0)(0)(r)(o)(),e.value0}throw new Error("Failed pattern match at ConeCanvas.Frontend.Textures line 314, column 5 - line 324, column 1: "+[e.constructor.name])}},b=function(n){return function(t){return function(){var o=r.peek(n.textTextures)(t.cacheIndex)();if(o instanceof f.Nothing)return v.fail("Textures>>lookupTextTexturePos: textureIndex invalid: "+e.show(e.showInt)(t.cacheIndex))();if(o instanceof f.Just)return{x1:s.toNumber(t.column)/s.toNumber(n.textCacheColumns),x2:(s.toNumber(t.column)+s.toNumber(n.textTextureWidth)/s.toNumber(n.textTextureWidthP2))/s.toNumber(n.textCacheColumns),y1:s.toNumber(t.row)/s.toNumber(n.textCacheRows),y2:(s.toNumber(t.row)+s.toNumber(n.textTextureHeight)/s.toNumber(n.textTextureHeightP2))/s.toNumber(n.textCacheRows),texture:o.value0};throw new Error("Failed pattern match at ConeCanvas.Frontend.Textures line 120, column 5 - line 131, column 1: "+[o.constructor.name])}}},E=function(n){return function(t){return function(){var o=r.peek(n.iconTextures)(t.cacheIndex)();if(o instanceof f.Nothing)return v.fail("Textures>>lookupIconTexturePos: textureIndex invalid: "+e.show(e.showInt)(t.cacheIndex))();if(o instanceof f.Just)return{x1:s.toNumber(t.column)/s.toNumber(n.iconCacheColumns),x2:s.toNumber(t.column+1|0)/s.toNumber(n.iconCacheColumns),y1:s.toNumber(t.row)/s.toNumber(n.iconCacheRows),y2:s.toNumber(t.row+1|0)/s.toNumber(n.iconCacheRows),texture:o.value0};throw new Error("Failed pattern match at ConeCanvas.Frontend.Textures line 156, column 5 - line 165, column 1: "+[o.constructor.name])}}},x=function(n){return function(n){return function(t){return function(a){return function(){var i=l.readSTRef(n.bindings.textureRef)(),u=o.lookup(t)(i.textTextureCache);if(u instanceof f.Just&&u.value0 instanceof f.Just){var c=b(i)(u.value0.value0)();return a(c)()}if(u instanceof f.Just&&u.value0 instanceof f.Nothing)return e.unit;if(u instanceof f.Nothing)return r.push(i.textLoad)(t)(),l.modifySTRef(n.bindings.textureRef)(function(n){var e={};for(var r in n)n.hasOwnProperty(r)&&(e[r]=n[r]);return e.textTextureCache=o.insert(t)(f.Nothing.value)(n.textTextureCache),e})(),e.unit;throw new Error("Failed pattern match at ConeCanvas.Frontend.Textures line 107, column 3 - line 117, column 1: "+[u.constructor.name])}}}}},F=function(n){var t=function(){var e=C.newTextureInit(n.textCacheColumns*n.textTextureWidthP2|0)(n.textCacheRows*n.textTextureHeightP2|0)(C.MIPMAP.value)();r.push(n.textTextures)(e)();var t=r.length(n.textTextures)();return{cacheIndex:t-1,row:0,column:0}},o=n.lastTextTexture.cacheIndex<0;if(o)return t;if(!o){var a=n.lastTextTexture.column<n.textCacheColumns-1;if(a)return e["return"](w.applicativeEff)(function(){var e={};for(var t in n.lastTextTexture)n.lastTextTexture.hasOwnProperty(t)&&(e[t]=n.lastTextTexture[t]);return e.column=n.lastTextTexture.column+1|0,e}());if(!a){var i=n.lastTextTexture.row<n.textCacheRows-1;if(i)return e["return"](w.applicativeEff)(function(){var e={};for(var t in n.lastTextTexture)n.lastTextTexture.hasOwnProperty(t)&&(e[t]=n.lastTextTexture[t]);return e.column=0,e.row=n.lastTextTexture.row+1|0,e}());if(!i)return t;throw new Error("Failed pattern match at ConeCanvas.Frontend.Textures line 275, column 18 - line 278, column 3: "+[i.constructor.name])}throw new Error("Failed pattern match at ConeCanvas.Frontend.Textures line 273, column 14 - line 278, column 3: "+[a.constructor.name])}throw new Error("Failed pattern match at ConeCanvas.Frontend.Textures line 271, column 8 - line 278, column 3: "+[o.constructor.name])},A=function(n){var t=function(){var e=C.newTextureInit(n.iconCacheColumns*n.iconTextureWidth|0)(n.iconCacheRows*n.iconTextureHeight|0)(C.LINEAR.value)();r.push(n.iconTextures)(e)();var t=r.length(n.iconTextures)();return{cacheIndex:t-1,row:0,column:0}},o=n.lastIconTexture.cacheIndex<0;if(o)return t;if(!o){var a=n.lastIconTexture.column<n.iconCacheColumns-1;if(a)return e["return"](w.applicativeEff)(function(){var e={};for(var t in n.lastIconTexture)n.lastIconTexture.hasOwnProperty(t)&&(e[t]=n.lastIconTexture[t]);return e.column=n.lastIconTexture.column+1|0,e}());if(!a){var i=n.lastIconTexture.row<n.iconCacheRows-1;if(i)return e["return"](w.applicativeEff)(function(){var e={};for(var t in n.lastIconTexture)n.lastIconTexture.hasOwnProperty(t)&&(e[t]=n.lastIconTexture[t]);return e.column=0,e.row=n.lastIconTexture.row+1|0,e}());if(!i)return t;throw new Error("Failed pattern match at ConeCanvas.Frontend.Textures line 331, column 18 - line 334, column 3: "+[i.constructor.name])}throw new Error("Failed pattern match at ConeCanvas.Frontend.Textures line 329, column 14 - line 334, column 3: "+[a.constructor.name])}throw new Error("Failed pattern match at ConeCanvas.Frontend.Textures line 327, column 8 - line 334, column 3: "+[o.constructor.name])},N=function(n){return function(n){return function(t){return function(a){var i=function(o){return function(){var a=l.readSTRef(n.bindings.textureRef)();return r.push(a.iconLoad)({name:t,image:o})(),e.unit}};return function(){var r=l.readSTRef(n.bindings.textureRef)(),u=o.lookup(t)(r.iconCache);if(u instanceof f.Just&&u.value0 instanceof f.Just){var c=E(r)(u.value0.value0)();return a(c)()}if(u instanceof f.Just&&u.value0 instanceof f.Nothing)return e.unit;if(u instanceof f.Nothing)return l.modifySTRef(n.bindings.textureRef)(function(n){var e={};for(var r in n)n.hasOwnProperty(r)&&(e[r]=n[r]);return e.iconCache=o.insert(t)(f.Nothing.value)(n.iconCache),e})(),n.loadIconCallback(t)(i)(),e.unit;throw new Error("Failed pattern match at ConeCanvas.Frontend.Textures line 136, column 5 - line 145, column 3: "+[u.constructor.name])}}}}},_=function(n){return function(e){return function(r){return function(o){return function(a){return function(u){return function(c){return function(l){return function(s){return i.preservingMatrix(n)(e)(function(f){return function(){t.translateST([o,-(a+c),0])(e.bindings.mvMatrix)(),t.scaleST3(u)(c)(1)(e.bindings.mvMatrix)(),i.setMVMatrix(n)(e)(s)(!1)();var f=[r.x1,r.y2,r.x2,r.y2,r.x2,r.y1,r.x1,r.y1];return g.fillBuffer(e.bindings.textureCoords)(0)(f)(),g.setUniformBoolean(e.bindings.uUseTexture)(!0)(),g.setUniformBoolean(e.bindings.uSimple)(!1)(),g.setUniformFloats(e.bindings.uTexAmbiance)([l])(),g.disableVertexAttribArray(e.bindings.aVertexNormal)(),g.enableVertexAttribArray(e.bindings.aTextureCoord)(),g.bindBufAndSetVertexAttr(e.bindings.vertexCoos)(e.bindings.aVertexPosition)(),g.bindBufAndSetVertexAttr(e.bindings.textureCoords)(e.bindings.aTextureCoord)(),C.withTexture2D(r.texture)(0)(e.bindings.uSampler)(0)(function(){return g.bindBuf(e.bindings.vertexIndices)(),g.colorMask(!0)(!0)(!0)(!1)(),g.drawElements(g.TRIANGLES.value)(6)(),g.colorMask(!0)(!0)(!0)(!0)()})()}})}}}}}}}}},D=function(n){return function(e){return function(r){return function(o){return function(a){return function(u){return function(c){return function(l){return function(s){if(r instanceof f.Just)return _(n)(e)(r.value0)(o)(a)(u)(c)(l)(s);if(r instanceof f.Nothing)return i.preservingMatrix(n)(e)(function(r){return function(){return t.translateST([o,-(a+c),0])(e.bindings.mvMatrix)(),t.scaleST3(u)(c)(1)(e.bindings.mvMatrix)(),i.setMVMatrix(n)(e)(s)(!1)(),g.setUniformFloats(e.bindings.uMaterialAmbient)(S.color4toArray(e.prefs.rectColor))(),g.setUniformBoolean(e.bindings.uUseTexture)(!1)(),g.setUniformBoolean(e.bindings.uSimple)(!0)(),g.drawArr(g.LINE_LOOP.value)(e.bindings.vertexCoos)(e.bindings.aVertexPosition)()}});throw new Error("Failed pattern match at ConeCanvas.Frontend.Textures line 85, column 5 - line 102, column 1: "+[r.constructor.name])}}}}}}}}},M=function(n){return function(t){return function(){var a=l.readSTRef(t.bindings.textureRef)(),i=r.last(a.textLoad)();if(i instanceof f.Nothing)return!1;if(i instanceof f.Just){var c=u.makeText(n)(t)(i.value0)(),s=F(a)(),d=r.peek(a.textTextures)(s.cacheIndex)();if(d instanceof f.Nothing)return v.fail("Textures>>constructTextTexture: Index failure: "+e.show(e.showInt)(s.cacheIndex))();if(d instanceof f.Just)return C.bindTexture(C.TEXTURE_2D.value)(d.value0)(),C.handleSubLoad2D(d.value0)(a.textTextureWidthP2*s.column|0)(a.textTextureHeightP2*s.row|0)(a.textTextureWidth)(a.textTextureHeight)(C.MIPMAP.value)(c)(),C.unbindTexture(C.TEXTURE_2D.value)(),r.pop(a.textLoad)(),l.modifySTRef(t.bindings.textureRef)(function(n){var e={};for(var t in n)n.hasOwnProperty(t)&&(e[t]=n[t]);return e.textTextureCache=o.insert(i.value0)(new f.Just(s))(n.textTextureCache),e.lastTextTexture=s,e})(),!0;throw new Error("Failed pattern match at ConeCanvas.Frontend.Textures line 254, column 13 - line 268, column 1: "+[d.constructor.name])}throw new Error("Failed pattern match at ConeCanvas.Frontend.Textures line 248, column 5 - line 268, column 1: "+[i.constructor.name])}}},L=function(n){return function(n){return function(){var t=l.readSTRef(n.bindings.textureRef)(),a=r.last(t.iconLoad)();if(a instanceof f.Nothing)return!1;if(a instanceof f.Just){var i=A(t)(),u=r.peek(t.iconTextures)(i.cacheIndex)();if(u instanceof f.Nothing)return v.fail("Textures>>constructIconTexture: Index failure: "+e.show(e.showInt)(i.cacheIndex))();if(u instanceof f.Just){var c=T(a.value0.image)();return C.bindTexture(C.TEXTURE_2D.value)(u.value0)(),C.handleSubLoad2D(u.value0)(t.iconTextureWidth*i.column|0)(t.iconTextureHeight*i.row|0)(t.iconTextureWidth)(t.iconTextureHeight)(C.MIPMAP.value)(c)(),C.unbindTexture(C.TEXTURE_2D.value)(),r.pop(t.iconLoad)(),l.modifySTRef(n.bindings.textureRef)(function(n){var e={};for(var t in n)n.hasOwnProperty(t)&&(e[t]=n[t]);return e.iconCache=o.insert(a.value0.name)(new f.Just(i))(n.iconCache),e.lastIconTexture=i,e})(),!0}throw new Error("Failed pattern match at ConeCanvas.Frontend.Textures line 296, column 13 - line 311, column 1: "+[u.constructor.name])}throw new Error("Failed pattern match at ConeCanvas.Frontend.Textures line 291, column 5 - line 311, column 1: "+[a.constructor.name])}}},I=function(n){return function(t){return function(o){return function(i){return function(u){return function(c){return function(){var s=n,f=t,d=o,v=i,h=u,p=c;n:for(;;){var g=P.getMillisecondsTime(),C=g-v>d;if(C)return p;if(!C){var S=function(){if(h)return M(s)(f);if(!h)return L(s)(f);throw new Error("Failed pattern match at ConeCanvas.Frontend.Textures line 192, column 26 - line 195, column 13: "+[h.constructor.name])}()(),y=P.getMillisecondsTime(),T=y-g;!function(){var n=h&&S;if(n)return function(){return l.modifySTRef(f.bindings.textureRef)(function(n){var e=a.runTextureAdmin(n.textureAdmin),t={};for(var r in n)n.hasOwnProperty(r)&&(t[r]=n[r]);return t.textureAdmin=function(){var n=0===e.textTextureLoadNum;if(n)return a.TextureAdmin(function(){var n={};for(var t in e)e.hasOwnProperty(t)&&(n[t]=e[t]);return n.textTextureLoadTimeSum=T,n.textTextureLoadTimeMax=T,n.textTextureLoadTimeMin=T,n.textTextureLoadNum=1,n}());if(!n)return a.TextureAdmin(function(){var n={};for(var t in e)e.hasOwnProperty(t)&&(n[t]=e[t]);return n.textTextureLoadTimeSum=e.textTextureLoadTimeSum+T,n.textTextureLoadTimeMax=m.max(e.textTextureLoadTimeMax)(T),n.textTextureLoadTimeMin=m.min(e.textTextureLoadTimeMin)(T),n.textTextureLoadNum=e.textTextureLoadNum+1|0,n}());throw new Error("Failed pattern match at ConeCanvas.Frontend.Textures line 203, column 33 - line 213, column 88: "+[n.constructor.name])}(),t})(),e.unit};if(!n){if(S)return function(){return l.modifySTRef(f.bindings.textureRef)(function(n){var e=a.runTextureAdmin(n.textureAdmin),t={};for(var r in n)n.hasOwnProperty(r)&&(t[r]=n[r]);return t.textureAdmin=function(){var n=0===e.iconLoadNum;if(n)return a.TextureAdmin(function(){var n={};for(var t in e)e.hasOwnProperty(t)&&(n[t]=e[t]);return n.iconLoadTimeSum=T,n.iconLoadTimeMax=T,n.iconLoadTimeMin=T,n.iconLoadNum=1,n}());if(!n)return a.TextureAdmin(function(){var n={};for(var t in e)e.hasOwnProperty(t)&&(n[t]=e[t]);return n.iconLoadTimeSum=e.iconLoadTimeSum+T,n.iconLoadTimeMax=m.max(e.iconLoadTimeMax)(T),n.iconLoadTimeMin=m.min(e.iconLoadTimeMin)(T),n.iconLoadNum=e.iconLoadNum+1|0,n}());throw new Error("Failed pattern match at ConeCanvas.Frontend.Textures line 221, column 37 - line 231, column 78: "+[n.constructor.name])}(),t})(),e.unit};if(!S)return e["return"](w.applicativeEff)(e.unit);throw new Error("Failed pattern match at ConeCanvas.Frontend.Textures line 215, column 22 - line 234, column 13: "+[S.constructor.name])}throw new Error("Failed pattern match at ConeCanvas.Frontend.Textures line 197, column 13 - line 234, column 13: "+[n.constructor.name])}()();var b=l.readSTRef(f.bindings.textureRef)(),E=r.length(b.textLoad)(),x=r.length(b.iconLoad)(),F=0===(E+x|0);if(F)return p||S;if(!F){var A=E>x,N=s,_=f,D=d,I=v,O=p||S;s=N,f=_,d=D,v=I,h=A,p=O;continue n}throw new Error("Failed pattern match at ConeCanvas.Frontend.Textures line 237, column 13 - line 243, column 1: "+[F.constructor.name])}throw new Error("Failed pattern match at ConeCanvas.Frontend.Textures line 189, column 5 - line 243, column 1: "+[C.constructor.name])}}}}}}}},O=function(n){return function(t){return function(o){return function(){var a=l.readSTRef(t.bindings.textureRef)(),i=P.getMillisecondsTime(),u=r.length(a.textLoad)(),s=r.length(a.iconLoad)();!function(){var r=0===(u+s|0);if(r)return e["return"](w.applicativeEff)(e.unit);if(!r){var a=u>s;return function(){var r=I(n)(t)(o)(i)(a)(!1)();return c.when(w.monadEff)(r)(function(){return l.writeSTRef(t.controlState.needRepaint)(!0)(),e.unit})()}}throw new Error("Failed pattern match at ConeCanvas.Frontend.Textures line 171, column 5 - line 179, column 5: "+[r.constructor.name])}()();var f=0!==(u+s|0);if(f)return p.traceA(w.applicativeEff)("lengthText: "+(e.show(e.showInt)(u)+(" lengthIcons: "+e.show(e.showInt)(s))))();if(!f)return e.unit;throw new Error("Failed pattern match at ConeCanvas.Frontend.Textures line 179, column 5 - line 184, column 1: "+[f.constructor.name])}}}};n.constructTextures=O,n.getIcon=N,n.rectangle=D,n.prepareTexture=y,n.drawTexture=_,n.getTextTexture=x}(PS["ConeCanvas.Frontend.Textures"]=PS["ConeCanvas.Frontend.Textures"]||{}),function(n){"use strict";var e=PS.Prelude,t=(PS["Data.Int.Bits"],PS["Control.Monad.Eff"]),r=PS["Control.Monad.ST"],o=(PS["Graphics.WebGLAll"],PS["Graphics.WebGLRaw"]),a=(PS["Data.Vector"],PS["Data.ST.Matrix4"]),i=PS["Debug.Trace"],u=(PS.ConeCanvas,PS["ConeCanvas.ConeControlTypes"],PS["ConeCanvas.Frontend.DrawTypes3d"],PS["ConeCanvas.Frontend.Matrix"]),c=PS["ConeCanvas.Color"],l=PS["Graphics.WebGL"],s=PS["Graphics.WebGLFramebuffer"],f=PS["Graphics.WebGLTexture"],d=function(n){return function(n){return r.writeSTRef(n.bindings.lastPickColor)(0)}},v=function(n){return n.value0<<16|n.value1<<8|n.value2},m=function(n){return function(e){return function(t){return function(r){return function(o){return function(i){return function(d){return function(v){
return u.preservingMatrix(n)(e)(function(m){return function(){return a.translateST([r,-(o+d),0])(e.bindings.mvMatrix)(),a.scaleST3(i)(d)(1)(e.bindings.mvMatrix)(),u.setMVMatrix(n)(e)(v)(!1)(),l.disable(l.DEPTH_TEST.value)(),s.bindFramebuffer(e.bindings.pickBuffer.l)(),l.viewport(0)(0)(e.windowSize.x)(e.windowSize.y)(),s.framebufferTexture2D(s.COLOR_ATTACHMENT0.value)(f.TEXTURE_2D.value)(e.bindings.pickBuffer.r)(),l.setUniformBoolean(e.bindings.uUseTexture)(!1)(),l.setUniformBoolean(e.bindings.uSimple)(!0)(),l.disableVertexAttribArray(e.bindings.aVertexNormal)(),l.disableVertexAttribArray(e.bindings.aTextureCoord)(),l.setUniformFloats(e.bindings.uMaterialAmbient)(c.color4toArray(t))(),l.bindBufAndSetVertexAttr(e.bindings.vertexCoos)(e.bindings.aVertexPosition)(),l.bindBuf(e.bindings.vertexIndices)(),l.drawElements(l.TRIANGLES.value)(6)(),s.unbindFramebuffer(),l.viewport(0)(0)(e.windowSize.x)(e.windowSize.y)(),l.enable(l.DEPTH_TEST.value)()}})}}}}}}}},h=function(n){return new c.Color4I(n>>16&255,n>>8&255,255&n,1)},p=function(n){return function(){var r=l.getCanvasWidth(n)(),a=l.getCanvasHeight(n)(),u=s.createFramebuffer();s.bindFramebuffer(u)();var c=f.newTexture(r)(a)(f.NEAREST.value)();s.framebufferTexture2D(s.COLOR_ATTACHMENT0.value)(f.TEXTURE_2D.value)(c)();var d=s.checkFramebufferStatus(o._FRAMEBUFFER)();return i.traceA(t.applicativeEff)("initPickbuffer Code: "+e.show(e.showInt)(d))(),s.unbindFramebuffer(),{l:u,r:c}}},w=function(n){return function(n){return r.modifySTRef(n.bindings.lastPickColor)(function(n){return n+1|0})}};n.resetPickColor=d,n.getNextPickColor=w,n.intToPickColor=h,n.pickColorToInt=v,n.paintPickColorToBuffer=m,n.initPickbuffer=p}(PS["ConeCanvas.Frontend.Pickbuffer"]=PS["ConeCanvas.Frontend.Pickbuffer"]||{}),function(n){"use strict";var e=PS.Prelude,t=PS["Data.Maybe"],r=PS["Data.Int"],o=PS["Control.Monad"],a=(PS.ConeCanvas,PS["ConeCanvas.ConeControlTypes"]),i=(PS["ConeCanvas.Frontend.DrawTypes3d"],PS["ConeCanvas.Frontend.Textures"]),u=PS["ConeCanvas.Frontend.Pickbuffer"],c=PS["Data.STSequence"],l=PS["Control.Monad.Eff"],s=PS["ConeCanvas.Color"],f=function(n){return function(r){return function(o){return function(l){return function(f){return function(d){var v=function(n){if(n instanceof t.Just)return n.value0;if(n instanceof t.Nothing)return{x:0,y:0,z:0};throw new Error("Failed pattern match at ConeCanvas.Frontend.ControlArea line 116, column 7 - line 117, column 7: "+[n.constructor.name])};return function(){i.rectangle(n)(r)(t.Nothing.value)(l.x)(-l.y)(f.x)(f.y)(1)(1)();var m=f.x*d,h=r.controlState.zoomControl*((f.y-m)/2),p=-(l.y+(h-f.y/2+m/2)),w=a.getConeFront(r.frontend);i.getIcon(n)(r)("Handle2.png")(function(e){return i.drawTexture(n)(r)(e)(l.x)(p)(f.x)(m)(1)(1)})();var g=u.getNextPickColor(n)(r)(),C=u.intToPickColor(g);u.paintPickColorToBuffer(n)(r)(s.color4IToColor4(C))(l.x)(p)(f.x)(m)(1)();var S=w.userToDevice(r)({x:l.x+f.x/2,y:l.y-m/2,z:1})(),P=w.userToDevice(r)({x:l.x+f.x-f.x/2,y:l.y-f.y+m/2,z:1})();return c.push(o)({l:g,r:new a.CIZoom({leftTopFront:v(S),rightBottomRear:v(P)})})(),e.unit}}}}}}},d=function(n){return function(r){return function(o){return function(l){return function(f){return function(d){var v=function(n){if(n instanceof t.Just)return n.value0;if(n instanceof t.Nothing)return{x:0,y:0,z:0};throw new Error("Failed pattern match at ConeCanvas.Frontend.ControlArea line 86, column 5 - line 87, column 5: "+[n.constructor.name])};return function(){i.rectangle(n)(r)(t.Nothing.value)(l.x)(-l.y)(f.x)(f.y)(1)(1)();var m=f.x/4,h=l.x+f.x/2-m/2,p=r.controlState.angleSelect.x*((f.x-m)/2),w=l.x+p+f.x/2-m/2,g=m*d,C=l.y+(-(f.y/2)+g/2),S=r.controlState.angleSelect.y*((f.y-g)/2),P=l.y+(S-f.y/2+g/2),y=a.getConeFront(r.frontend);i.getIcon(n)(r)("Turn.png")(function(e){return i.drawTexture(n)(r)(e)(h)(-C)(m)(g)(1)(1)})();var T=u.getNextPickColor(n)(r)(),b=u.intToPickColor(T);u.paintPickColorToBuffer(n)(r)(s.color4IToColor4(b))(l.x)(-l.y)(f.x)(f.y)(1)();var E=y.userToDevice(r)({x:l.x,y:l.y,z:1})(),x=y.userToDevice(r)({x:l.x+f.x,y:l.y-f.y,z:1})(),F=new a.CITurn({leftTopFront:v(E),rightBottomRear:v(x)});i.getIcon(n)(r)("Handle.png")(function(e){return i.drawTexture(n)(r)(e)(w)(-P)(m)(g)(1)(1)})();var A=u.getNextPickColor(n)(r)(),N=u.intToPickColor(A);u.paintPickColorToBuffer(n)(r)(s.color4IToColor4(N))(w)(-P)(m)(g)(1)();var _=y.userToDevice(r)({x:l.x+m/2,y:l.y-g/2,z:1})(),D=y.userToDevice(r)({x:l.x+f.x-m/2,y:l.y-f.y+g/2,z:1})(),M=new a.CIAngel({leftTopFront:v(_),rightBottomRear:v(D)});return c.push(o)({l:A,r:M})(),c.push(o)({l:T,r:F})(),e.unit}}}}}}},v=function(n){return function(e){return function(t){var a=r.toNumber(e.windowSize.x)/r.toNumber(e.windowSize.y);return o.when(l.monadEff)(e.controlState.showControl)(function(){return d(n)(e)(t)({x:1.375,y:2.48})({x:1,y:1*a})(a)(),f(n)(e)(t)({x:2.375,y:2.48})({x:.1,y:1*a})(a)()})}}};n.coneDrawControls2=v}(PS["ConeCanvas.Frontend.ControlArea"]=PS["ConeCanvas.Frontend.ControlArea"]||{}),function(n){"use strict";n.asDataView=function(n){return new DataView(n)},n.getFloat32Unsafe=function(n,e,t){return n.getFloat32(e,t)}}(PS["Data.DataView"]=PS["Data.DataView"]||{}),function(n){"use strict";var e=PS["Data.DataView"];PS.Prelude,PS["Data.Function"],PS["Data.Maybe"],PS["Data.ArrayBuffer.Types"];n.getFloat32Unsafe=e.getFloat32Unsafe,n.asDataView=e.asDataView}(PS["Data.DataView"]=PS["Data.DataView"]||{}),function(n){"use strict";var e=PS.Prelude,t=PS["Data.Maybe"],r=PS["Graphics.WebGL"],o=PS["Data.ST.Matrix4"],a=(PS["Data.ArrayBuffer.Types"],PS["Control.Monad.ST"]),i=PS["Data.StrMap"],u=PS["Data.Map"],c=PS["Data.STSequence"],l=PS["Data.DataView"],s=PS["Data.Array"],f=(PS["Data.Array.Unsafe"],PS["Data.Vector3"]),d=(PS["Data.Function"],PS["Data.List"]),v=PS.Math,m=PS["Data.Int"],h=PS["Data.Foldable"],p=PS["Data.Traversable"],w=(PS.ConeCanvas,PS["ConeCanvas.ConeControlTypes"],PS["ConeCanvas.Frontend.DrawTypes3d"],PS["ConeCanvas.Frontend.Matrix"]),g=PS["ConeCanvas.Color"],C=PS["Control.Monad.Eff"],S=PS["ConeCanvas.GeometryTypes"],P=function(n){return function(e){return function(t){return function(r){return v.min(v.min(v.min(n)(e))(t))(r)}}}},y=function(n){return function(e){return function(t){return function(r){return v.max(v.max(v.max(n)(e))(t))(r)}}}},T=function(n){return function(a){return function(i){return function(u){return function(c){return function(c){return function(c){return function(l){return function(l){return function(l){var s=v.abs(u.extent.maxX-u.extent.minX),f=c/(1.5*s),d=(v.abs(u.extent.maxZ-u.extent.minZ),v.abs(u.extent.maxY-u.extent.minY),function(){return i.condColor instanceof t.Just?[i.condColor.value0.value0,i.condColor.value0.value1,i.condColor.value0.value2,1]:g.color4toArray(a.prefs.massiveColor)}());return w.preservingMatrix(n)(a)(function(t){return function(){return o.rotateSTX(-v.pi/2)(a.bindings.mvMatrix)(),o.scaleST3(f)(f)(f)(a.bindings.mvMatrix)(),w.setMVMatrix(n)(a)(f)(!0)(),r.setUniformBoolean(a.bindings.uUseTexture)(!1)(),r.setUniformBoolean(a.bindings.uSimple)(!1)(),r.disableVertexAttribArray(a.bindings.aTextureCoord)(),r.enableVertexAttribArray(a.bindings.aVertexNormal)(),r.setUniformFloats(a.bindings.uMaterialAmbient)(d)(),r.setUniformFloats(a.bindings.uMaterialDiffuse)(d)(),r.setUniformFloats(a.bindings.uMaterialSpecular)(d)(),r.bindBufAndSetVertexAttr(u.normals)(a.bindings.aVertexNormal)(),r.drawArr(r.TRIANGLES.value)(u.triangles)(a.bindings.aVertexPosition)(),e.unit}})}}}}}}}}}},b=function(n){return function(r){return function(o){var a=function(n){var t=m.toNumber(d.length(n.indices)),r=f.vec3(n.normal.x/t)(n.normal.y/t)(n.normal.z/t);return function(){return p.traverse(d.traversableList)(C.applicativeEff)(function(n){return function(){return c.poke(o)(3*n|0)(f.get3X(r))(),c.poke(o)((3*n|0)+1|0)(f.get3Y(r))(),c.poke(o)((3*n|0)+2|0)(f.get3Z(r))()}})(n.indices)(),e.unit}},i=function(o){return function(a){var i=r[(3*o|0)+2|0],c=r[(3*o|0)+1|0],l=r[3*o|0],s={x:l,y:c,z:i},f=n[(3*(o/3|0)|0)+2|0],v=n[(3*(o/3|0)|0)+1|0],m=n[3*(o/3|0)|0],h={x:m,y:v,z:f},p=u.lookup(S.ordPoint3(e.ordNumber))(s)(a);if(p instanceof t.Nothing)return u.insert(S.ordPoint3(e.ordNumber))(s)({normal:h,indices:d.singleton(o)})(a);if(p instanceof t.Just)return u.update(S.ordPoint3(e.ordNumber))(function(n){return new t.Just({normal:{x:m+p.value0.normal.x,y:v+p.value0.normal.y,z:f+p.value0.normal.z},indices:d[":"](o)(p.value0.indices)})})(s)(a);throw new Error("Failed pattern match at ConeCanvas.Frontend.STL line 165, column 12 - line 170, column 5: "+[p.constructor.name])}},l=h.foldr(h.foldableArray)(i)(u.empty)(s.range(0)((s.length(r)/3|0)-1));return function(){return p.traverse(u.traversableMap(S.ordPoint3(e.ordNumber)))(C.applicativeEff)(a)(l)(),e.unit}}}},E=function(n){return function(e){return function(t){var o=l.asDataView(e),a=function(n){return function(e){return function(t){return function(r){var a=l.getFloat32Unsafe(o,(84+(50*r|0)|0)+8|0,!0),i=l.getFloat32Unsafe(o,(84+(50*r|0)|0)+4|0,!0),u=l.getFloat32Unsafe(o,(84+(50*r|0)|0)+0|0,!0);return function(){c.poke(n)(0+(3*r|0)|0)(u)(),c.poke(n)(1+(3*r|0)|0)(i)(),c.poke(n)(2+(3*r|0)|0)(a)();var s=l.getFloat32Unsafe(o,(84+(50*r|0)|0)+44|0,!0),f=l.getFloat32Unsafe(o,(84+(50*r|0)|0)+32|0,!0),d=l.getFloat32Unsafe(o,(84+(50*r|0)|0)+20|0,!0),v=l.getFloat32Unsafe(o,(84+(50*r|0)|0)+40|0,!0),m=l.getFloat32Unsafe(o,(84+(50*r|0)|0)+28|0,!0),h=l.getFloat32Unsafe(o,(84+(50*r|0)|0)+16|0,!0),p=l.getFloat32Unsafe(o,(84+(50*r|0)|0)+36|0,!0),w=l.getFloat32Unsafe(o,(84+(50*r|0)|0)+24|0,!0),g=l.getFloat32Unsafe(o,(84+(50*r|0)|0)+12|0,!0);return c.poke(e)(0+(9*r|0)|0)(g)(),c.poke(e)(1+(9*r|0)|0)(h)(),c.poke(e)(2+(9*r|0)|0)(d)(),c.poke(e)(3+(9*r|0)|0)(w)(),c.poke(e)(4+(9*r|0)|0)(m)(),c.poke(e)(5+(9*r|0)|0)(f)(),c.poke(e)(6+(9*r|0)|0)(p)(),c.poke(e)(7+(9*r|0)|0)(v)(),c.poke(e)(8+(9*r|0)|0)(s)(),{minX:P(t.minX)(g)(w)(p),maxX:y(t.maxX)(g)(w)(p),minY:P(t.minY)(h)(m)(v),maxY:y(t.maxY)(h)(m)(v),minZ:P(t.minZ)(d)(f)(s),maxZ:y(t.maxZ)(d)(f)(s)}}}}}};return function(){var e=c.fromArray(s.replicate(3*n|0)(0))(),o=c.fromArray(s.replicate(9*n|0)(0))(),i={minX:1e3,maxX:-1e3,minY:1e3,maxY:-1e3,minZ:1e3,maxZ:-1e3},u=s.foldM(C.monadEff)(a(e)(o))(i)(s.range(0)(n-1))(),l=c.toArray(e)(),f=c.toArray(o)(),d=c.fromArray(s.replicate(9*n|0)(0))();b(l)(f)(d)();var v=c.toArray(d)(),m=r.makeBufferFloat(f)(),h=r.makeBufferFloat(v)();return{name:t,size:n,normals:h,triangles:m,extent:u}}}}},x=function(n){return function(n){return function(r){return function(o){var u=function(o){return function(u){return 0===o?e["return"](C.applicativeEff)(e.unit):function(){var c=E(o)(u)(r)();return a.modifySTRef(n.bindings.stlCache)(function(n){return i.insert(r)(new t.Just(c))(n)})(),a.writeSTRef(n.controlState.needRepaint)(!0)(),e.unit}}};return function(){var c=a.readSTRef(n.bindings.stlCache)(),l=i.lookup(r)(c);if(l instanceof t.Just&&l.value0 instanceof t.Just)return o(l.value0.value0)();if(l instanceof t.Just&&l.value0 instanceof t.Nothing)return e.unit;if(l instanceof t.Nothing)return a.modifySTRef(n.bindings.stlCache)(function(n){return i.insert(r)(t.Nothing.value)(n)})(),n.loadSTLCallback(r)(u)(),e.unit;throw new Error("Failed pattern match at ConeCanvas.Frontend.STL line 81, column 5 - line 88, column 3: "+[l.constructor.name])}}}}};n.getSTL=x,n.drawSTL=T,n.makeSTL=E}(PS["ConeCanvas.Frontend.STL"]=PS["ConeCanvas.Frontend.STL"]||{}),function(n){"use strict";var e=PS.Prelude,t=PS["Data.ST.Matrix4"],r=PS["Data.STSequence"],o=PS["Data.String"],a=PS["Data.Vector3"],i=PS["Graphics.WebGL"],u=(PS.ConeCanvas,PS["ConeCanvas.ConeControlTypes"]),c=PS["ConeCanvas.Frontend.Cone"],l=PS["ConeCanvas.Frontend.ControlArea"],s=PS["ConeCanvas.Frontend.DrawTypes3d"],f=PS["ConeCanvas.Frontend.Matrix"],d=PS["ConeCanvas.Frontend.Pickbuffer"],v=PS["ConeCanvas.Frontend.STL"],m=PS["ConeCanvas.Frontend.Textures"],h=PS["Control.Monad"],p=PS["Control.Monad.ST"],w=PS["Data.Array"],g=PS["Data.Foldable"],C=PS["Data.Int"],S=PS["Data.Maybe"],P=PS["Debug.Trace"],y=PS.Extensions,T=PS.Math,b=PS["Control.Monad.Eff"],E=PS["ConeCanvas.ConeControl"],x=PS["ConeCanvas.Color"],F=PS["ConeCanvas.ConeZipper"],A=function(n){return function(t){var r=t%60!==0;if(r)return e["return"](b.applicativeEff)(!1);if(!r)return function(){var r=p.readSTRef(n.animatePaintRef)();if(r instanceof S.Nothing)return!1;if(r instanceof S.Just){var o=E.getMillisecondsTime(),a=o-r.value0>E.stepTime+10;if(a)return p.writeSTRef(n.controlState.needRepaint)(!0)(),P.trace("cancelPaint itemsDrawn: "+e.show(e.showInt)(t))(function(n){return e["return"](b.applicativeEff)(!0)})();if(!a)return!1;throw new Error("Failed pattern match at ConeCanvas.Frontend.DrawWebGL line 140, column 21 - line 147, column 1: "+[a.constructor.name])}throw new Error("Failed pattern match at ConeCanvas.Frontend.DrawWebGL line 136, column 13 - line 147, column 1: "+[r.constructor.name])};throw new Error("Failed pattern match at ConeCanvas.Frontend.DrawWebGL line 132, column 5 - line 147, column 1: "+[r.constructor.name])}},N=function(n){return function(u){return function(c){return function(l){return function(v){return function(p){return function(w){return function(g){return function(C){return function(P){return f.preservingMatrix(n)(c)(function(f){var y=p*s.labelWidthFactor,E=p*s.labelHeightFactor;return function(){return t.translateST(a["vec3'"]([-v.x,-v.y,v.z]))(f)(),t.rotateSTY(T.pi+l.turnAngle)(f)(),function(){if(u.condLabel instanceof S.Nothing)return e["return"](b.applicativeEff)(e.unit);if(u.condLabel instanceof S.Just)return h.when(b.monadEff)(!o["null"](u.condLabel.value0.label))(function(){var t=function(){var n=c.controlState.showIndex===!1;if(n)return u.condLabel.value0.label;if(!n)return e.show(e.showInt)(u.realIndex+1|0)+(" "+u.condLabel.value0.label);throw new Error("Failed pattern match at ConeCanvas.Frontend.DrawWebGL line 304, column 32 - line 307, column 25: "+[n.constructor.name])}(),r=function(){var n=o.length(t)>c.prefs.maxTextLength;if(n)return o.take(c.prefs.maxTextLength-2)(t)+"..";if(!n)return t;throw new Error("Failed pattern match at ConeCanvas.Frontend.DrawWebGL line 308, column 38 - line 311, column 21: "+[n.constructor.name])}();return function(){return h.when(b.monadEff)(g&&c.prefs.labelTextBackground||c.prefs.alwaysGreyTextBack)(i.setUniformBoolean(c.bindings.uUseTextureFrame)(!0))(),m.getTextTexture(n)(c)(r)(function(e){return m.drawTexture(n)(c)(e)(-y/2/w)(-E)(y/w)(E)(P)(u.scale*l.commandingScale)})()}}());throw new Error("Failed pattern match at ConeCanvas.Frontend.DrawWebGL line 301, column 13 - line 323, column 13: "+[u.condLabel.constructor.name])}()(),h.when(b.monadEff)(g||c.prefs.alwaysGreyTextBack)(i.setUniformBoolean(c.bindings.uUseTextureFrame)(!1))(),h.when(b.monadEff)(l.needClickInfos)(function(){var t=d.getNextPickColor(n)(c)(),o=d.intToPickColor(t);return d.paintPickColorToBuffer(n)(c)(x.color4IToColor4(o))(-y/2/w)(-E)(y/w)(E)(u.scale*l.commandingScale)(),r.push(l.ciAccu)({l:t,r:C})(),e.unit})(),e.unit}})}}}}}}}}}},_=function(n){return function(r){return function(o){return function(a){return function(i){var c=function(a){return function(c){var l=-(T.pi/r.prefs.angleSelectFactor)*(r.controlState.angleSelect.x+r.prefs.angleSelectAddX),d=T.pi/r.prefs.angleSelectFactor*(r.controlState.angleSelect.y+r.prefs.angleSelectAddY),v=function(){if(o.upDown>0)return 1-o.upDown/100;if(o.upDown<0)return 1+o.upDown/100;if(e.otherwise)return 1;throw new Error("Failed pattern match at ConeCanvas.Frontend.DrawWebGL line 242, column 11 - line 284, column 1: "+[])}(),m=1+-1*v,h=function(){if(g.elem(g.foldableArray)(e.eqNumber)(o.upDown)([0,100,-100]))return 1;if(o.upDown>0)return 1-v;if(e.otherwise)return 1-m;throw new Error("Failed pattern match at ConeCanvas.Frontend.DrawWebGL line 242, column 11 - line 284, column 1: "+[])}();r.prefs.coneHeight/i.scale;return f.preservingMatrix(n)(r)(function(e){return function(){var e=f.initialMVMatrix(n)(r)();t.rotateSTX(d*h*2)(e)(),t.rotateSTY(-l*h*2)(e)();var v=u.getConeFront(r.frontend).deviceToUser(r)({x:C.toNumber(r.windowSize.x)/6,y:.9949999999999999*C.toNumber(r.windowSize.y),z:.3})();if(v instanceof S.Just){var m=T.min(3*c)(.3),p=1/r.controlState.zoom,w=.25*p,g=w+(m-w)*h,P={x:v.value0.x+g*s.labelWidthFactor/2,y:v.value0.y-g*s.labelHeightFactor,z:v.value0.z},b=P.x+(a.x-P.x)*h,E=-P.y+(a.y- -P.y)*h,x=P.z+(a.z-P.z)*h;return N(n)(i)(r)(o)({x:b,y:E,z:x})(g)(f.getPerspectiveRatio(r))(!0)(new u.CILabel(i.realIndex))(1)()}if(v instanceof S.Nothing)return y.fail("ConeView3D>>transformToFloating: condPosition impossible")();throw new Error("Failed pattern match at ConeCanvas.Frontend.DrawWebGL line 265, column 19 - line 284, column 1: "+[v.constructor.name])}})}},l=2===i.level,d=0===i.drawIndex&&2===i.level&&!o.isGlobalView&&0!==o.upDown;if(d)return c(i.coosLabel)(a);if(!d){var v=T.min(3*a)(.3/o.commandingScale);return N(n)(i)(r)(o)(i.coosLabel)(v)(f.getPerspectiveRatio(r))(l)(new u.CILabel(i.realIndex))(i.fade)}throw new Error("Failed pattern match at ConeCanvas.Frontend.DrawWebGL line 234, column 8 - line 240, column 5: "+[d.constructor.name])}}}}},D=function(n){return function(t){return function(r){return function(o){if(o.fade<1)return e["return"](b.applicativeEff)(e.unit);if(e["=="](s.eqDrawTag)(o.drawTag)(s.DTCone.value)){var a=s.coneRadius/o.scale,i=t.prefs.coneHeight/o.scale;return c.drawConeXZ(n)(t)(o)(o.coordinates.x)(o.coordinates.y)(o.coordinates.z)(i)(a)(r.commandingScale)}if(e.otherwise)return e["return"](b.applicativeEff)(e.unit);throw new Error("Failed pattern match at ConeCanvas.Frontend.DrawWebGL line 149, column 1 - line 162, column 1: "+[t.constructor.name,r.constructor.name,o.constructor.name])}}}},M=function(n){return function(o){return function(u){return function(c){return function(l){return function(s){return function(p){return function(w){return function(g){return function(C){return function(){return function(){if(o.condSTLName instanceof S.Just)return f.preservingMatrix(n)(u)(function(r){return function(){return t.translateST(a["vec3'"]([-l.x,-(l.y+2*s),l.z]))(r)(),t.rotateSTY(T.pi+o.angle)(r)(),v.getSTL(n)(u)(o.condSTLName.value0)(function(e){return v.drawSTL(n)(u)(o)(e)(-s/p)(-s)(2*s/p)(2*s)(C)(o.scale*c.commandingScale)})(),e.unit}});if(o.condSTLName instanceof S.Nothing)return e["return"](b.applicativeEff)(e.unit);throw new Error("Failed pattern match at ConeCanvas.Frontend.DrawWebGL line 351, column 9 - line 366, column 9: "+[o.condSTLName.constructor.name])}()(),f.preservingMatrix(n)(u)(function(f){return function(){return t.translateST(a["vec3'"]([-l.x,-(l.y+s),l.z]))(f)(),t.rotateSTY(T.pi+c.turnAngle)(f)(),function(){if(o.condSTLName instanceof S.Just)return e["return"](b.applicativeEff)(e.unit);if(o.condSTLName instanceof S.Nothing){if(o.condIconName instanceof S.Just)return function(){return h.when(b.monadEff)(w&&u.prefs.labelIconBackground)(i.setUniformBoolean(u.bindings.uUseTextureFrame)(!0))(),m.getIcon(n)(u)(o.condIconName.value0)(function(e){return m.drawTexture(n)(u)(e)(-s/p)(-s)(2*s/p)(2*s)(C)(o.scale*c.commandingScale)})(),e.unit};if(o.condIconName instanceof S.Nothing)return e["return"](b.applicativeEff)(e.unit);throw new Error("Failed pattern match at ConeCanvas.Frontend.DrawWebGL line 371, column 28 - line 387, column 13: "+[o.condIconName.constructor.name])}throw new Error("Failed pattern match at ConeCanvas.Frontend.DrawWebGL line 369, column 13 - line 387, column 13: "+[o.condSTLName.constructor.name])}()(),h.when(b.monadEff)(c.needClickInfos)(function(){var t=d.getNextPickColor(n)(u)(),a=d.intToPickColor(t);return d.paintPickColorToBuffer(n)(u)(x.color4IToColor4(a))(-s/p)(-s)(2*s/p)(2*s+s*(10/12))(o.scale*c.commandingScale)(),r.push(c.ciAccu)({l:t,r:g})(),e.unit})(),e.unit}})()}}}}}}}}}}},L=function(n){return function(r){return function(o){return function(i){if(e["=="](s.eqDrawTag)(i.drawTag)(s.DTLeaf.value)&&(i.level>1||o.isGlobalView)){var l=s.sphereRadius/i.scale,d=s.coneRadius/i.scale;return function(){return M(n)(i)(r)(o)(i.coordinates)(2.5*l)(f.getPerspectiveRatio(r))(!1)(new u.CICard(i.conePath))(i.fade)(),_(n)(r)(o)(l)(i)()}}if(e["=="](s.eqDrawTag)(i.drawTag)(s.DTLeaf.value))return e["return"](b.applicativeEff)(e.unit);if(e["=="](s.eqDrawTag)(i.drawTag)(s.DTFloatLabel.value)){var v=function(){var n=function(){if(o.upDown>0)return 1-o.upDown/100;if(o.upDown<0)return 1+o.upDown/100;if(e.otherwise)return 1;throw new Error("Failed pattern match at ConeCanvas.Frontend.DrawWebGL line 199, column 21 - line 202, column 17: "+[])}(),t=1+-1*n,r=function(){if(g.elem(g.foldableArray)(e.eqNumber)(o.upDown)([0,100,-100]))return 1;if(o.upDown>0)return 1-n;if(e.otherwise)return 1-t;throw new Error("Failed pattern match at ConeCanvas.Frontend.DrawWebGL line 194, column 17 - line 203, column 5: "+[])}();return r}();return f.preservingMatrix(n)(r)(function(t){return function(){var t=(f.initialMVMatrix(n)(r)(),u.getConeFront(r.frontend).deviceToUser(r)({x:C.toNumber(r.windowSize.x)/6,y:.9949999999999999*C.toNumber(r.windowSize.y),z:.3})());return function(){if(t instanceof S.Just){var a=1/r.controlState.zoom,c=.25*a;return N(n)(i)(r)(function(){var n={};for(var e in o)o.hasOwnProperty(e)&&(n[e]=o[e]);return n.turnAngle=0,n}())({x:t.value0.x+c*s.labelWidthFactor/2,y:-t.value0.y+c*s.labelHeightFactor,z:t.value0.z})(c)(f.getPerspectiveRatio(r))(!0)(new u.CISuperLabel(1))(v*i.fade)}return P.trace("ConeView3D>>drawIt': DTFloatLabel deviceToUser failed")(function(n){return e["return"](b.applicativeEff)(e.unit)})}()(),e.unit}})}if(e.otherwise){var l=s.sphereRadius/i.scale,m=(a.vec3(-i.coordinates.x)(-i.coordinates.y)(i.coordinates.z),r.prefs.coneHeight/i.scale),d=s.coneRadius/i.scale;return function(){return h.when(b.monadEff)(i.fade<1)(c.drawConeXZ(n)(r)(i)(i.coordinates.x)(i.coordinates.y)(i.coordinates.z)(m)(d)(o.commandingScale))(),h.when(b.monadEff)(i.level>1)(_(n)(r)(o)(l)(i))(),h.when(b.monadEff)(i.level>0)(function(){var e=1.5*l;return f.preservingMatrix(n)(r)(function(c){return function(){return t.rotateSTY(o.turnAngle)(c)(),t.translateST(a.vec3(0)(0)(-d))(c)(),t.rotateSTY(-o.turnAngle)(c)(),t.translateST(a.vec3(0)(0)(d))(c)(),M(n)(i)(r)(o)({x:i.coordinates.x,y:i.coordinates.y+m-4*l,z:i.coordinates.z-d})(e)(f.getPerspectiveRatio(r))(!1)(new u.CICard(i.conePath))(i.fade)()}})}())(),e.unit}}throw new Error("Failed pattern match at ConeCanvas.Frontend.DrawWebGL line 164, column 1 - line 229, column 1: "+[r.constructor.name,o.constructor.name,i.constructor.name])}}}},I=function(n){return function(n){return function(t){return function(r){return function(){return function(){if(r instanceof S.Nothing)return y.mapE_(t)(n);if(r instanceof S.Just)return y.mapEBreak_(t)(r.value0)(n);throw new Error("Failed pattern match at ConeCanvas.Frontend.DrawWebGL line 125, column 5 - line 128, column 5: "+[r.constructor.name])}()(),e.unit}}}}},O=function(n){return function(t){return function(o){return function(a){var u=function(n){return function(t){var r=e.compare(e.ordNumber)(n.coordinates.y)(t.coordinates.y);return r instanceof e.EQ?e.compare(e.ordNumber)(t.coordinates.z)(n.coordinates.z):r}};return function(){var e=r.toArray(a)(),c=w.sortBy(u)(e);return I(t)(c)(D(n)(t)(o))(function(){if(o.isGlobalView)return S.Nothing.value;if(!o.isGlobalView)return new S.Just(A(t));throw new Error("Failed pattern match at ConeCanvas.Frontend.DrawWebGL line 107, column 10 - line 107, column 84: "+[o.isGlobalView.constructor.name])}())(),i.enable(i.BLEND.value)(),I(t)(c)(L(n)(t)(o))(function(){if(o.isGlobalView)return S.Nothing.value;if(!o.isGlobalView)return new S.Just(A(t));throw new Error("Failed pattern match at ConeCanvas.Frontend.DrawWebGL line 110, column 10 - line 110, column 84: "+[o.isGlobalView.constructor.name])}())(),i.disable(i.BLEND.value)()}}}}},R=function(n){return function(e){return function(e){return function(t){return function(t){return function(o){return function(a){return function(c){return function(s){var d=function(){return o instanceof u.CommandingTurn?o.value0:0}(),v=F.coneNumLevel(e),m=function(){return o instanceof u.CommandingNothing}(),h=F.coneIsRoot(e),p=2*T.pi/C.toNumber(v);return function(){var e=r.empty(),o=-(d/100)*p;return O(n)(a)({ciAccu:e,turnAngle:o,commandingScale:c.commandingScale,upDown:function(){if(h)return 0;if(!h)return c.upDown;throw new Error("Failed pattern match at ConeCanvas.Frontend.DrawWebGL line 74, column 20 - line 75, column 9: "+[h.constructor.name])}(),needClickInfos:m,isGlobalView:t})(s)(),function(){return f.setPerspectiveLabel(n)(a)(),i.enable(i.BLEND.value)(),l.coneDrawControls2(n)(a)(e)(),i.disable(i.BLEND.value)()}(),r.toArray(e)()}}}}}}}}}};n.drawEverything=R,n.drawIcon=M,n.drawLabel=N}(PS["ConeCanvas.Frontend.DrawWebGL"]=PS["ConeCanvas.Frontend.DrawWebGL"]||{}),function(n){"use strict";var e=(PS.Prelude,PS["Data.Int"]),t=PS["Data.Maybe"],r=PS.Math,o=PS.Extensions,a=(PS.ConeCanvas,PS["ConeCanvas.ConeControlTypes"]),i=PS["ConeCanvas.Frontend.DrawTypes3d"],u=(PS["Control.Monad.Eff"],function(n){return function(e){return r.max(e.leftTopFront.y)(e.leftTopBack.y)<=n.y}}),c=function(n){var e=function(n){return function(e){var t=r.abs(n-e),o=function(){var r=e>n;if(r)return n-t/2;if(!r)return n+t/2;throw new Error("Failed pattern match at ConeCanvas.Frontend.Frustum line 49, column 34 - line 50, column 29: "+[r.constructor.name])}(),a=function(){var r=e>n;if(r)return e+t/2;if(!r)return e-t/2;throw new Error("Failed pattern match at ConeCanvas.Frontend.Frustum line 50, column 34 - line 51, column 25: "+[r.constructor.name])}();return{l:o,r:a}}},t=e(n.leftTopBack.x)(n.rightBottomBack.x),o=e(n.leftTopFront.x)(n.rightBottomFront.x),a=e(n.leftTopBack.y)(n.rightBottomBack.y),i=e(n.leftTopFront.y)(n.rightBottomFront.y),u=e(n.leftTopFront.z)(n.leftTopBack.z),c=e(n.rightBottomFront.z)(n.rightBottomBack.z);return{leftTopFront:{x:o.l,y:i.l,z:u.l},rightBottomFront:{x:o.r,y:i.r,z:c.l},leftTopBack:{x:t.l,y:a.l,z:u.r},rightBottomBack:{x:t.r,y:a.r,z:c.r}}},l=function(n){return function(){var r=a.getConeFront(n.frontend).deviceToUser(n)({x:0,y:e.toNumber(n.windowSize.y),z:0})(),i=a.getConeFront(n.frontend).deviceToUser(n)({x:e.toNumber(n.windowSize.x),y:0,z:0})(),u=a.getConeFront(n.frontend).deviceToUser(n)({x:0,y:e.toNumber(n.windowSize.y),z:1})(),l=a.getConeFront(n.frontend).deviceToUser(n)({x:e.toNumber(n.windowSize.x),y:0,z:1})(),s=[r,i,u,l];if(4===s.length&&s[0]instanceof t.Just&&s[1]instanceof t.Just&&s[2]instanceof t.Just&&s[3]instanceof t.Just){var f={leftTopFront:s[0].value0,rightBottomFront:s[1].value0,leftTopBack:s[2].value0,rightBottomBack:s[3].value0},d=c(f),v={drawFrustum:f,calculatedFrustum:d};return v}return o.fail("ConeView3D>>calcFrustum: Frustum calculation failed!")()}},s=function(n){return function(e){return function(t){return function(o){return function(a){var i=t>=n&&o>=e;if(i)return r.min(n)(e)<=a&&a<=r.max(t)(o);if(!i){var u=n>=t&&e>=o;if(u)return r.min(t)(o)<=a&&a<=r.max(n)(e);if(!u){var c=t>=n&&e>=o;if(c)return r.min(n)(o)<=a&&a<=r.max(t)(e);if(!c)return r.min(t)(e)<=a&&a<=r.max(n)(o);throw new Error("Failed pattern match at ConeCanvas.Frontend.Frustum line 85, column 18 - line 91, column 1: "+[c.constructor.name])}throw new Error("Failed pattern match at ConeCanvas.Frontend.Frustum line 83, column 14 - line 91, column 1: "+[u.constructor.name])}throw new Error("Failed pattern match at ConeCanvas.Frontend.Frustum line 81, column 5 - line 91, column 1: "+[i.constructor.name])}}}}},f=function(n){return function(e){return s(e.leftTopFront.x)(e.leftTopBack.x)(e.rightBottomFront.x)(e.rightBottomBack.x)(n.x)&&s(e.leftTopFront.y)(e.leftTopBack.y)(e.rightBottomFront.y)(e.rightBottomBack.y)(n.y)&&s(e.leftTopFront.z)(e.rightBottomFront.z)(e.leftTopBack.z)(e.rightBottomBack.z)(n.z)}},d=function(n){return function(e){return function(t){return function(r){var o=function(){var o=f(e)(r)||f(function(){var r={};for(var o in e)e.hasOwnProperty(o)&&(r[o]=e[o]);return r.y=e.y-n*t,r}())(r)||f(function(){var r={};for(var o in e)e.hasOwnProperty(o)&&(r[o]=e[o]);return r.y=e.y-n*t,r.x=e.x+i.coneRadius*t,r}())(r)||f(function(){var r={};for(var o in e)e.hasOwnProperty(o)&&(r[o]=e[o]);return r.y=e.y-n*t,r.x=e.x-i.coneRadius*t,r}())(r);if(o)return i.InsideFrustum.value;if(!o){var a=u(e)(r);if(a)return i.InsideFrustum.value;if(!a)return i.OutsideFrustum.value;throw new Error("Failed pattern match at ConeCanvas.Frontend.Frustum line 139, column 22 - line 142, column 5: "+[a.constructor.name])}throw new Error("Failed pattern match at ConeCanvas.Frontend.Frustum line 134, column 15 - line 142, column 5: "+[o.constructor.name])}();return o}}}},v=function(n){return function(e){return function(t){var r=e>n;if(r)return t>=n&&e>=t;if(!r)return t>=e&&n>=t;throw new Error("Failed pattern match at ConeCanvas.Frontend.Frustum line 75, column 5 - line 79, column 1: "+[r.constructor.name])}}},m=function(n){return function(e){var t=v(e.leftTopFront.x)(e.rightBottomFront.x)(n.leftTopFront.x)&&v(e.leftTopFront.x)(e.rightBottomFront.x)(n.rightBottomFront.x)&&v(e.leftTopBack.x)(e.rightBottomBack.x)(n.leftTopBack.x)&&v(e.leftTopBack.x)(e.rightBottomBack.x)(n.rightBottomBack.x)&&v(e.leftTopFront.y)(e.rightBottomFront.y)(n.leftTopFront.y)&&v(e.leftTopFront.y)(e.rightBottomFront.y)(n.rightBottomFront.y)&&v(e.leftTopBack.y)(e.rightBottomBack.y)(n.leftTopBack.y)&&v(e.leftTopBack.y)(e.rightBottomBack.y)(n.rightBottomBack.y)&&v(e.leftTopFront.z)(e.leftTopBack.z)(n.leftTopFront.z)&&v(e.leftTopFront.z)(e.leftTopBack.z)(n.leftTopBack.z)&&v(e.rightBottomFront.z)(e.rightBottomBack.z)(n.rightBottomFront.z)&&v(e.rightBottomFront.z)(e.rightBottomBack.z)(n.rightBottomBack.z);return t}};n.frustumInside=m,n.calcFrustumVerdict=d,n.calcFrustums=l}(PS["ConeCanvas.Frontend.Frustum"]=PS["ConeCanvas.Frontend.Frustum"]||{}),function(n){"use strict";var e=PS.Prelude,t=PS["Data.Int"],r=PS["Data.Maybe"],o=PS["Data.Maybe.Unsafe"],a=PS["Control.Monad.ST"],i=PS.Math,u=PS["Data.List"],c=PS["Data.Foldable"],l=PS["Data.Array"],s=PS["Control.Monad"],f=PS["Debug.Trace"],d=PS["Data.ST.Matrix4"],v=PS["Data.Vector3"],m=PS.Extensions,h=(PS.ConeCanvas,PS["ConeCanvas.ConeControlTypes"]),p=PS["ConeCanvas.Frontend.DrawTypes3d"],w=PS["ConeCanvas.Frontend.DrawWebGL"],g=PS["ConeCanvas.Frontend.Matrix"],C=PS["Data.STSequence"],S=PS["ConeCanvas.Frontend.Frustum"],P=PS["ConeCanvas.ConeTransforms"],y=PS["ConeCanvas.ConeModel"],T=PS["ConeCanvas.ConeZipper"],b=PS["Control.Monad.Eff"],E=PS["ConeCanvas.ConeControl"],x=function(n){return function(n){if(u["null"](n))return n;if(e.otherwise)return u.take(u.length(n)-1)(n);throw new Error("Failed pattern match at ConeCanvas.Frontend.DrawProcessing line 485, column 1 - line 490, column 1: "+[n.constructor.name])}},F=function(n){return function(n){return n instanceof h.CommandingTrans?!0:n instanceof h.CommandingClockwork}},A=function(n){return function(n){return n instanceof h.CommandingTrans?n.value0:P.emptyTransform(0)}},N=function(n){return function(o){return function(a){if(n instanceof r.Nothing)return 0;if(n instanceof r.Just){var c=u.uncons(n.value0.path);if(c instanceof r.Nothing)return 0;if(c instanceof r.Just){var l=c.value0.head-o,s=t.round(t.toNumber(a)/2),f=function(){if(0===l)return 0;if(-l>s)return a+l|0;if(l>s)return l-a;if(e.otherwise)return l;throw new Error("Failed pattern match at ConeCanvas.Frontend.DrawProcessing line 474, column 25 - line 479, column 11: "+[l.constructor.name])}(),d=2*i.pi/t.toNumber(a);return 0===f?0:-(t.toNumber(f)*d)*(n.value0.progress/100)}throw new Error("Failed pattern match at ConeCanvas.Frontend.DrawProcessing line 468, column 3 - line 484, column 1: "+[c.constructor.name])}throw new Error("Failed pattern match at ConeCanvas.Frontend.DrawProcessing line 466, column 1 - line 467, column 1: "+[n.constructor.name,o.constructor.name,a.constructor.name])}}},_=function(n){return function(t){if(t instanceof y.TDClockwise){var r=m.modFloat(n)(2*i.pi),o=function(){var n=0>=r;if(n)return r;if(!n)return r-2*i.pi;throw new Error("Failed pattern match at ConeCanvas.Frontend.DrawProcessing line 565, column 15 - line 568, column 5: "+[n.constructor.name])}();return o}if(t instanceof y.TDAntiClockwise){var r=m.modFloat(n)(2*i.pi),o=function(){
var n=r>=0;if(n)return r;if(!n)return 2*i.pi-r;throw new Error("Failed pattern match at ConeCanvas.Frontend.DrawProcessing line 571, column 15 - line 574, column 5: "+[n.constructor.name])}();return o}if(t instanceof y.TDShortest){var r=m.modFloat(n)(2*i.pi),o=function(){if(0>r){var t=n>-i.pi;if(t)return r;if(!t)return i.pi-r;throw new Error("Failed pattern match at ConeCanvas.Frontend.DrawProcessing line 578, column 28 - line 579, column 11: "+[t.constructor.name])}if(r<i.pi)return r;if(e.otherwise)return r-i.pi;throw new Error("Failed pattern match at ConeCanvas.Frontend.DrawProcessing line 576, column 5 - line 589, column 1: "+[])}();return o}throw new Error("Failed pattern match at ConeCanvas.Frontend.DrawProcessing line 563, column 1 - line 569, column 1: "+[n.constructor.name,t.constructor.name])}},D=function(n){return function(e){if(n instanceof r.Nothing)return r.Nothing.value;if(n instanceof r.Just){var t=u.uncons(n.value0.path);if(t instanceof r.Nothing)return r.Nothing.value;if(t instanceof r.Just){var o=e===t.value0.head;if(o)return new r.Just({path:t.value0.tail,progress:n.value0.progress});if(!o)return r.Nothing.value;throw new Error("Failed pattern match at ConeCanvas.Frontend.DrawProcessing line 461, column 20 - line 465, column 1: "+[o.constructor.name])}throw new Error("Failed pattern match at ConeCanvas.Frontend.DrawProcessing line 459, column 3 - line 465, column 1: "+[t.constructor.name])}throw new Error("Failed pattern match at ConeCanvas.Frontend.DrawProcessing line 457, column 1 - line 458, column 1: "+[n.constructor.name,e.constructor.name])}},M=function(n){var e=2*i.pi/i.max(t.toNumber(2))(t.toNumber(n));return 1.6179999999999999/(i.sqrt(2-2*i.cos(e))/2)},L=function(n){return function(e){return function(t){for(var o=n,a=e,i=t;;){var u=T.coneUp(a);if(u instanceof r.Nothing)return i;{if(!(u instanceof r.Just))throw new Error("Failed pattern match at ConeCanvas.Frontend.DrawProcessing line 788, column 5 - line 794, column 1: "+[u.constructor.name]);var c=T.coneNumLevel(u.value0),l=M(c),s=o,f=i*l;o=s,a=u.value0,i=f}}}}},I=function(n){return function(e){return function(t){var o=l.uncons(t);if(o instanceof r.Just){var a=M(n),i=M(o.value0.head.l);return i+(a-i)/100*function(){if(o.value0.head.r)return e;if(!o.value0.head.r)return 100-e;throw new Error("Failed pattern match at ConeCanvas.Frontend.DrawProcessing line 775, column 34 - line 777, column 58: "+[o.value0.head.r.constructor.name])}()}if(o instanceof r.Nothing)return M(n);throw new Error("Failed pattern match at ConeCanvas.Frontend.DrawProcessing line 770, column 5 - line 781, column 1: "+[o.constructor.name])}}},O=function(n){return function(e){return function(t){return function(r){var o=i.sin(e)*p.coneRadius/r,a=t.y+n/r,u=i.cos(e)*p.coneRadius/r,c=p.sphereRadius/r,l=c*p.labelWidthFactor,s=(c*p.labelHeightFactor,p.coneRadius/r),f=s+l/2,d=i.sqrt(f*f/(1+o*o/(u*u))),v=function(){var n=i.abs(u)<1e-5;if(n)return 0;if(!n){var e=u>0;if(e)return d;if(!e)return-d;throw new Error("Failed pattern match at ConeCanvas.Frontend.DrawProcessing line 725, column 47 - line 726, column 9: "+[e.constructor.name])}throw new Error("Failed pattern match at ConeCanvas.Frontend.DrawProcessing line 725, column 14 - line 726, column 9: "+[n.constructor.name])}(),m=function(){var n=i.abs(u)<1e-5;if(n){var e=o>0;if(e)return f;if(!e)return-f;throw new Error("Failed pattern match at ConeCanvas.Frontend.DrawProcessing line 726, column 39 - line 726, column 67: "+[e.constructor.name])}if(!n)return o*(v/u);throw new Error("Failed pattern match at ConeCanvas.Frontend.DrawProcessing line 726, column 14 - line 727, column 5: "+[n.constructor.name])}();return{x:t.x+v,y:a,z:t.z+m}}}}},R=function(n){return function(e){return function(t){return function(r){return{x:t.x+i.cos(e)*p.coneRadius/r,y:t.y+n/r,z:t.z+i.sin(e)*p.coneRadius/r}}}}},k=function(n){return function(o){return function(a){return function(c){if(c instanceof u.Nil)return e["return"](b.applicativeEff)(new r.Just(R(o)(p.startAngleConst)(p.coosTop)(1)));var l=function(a){return function(c){return function(s){return function(f){if(c instanceof u.Nil)return e["return"](b.applicativeEff)(new r.Just(s));if(a instanceof r.Nothing)return e["return"](b.applicativeEff)(r.Nothing.value);if(a instanceof r.Just){var d=u.uncons(c);if(d instanceof r.Just){var v=T.coneSetPos(a.value0)(d.value0.head),m=T.coneGetPosition(a.value0);if(v instanceof r.Nothing)return e["return"](b.applicativeEff)(r.Nothing.value);if(v instanceof r.Just){var h=d.value0.head-m,w=T.coneNumLevel(a.value0),g=f*M(w),C=2*i.pi/t.toNumber(w),S=p.startAngleConst+t.toNumber(h)*C;return function(){var e=T.coneDown(n)(v.value0)();return l(e)(d.value0.tail)(R(o)(S)(s)(f))(g)()}}throw new Error("Failed pattern match at ConeCanvas.Frontend.DrawProcessing line 809, column 17 - line 819, column 13: "+[v.constructor.name])}return e["return"](b.applicativeEff)(r.Nothing.value)}throw new Error("Failed pattern match at ConeCanvas.Frontend.DrawProcessing line 795, column 1 - line 796, column 1: "+[a.constructor.name,c.constructor.name,s.constructor.name,f.constructor.name])}}}};return function(){var e=T.coneDown(n)(T.coneRoot(a))();T.coneNumLevel(a);return l(e)(c)(R(o)(p.startAngleConst)(p.coosTop)(1))(M(1))()}}}}},U=function(n){return function(n){return function(e){return function(o){return function(a){return function(u){return function(c){var s=l.uncons(l.mapMaybe(P.getTurn(e))(a.transforms));if(s instanceof r.Just&&s.value0.head instanceof h.TOTurn){var f=T.normalizePos(s.value0.head.value1.index-(o+1|0))(s.value0.head.value1.ngon),d=c+(t.toNumber(f)+1)*(2*i.pi/t.toNumber(s.value0.head.value1.ngon)),v=c+t.toNumber(n)*u,m=_(v-d)(s.value0.head.value2);return d+m/100*function(){if(s.value0.head.value0)return a.progress;if(!s.value0.head.value0)return 100-a.progress;throw new Error("Failed pattern match at ConeCanvas.Frontend.DrawProcessing line 699, column 34 - line 701, column 69: "+[s.value0.head.value0.constructor.name])}()}return c+t.toNumber(n)*u}}}}}}},G=function(n){return function(e){return function(r){return function(o){var a=A(n)(o),u=(l.mapMaybe(P.getSizeChange)(a.transforms),T.coneNumLevel(r)),c=T.coneGetPosition(r),s=T.normalizePos(c)(u),f=2*i.pi/t.toNumber(u),d=U(n)(0)(s)(c)(a)(f)(p.startAngleConst);return R(e)(d)(p.coosTop)(1)}}}},B=function(n){return function(a){return function(s){return function(m){return function(p){var w=-(i.pi/m.prefs.angleSelectFactor)*(m.controlState.angleSelect.x+m.prefs.angleSelectAddX),C=i.pi/m.prefs.angleSelectFactor*(m.controlState.angleSelect.y+m.prefs.angleSelectAddY);if(p instanceof h.CommandingUpDown){var S=A(n)(p),y=G(n)(m.prefs.coneHeight)(s)(p),E=l.mapMaybe(P.getSizeChange)(S.transforms),x=T.coneNumLevel(s),F=I(x)(S.progress)(E),N=function(){if(p.value0>0)return 1-p.value0/100;if(p.value0<0)return 1+p.value0/100;if(e.otherwise)return 1;throw new Error("Failed pattern match at ConeCanvas.Frontend.DrawProcessing line 91, column 13 - line 119, column 9: "+[])}(),_=1+-1*N,D=function(){if(c.elem(c.foldableArray)(e.eqNumber)(p.value0)([0,100,-100]))return 1;if(p.value0>0)return 1-N;if(e.otherwise)return 1-_;throw new Error("Failed pattern match at ConeCanvas.Frontend.DrawProcessing line 91, column 13 - line 119, column 9: "+[])}(),M=v.vec3(-y.x*D)(-y.y*D)(y.z*D),O=function(){if(c.elem(c.foldableArray)(e.eqNumber)(p.value0)([0,100,-100]))return 1;if(p.value0>0)return 1+N*(F-1);if(e.otherwise)return 1+_*(F-1);throw new Error("Failed pattern match at ConeCanvas.Frontend.DrawProcessing line 91, column 13 - line 119, column 9: "+[])}();return function(){var e=g.setPerspective(n)(m)(1)();return d.rotateSTX(C)(e)(),d.rotateSTY(-w)(e)(),d.translateST(M)(e)(),d.scaleST3(O)(O)(O)(e)(),d.translateST(v.vec3(y.x)(y.y)(-y.z))(e)(),{commandingScale:O,upDown:p.value0}}}if(p instanceof h.CommandingTurn){var x=T.coneNumLevel(s),R=2*i.pi/t.toNumber(x),U=p.value0/-100*R+w;return function(){var e=g.setPerspective(n)(m)(1)();return d.rotateSTX(C)(e)(),d.rotateSTY(-U)(e)(),{commandingScale:1,upDown:0}}}return p instanceof h.CommandingGlobal?function(){var t=e["<$>"](b.functorEff)(o.fromJust)(k(n)(m.prefs.coneHeight)(s)(T.coneGetPath(a)))(),r=v.vec3(t.x)(t.y)(-t.z),i=G(n)(m.prefs.coneHeight)(s)(p),u=v.vec3(-i.x)(-i.y)(i.z),c=L(n)(a)(1),l=1.71*c,f=function(){if(p.value1)return 100-p.value0;if(!p.value1)return p.value0;throw new Error("Failed pattern match at ConeCanvas.Frontend.DrawProcessing line 130, column 39 - line 131, column 17: "+[p.value1.constructor.name])}(),h=0+(l-0)/100*f,S=g.setPerspective(n)(m)(h)();return d.rotateSTX(C)(S)(),d.rotateSTY(-w)(S)(),d.translateST(u)(S)(),d.scaleST3(c)(c)(c)(S)(),d.translateST(r)(S)(),{commandingScale:c,upDown:0}}:p instanceof h.CommandingClockwork?function(){var t=T.coneSetPath(n)(s)(p.value0.ccFrom)(),i=T.coneSetPath(n)(s)(p.value0.ccTo)(),l=T.coneSetPath(n)(s)(p.value0.ccUpper)(),h=function(){if(l instanceof r.Nothing)return f.trace("ConeView3D>>calcMatrices: can't set upper path."+e.show(u.showList(e.showInt))(p.value0.ccUpper))(function(n){return 1});if(l instanceof r.Just)return L(n)(l.value0)(1);throw new Error("Failed pattern match at ConeCanvas.Frontend.DrawProcessing line 169, column 23 - line 172, column 17: "+[l.constructor.name])}(),S=(A(n)(p),function(){if(i instanceof r.Nothing)return f.trace("ConeView3D>>calcMatrices: can't set to path."+e.show(u.showList(e.showInt))(p.value0.ccTo))(function(n){return 1});if(i instanceof r.Just)return L(n)(i.value0)(1);throw new Error("Failed pattern match at ConeCanvas.Frontend.DrawProcessing line 173, column 23 - line 176, column 17: "+[i.constructor.name])}()),P=p.value0.ccSecond>.1&&p.value0.ccSecond<99.9,y=p.value0.ccSecond<.1,E=function(){if(t instanceof r.Nothing)return f.trace("ConeView3D>>calcMatrices: can't set from path."+e.show(u.showList(e.showInt))(p.value0.ccFrom))(function(n){return 1});if(t instanceof r.Just)return L(n)(t.value0)(1);throw new Error("Failed pattern match at ConeCanvas.Frontend.DrawProcessing line 165, column 23 - line 168, column 17: "+[t.constructor.name])}(),x=function(){if(p.value0.ccFirst<99.9)return E+(h-E)/100*p.value0.ccFirst;if(p.value0.ccThird<.1)return h;if(e.otherwise)return h+(S-h)/100*p.value0.ccThird;throw new Error("Failed pattern match at ConeCanvas.Frontend.DrawProcessing line 149, column 58 - line 205, column 9: "+[])}(),F=(T.coneGetPath(a),100-p.value0.ccTotal),N=function(){if(10>F)return 10*F;if(F>=90)return 100-10*(F-90);if(e.otherwise)return 100;throw new Error("Failed pattern match at ConeCanvas.Frontend.DrawProcessing line 149, column 58 - line 205, column 9: "+[])}(),_=e["<$>"](b.functorEff)(o.fromJust)(k(n)(m.prefs.coneHeight)(s)(p.value0.ccFrom))(),D=e["<$>"](b.functorEff)(o.fromJust)(k(n)(m.prefs.coneHeight)(s)(u.toList(c.foldableArray)([])))(),M=function(){if(i instanceof r.Nothing)return f.trace("ConeView3D>>calcMatrices: can't set to path.")(function(t){return e["<$>"](b.functorEff)(o.fromJust)(k(n)(m.prefs.coneHeight)(s)(p.value0.ccTo))});if(i instanceof r.Just)return e["<$>"](b.functorEff)(o.fromJust)(k(n)(m.prefs.coneHeight)(i.value0)(p.value0.ccTo));throw new Error("Failed pattern match at ConeCanvas.Frontend.DrawProcessing line 183, column 23 - line 187, column 13: "+[i.constructor.name])}()(),I=v.vec3(-D.x)(-D.y)(D.z),O=function(){if(y)return v.vec3(_.x)(_.y)(-_.z);if(P)return v.vec3(_.x+(M.x-_.x)/100*p.value0.ccSecond)(_.y+(M.y-_.y)/100*p.value0.ccSecond)(-(_.z+(M.z-_.z)/100*p.value0.ccSecond));if(e.otherwise)return v.vec3(M.x)(M.y)(-M.z);throw new Error("Failed pattern match at ConeCanvas.Frontend.DrawProcessing line 149, column 58 - line 205, column 9: "+[])}(),R=1.71*S,U=0+(R-0)/100*N,G=g.setPerspective(n)(m)(U)();return d.rotateSTX(C)(G)(),d.rotateSTY(-w)(G)(),d.translateST(I)(G)(),d.scaleST3(x)(x)(x)(G)(),d.translateST(O)(G)(),{commandingScale:x,upDown:0}}:function(){var e=g.setPerspective(n)(m)(1)();return d.rotateSTX(C)(e)(),d.rotateSTY(-w)(e)(),{commandingScale:1,upDown:0}}}}}}},J=function(n){return function(o){return function(a){return function(c){return function(f){return function(d){return function(v){return function(w){return function(g){return function(E){return function(x){return function(F){return function(A){return function(_){return function(M){return function(L){return function(k){var G=L.prefs.coneHeight*(t.toNumber(L.windowSize.y)/L.prefs.coneHeight*2.5)*(A/w),B=T.coneGetPosition(c),z=T.zipGetEntry(c),W=e["++"](u.semigroupList)(_)(u.singleton(T.coneGetPosition(c)));return function(){var u=T.coneDown(n)(c)();if(u instanceof r.Nothing){var _=function(){var e=T.coneIsLeaf(n)(c);if(e)return p.DTLeaf.value;if(!e)return p.DTCone.value;throw new Error("Failed pattern match at ConeCanvas.Frontend.DrawProcessing line 370, column 31 - line 373, column 17: "+[e.constructor.name])}(),j=function(){var e=G>150;if(e)return y.stlName(n)(z);if(!e)return r.Nothing.value;throw new Error("Failed pattern match at ConeCanvas.Frontend.DrawProcessing line 374, column 31 - line 375, column 13: "+[e.constructor.name])}(),V=function(){var e=G>150;if(e)return y.iconName(n)(z);if(!e)return r.Nothing.value;throw new Error("Failed pattern match at ConeCanvas.Frontend.DrawProcessing line 373, column 31 - line 374, column 17: "+[e.constructor.name])}(),q=function(){var e=G>300;if(e){var t=T.zipGetEntry(c);return new r.Just({label:y.label(n)(t),comment:y.comment(n)(t),targetUri:y.targetUri(n)(t)})}if(!e)return r.Nothing.value;throw new Error("Failed pattern match at ConeCanvas.Frontend.DrawProcessing line 366, column 33 - line 370, column 17: "+[e.constructor.name])}();return s.when(b.monadEff)(!(F||y.hidden(n)(z)))(function(){return C.push(o)({drawIndex:a,realIndex:B,conePath:W,level:g,coordinates:f,coosLabel:d,angle:v,scale:w,fade:x,condIconName:V,condSTLName:j,condColor:y.color(n)(z),condLabel:q,drawTag:_})(),e.unit})()}if(u instanceof r.Just){var j=function(){var e=G>150;if(e)return y.stlName(n)(z);if(!e)return r.Nothing.value;throw new Error("Failed pattern match at ConeCanvas.Frontend.DrawProcessing line 400, column 30 - line 401, column 17: "+[e.constructor.name])}(),Z=l.mapMaybe(P.getSizeChange)(E.transforms),K=T.coneNumLevel(u.value0),X=w*I(K)(E.progress)(Z),V=function(){var e=G>150;if(e)return y.iconName(n)(z);if(!e)return r.Nothing.value;throw new Error("Failed pattern match at ConeCanvas.Frontend.DrawProcessing line 399, column 31 - line 400, column 17: "+[e.constructor.name])}(),Y=S.calcFrustumVerdict(L.prefs.coneHeight)({x:f.x,y:-f.y,z:f.z})(w)(k),q=function(){var e=G>300;if(e){var t=T.zipGetEntry(c);return new r.Just({label:y.label(n)(t),comment:y.comment(n)(t),targetUri:y.targetUri(n)(t)})}if(!e)return r.Nothing.value;throw new Error("Failed pattern match at ConeCanvas.Frontend.DrawProcessing line 401, column 30 - line 405, column 17: "+[e.constructor.name])}(),Q=T.coneGetPosition(u.value0),nn=2*i.pi/t.toNumber(K);return s.when(b.monadEff)(!(60>G||e["=="](p.eqFrustumVerdict)(Y)(p.OutsideFrustum.value))&&x>0)(function(){return l.foldM(b.monadEff)(function(e){return function(t){var a=T.normalizePos(Q+t|0)(K),i=P.filterTransform(a)(E),u=function(){var n=1>x;if(n)return x;if(!n){var e=l.uncons(l.mapMaybe(P.getFade(a))(E.transforms));return e instanceof r.Just&&e.value0.head instanceof h.TOFade&&e.value0.head.value0 instanceof r.Just&&e.value0.head.value0.value0?E.progress/100:e instanceof r.Just&&e.value0.head instanceof h.TOFade&&e.value0.head.value0 instanceof r.Just&&!e.value0.head.value0.value0?(100-E.progress)/100:e instanceof r.Just&&e.value0.head instanceof h.TOFade&&e.value0.head.value0 instanceof r.Nothing?0:1}throw new Error("Failed pattern match at ConeCanvas.Frontend.DrawProcessing line 417, column 38 - line 423, column 25: "+[n.constructor.name])}(),s=N(M)(T.coneGetFirstBelow(c))(K),d=U(n)(t)(a)(Q)(E)(nn)(v+s),m=function(){var n=0===t;if(n)return e;if(!n)return T.coneRight(e);throw new Error("Failed pattern match at ConeCanvas.Frontend.DrawProcessing line 411, column 41 - line 414, column 30: "+[n.constructor.name])}();return function(){return J(n)(o)(t)(m)(R(L.prefs.coneHeight)(d)(f)(w))(O(L.prefs.coneHeight)(d)(f)(w))(d)(X)(g+1|0)(i)(u)(!1)(A)(W)(D(M)(a))(L)(k)(),m}}})(u.value0)(l[".."](0)(K-1))(),e.unit})(),m.mapE(H(n)(o)(f)(v)(w)(X)(g+1|0)(E.progress)(A)(W)(L)(k))(l.mapMaybe(P.getIntro)(E.transforms))(),m.mapE($(n)(o)(f)(v)(w)(X)(g+1|0)(E.progress)(A)(W)(L)(k))(l.mapMaybe(P.getLift)(E.transforms))(),s.when(b.monadEff)(!(F||y.hidden(n)(z)||e["=="](p.eqFrustumVerdict)(Y)(p.AboveFrustum.value)))(function(){return C.push(o)({drawIndex:a,realIndex:B,conePath:W,level:g,coordinates:f,coosLabel:d,angle:v,scale:w,fade:x,condIconName:V,condSTLName:j,condColor:y.color(n)(z),condLabel:q,drawTag:p.DTCone.value})(),e.unit})()}throw new Error("Failed pattern match at ConeCanvas.Frontend.DrawProcessing line 364, column 5 - line 456, column 1: "+[u.constructor.name])}}}}}}}}}}}}}}}}}},$=function(n){return function(e){return function(o){return function(a){return function(u){return function(c){return function(l){return function(s){return function(f){return function(d){return function(v){return function(w){return function(g){var C=P.getLiftBase(g);if(C instanceof r.Just&&C.value0 instanceof h.TPLift){var S=a+t.toNumber(C.value0.value1.pos.index)*(2*i.pi/t.toNumber(C.value0.value1.pos.ngon)),y=function(){if(C.value0.value0)return 100-s;if(!C.value0.value0)return s;throw new Error("Failed pattern match at ConeCanvas.Frontend.DrawProcessing line 540, column 31 - line 541, column 17: "+[C.value0.value0.constructor.name])}(),b=c+(u-c)/100*y,E={x:o.x+i.cos(S)*p.coneRadius/u,y:o.y+v.prefs.coneHeight/u,z:o.z+i.sin(S)*p.coneRadius/u},x=function(){var n=P["getFade'"](g);return n instanceof r.Just&&n.value0 instanceof h.TOFade&&n.value0.value0 instanceof r.Just&&n.value0.value0.value0?s/100:n instanceof r.Just&&n.value0 instanceof h.TOFade&&n.value0.value0 instanceof r.Just&&!n.value0.value0.value0?(100-s)/100:1}(),F={x:E.x+(o.x-E.x)/100*y,y:E.y+(o.y/u-E.y)/100*y/b,z:E.z+(o.z-E.z)/100*y};return J(n)(e)(-1)(T.makeZipper(n)(C.value0.value1.model))(F)(F)(S)(b)(l)(P.buildTransform(s)(C.value0.value1.transforms))(x)(!0)(f)(d)(r.Nothing.value)(v)(w)}return m.fail("ConeView::drawLift>> cant extract lift")}}}}}}}}}}}}},H=function(n){return function(e){return function(o){return function(a){return function(u){return function(c){return function(l){return function(s){return function(f){return function(d){return function(v){return function(w){return function(g){var C=P.getIntroBase(g);if(C instanceof r.Just&&C.value0 instanceof h.TPIntro){var S=a+t.toNumber(C.value0.value0.pos.index)*(2*i.pi/t.toNumber(C.value0.value0.pos.ngon)),y=function(){var n=P["getFade'"](g);return n instanceof r.Just&&n.value0 instanceof h.TOFade&&n.value0.value0 instanceof r.Just&&n.value0.value0.value0?s/100:n instanceof r.Just&&n.value0 instanceof h.TOFade&&n.value0.value0 instanceof r.Just&&!n.value0.value0.value0?(100-s)/100:1}(),b=function(n){return{x:o.x+i.cos(n)*p.coneRadius/u,y:o.y+v.prefs.coneHeight/u,z:o.z+i.sin(n)*p.coneRadius/u}},E=b(S);return J(n)(e)(-1)(T.makeZipper(n)(C.value0.value0.model))(E)(E)(S)(c)(l)(P.buildTransform(s)(C.value0.value0.transforms))(y)(!1)(f)(d)(r.Nothing.value)(v)(w)}return m.fail("ConeView::drawIntro>> can't extract intro")}}}}}}}}}}}}},z=function(n){return function(o){return function(o){return function(c){return function(c){return function(f){return function(d){return function(d){return function(v){return function(m){return function(w){var g=function(a){var u=function(){return d instanceof h.CommandingUpDown?d.value0:0}(),w=function(){return d instanceof h.CommandingTrans?d.value0:P.emptyTransform(0)}(),g=l.mapMaybe(P.getSizeChange)(w.transforms),C=T.coneNumLevel(c),S=I(C)(w.progress)(g),y=T.coneIsRoot(c),F=T.coneGetPosition(c),A=x(e.showInt)(T.coneGetPath(c)),N=function(){return d instanceof h.CommandingClockwork?new r.Just({path:d.value0.ccTo,progress:d.value0.ccSecond}):r.Nothing.value}(),_=2*i.pi/t.toNumber(C);return function(){E.getMillisecondsTime();s.when(b.monadEff)(!(f&&0>=u))(function(){return l.foldM(b.monadEff)(function(e){return function(t){var i=T.normalizePos(F+t|0)(C),u=U(n)(t)(i)(F)(w)(_)(p.startAngleConst),c=P.filterTransform(i)(w),s=function(){var n=l.uncons(l.mapMaybe(P.getFade(i))(w.transforms));return n instanceof r.Just&&n.value0.head instanceof h.TOFade&&n.value0.head.value0 instanceof r.Just&&n.value0.head.value0.value0?w.progress/100:n instanceof r.Just&&n.value0.head instanceof h.TOFade&&n.value0.head.value0 instanceof r.Just&&!n.value0.head.value0.value0?(100-w.progress)/100:n instanceof r.Just&&n.value0.head instanceof h.TOFade&&n.value0.head.value0 instanceof r.Nothing?0:1}(),f=function(){var n=0===t;if(n)return e;if(!n)return T.coneRight(e);throw new Error("Failed pattern match at ConeCanvas.Frontend.DrawProcessing line 291, column 34 - line 294, column 21: "+[n.constructor.name])}();return function(){return J(n)(o)(t)(f)(R(v.prefs.coneHeight)(u)(p.coosTop)(1))(O(v.prefs.coneHeight)(u)(p.coosTop)(1))(u)(S)(function(){if(y)return 1;if(!y)return 2;throw new Error("Failed pattern match at ConeCanvas.Frontend.DrawProcessing line 304, column 38 - line 304, column 68: "+[y.constructor.name])}())(c)(s)(!1)(m)(A)(N)(v)(a)(),f}}})(c)(l[".."](0)(C-1))(),e.unit})();E.getMillisecondsTime();return e.unit}},A=function(t){var r=function(n){return function(e){return.5*n>i.abs(n-e)}},o=e["=="](y.eqConeZip(y.eqConeNode(n["__superclass_Prelude.Eq_0"]())))(t.selectedZip)(c)&&e["=="](u.eqList(e.eqInt))(t.selectedPath)(T.coneGetPath(c))&&r(t.scale)(m)&&S.frustumInside(w.drawFrustum)(t.cachedFrustum);return o},N=F(n)(d);if(N)return function(){a.writeSTRef(v.bindings.drawStructsCache)(r.Nothing.value)(),g(w.drawFrustum)();var n=E.getMillisecondsTime();return a.writeSTRef(v.animatePaintRef)(new r.Just(n))(),a.writeSTRef(v.bindings.drawStructsCache)(r.Nothing.value)(),e.unit};if(!N)return function(){var n=a.readSTRef(v.bindings.drawStructsCache)();if(n instanceof r.Nothing){g(w.calculatedFrustum)();var t=C.toArray(o)();a.writeSTRef(v.bindings.drawStructsCache)(new r.Just({selectedZip:c,selectedPath:T.coneGetPath(c),scale:m,cachedFrustum:w.calculatedFrustum,structs:t}))();var i=E.getMillisecondsTime();return a.writeSTRef(v.animatePaintRef)(new r.Just(i))(),e.unit}if(n instanceof r.Just){var u=A(n.value0);if(u)return C.pushAll(o)(n.value0.structs)(),e.unit;if(!u){g(w.calculatedFrustum)();var t=C.toArray(o)();a.writeSTRef(v.bindings.drawStructsCache)(new r.Just({selectedZip:c,selectedPath:T.coneGetPath(c),scale:m,cachedFrustum:w.calculatedFrustum,structs:t}))();var i=E.getMillisecondsTime();return a.writeSTRef(v.animatePaintRef)(new r.Just(i))(),e.unit}throw new Error("Failed pattern match at ConeCanvas.Frontend.DrawProcessing line 254, column 31 - line 271, column 3: "+[u.constructor.name])}throw new Error("Failed pattern match at ConeCanvas.Frontend.DrawProcessing line 240, column 13 - line 271, column 3: "+[n.constructor.name])};throw new Error("Failed pattern match at ConeCanvas.Frontend.DrawProcessing line 229, column 5 - line 271, column 3: "+[N.constructor.name])}}}}}}}}}}},W=function(n){return function(o){return function(o){return function(a){return function(a){return function(u){return function(c){return function(f){return function(d){return function(v){return function(w){var g=(function(){return f instanceof h.CommandingUpDown?f.value0:0}(),function(){return f instanceof h.CommandingTrans?f.value0:P.emptyTransform(0)}()),S=l.mapMaybe(P.getSizeChange)(g.transforms),E=(-(i.pi/d.prefs.angleSelectFactor)*(d.controlState.angleSelect.x+d.prefs.angleSelectAddX),T.coneNumLevel(a)),F=I(E)(g.progress)(S),A=(i.pi/d.prefs.angleSelectFactor*(d.controlState.angleSelect.y+d.prefs.angleSelectAddY),T.coneIsRoot(a)),N=(T.coneGetPosition(a),x(e.showInt)(T.coneGetPath(a))),_=function(){var e=function(){var n=A||u;if(n)return new r.Just(a);if(!n)return T.coneUp(a);throw new Error("Failed pattern match at ConeCanvas.Frontend.DrawProcessing line 660, column 15 - line 662, column 32: "+[n.constructor.name])}();if(e instanceof r.Nothing)return{icon:r.Nothing.value,stl:r.Nothing.value,label:r.Nothing.value,color:r.Nothing.value,index:0};if(e instanceof r.Just){var t=T.zipGetEntry(e.value0);return{icon:y.iconName(n)(t),stl:y.stlName(n)(t),label:new r.Just({label:y.label(n)(t),comment:y.comment(n)(t),targetUri:y.targetUri(n)(t)}),color:y.color(n)(t),index:T.coneGetPosition(e.value0)}}throw new Error("Failed pattern match at ConeCanvas.Frontend.DrawProcessing line 660, column 9 - line 675, column 5: "+[e.constructor.name])}();2*i.pi/t.toNumber(E);return function(){return m.mapE(H(n)(o)(p.coosTop)(p.startAngleConst)(1)(F)(2)(g.progress)(v)(N)(d)(w))(l.mapMaybe(P.getIntro)(g.transforms))(),m.mapE($(n)(o)(p.coosTop)(p.startAngleConst)(1)(F)(2)(g.progress)(v)(N)(d)(w))(l.mapMaybe(P.getLift)(g.transforms))(),s.when(b.monadEff)(!c)(function(){return C.push(o)({drawIndex:-1,realIndex:_.index,conePath:N,level:3,coordinates:p.coosTop,coosLabel:p.coosTop,angle:p.startAngleConst,scale:1,fade:1,condIconName:_.icon,condSTLName:_.stl,condLabel:_.label,condColor:_.color,drawTag:p.DTFloatLabel.value})(),e.unit})(),s.when(b.monadEff)(!A)(function(){return C.push(o)({drawIndex:0,realIndex:_.index,conePath:N,level:function(){if(A)return 0;if(!A)return 1;throw new Error("Failed pattern match at ConeCanvas.Frontend.DrawProcessing line 638, column 36 - line 638, column 66: "+[A.constructor.name])}(),coordinates:p.coosTop,coosLabel:p.coosTop,angle:p.startAngleConst,scale:1,fade:1,condIconName:_.icon,condSTLName:_.stl,condLabel:_.label,condColor:_.color,drawTag:p.DTCone.value})(),e.unit})()}}}}}}}}}}}},j=function(n){return function(t){return function(r){return function(a){return function(i){var u=function(){return a instanceof h.CommandingUpDown?a.value0:0}(),c=function(){return a instanceof h.CommandingGlobal?!0:a instanceof h.CommandingClockwork}(),l=function(){if(u>0&&!r)return o.fromJust(T.coneUp(t));if(c)return T.coneRoot(t);if(e.otherwise)return t;throw new Error("Failed pattern match at ConeCanvas.Frontend.DrawProcessing line 55, column 1 - line 78, column 1: "+[])}();return function(){var e=B(n)(t)(l)(i)(a)(),o=e.commandingScale*i.controlState.zoom,u=S.calcFrustums(i)(),s=C.empty();return z(n)(n["__superclass_Prelude.Show_1"]())(s)(t)(l)(r)(c)(a)(i)(o)(u)(),W(n)(n["__superclass_Prelude.Show_1"]())(s)(t)(l)(r)(c)(a)(i)(o)(u.drawFrustum)(),w.drawEverything(n)(n["__superclass_Prelude.Show_1"]())(l)(r)(c)(a)(i)(e)(s)()}}}}}};n.coneDrawPos=j}(PS["ConeCanvas.Frontend.DrawProcessing"]=PS["ConeCanvas.Frontend.DrawProcessing"]||{}),function(n){"use strict";n.addKeyEventListener=function(n){return function(e){return function(t){return function(){var r=document.getElementById(t);r.setAttribute("tabindex","0"),r.focus(),r.addEventListener(n,function(n){e(n)()&&n.preventDefault()})}}}},n.eventGetKeyCode=function(n){return n.keyCode},n.isMetaPressed=function(n){return n.metaKey},n.isControlPressed=function(n){return n.ctrlKey},n.isShiftPressed=function(n){return n.shiftKey},n.isAltPressed=function(n){return n.altKey}}(PS["ConeCanvas.Frontend.Events.Keyboard"]=PS["ConeCanvas.Frontend.Events.Keyboard"]||{}),function(n){"use strict";var e=PS["ConeCanvas.Frontend.Events.Keyboard"],t=PS.Prelude,r=PS["Data.Maybe"],o=PS["Data.Set"],a=(PS["Control.Monad.Eff.WebGL"],PS["Control.Monad.Eff"],PS["Data.Either"]),i=(PS.ConeCanvas,PS["ConeCanvas.ConeControlTypes"]),u=(PS["ConeCanvas.Frontend.DrawTypes3d"],PS["ConeCanvas.ConeControl"]),c=function(n){return function(t){return function(o){return function(o){return function(c){return function(l){var s=e.eventGetKeyCode(c),f=function(){if(l)return new a.Left(s);if(!l)return new a.Right(s);throw new Error("Failed pattern match at ConeCanvas.Frontend.Events.Keyboard line 72, column 14 - line 73, column 3: "+[l.constructor.name])}(),d=function(){if(f instanceof a.Left&&37===f.value0){var n=e.isControlPressed(c)||e.isMetaPressed(c);if(n)return new r.Just(i.KMoveLeft.value);if(!n)return new r.Just(i.KRight.value);throw new Error("Failed pattern match at ConeCanvas.Frontend.Events.Keyboard line 75, column 33 - line 76, column 19: "+[n.constructor.name])}if(f instanceof a.Left&&39===f.value0){var t=e.isControlPressed(c)||e.isMetaPressed(c);if(t)return new r.Just(i.KMoveRight.value);if(!t)return new r.Just(i.KLeft.value);throw new Error("Failed pattern match at ConeCanvas.Frontend.Events.Keyboard line 77, column 33 - line 78, column 19: "+[t.constructor.name])}if(f instanceof a.Left&&38===f.value0){var o=e.isControlPressed(c)||e.isMetaPressed(c);if(o)return new r.Just(i.KMoveUp.value);if(!o)return new r.Just(i.KDown.value);throw new Error("Failed pattern match at ConeCanvas.Frontend.Events.Keyboard line 79, column 33 - line 80, column 19: "+[o.constructor.name])}if(f instanceof a.Left&&40===f.value0){var u=e.isControlPressed(c)||e.isMetaPressed(c);if(u)return new r.Just(i.KMoveDown.value);if(!u)return new r.Just(i.KUp.value);throw new Error("Failed pattern match at ConeCanvas.Frontend.Events.Keyboard line 81, column 33 - line 82, column 19: "+[u.constructor.name])}if(f instanceof a.Left&&49===f.value0){var l=e.isShiftPressed(c);if(l){var s=e.isControlPressed(c)||e.isMetaPressed(c);if(s)return new r.Just(i.KSetFirst.value);if(!s)return new r.Just(i.KFirst.value);throw new Error("Failed pattern match at ConeCanvas.Frontend.Events.Keyboard line 84, column 35 - line 87, column 35: "+[s.constructor.name])}if(!l)return r.Nothing.value;throw new Error("Failed pattern match at ConeCanvas.Frontend.Events.Keyboard line 83, column 33 - line 88, column 19: "+[l.constructor.name])}if(f instanceof a.Left&&88===f.value0){var d=!e.isShiftPressed(c)&&(e.isControlPressed(c)||e.isMetaPressed(c));if(d)return new r.Just(i.KCut.value);if(!d)return r.Nothing.value;throw new Error("Failed pattern match at ConeCanvas.Frontend.Events.Keyboard line 89, column 33 - line 91, column 19: "+[d.constructor.name])}if(f instanceof a.Left&&67===f.value0){var v=!e.isShiftPressed(c)&&(e.isControlPressed(c)||e.isMetaPressed(c));if(v)return new r.Just(i.KCopy.value);if(!v)return r.Nothing.value;throw new Error("Failed pattern match at ConeCanvas.Frontend.Events.Keyboard line 92, column 33 - line 94, column 19: "+[v.constructor.name])}if(f instanceof a.Left&&86===f.value0){var m=!e.isShiftPressed(c)&&(e.isControlPressed(c)||e.isMetaPressed(c));if(m)return new r.Just(i.KPaste.value);if(!m)return r.Nothing.value;throw new Error("Failed pattern match at ConeCanvas.Frontend.Events.Keyboard line 95, column 33 - line 97, column 19: "+[m.constructor.name])}if(f instanceof a.Left&&76===f.value0){var h=!e.isShiftPressed(c)&&!(e.isControlPressed(c)||e.isMetaPressed(c));if(h)return new r.Just(i.KLink.value);if(!h)return r.Nothing.value;throw new Error("Failed pattern match at ConeCanvas.Frontend.Events.Keyboard line 98, column 33 - line 100, column 19: "+[h.constructor.name])}if(f instanceof a.Left&&70===f.value0){var p=!e.isShiftPressed(c)&&!(e.isControlPressed(c)||e.isMetaPressed(c));if(p)return new r.Just(i.KClockwork.value);if(!p)return r.Nothing.value;throw new Error("Failed pattern match at ConeCanvas.Frontend.Events.Keyboard line 101, column 33 - line 103, column 19: "+[p.constructor.name])}if(f instanceof a.Left&&71===f.value0){var w=!e.isShiftPressed(c)&&!(e.isControlPressed(c)||e.isMetaPressed(c));if(w)return new r.Just(i.KGlobal.value);if(!w)return r.Nothing.value;throw new Error("Failed pattern match at ConeCanvas.Frontend.Events.Keyboard line 104, column 33 - line 106, column 19: "+[w.constructor.name])}if(f instanceof a.Right&&71===f.value0){var g=!e.isShiftPressed(c)&&!(e.isControlPressed(c)||e.isMetaPressed(c));if(g)return new r.Just(i.KUnglobal.value);if(!g)return r.Nothing.value;throw new Error("Failed pattern match at ConeCanvas.Frontend.Events.Keyboard line 107, column 33 - line 109, column 19: "+[g.constructor.name])}if(f instanceof a.Right&&90===f.value0){var C=e.isControlPressed(c)||e.isMetaPressed(c);if(C)return r.Nothing.value;if(!C){var S=!e.isShiftPressed(c);if(S)return new r.Just(i.KZoomNormal.value);if(!S)return new r.Just(i.KZoomOut.value);
throw new Error("Failed pattern match at ConeCanvas.Frontend.Events.Keyboard line 111, column 42 - line 112, column 19: "+[S.constructor.name])}throw new Error("Failed pattern match at ConeCanvas.Frontend.Events.Keyboard line 110, column 33 - line 112, column 19: "+[C.constructor.name])}if(f instanceof a.Right&&66===f.value0){var P=(e.isControlPressed(c)||e.isMetaPressed(c))&&e.isShiftPressed(c);if(P)return new r.Just(i.KBench.value);if(!P)return r.Nothing.value;throw new Error("Failed pattern match at ConeCanvas.Frontend.Events.Keyboard line 113, column 33 - line 116, column 19: "+[P.constructor.name])}if(f instanceof a.Right&&68===f.value0){var y=e.isControlPressed(c)||e.isMetaPressed(c);if(y)return new r.Just(i.KToggleDemo.value);if(!y)return r.Nothing.value;throw new Error("Failed pattern match at ConeCanvas.Frontend.Events.Keyboard line 117, column 33 - line 121, column 19: "+[y.constructor.name])}if(f instanceof a.Right&&75===f.value0){var T=e.isAltPressed(c)||e.isMetaPressed(c);if(T)return new r.Just(i.KToggleControl.value);if(!T)return r.Nothing.value;throw new Error("Failed pattern match at ConeCanvas.Frontend.Events.Keyboard line 122, column 33 - line 125, column 19: "+[T.constructor.name])}if(f instanceof a.Right&&73===f.value0){var b=e.isAltPressed(c)||e.isMetaPressed(c);if(b)return new r.Just(i.KToggleIndex.value);if(!b)return r.Nothing.value;throw new Error("Failed pattern match at ConeCanvas.Frontend.Events.Keyboard line 126, column 33 - line 129, column 19: "+[b.constructor.name])}return f instanceof a.Left&&17===f.value0?new r.Just(i.KEditModeOn.value):f instanceof a.Right&&17===f.value0?new r.Just(i.KEditModeOff.value):r.Nothing.value}();if(d instanceof r.Nothing)return function(){var r=i.readPaintRef(n)(t)();if(l)return r.keyCallback(!0)(s)(e.isShiftPressed(c))(e.isControlPressed(c))(e.isAltPressed(c))();if(!l)return r.keyCallback(!1)(s)(e.isShiftPressed(c))(e.isControlPressed(c))(e.isAltPressed(c))();throw new Error("Failed pattern match at ConeCanvas.Frontend.Events.Keyboard line 137, column 9 - line 140, column 5: "+[l.constructor.name])};if(d instanceof r.Just)return function(){return u.keyAction(n)(d.value0)(t)(o)(),!0};throw new Error("Failed pattern match at ConeCanvas.Frontend.Events.Keyboard line 134, column 3 - line 144, column 1: "+[d.constructor.name])}}}}}},l=function(n){return function(r){return function(a){return function(u){return function(l){var s=e.eventGetKeyCode(l);return function(){var e=i.readPaintRef(n)(r)(),f=!o.member(t.ordInt)(s)(e.bindings.keysPressed);if(f)return!0;if(!f)return i.writePaintRef(n)(r)(function(){var n={};for(var r in e)e.hasOwnProperty(r)&&(n[r]=e[r]);return n.bindings=function(){var n={};for(var r in e.bindings)e.bindings.hasOwnProperty(r)&&(n[r]=e.bindings[r]);return n.keysPressed=o["delete"](t.ordInt)(s)(e.bindings.keysPressed),n}(),n}())(),c(n)(r)(a)(u)(l)(!1)();throw new Error("Failed pattern match at ConeCanvas.Frontend.Events.Keyboard line 59, column 3 - line 68, column 1: "+[f.constructor.name])}}}}}},s=function(n){return function(r){return function(a){return function(u){return function(l){var s=e.eventGetKeyCode(l);return function(){var e=i.readPaintRef(n)(r)(),f=o.member(t.ordInt)(s)(e.bindings.keysPressed);if(f)return!0;if(!f)return i.writePaintRef(n)(r)(function(){var n={};for(var r in e)e.hasOwnProperty(r)&&(n[r]=e[r]);return n.bindings=function(){var n={};for(var r in e.bindings)e.bindings.hasOwnProperty(r)&&(n[r]=e.bindings[r]);return n.keysPressed=o.insert(t.ordInt)(s)(e.bindings.keysPressed),n}(),n}())(),c(n)(r)(a)(u)(l)(!0)();throw new Error("Failed pattern match at ConeCanvas.Frontend.Events.Keyboard line 47, column 3 - line 54, column 1: "+[f.constructor.name])}}}}}},f=function(n){return function(t){return function(r){return function(o){return function(){var a=i.readPaintRef(n)(t)();return e.addKeyEventListener("keydown")(s(n)(t)(r)(o))(a.bindings.context.canvasName)(),e.addKeyEventListener("keyup")(l(n)(t)(r)(o))(a.bindings.context.canvasName)()}}}}};n.handleKeys=c,n.handleKeyU=l,n.handleKeyD=s,n.addKeyboardEventListeners=f}(PS["ConeCanvas.Frontend.Events.Keyboard"]=PS["ConeCanvas.Frontend.Events.Keyboard"]||{}),function(n){"use strict";n.addMouseEventListener=function(n){return function(e){return function(t){return function(){var r=document.getElementById(t);r.addEventListener(n,function(n){e(n)()&&n.preventDefault()})}}}},n.eventGetButton=function(n){return n.button},n.eventGetIsUp=function(n){return n.deltaY>0},n.getMousePos=function(n){return function(e){return function(){var t=document.getElementById(e),r=t.getBoundingClientRect(),o=t.scrollWidth,a=t.width,i=a/o,u=t.scrollHeight,c=t.height,l=c/u;return{x:(n.clientX-r.left)*i,y:(n.clientY-r.top)*l}}}}}(PS["ConeCanvas.Frontend.Events.Mouse"]=PS["ConeCanvas.Frontend.Events.Mouse"]||{}),function(n){"use strict";var e=PS["ConeCanvas.Frontend.Events.Mouse"],t=PS.Prelude,r=PS["Data.Maybe"],o=PS["Data.Int"],a=PS["Data.TypedArray"],i=(PS["Graphics.WebGLAll"],PS["Control.Monad.Eff.WebGL"],PS["Control.Monad.Eff"]),u=PS["Data.Array"],c=PS["Debug.Trace"],l=(PS.ConeCanvas,PS["ConeCanvas.ConeControlTypes"]),s=(PS["ConeCanvas.Frontend.DrawTypes3d"],PS["ConeCanvas.Frontend.Pickbuffer"]),f=PS["ConeCanvas.ConeControl"],d=PS["Graphics.WebGLFramebuffer"],v=PS["Graphics.WebGL"],m=PS["Graphics.WebGLTexture"],h=PS["ConeCanvas.Color"],p=function(n){return{x:o.toNumber(n.x),y:o.toNumber(n.y)}},w=function(n){return function(t){return function(r){return function(r){return function(r){var o=e.eventGetIsUp(r);return function(){return f.scrollNotified(n)(t)(o)(),!0}}}}}},g=function(n){return function(r){return function(o){return function(a){return function(a){var u=e.eventGetButton(a);return 0===u?function(){var t=l.readPaintRef(n)(r)(),i=e.getMousePos(a)(t.bindings.context.canvasName)();return f.releasedButton(n)(r)(o)(p(i))(),!0}:t["return"](i.applicativeEff)(!0)}}}}},C=function(n){return function(t){return function(r){return function(r){return function(r){return function(){var o=l.readPaintRef(n)(t)(),a=e.getMousePos(r)(o.bindings.context.canvasName)();return f.motionNotified(n)(t)(p(a))(),!0}}}}}},S=function(n){return function(o){return function(w){return function(w){return function(g){var C=e.eventGetButton(g);return 0===C?function(){var C=l.readPaintRef(n)(o)(),S=a.asUint8Array([0,0,0,0]),P=e.getMousePos(g)(C.bindings.context.canvasName)();d.bindFramebuffer(C.bindings.pickBuffer.l)(),v.viewport(0)(0)(C.windowSize.x)(C.windowSize.y)(),d.framebufferTexture2D(d.COLOR_ATTACHMENT0.value)(m.TEXTURE_2D.value)(C.bindings.pickBuffer.r)();var y=d.readPixels(P.x)(C.windowSize.y-P.y)(1)(1)(S)();d.unbindFramebuffer(),v.viewport(0)(0)(C.windowSize.x)(C.windowSize.y)();var T=h.color4IfromArray(a.asArray(y)),b=s.pickColorToInt(T),E=function(){var n=u.uncons(u.filter(function(n){return n.l===b})(C.labelSelection));if(n instanceof r.Nothing)return r.Nothing.value;if(n instanceof r.Just)return new r.Just(n.value0.head.r);throw new Error("Failed pattern match at ConeCanvas.Frontend.Events.Mouse line 62, column 30 - line 65, column 9: "+[n.constructor.name])}();return c.traceA(i.applicativeEff)("handleMousedown x: "+(t.show(t.showInt)(P.x)+(" y: "+(t.show(t.showInt)(P.y)+(" color: "+(t.show(h.showColor4I)(T)+(" code: "+(t.show(t.showInt)(b)+(" hasClickIndex: "+t.show(t.showBoolean)(r.isJust(E)))))))))))(),f.pressedButton(n)(o)(w)(E)(p(P))(),!1}:t["return"](i.applicativeEff)(!1)}}}}},P=function(n){return function(t){return function(r){return function(o){return function(){var a=l.readPaintRef(n)(t)();return e.addMouseEventListener("mousedown")(S(n)(t)(r)(o))(a.bindings.context.canvasName)(),e.addMouseEventListener("mouseup")(g(n)(t)(r)(o))(a.bindings.context.canvasName)(),e.addMouseEventListener("mousemove")(C(n)(t)(r)(o))(a.bindings.context.canvasName)(),e.addMouseEventListener("wheel")(w(n)(t)(r)(o))(a.bindings.context.canvasName)()}}}}};n.handleMousewheel=w,n.handleMousemove=C,n.handleMouseup=g,n.handleMousedown=S,n.addMouseEventListeners=P}(PS["ConeCanvas.Frontend.Events.Mouse"]=PS["ConeCanvas.Frontend.Events.Mouse"]||{}),function(n){"use strict";var e=(PS.Prelude,PS["Graphics.WebGLAll"],PS["Data.Vector"]),t=(PS.ConeCanvas,PS["ConeCanvas.ConeControlTypes"],PS["ConeCanvas.Frontend.DrawTypes3d"],PS["Control.Monad.Eff"],PS["Graphics.WebGL"]),r=PS["ConeCanvas.Color"],o=function(n){return function(n){return function(){return t.setUniformFloats(n.bindings.uLightDirection)(e.toArray(n.prefs.lightDirection))(),t.setUniformFloats(n.bindings.uLightAmbient)(r.color4toArray(n.prefs.lightAmbient))(),t.setUniformFloats(n.bindings.uLightDiffuse)(r.color4toArray(n.prefs.lightDiffuse))(),t.setUniformFloats(n.bindings.uLightSpecular)(r.color4toArray(n.prefs.lightSpecular))(),t.setUniformFloats(n.bindings.uMaterialAmbient)(r.color4toArray(n.prefs.materialAmbient))(),t.setUniformFloats(n.bindings.uMaterialDiffuse)(r.color4toArray(n.prefs.materialDiffuse))(),t.setUniformFloats(n.bindings.uMaterialSpecular)(r.color4toArray(n.prefs.materialSpecular))(),t.setUniformFloats(n.bindings.uShininess)([n.prefs.shininess])()}}},a=function(n){return function(n){return function(e){return t.setUniformFloats(n.bindings.uLightDiffuse)(r.color4toArray(function(){if(e)return n.prefs.lightDiffuseEdit;if(!e)return n.prefs.lightDiffuse;throw new Error("Failed pattern match at ConeCanvas.Frontend.Lightning line 34, column 23 - line 36, column 59: "+[e.constructor.name])}()))}}};n.setLightning=o,n.setEditLightning=a}(PS["ConeCanvas.Frontend.Lightning"]=PS["ConeCanvas.Frontend.Lightning"]||{}),function(n){"use strict";var e=PS.Prelude,t=PS["Data.Maybe"],r=PS["Data.Maybe.Unsafe"],o=PS["Data.Int"],a=PS["Control.Monad.ST"],i=PS["Control.Monad"],u=PS["Data.Array"],c=PS["Control.Monad.Eff.Random"],l=(PS["Graphics.Canvas"],PS["Graphics.WebGLAll"],PS["Data.ST.Matrix"]),s=PS["Data.Matrix4"],f=(PS["Data.Vector"],PS["Data.Set"]),d=PS["Data.StrMap"],v=PS["Debug.Trace"],m=PS.Extensions,h=(PS.ConeCanvas,PS["ConeCanvas.ConeControlTypes"]),p=PS["ConeCanvas.Frontend.DrawTypes3d"],w=PS["ConeCanvas.Frontend.DrawProcessing"],g=PS["ConeCanvas.Frontend.Pickbuffer"],C=PS["ConeCanvas.Frontend.Cone"],S=PS["ConeCanvas.Frontend.Textures"],P=PS["ConeCanvas.Frontend.Lightning"],y=PS["ConeCanvas.Frontend.Matrix"],T=PS["ConeCanvas.Frontend.Shaders"],b=(PS["ConeCanvas.Preferences"],PS["ConeCanvas.Frontend.Events.Keyboard"]),E=PS["ConeCanvas.Frontend.Events.Mouse"],x=PS["Data.Generic"],F=PS["Control.Monad.Eff"],A=PS["Graphics.WebGL"],N=PS["Graphics.WebGLTexture"],_=PS["ConeCanvas.ConeControl"],D=PS["ConeCanvas.ConeModel"],M=PS["ConeCanvas.ConeZipper"],L=PS["ConeCanvas.Color"],I=PS["Graphics.WebGLFramebuffer"],O=PS["Data.TypeNat"],R=function(n){return function(l){return function(s){return function(){var f=h.readPaintRef(n)(l)();if(f.cycleCallback(),f.benchmark instanceof t.Nothing)return A.requestAnimationFrame(function(){N.activeTexture(0)();var t=_.getMillisecondsTime();_.animateFunc(n)(l)(t)(!1)();var a=_.getMillisecondsTime(),d=a-t;return function(){var n=d>_.stepTime;if(n)return v.traceA(F.applicativeEff)("Too slow: "+e.show(e.showNumber)(d));if(!n)return e["return"](F.applicativeEff)(e.unit);throw new Error("Failed pattern match at ConeCanvas.Frontend.FrontendWebGL line 143, column 17 - line 146, column 17: "+[n.constructor.name])}()(),S.constructTextures(n)(f)(_.stepTime-d)(),i.when(F.monadEff)(u["null"](f.commandQueue)&&f.demoMode)(function(){if(f.state instanceof h.OSNormal){if(f.selectionModel instanceof D.OSParent)return e["return"](F.applicativeEff)(e.unit);if(f.selectionModel instanceof D.OSCurrent)return function(){var t=M.countAllPositions(n)(M.selGetPos(n)(f.selectionModel))(),a=c.randomInt(0)(t-1)(),i=M.getZipFromIndex(n)(M.selGetPos(n)(f.selectionModel))(a)(),u=M.coneGetPath(r.fromJust(i)),s=c.randomInt(1e3)(3e3)();return h.modifyPaintRef(n)(l)(function(n){var e={};for(var t in n)n.hasOwnProperty(t)&&(e[t]=n[t]);return e.commandQueue=[new D.AnimClockwork(u),new D.AnimPause(o.toNumber(s))],e})(),e.unit};throw new Error("Failed pattern match at ConeCanvas.Frontend.FrontendWebGL line 150, column 29 - line 162, column 25: "+[f.selectionModel.constructor.name])}return e["return"](F.applicativeEff)(e.unit)}())(),R(n)(l)(s)()})();if(f.benchmark instanceof t.Just)return A.requestAnimationFrame(function(){var r=_.getMillisecondsTime();_.animateFunc(n)(l)(r)(!1)();var i=_.getMillisecondsTime(),c=i-r;return function(){var n=c>_.stepTime;if(n)return v.traceA(F.applicativeEff)("Too slow bench: "+e.show(e.showNumber)(c));if(!n)return e["return"](F.applicativeEff)(e.unit);throw new Error("Failed pattern match at ConeCanvas.Frontend.FrontendWebGL line 169, column 17 - line 172, column 17: "+[n.constructor.name])}()(),S.constructTextures(n)(f)(_.stepTime-c)(),function(){var r=u["null"](f.commandQueue);if(r)return function(){v.traceA(F.applicativeEff)("Benchmark finished cycles: "+(e.show(e.showInt)(f.benchmark.value0.cycles)+(" runtime per cycle:  "+e.show(e.showNumber)(f.benchmark.value0.runtime/o.toNumber(f.benchmark.value0.cycles)))))();var r=a.readSTRef(f.bindings.textureRef)();v.traceA(F.applicativeEff)("Benchmark finished textures: "+x.gShow(p.genericTextureAdimin)(r.textureAdmin))();var i=p.runTextureAdmin(r.textureAdmin);return v.traceA(F.applicativeEff)("IconText average load time: "+(e.show(e.showNumber)(i.iconLoadTimeSum/o.toNumber(i.iconLoadNum))+(" Text texture average load time: "+e.show(e.showNumber)(i.textTextureLoadTimeSum/o.toNumber(i.textTextureLoadNum)))))(),h.modifyPaintRef(n)(l)(function(n){var e={};for(var r in n)n.hasOwnProperty(r)&&(e[r]=n[r]);return e.benchmark=t.Nothing.value,e})()};if(!r)return h.modifyPaintRef(n)(l)(function(n){var e={};for(var r in n)n.hasOwnProperty(r)&&(e[r]=n[r]);return e.benchmark=new t.Just({runtime:f.benchmark.value0.runtime+c,cycles:f.benchmark.value0.cycles+1|0}),e});throw new Error("Failed pattern match at ConeCanvas.Frontend.FrontendWebGL line 173, column 17 - line 187, column 17: "+[r.constructor.name])}()(),R(n)(l)(s)()})();throw new Error("Failed pattern match at ConeCanvas.Frontend.FrontendWebGL line 136, column 5 - line 189, column 1: "+[f.benchmark.constructor.name])}}}},k=function(n){return new h.ConeFront({startCanvas:function(e){return function(t){return v.trace("startCanvas")(function(r){return function(){var r=h.readPaintRef(n)(e)(),o=A.getCanvasWidth(r.bindings.context)(),a=A.getCanvasHeight(r.bindings.context)();A.viewport(0)(0)(o)(a)(),h.modifyPaintRef(n)(e)(function(n){var e={};for(var t in n)n.hasOwnProperty(t)&&(e[t]=n[t]);return e.windowSize={x:o,y:a},e})();var i=h.readPaintRef(n)(e)();b.addKeyboardEventListeners(n)(e)(k(n))(t)(),E.addMouseEventListeners(n)(e)(k(n))(t)(),g.resetPickColor(n)(i)(),A.setUniformBoolean(r.bindings.uUseTexture)(!1)(),A.setUniformBoolean(r.bindings.uUseTextureFrame)(!1)(),A.setUniformFloats(r.bindings.uTextureFrameColor)(L.color4toArray(i.prefs.textureFrameColor))(),A.setUniformFloats(r.bindings.uTexAmbiance)([1])(),A.enableVertexAttribArray(r.bindings.aVertexNormal)(),A.disableVertexAttribArray(r.bindings.aTextureCoord)(),A.disable(A.BLEND.value)(),A.blendFunc(A.SRC_ALPHA.value)(A.ONE_MINUS_SRC_ALPHA.value)(),A.enable(A.DEPTH_TEST.value)(),A.depthFunc(A.LESS.value)(),P.setLightning(n)(i)();var u=_.getMillisecondsTime();return _.animateFunc(n)(e)(u)(!0)(),R(n)(e)(k(n))()}})}},paintIt:function(t){return function(r){return function(){var o=h.readPaintRef(n)(t)();g.resetPickColor(n)(o)(),P.setEditLightning(n)(o)(o.controlState.editMode)(),a.writeSTRef(o.controlState.needRepaint)(!1)(),I.bindFramebuffer(o.bindings.pickBuffer.l)(),N.activeTexture(0)(),A.viewport(0)(0)(o.windowSize.x)(o.windowSize.y)(),I.framebufferTexture2D(I.COLOR_ATTACHMENT0.value)(N.TEXTURE_2D.value)(o.bindings.pickBuffer.r)(),A.clearColor(0)(0)(0)(0)(),A.clear([A.COLOR_BUFFER_BIT.value])(),I.unbindFramebuffer(),A.viewport(0)(0)(o.windowSize.x)(o.windowSize.y)(),A.clearDepth(100)(),A.clearColor(o.prefs.backColor.value0)(o.prefs.backColor.value1)(o.prefs.backColor.value2)(o.prefs.backColor.value3)(),A.clear([A.COLOR_BUFFER_BIT.value,A.DEPTH_BUFFER_BIT.value])(),y.setPerspective(n)(o)(1)();var i=function(){if(o.selectionModel instanceof D.OSCurrent)return w.coneDrawPos(n)(o.selectionModel.value0)(!1)(r)(o);if(o.selectionModel instanceof D.OSParent)return w.coneDrawPos(n)(o.selectionModel.value0)(!0)(r)(o);throw new Error("Failed pattern match at ConeCanvas.Frontend.FrontendWebGL line 243, column 19 - line 246, column 9: "+[o.selectionModel.constructor.name])}()();return h.modifyPaintRef(n)(t)(function(n){var e={};for(var t in n)n.hasOwnProperty(t)&&(e[t]=n[t]);return e.labelSelection=i,e.counter=n.counter+1|0,e})(),e.unit}}},warningCancel:function(e){return function(t){return function(){var r=h.readPaintRef(n)(e)();return r.alertCallback(t)(),!0}}},warning:function(t){return function(r){return function(){var o=h.readPaintRef(n)(t)();return o.alertCallback(r)(),e.unit}}},quit:function(n){return e["return"](F.applicativeEff)(e.unit)},userToDevice:function(n){return function(r){return function(){var a=l.fromSTMat(O.s4)(n.bindings.mvMatrix)(),i=l.fromSTMat(O.s4)(n.bindings.pMatrix)(),u=s.project([r.x,r.y,r.z])(a)(i)([0,0,o.toNumber(n.windowSize.x),o.toNumber(n.windowSize.y)]);return u instanceof t.Nothing?(v.traceA(F.applicativeEff)("userToDevice x: "+(e.show(e.showNumber)(r.x)+(" y: "+(e.show(e.showNumber)(r.y)+(" z: "+(e.show(e.showNumber)(r.z)+" returns Nothing"))))))(),t.Nothing.value):u instanceof t.Just&&3===u.value0.length?new t.Just({x:o.toNumber(n.windowSize.x)-u.value0[0],y:u.value0[1],z:u.value0[2]}):m.fail("FrontendWebGL>>userToDevice: Impossible!")()}}},deviceToUser:function(n){return function(e){return function(){var r=l.fromSTMat(O.s4)(n.bindings.mvMatrix)(),a=l.fromSTMat(O.s4)(n.bindings.pMatrix)(),i=s.unProject([o.toNumber(n.windowSize.x)-e.x,e.y,e.z])(r)(a)([0,0,o.toNumber(n.windowSize.x),o.toNumber(n.windowSize.y)]);return i instanceof t.Nothing?t.Nothing.value:i instanceof t.Just&&3===i.value0.length?new t.Just({x:i.value0[0],y:i.value0[1],z:i.value0[2]}):m.fail("FrontendWebGL>>deviceToUser: Impossible!")()}}}})},U=function(n){return function(r){return function(o){return function(i){return function(u){return A.runWebGLAttr(r)(function(){var n={};for(var e in A.defContextAttributes)A.defContextAttributes.hasOwnProperty(e)&&(n[e]=A.defContextAttributes[e]);return n.preserveDrawingBuffer=!1,n}())(function(n){return o(n)})(function(r){return function(){return v.traceA(F.applicativeEff)("WebGL started")(),A.withShaders(T.shaders)(function(n){return i(n)})(function(o){return function(){A.bindAttribLocation(o.webGLProgram)(0)("aVertexPosition")(),v.traceA(F.applicativeEff)("shadersReady")();var i=l["identityST'"](O.s4)(),c=l["identityST'"](O.s4)(),s=p.emptyTextureCache(),m=a.newSTRef(s)(),h=a.newSTRef(d.empty)(),w=a.newSTRef(0)(),P=a.newSTRef(t.Nothing.value)(),y=g.initPickbuffer(r)(),T=C.prepareConeXZ(n.coneHeight)(),b=S.prepareTexture();A.makeBufferFloatDyn([])(),A.makeBufferFloatDyn([])();return u({aVertexPosition:o.aVertexPosition,aVertexNormal:o.aVertexNormal,uPMatrix:o.uPMatrix,uMVMatrix:o.uMVMatrix,uNMatrix:o.uNMatrix,uShininess:o.uShininess,uLightDirection:o.uLightDirection,uLightAmbient:o.uLightAmbient,uLightDiffuse:o.uLightDiffuse,uLightSpecular:o.uLightSpecular,uMaterialAmbient:o.uMaterialAmbient,uMaterialDiffuse:o.uMaterialDiffuse,uMaterialSpecular:o.uMaterialSpecular,uScale:o.uScale,aTextureCoord:o.aTextureCoord,uSampler:o.uSampler,uUseTexture:o.uUseTexture,uSimple:o.uSimple,uUseTextureFrame:o.uUseTextureFrame,uTextureFrameColor:o.uTextureFrameColor,uTexAmbiance:o.uTexAmbiance,webGLProgram:o.webGLProgram,mvMatrix:i,pMatrix:c,keysPressed:f.empty,vBufferCone:T.vBuffer,nBufferCone:T.nBuffer,vBufferSTL:T.vBuffer,nBufferSTL:T.nBuffer,textureCoords:b.textureCoords,vertexIndices:b.vertexIndices,vertexCoos:b.vertexCoos,textureRef:m,stlCache:h,pickBuffer:y,lastPickColor:w,context:r,benchmark:t.Nothing.value,drawStructsCache:P})(),e.unit}})()}})}}}}};n.myFrontend=k,n.loop=R,n.initGUI=U}(PS["ConeCanvas.Frontend.FrontendWebGL"]=PS["ConeCanvas.Frontend.FrontendWebGL"]||{}),function(n){"use strict";n.navigateToUrlInt=function(n){return function(){globSetURL(n)}},n.handleSelectedPrim=function(n){return function(n){return function(){globSelectedPrim(n)}}},n.getServerHash=function(){return window.location.hash},n.getSearchString=function(n){return function(){var e=document.getElementById(n);return e.value}}}(PS.Main=PS.Main||{}),function(n){"use strict";var e=PS.Prelude,t=(PS["Data.Maybe"],PS["Data.Foreign.Class"]),r=(PS["Control.Monad.ST"],PS["Data.Map"],PS["Data.List"],PS.ConeCanvas,PS["ConeCanvas.ConeModel"]),o=PS["Data.Either"],a=PS["Data.Foreign.Index"],i=function(){function n(n){this.value0=n}return n.create=function(e){return new n(e)},n}(),u=function(){function n(n){this.value0=n}return n.create=function(e){return new n(e)},n}(),c=function(){function n(){}return n.value=new n,n}(),l=function(){function n(){}return n.value=new n,n}(),s=function(){function n(){}return n.value=new n,n}(),f=function(){function n(){}return n.value=new n,n}(),d=function(){function n(){}return n.value=new n,n}(),v=function(){function n(){}return n.value=new n,n}(),m=function(){function n(n){this.value0=n}return n.create=function(e){return new n(e)},n}(),h=function(){function n(n){this.value0=n}return n.create=function(e){return new n(e)},n}(),p=new e.Show(function(n){if(n instanceof c)return"CPENext";if(n instanceof l)return"CPEPrevious";if(n instanceof s)return"CPEStart";if(n instanceof f)return"CPEEnd";if(n instanceof d)return"CPEExposeCanvas";if(n instanceof v)return"CPEHideCanvas";throw new Error("Failed pattern match at OntoPanel.OntoPanelTypes line 49, column 5 - line 50, column 5: "+[n.constructor.name])}),w=function(n){return new t.IsForeign(function(i){return e.bind(o.bindEither)(t.readProp(t.intIsForeign)(a.indexString)("nodeId")(i))(function(u){return e.bind(o.bindEither)(t.readProp(t.arrayIsForeign(r.isForeignConeNode(n)))(a.indexString)("nodeChilds")(i))(function(n){return e["return"](o.applicativeEither)(new m({nodeId:u,nodeChilds:n}))})})})},g=function(n){return new t.IsForeign(function(i){return e.bind(o.bindEither)(t.readProp(t.arrayIsForeign(r.isForeignConeNode(n)))(a.indexString)("children")(i))(function(r){return e.bind(o.bindEither)(t.readProp(t.arrayIsForeign(w(n)))(a.indexString)("cacheIt")(i))(function(n){return e["return"](o.applicativeEither)(new h({children:r,cacheIt:n}))})})})};n.ChildLoad=h,n.ChildCached=m,n.CPENext=c,n.CPEPrevious=l,n.CPEStart=s,n.CPEEnd=f,n.CPEExposeCanvas=d,n.CPEHideCanvas=v,n.ConePresentationFrame=u,n.FrontendCache=i,n.showConePresentation=p,n.childCachedIsForeign=w,n.childLoadIsForeign=g}(PS["OntoPanel.OntoPanelTypes"]=PS["OntoPanel.OntoPanelTypes"]||{}),function(n){"use strict";n.ajaxGetInt=function(n){return function(e){return function(){var t=new XMLHttpRequest;t.onreadystatechange=function(){4==t.readyState&&200==t.status&&e(t.responseText)()},t.open("GET",n),t.timeout=2e4,t.ontimeout=function(){console.log("ServerConnection>>ajaxGetInt: Timeout"),e("")()},t.setRequestHeader("Content-Type","application/json"),t.send()}}},n.ajaxGetIntSync=function(n){return function(){var e=new XMLHttpRequest;return e.open("GET",n,!1),e.setRequestHeader("Content-Type","application/json"),e.send(),200==e.status?e.responseText:""}},n.ajaxPostInt=function(n){return function(e){return function(t){return function(){var r=new XMLHttpRequest;r.onreadystatechange=function(){4==r.readyState&&200==r.status&&t(r.responseText)()},r.open("POST",n,!0),r.timeout=2e4,r.ontimeout=function(){console.log("ServerConnection>>ajaxPostInt: Timeout"),t("")()},r.setRequestHeader("Content-Type","application/x-www-form-urlencoded"),r.send("data=".concat(e))}}}}}(PS["OntoPanel.ServerConnection"]=PS["OntoPanel.ServerConnection"]||{}),function(n){"use strict";var e=PS.Prelude,t=PS["Data.Maybe"],r=PS["Data.Either"],o=PS["Data.List"],a=PS["Data.Foreign"],i=PS["Data.Foreign.Class"],u=PS["Data.Foreign.NullOrUndefined"],c=(PS.ConeCanvas,PS["OntoPanel.OntoPanelTypes"]),l=PS.Extensions,s=PS["ConeCanvas.ConeModel"],f=PS["Control.Monad.Eff"],d=PS["ConeCanvas.ConeZipper"],v=PS["Data.Foreign.Index"],m=PS["Data.Foldable"],h=function(){function n(n,e){this.value0=n,this.value1=e}return n.create=function(e){return function(t){return new n(e,t)}},n}(),p=function(){function n(n){this.value0=n}return n.create=function(e){return new n(e)},n}(),w=function(){function n(n){this.value0=n}return n.create=function(e){return new n(e)},n}(),g=function(){function n(n){this.value0=n}return n.create=function(e){return new n(e)},n}(),C=function(){function n(n){this.value0=n}return n.create=function(e){return new n(e)},n}(),S=function(){function n(){}return n.value=new n,n}(),P=function(){function n(){}return n.value=new n,n}(),y=function(){function n(){}return n.value=new n,n}(),T=function(){function n(n){this.value0=n}return n.create=function(e){return new n(e)},n}(),b=function(){function n(n){this.value0=n}return n.create=function(e){return new n(e)},n}(),E=function(){function n(n){this.value0=n}return n.create=function(e){return new n(e)},n}(),x=function(){function n(n){this.value0=n}return n.create=function(e){return new n(e)},n}(),F=function(){function n(n){this.value0=n}return n.create=function(e){return new n(e)},n}(),A=function(){function n(n,e,t){this.value0=n,this.value1=e,this.value2=t}return n.create=function(e){return function(t){return function(r){return new n(e,t,r)}}},n}(),N=function(){function n(n,e){this.value0=n,this.value1=e}return n.create=function(e){return function(t){return new n(e,t)}},n}(),_=function(){function n(n){this.value0=n}return n.create=function(e){return new n(e)},n}(),D=function(){function n(n,e){this.value0=n,this.value1=e}return n.create=function(e){return function(t){return new n(e,t)}},n}(),M=function(){function n(){}return n.value=new n,n}(),L=function(){function n(){}return n.value=new n,n}(),I=function(){function n(){}return n.value=new n,n}(),O=function(){function n(n){this.value0=n}return n.create=function(e){return new n(e)},n}(),R=function(){function n(n){this.value0=n}return n.create=function(e){return new n(e)},n}(),k=function(){function n(n){this.value0=n}return n.create=function(e){return new n(e)},n}(),U=function(){function n(){}return n.value=new n,n}(),G=function(){function n(n){this.value0=n}return n.create=function(e){return new n(e)},n}(),B=function(n){return function(r){if(r.value1 instanceof t.Nothing)return e["return"](f.applicativeEff)(r.value0);if(r.value1 instanceof t.Just)return function(){var e=d.coneSetPath(n)(r.value0)(r.value1.value0)();if(e instanceof t.Nothing)return r.value0;if(e instanceof t.Just)return e.value0;throw new Error("Failed pattern match at OntoPanel.Foreign line 38, column 5 - line 42, column 1: "+[e.constructor.name])};throw new Error("Failed pattern match at OntoPanel.Foreign line 35, column 1 - line 36, column 1: "+[r.constructor.name])}},J=function(n){return function(e){if(e instanceof p)return function(){var t=B(n)(e.value0)();return new s.OSCurrent(t)};if(e instanceof w)return function(){var t=B(n)(e.value0)();return new s.OSParent(t)};throw new Error("Failed pattern match at OntoPanel.Foreign line 71, column 1 - line 74, column 1: "+[e.constructor.name])}},$=function(n){return function(r){if(r instanceof g)return e["return"](f.applicativeEff)(new s.AnimMoveLeft(r.value0));if(r instanceof C)return e["return"](f.applicativeEff)(new s.AnimMoveRight(r.value0));if(r instanceof S)return e["return"](f.applicativeEff)(s.AnimTurnToFirst.value);if(r instanceof P)return e["return"](f.applicativeEff)(s.AnimMoveUp.value);if(r instanceof y)return e["return"](f.applicativeEff)(s.AnimMoveDown.value);if(r instanceof T)return e["return"](f.applicativeEff)(new s.AnimClockwork(r.value0));if(r instanceof b&&r.value0 instanceof t.Nothing)return e["return"](f.applicativeEff)(new s.AnimTransformLeft(t.Nothing.value));if(r instanceof b&&r.value0 instanceof t.Just)return function(){var e=B(n)(r.value0.value0)();return new s.AnimTransformLeft(new t.Just(e))};if(r instanceof E&&r.value0 instanceof t.Nothing)return e["return"](f.applicativeEff)(new s.AnimTransformRight(t.Nothing.value));if(r instanceof E&&r.value0 instanceof t.Just)return function(){var e=B(n)(r.value0.value0)();return new s.AnimTransformRight(new t.Just(e))};if(r instanceof x&&r.value0 instanceof t.Nothing)return e["return"](f.applicativeEff)(new s.AnimTransformUp(t.Nothing.value));if(r instanceof x&&r.value0 instanceof t.Just)return function(){var e=B(n)(r.value0.value0)();return new s.AnimTransformUp(new t.Just(e))};if(r instanceof F&&r.value0 instanceof t.Nothing)return e["return"](f.applicativeEff)(new s.AnimTransformDown(t.Nothing.value));if(r instanceof F&&r.value0 instanceof t.Just)return function(){var e=B(n)(r.value0.value0)();return new s.AnimTransformDown(new t.Just(e))};if(r instanceof A&&r.value2 instanceof t.Nothing)return function(){var e=B(n)(r.value1)();return new s.AnimTransformIntro(r.value0,e,t.Nothing.value)};if(r instanceof A&&r.value2 instanceof t.Just)return function(){var e=B(n)(r.value1)(),o=B(n)(r.value2.value0)();return new s.AnimTransformIntro(r.value0,e,new t.Just(o))};if(r instanceof N&&r.value1 instanceof t.Nothing)return e["return"](f.applicativeEff)(new s.AnimTransformExtro(r.value0,t.Nothing.value));if(r instanceof N&&r.value1 instanceof t.Just)return function(){var e=J(n)(r.value1.value0)();return new s.AnimTransformExtro(r.value0,new t.Just(e))};if(r instanceof _&&r.value0 instanceof t.Nothing)return e["return"](f.applicativeEff)(new s.AnimTransformShiftToZero(t.Nothing.value));if(r instanceof _&&r.value0 instanceof t.Just)return function(){var e=B(n)(r.value0.value0)();return new s.AnimTransformShiftToZero(new t.Just(e))};if(r instanceof D&&r.value1 instanceof t.Nothing)return function(){var e=B(n)(r.value0)();return new s.AnimTransformReplace(e)};if(r instanceof D&&r.value1 instanceof t.Just)return function(){var e=B(n)(r.value0)(),o=d.coneSetPath(n)(e)(r.value1.value0)();if(o instanceof t.Nothing)return new s.AnimTransformReplace(e);if(o instanceof t.Just)return new s.AnimTransformReplace(o.value0);throw new Error("Failed pattern match at OntoPanel.Foreign line 235, column 5 - line 238, column 1: "+[o.constructor.name])};if(r instanceof M)return e["return"](f.applicativeEff)(s.AnimCut.value);if(r instanceof L)return e["return"](f.applicativeEff)(s.AnimCopy.value);if(r instanceof I)return e["return"](f.applicativeEff)(s.AnimPaste.value);if(r instanceof O)return e["return"](f.applicativeEff)(new s.AnimGlobalView(r.value0));if(r instanceof R)return e["return"](f.applicativeEff)(new s.AnimZoom(r.value0));if(r instanceof k)return e["return"](f.applicativeEff)(new s.AnimPause(r.value0));if(r instanceof U)return e["return"](f.applicativeEff)(s.AnimNull.value);throw new Error("Failed pattern match at OntoPanel.Foreign line 192, column 1 - line 193, column 1: "+[r.constructor.name])}},H=function(n){return function(e){return function(){var t=l.mapM(f.monadEff)($(n))(e.value0.animations)();return new c.ConePresentationFrame({animations:t,url:e.value0.url})}}},z=function(n){return new i.IsForeign(function(a){return e.bind(r.bindEither)(i.readProp(s.isForeignConeNode(n))(v.indexString)("node")(a))(function(n){return e.bind(r.bindEither)(e["<$>"](r.functorEither)(u.runNullOrUndefined)(i.readProp(i.nullOrUndefinedIsForeign(i.arrayIsForeign(i.intIsForeign)))(v.indexString)("newConePath")(a)))(function(a){return e["return"](r.applicativeEither)(new h({content:n,before:o.Nil.value,after:o.Nil.value,parents:o.Nil.value},function(){if(a instanceof t.Nothing)return t.Nothing.value;if(a instanceof t.Just)return new t.Just(o.toList(m.foldableArray)(a.value0));throw new Error("Failed pattern match at OntoPanel.Foreign line 51, column 19 - line 53, column 56: "+[a.constructor.name])}()))})})})},W=function(n){return new i.IsForeign(function(t){return e.bind(r.bindEither)(i.read(z(n))(t))(function(n){return e.bind(r.bindEither)(i.readProp(i.stringIsForeign)(v.indexString)("tag")(t))(function(e){
return"OSCurrent"===e?r.Right.create(new p(n)):"OSParent"===e?r.Right.create(new w(n)):r.Left.create(new a.JSONError("ConeModel>>isForeignConeZip: unknown tag: "+e))})})})},j=function(n){return new i.IsForeign(function(c){return e.bind(r.bindEither)(i.readProp(i.stringIsForeign)(v.indexString)("tag")(c))(function(l){return e.bind(r.bindEither)(function(){return"AnimMoveLeft"===l?r.Right.create(e["<$>"](r.functorEither)(g.create)(i.readProp(i.intIsForeign)(v.indexString)("left")(c))):"AnimMoveRight"===l?r.Right.create(e["<$>"](r.functorEither)(C.create)(i.readProp(i.intIsForeign)(v.indexString)("right")(c))):"AnimTurnToFirst"===l?r.Right.create(e.pure(r.applicativeEither)(S.value)):"AnimMoveUp"===l?r.Right.create(e.pure(r.applicativeEither)(P.value)):"AnimMoveDown"===l?r.Right.create(e.pure(r.applicativeEither)(y.value)):"AnimClockwork"===l?r.Right.create(e.bind(r.bindEither)(i.readProp(i.arrayIsForeign(i.intIsForeign))(v.indexString)("conePath")(c))(function(n){return e["return"](r.applicativeEither)(new T(o.toList(m.foldableArray)(n)))})):"AnimTransformLeft"===l?r.Right.create(e.bind(r.bindEither)(e["<$>"](r.functorEither)(u.runNullOrUndefined)(i.readProp(i.nullOrUndefinedIsForeign(z(n)))(v.indexString)("model")(c)))(function(n){return e["return"](r.applicativeEither)(new b(n))})):"AnimTransformRight"===l?r.Right.create(e.bind(r.bindEither)(e["<$>"](r.functorEither)(u.runNullOrUndefined)(i.readProp(i.nullOrUndefinedIsForeign(z(n)))(v.indexString)("model")(c)))(function(n){return e["return"](r.applicativeEither)(new E(n))})):"AnimTransformIntro"===l?r.Right.create(e.bind(r.bindEither)(i.readProp(i.booleanIsForeign)(v.indexString)("leftOrRight")(c))(function(t){return e.bind(r.bindEither)(i.readProp(z(n))(v.indexString)("introModel")(c))(function(o){return e.bind(r.bindEither)(e["<$>"](r.functorEither)(u.runNullOrUndefined)(i.readProp(i.nullOrUndefinedIsForeign(z(n)))(v.indexString)("model")(c)))(function(n){return e["return"](r.applicativeEither)(new A(t,o,n))})})})):"AnimTransformExtro"===l?r.Right.create(e.bind(r.bindEither)(i.readProp(i.booleanIsForeign)(v.indexString)("leftOrRight")(c))(function(t){return e.bind(r.bindEither)(e["<$>"](r.functorEither)(u.runNullOrUndefined)(i.readProp(i.nullOrUndefinedIsForeign(W(n)))(v.indexString)("model")(c)))(function(n){return e["return"](r.applicativeEither)(new N(t,n))})})):"AnimTransformDown"===l?r.Right.create(e.bind(r.bindEither)(e["<$>"](r.functorEither)(u.runNullOrUndefined)(i.readProp(i.nullOrUndefinedIsForeign(z(n)))(v.indexString)("model")(c)))(function(n){return e["return"](r.applicativeEither)(new F(n))})):"AnimTransformUp"===l?r.Right.create(e.bind(r.bindEither)(e["<$>"](r.functorEither)(u.runNullOrUndefined)(i.readProp(i.nullOrUndefinedIsForeign(z(n)))(v.indexString)("model")(c)))(function(n){return e["return"](r.applicativeEither)(new x(n))})):"AnimTransformShiftToZero"===l?r.Right.create(e.bind(r.bindEither)(e["<$>"](r.functorEither)(u.runNullOrUndefined)(i.readProp(i.nullOrUndefinedIsForeign(z(n)))(v.indexString)("model")(c)))(function(n){return e["return"](r.applicativeEither)(new _(n))})):"AnimTransformReplace"===l?r.Right.create(e.bind(r.bindEither)(e["<$>"](r.functorEither)(u.runNullOrUndefined)(i.readProp(i.nullOrUndefinedIsForeign(i.arrayIsForeign(i.intIsForeign)))(v.indexString)("newConePath")(c)))(function(a){return e.bind(r.bindEither)(i.readProp(z(n))(v.indexString)("newModel")(c))(function(n){if(a instanceof t.Nothing)return e["return"](r.applicativeEither)(new D(n,t.Nothing.value));if(a instanceof t.Just)return e["return"](r.applicativeEither)(new D(n,new t.Just(o.toList(m.foldableArray)(a.value0))));throw new Error("Failed pattern match at OntoPanel.Foreign line 168, column 21 - line 171, column 17: "+[a.constructor.name])})})):"AnimGlobalView"===l?r.Right.create(e["<$>"](r.functorEither)(O.create)(i.readProp(i.booleanIsForeign)(v.indexString)("startOrFinish")(c))):"AnimZoom"===l?r.Right.create(e.bind(r.bindEither)(e["<$>"](r.functorEither)(u.runNullOrUndefined)(i.readProp(i.nullOrUndefinedIsForeign(i.numberIsForeign))(v.indexString)("factor")(c)))(function(n){return e["return"](r.applicativeEither)(new R(n))})):"AnimPause"===l?r.Right.create(e["<$>"](r.functorEither)(k.create)(i.readProp(i.numberIsForeign)(v.indexString)("time")(c))):"AnimCut"===l?r.Right.create(e.pure(r.applicativeEither)(M.value)):"AnimCopy"===l?r.Right.create(e.pure(r.applicativeEither)(L.value)):"AnimPaste"===l?r.Right.create(e.pure(r.applicativeEither)(I.value)):"AnimNull"===l?r.Right.create(e.pure(r.applicativeEither)(U.value)):r.Left.create(new a.JSONError("ConeModel>>foreignAnimationFS: Unknown tag: ++ show tag"))}())(function(n){return n})})})},V=function(n){return new i.IsForeign(function(t){return e.bind(r.bindEither)(i.readProp(i.arrayIsForeign(j(n)))(v.indexString)("animations")(t))(function(n){return e.bind(r.bindEither)(e["<$>"](r.functorEither)(u.runNullOrUndefined)(i.readProp(i.nullOrUndefinedIsForeign(i.stringIsForeign))(v.indexString)("urlExpl")(t)))(function(t){return e["return"](r.applicativeEither)(new G({animations:n,url:t}))})})})};n.ConePresentationFrameF=G,n.AnimMoveLeftF=g,n.AnimMoveRightF=C,n.AnimTurnToFirstF=S,n.AnimMoveUpF=P,n.AnimMoveDownF=y,n.AnimClockworkF=T,n.AnimTransformLeftF=b,n.AnimTransformRightF=E,n.AnimTransformUpF=x,n.AnimTransformDownF=F,n.AnimTransformIntroF=A,n.AnimTransformExtroF=N,n.AnimTransformShiftToZeroF=_,n.AnimTransformReplaceF=D,n.AnimCutF=M,n.AnimCopyF=L,n.AnimPasteF=I,n.AnimGlobalViewF=O,n.AnimZoomF=R,n.AnimPauseF=k,n.AnimNullF=U,n.OSCurrentF=p,n.OSParentF=w,n.ConeZipF=h,n.runConePresentationFrameF=H,n.runAnimationF=$,n.runConeSelectionF=J,n.runConeZipF=B,n.isForeignConeZipF=z,n.isForeignConeSelectionF=W,n.foreignAnimation=j,n.foreignConePresentationFrameF=V}(PS["OntoPanel.Foreign"]=PS["OntoPanel.Foreign"]||{}),function(n){"use strict";var e=PS["OntoPanel.ServerConnection"],t=PS.Prelude,r=PS["Data.Either"],o=PS["Data.Maybe"],a=PS["Data.Foreign.Class"],i=PS["Data.List"],u=PS["Control.Monad.Eff"],c=PS["Debug.Trace"],l=(PS.DOM,PS["ConeCanvas.ConeModel"],PS["OntoPanel.OntoPanelTypes"]),s=PS["OntoPanel.Foreign"],f=PS.Extensions,d=PS["Data.Foreign.Index"],v=PS["Data.Foreign"],m=PS["Data.Unfoldable"],h=PS["Data.Foldable"],p=function(){function n(){}return n.value=new n,n}(),w=function(){function n(n,e){this.value0=n,this.value1=e}return n.create=function(e){return function(t){return new n(e,t)}},n}(),g=function(){function n(n,e){this.value0=n,this.value1=e}return n.create=function(e){return function(t){return new n(e,t)}},n}(),C=function(){function n(n){this.value0=n}return n.create=function(e){return new n(e)},n}(),S=function(){function n(n){this.value0=n}return n.create=function(e){return new n(e)},n}(),P=function(){function n(n){this.value0=n}return n.create=function(e){return new n(e)},n}(),y=function(){function n(n){this.value0=n}return n.create=function(e){return new n(e)},n}(),T=new a.IsForeign(function(n){return t.bind(r.bindEither)(a.readProp(a.stringIsForeign)(d.indexString)("tag")(n))(function(e){return t.bind(r.bindEither)(c.traceA(r.applicativeEither)("Tag: "+e))(function(){return"PathToRoot"===e?t["<$>"](r.functorEither)(P.create)(a.readProp(a.arrayIsForeign(a.intIsForeign))(d.indexString)("ids")(n)):"IconList"===e?t["<$>"](r.functorEither)(C.create)(a.readProp(a.arrayIsForeign(a.stringIsForeign))(d.indexString)("icons")(n)):"STLList"===e?t["<$>"](r.functorEither)(S.create)(a.readProp(a.arrayIsForeign(a.stringIsForeign))(d.indexString)("stls")(n)):"Base64IMG"===e?t["<*>"](r.applyEither)(t["<$>"](r.functorEither)(w.create)(a.readProp(a.stringIsForeign)(d.indexString)("name")(n)))(a.readProp(a.stringIsForeign)(d.indexString)("base64")(n)):"STLBinary"===e?t["<*>"](r.applyEither)(t["<$>"](r.functorEither)(g.create)(a.readProp(a.stringIsForeign)(d.indexString)("name")(n)))(a.readProp(a.stringIsForeign)(d.indexString)("base64")(n)):"Prefs"===e?t["<$>"](r.functorEither)(y.create)(a.readProp(a.stringIsForeign)(d.indexString)("string")(n)):t["return"](r.applicativeEither)(p.value)})})}),b=function(n){return function(i){return function(l){return function(s){if(i instanceof o.Just)return e.ajaxPostInt(l)(s)(function(e){return c.trace("received: "+e)(function(o){return r.either(function(n){return c.trace("Parse Error: "+t.show(v.showForeignError)(n))(function(n){return t["return"](u.applicativeEff)(t.unit)})})(i.value0)(a.readJSON(n)(e))})});if(i instanceof o.Nothing)return e.ajaxPostInt(l)(s)(t["const"](t["return"](u.applicativeEff)(t.unit)));throw new Error("Failed pattern match at OntoPanel.ServerConnection line 126, column 5 - line 134, column 1: "+[i.constructor.name])}}}},E=function(n){return function(e){return function(t){return c.trace("post: "+e)(function(r){return b(s.foreignConePresentationFrameF(n))(new o.Just(t))("/present/event")(e)})}}},x=function(n){return b(a.stringIsForeign)(o.Nothing.value)("/model/event")(t.show(t.showArray(t.showInt))(i.fromList(m.unfoldableArray)(n)))},F=function(n){return function(t){return e.ajaxGetInt("/model/full"+t)(n)}},A=function(n){return function(o){return function(i){return function(){var u=e.ajaxGetIntSync(o)();return r.either(function(n){return c.trace("Parse Error: "+t.show(v.showForeignError)(n))(function(n){return i})})(t.id(t.categoryFn))(a.readJSON(n)(u))}}}},N=function(n){return function(e){return A(l.childLoadIsForeign(n))("/cone/children?id="+t.show(t.showString)(e))(new l.ChildLoad({children:[],cacheIt:[]}))}},_=function(n){return function(i){return function(l){if(i instanceof o.Nothing)return e.ajaxGetInt(l)(t["const"](t["return"](u.applicativeEff)(t.unit)));if(i instanceof o.Just)return e.ajaxGetInt(l)(function(e){return r.either(function(n){return c.trace("Parse Error: "+t.show(v.showForeignError)(n))(function(n){return t["return"](u.applicativeEff)(t.unit)})})(i.value0)(a.readJSON(n)(e))});throw new Error("Failed pattern match at OntoPanel.ServerConnection line 115, column 5 - line 119, column 1: "+[i.constructor.name])}}},D=function(n){var e=function(e){return e instanceof C?n(e.value0):f.fail("loadIconNames>>Load failure.")};return _(T)(new o.Just(e))("/iconlist")},M=function(n){return function(e){var t=function(t){return t instanceof P?e(i.toList(h.foldableArray)(t.value0)):f.fail("URL not found on server: "+n)};return _(T)(new o.Just(t))("/cone/rootpath?targeturl="+n)}},L=function(n){var e=function(e){return e instanceof y?n(e.value0):f.fail("loadPrefs>>Load failure.")};return _(T)(new o.Just(e))("/prefs")},I=function(n){var e=function(e){return e instanceof S?n(e.value0):f.fail("loadSTLNames>>Load failure.")};return _(T)(new o.Just(e))("/stllist")};n.CSRInvalid=p,n.CSRBase64IMG=w,n.CSRSTLBinary=g,n.CSRIconList=C,n.CSRSTLList=S,n.CSRPathToRoot=P,n.CSRJson=y,n.ajaxModel=F,n.ajaxGet=_,n.sendSelected=x,n.presentationPost=E,n.loadGet=N,n.loadPrefs=L,n.loadSTLNames=I,n.loadIconNames=D,n.loadPath=M,n.coneSrvResponseIsForeign=T}(PS["OntoPanel.ServerConnection"]=PS["OntoPanel.ServerConnection"]||{}),function(n){"use strict";var e=PS.Prelude,t=PS["Data.Maybe"],r=PS["Data.Map"],o=PS["Control.Monad.ST"],a=PS["Data.List"],i=PS["Data.Either"],u=PS["Data.Foldable"],c=(PS.ConeCanvas,PS["OntoPanel.OntoPanelTypes"]),l=PS["OntoPanel.ServerConnection"],s=PS["Control.Monad.Eff"],f=PS["ConeCanvas.ConeModel"],d=PS["ConeCanvas.ConeZipper"],v=e["<$>"](s.functorEff)(c.FrontendCache.create)(o.newSTRef({cacheContent:r.empty,cacheHits:r.empty})),m=function(n){var o=function(n){if(n instanceof t.Nothing)return new t.Just(1);if(n instanceof t.Just)return new t.Just(n.value0+1|0);throw new Error("Failed pattern match at OntoPanel.FrontendCache line 85, column 5 - line 86, column 5: "+[n.constructor.name])};return r.alter(e.ordInt)(o)(n)},h=function(n){return function(n){return function(t){return r.insert(e.ordInt)(t.value0.nodeId)(a.toList(u.foldableArray)(t.value0.nodeChilds))(n)}}},p=function(n){return function(n){return function(t){return function(o){return r.insert(e.ordInt)(t)(o)(n)}}}},w=function(n){return function(i){return function(c){return function(){var s=o.readSTRef(i.value0)(),f=r.lookup(e.ordInt)(c)(s.cacheContent);if(f instanceof t.Just)return o.writeSTRef(i.value0)(function(){var n={};for(var e in s)s.hasOwnProperty(e)&&(n[e]=s[e]);return n.cacheHits=m(c)(s.cacheHits),n}())(),a.toList(a.foldableList)(f.value0);if(f instanceof t.Nothing){var d=l.loadGet(n)(e.show(e.showInt)(c))(),v=p(n)(s.cacheContent)(c)(a.toList(u.foldableArray)(d.value0.children)),w=u.foldl(u.foldableArray)(h(n))(v)(d.value0.cacheIt);return o.writeSTRef(i.value0)(function(){var n={};for(var e in s)s.hasOwnProperty(e)&&(n[e]=s[e]);return n.cacheContent=w,n}())(),a.toList(u.foldableArray)(d.value0.children)}throw new Error("Failed pattern match at OntoPanel.FrontendCache line 40, column 5 - line 54, column 1: "+[f.constructor.name])}}}},g=function(n){return function(t){return function(r){if(r.value0.children instanceof i.Left)return new f.ConeNode(function(){var e={};for(var o in r.value0)r.value0.hasOwnProperty(o)&&(e[o]=r.value0[o]);return e.children=new i.Left(w(n)(t)),e}());if(r.value0.children instanceof i.Right)return new f.ConeNode(function(){var o={};for(var u in r.value0)r.value0.hasOwnProperty(u)&&(o[u]=r.value0[u]);return o.children=new i.Right(e.map(a.functorList)(g(n)(t))(r.value0.children.value0)),o}());throw new Error("Failed pattern match at OntoPanel.FrontendCache line 56, column 5 - line 60, column 1: "+[r.value0.children.constructor.name])}}},C=function(n){return function(e){return function(t){return d.makeZipper(n)(g(n)(e)(t.content))}}},S=function(n){return function(e){return function(t){if(t instanceof f.OSCurrent)return new f.OSCurrent(C(n)(e)(t.value0));if(t instanceof f.OSParent)return new f.OSParent(C(n)(e)(t.value0));throw new Error("Failed pattern match at OntoPanel.FrontendCache line 64, column 1 - line 65, column 1: "+[e.constructor.name,t.constructor.name])}}};n.setLoadFuncSel=S,n.setLoadFuncZipper=C,n.setLoadFuncNode=g,n.newCache=v,n.loadFunc=w}(PS["OntoPanel.FrontendCache"]=PS["OntoPanel.FrontendCache"]||{}),function(n){"use strict";var e=PS.Prelude,t=PS["Data.Maybe"],r=PS["Data.Foreign"],o=PS["Data.Foreign.Class"],a=PS["Data.Foreign.NullOrUndefined"],i=PS["Data.Either"],u=PS["Data.List"],c=PS["Debug.Trace"],l=(PS.ConeCanvas,PS["OntoPanel.OntoPanelTypes"],PS["OntoPanel.ServerConnection"]),s=PS["OntoPanel.FrontendCache"],f=PS["OntoPanel.Foreign"],d=PS["ConeCanvas.Color"],v=PS["ConeCanvas.ConeModel"],m=PS["Data.Foreign.Index"],h=PS["ConeCanvas.ConeZipper"],p=(PS["Control.Monad.Eff"],new e.Show(function(n){return'"'+(n.label+(" "+(e.show(t.showMaybe(e.showString))(n.condSTL)+'"')))})),w=new e.Eq(function(n){return function(e){return n.entryId===e.entryId}}),g={entryId:0,label:"",targetUri:t.Nothing.value,comment:t.Nothing.value,condIcon:t.Nothing.value,condSTL:t.Nothing.value,condColor:t.Just.create(d.color3fromArray([.5,.5,.5])),isLeaf:!0,isHidden:!0},C=new v.ConeNode({entry:g,nodeId:0,firstInd:0,children:new i.Right(u.Nil.value)}),S=new o.IsForeign(function(n){return e.bind(i.bindEither)(e["<$>"](i.functorEither)(a.runNullOrUndefined)(o.readProp(o.nullOrUndefinedIsForeign(o.intIsForeign))(m.indexString)("entryId")(n)))(function(r){return e.bind(i.bindEither)(o.readProp(o.stringIsForeign)(m.indexString)("label")(n))(function(u){return e.bind(i.bindEither)(e["<$>"](i.functorEither)(a.runNullOrUndefined)(o.readProp(o.nullOrUndefinedIsForeign(o.stringIsForeign))(m.indexString)("targetUri")(n)))(function(c){return e.bind(i.bindEither)(e["<$>"](i.functorEither)(a.runNullOrUndefined)(o.readProp(o.nullOrUndefinedIsForeign(o.stringIsForeign))(m.indexString)("comment")(n)))(function(l){return e.bind(i.bindEither)(e["<$>"](i.functorEither)(a.runNullOrUndefined)(o.readProp(o.nullOrUndefinedIsForeign(o.stringIsForeign))(m.indexString)("iconName")(n)))(function(s){return e.bind(i.bindEither)(e["<$>"](i.functorEither)(a.runNullOrUndefined)(o.readProp(o.nullOrUndefinedIsForeign(o.stringIsForeign))(m.indexString)("stlName")(n)))(function(f){return e.bind(i.bindEither)(e["<$>"](i.functorEither)(a.runNullOrUndefined)(o.readProp(o.nullOrUndefinedIsForeign(o.arrayIsForeign(o.numberIsForeign)))(m.indexString)("color")(n)))(function(a){return e.bind(i.bindEither)(o.readProp(o.booleanIsForeign)(m.indexString)("isLeaf")(n))(function(n){return e["return"](i.applicativeEither)({entryId:function(){if(r instanceof t.Nothing)return 0;if(r instanceof t.Just)return r.value0;throw new Error("Failed pattern match at OntoPanel.DynamicModel line 75, column 31 - line 78, column 13: "+[r.constructor.name])}(),label:u,targetUri:c,comment:l,condIcon:s,condSTL:f,condColor:e["<$>"](t.functorMaybe)(d.color3fromArray)(a),isLeaf:n,isHidden:!1})})})})})})})})})}),P=new v.ConeEntry(function(){return S},function(){return w},function(){return p},function(n){return[]},function(n){return n.condColor},function(n){return n.comment},function(n){return n.entryId},function(n){return n.isHidden},function(n){return n.condIcon},function(n){return n.isLeaf},function(n){return n.label},function(n){var e={};for(var t in n)n.hasOwnProperty(t)&&(e[t]=n[t]);return e.isHidden=!0,e.isLeaf=!0,e},function(n){var e={};for(var t in n)n.hasOwnProperty(t)&&(e[t]=n[t]);return e.isHidden=!0,e.isLeaf=!1,e},function(n){return[]},function(n){return t.Nothing.value},function(n){return n.condSTL},function(n){return n.targetUri}),y=function(n){return function(a){return function(u){return function(d){var v=t.maybe("")(function(n){return function(n){return"seed="+n}(e.show(e.showInt)(n))})(a),m=t.maybe("")(function(n){return function(n){return"ratio="+n}(e.show(e.showInt)(n))})(u),p=function(){if(""===v&&""===m)return"";if(""!==v&&""!==m)return"?"+(v+("&"+m));if(""===v)return"?"+m;if(e.otherwise)return"?"+v;throw new Error("Failed pattern match at OntoPanel.DynamicModel line 116, column 1 - line 140, column 28: "+[])}(),w=function(n){return function(a){var u=function(){if(""===a)return new i.Left(new r.JSONError("no server response"));if(e.otherwise)return o.readJSON(f.isForeignConeZipF(P))(a);throw new Error("Failed pattern match at OntoPanel.DynamicModel line 129, column 13 - line 132, column 13: "+[])}(),l=i.either(function(n){return c.trace("Parse Error: "+e.show(r.showForeignError)(n))(function(n){return new f.ConeZipF(h.makeZipper(P)(C),t.Nothing.value)})})(e.id(e.categoryFn))(u);return function(){var e=f.runConeZipF(P)(l)(),r=s.setLoadFuncZipper(P)(n)(e),o=h.coneDown(P)(r)();if(o instanceof t.Nothing)return d(r)();if(o instanceof t.Just)return d(o.value0)();throw new Error("Failed pattern match at OntoPanel.DynamicModel line 138, column 9 - line 140, column 28: "+[o.constructor.name])}}};return l.ajaxModel(w(n))(p)}}}};n.dynamicModel=y,n.emptyDynamicModel=C,n.emptyDynamicEntry=g,n.dynamicEntryIsForeign=S,n.dynamicConeEntry=P,n.eqDynamicEntry=w,n.showDynamicEntry=p}(PS["OntoPanel.DynamicModel"]=PS["OntoPanel.DynamicModel"]||{}),function(n){"use strict";n.imageDirect=function(n){return function(e){return function(t){return function(){var r=new Image;e&&(r.crossOrigin="anonymous"),r.onload=t(r),r.src=n,r.complete===!0&&(r.onload=null,t(r))}}}}}(PS["OntoPanel.IconLoading"]=PS["OntoPanel.IconLoading"]||{}),function(n){"use strict";var e=PS["OntoPanel.IconLoading"],t=PS.Prelude,r=(PS["Data.Maybe"],PS["Control.Monad.Eff.WebGL"],PS["Control.Monad.Eff"],PS["Data.String"]),o=(PS.DOM,PS["OntoPanel.ServerConnection"],PS["Graphics.Canvas"],function(n){return function(o){if(r.contains("http://")(n)||r.contains("https://")(n))return e.imageDirect(n)(!0)(o);if(t.otherwise)return e.imageDirect("/icons?name="+n)(!1)(o);throw new Error("Failed pattern match at OntoPanel.IconLoading line 30, column 1 - line 43, column 1: "+[n.constructor.name,o.constructor.name])}});n.imageAjax=o}(PS["OntoPanel.IconLoading"]=PS["OntoPanel.IconLoading"]||{}),function(n){"use strict";n.primHideCanvas=function(){globCanvasHide()},n.primExposeCanvas=function(){globCanvasExpose()},n.primSetURL=function(n){return function(){globSetURL(n)}}}(PS["OntoPanel.Presentation"]=PS["OntoPanel.Presentation"]||{}),function(n){"use strict";var e=PS["OntoPanel.Presentation"],t=PS.Prelude,r=PS["Control.Monad.Eff"],o=(PS.DOM,PS["Data.Maybe"]),a=(PS.ConeCanvas,PS["OntoPanel.ServerConnection"]),i=PS["OntoPanel.OntoPanelTypes"],u=PS["OntoPanel.FrontendCache"],c=PS["OntoPanel.Foreign"],l=PS["Debug.Trace"],s=PS["ConeCanvas.ConeModel"],f=function(n){return function(e){return function(t){return t instanceof s.AnimTransformLeft&&t.value0 instanceof o.Just?new s.AnimTransformLeft(new o.Just(u.setLoadFuncZipper(n)(e)(t.value0.value0))):t instanceof s.AnimTransformRight&&t.value0 instanceof o.Just?new s.AnimTransformRight(new o.Just(u.setLoadFuncZipper(n)(e)(t.value0.value0))):t instanceof s.AnimTransformIntro&&t.value2 instanceof o.Nothing?new s.AnimTransformIntro(t.value0,u.setLoadFuncZipper(n)(e)(t.value1),o.Nothing.value):t instanceof s.AnimTransformIntro&&t.value2 instanceof o.Just?new s.AnimTransformIntro(t.value0,u.setLoadFuncZipper(n)(e)(t.value1),new o.Just(u.setLoadFuncZipper(n)(e)(t.value2.value0))):t instanceof s.AnimTransformExtro&&t.value1 instanceof o.Just?new s.AnimTransformExtro(t.value0,new o.Just(u.setLoadFuncSel(n)(e)(t.value1.value0))):t instanceof s.AnimTransformDown&&t.value0 instanceof o.Just?new s.AnimTransformDown(new o.Just(u.setLoadFuncZipper(n)(e)(t.value0.value0))):t instanceof s.AnimTransformUp&&t.value0 instanceof o.Just?new s.AnimTransformUp(new o.Just(u.setLoadFuncZipper(n)(e)(t.value0.value0))):t instanceof s.AnimTransformShiftToZero&&t.value0 instanceof o.Just?new s.AnimTransformShiftToZero(new o.Just(u.setLoadFuncZipper(n)(e)(t.value0.value0))):t}}},d=function(n){return'"'+(n+'"')},v=function(n){return function(n){return function(r){return function(){return n.animate(r.value0.animations)(),r.value0.url instanceof o.Just&&""!==r.value0.url.value0?e.primSetURL(r.value0.url.value0)():t.unit}}}},m=function(n){return function(o){return function(u){return function(s){return s instanceof i.CPEExposeCanvas?function(){return a.presentationPost(n)(d(t.show(i.showConePresentation)(s)))(function(n){return t["return"](r.applicativeEff)(t.unit)})(),e.primExposeCanvas()}:s instanceof i.CPEHideCanvas?function(){return a.presentationPost(n)(d(t.show(i.showConePresentation)(s)))(function(n){return t["return"](r.applicativeEff)(t.unit)})(),e.primHideCanvas()}:a.presentationPost(n)(d(t.show(i.showConePresentation)(s)))(function(e){return function(){var r=c.runConePresentationFrameF(n)(e)();return l.trace("recieved frame")(function(e){var a=t.map(t.functorArray)(f(n)(u))(r.value0.animations);return v(n)(o)(new i.ConePresentationFrame({animations:a,url:r.value0.url}))})()}})}}}},h=function(n){return function(e){return function(o){return function(a){return function(u){return function(c){return function(l){return function(s){var f=s&&!l&&!c&&a;if(f)return 78===u?function(){return m(n)(e)(o)(i.CPENext.value)(),!0}:80===u?function(){return m(n)(e)(o)(i.CPEPrevious.value)(),!0}:83===u?function(){return m(n)(e)(o)(i.CPEStart.value)(),!0}:69===u?function(){return m(n)(e)(o)(i.CPEEnd.value)(),!0}:88===u?function(){return m(n)(e)(o)(i.CPEExposeCanvas.value)(),!0}:72===u?function(){return m(n)(e)(o)(i.CPEHideCanvas.value)(),!0}:t["return"](r.applicativeEff)(!1);if(!f)return t["return"](r.applicativeEff)(!1);throw new Error("Failed pattern match at OntoPanel.Presentation line 75, column 5 - line 99, column 1: "+[f.constructor.name])}}}}}}}};n.installPresentationCallback=h}(PS["OntoPanel.Presentation"]=PS["OntoPanel.Presentation"]||{}),function(n){"use strict";n.stlFromBase64=function(n){for(var e=window.atob(n),t=e.length,r=new Uint8Array(t),o=0;t>o;o++)r[o]=e.charCodeAt(o);return r.buffer},n.getSTLSize=function(n){var e=n.slice(80,84),t=new Uint32Array(e);return t[0]}}(PS["OntoPanel.STLLoading"]=PS["OntoPanel.STLLoading"]||{}),function(n){"use strict";var e=PS["OntoPanel.STLLoading"],t=PS.Prelude,r=PS["Data.Maybe"],o=PS["Control.Monad.Eff"],a=(PS.DOM,PS["Data.ArrayBuffer.Types"],PS["Debug.Trace"]),i=(PS["Control.Monad.Eff.WebGL"],PS["OntoPanel.ServerConnection"]),u=function(n){return function(u){var c=function(n){if(n instanceof i.CSRSTLBinary){var r=e.stlFromBase64(n.value1),c=e.getSTLSize(r);return u(c)(r)}return a.trace("stlEff: wrong answer: ")(function(n){return t["return"](o.applicativeEff)(t.unit)})};return i.ajaxGet(i.coneSrvResponseIsForeign)(new r.Just(c))(n)}},c=function(n){return u("/stl?name="+n)};n.stlAjax=c}(PS["OntoPanel.STLLoading"]=PS["OntoPanel.STLLoading"]||{}),function(n){"use strict";var e=PS.Prelude,t=PS["Control.Monad.ST"],r=PS["Data.String"],o=PS["Data.Maybe"],a=PS["Data.List"],i=(PS.ConeCanvas,PS["ConeCanvas.ConeFilter"]),u=(PS["OntoPanel.OntoPanelTypes"],PS["ConeCanvas.ConeModel"]),c=PS["Control.Monad.Eff"],l=PS["ConeCanvas.ConeZipper"],s=function(n){return function(s){return function(f){return function(d){var v=function(t){return function(r){var i=a.uncons(r);if(i instanceof o.Nothing)return e["return"](c.applicativeEff)(e.unit);if(i instanceof o.Just&&i.value0.tail instanceof a.Nil)return function(){return t.setModel(new u.OSCurrent(l.makeZipper(n)(i.value0.head)))(),e.unit};if(i instanceof o.Just)return function(){return t.setModel(new u.OSCurrent(l.makeZipper(n)(i.value0.head)))(),e.unit};throw new Error("Failed pattern match at OntoPanel.Search line 58, column 9 - line 67, column 24: "+[i.constructor.name])}};return function(){var a=t.readSTRef(f)(),c=s.getModel(),l=r.trim(d);if(a instanceof o.Nothing){var m=""===l;if(m)return e.unit;if(!m){if(c instanceof u.OSCurrent){t.writeSTRef(f)(new o.Just({lastSearch:l,originalModel:c.value0}))();var h=i.filterContainsString(n)(l)(c.value0.content)();return v(s)(h)()}if(c instanceof u.OSParent)return e.unit;throw new Error("Failed pattern match at OntoPanel.Search line 39, column 21 - line 45, column 9: "+[c.constructor.name])}throw new Error("Failed pattern match at OntoPanel.Search line 36, column 13 - line 45, column 9: "+[m.constructor.name])}if(a instanceof o.Just){var p=l===a.value0.lastSearch;if(p)return e.unit;if(!p){var w=""===l;if(w)return t.writeSTRef(f)(o.Nothing.value)(),s.setModel(new u.OSCurrent(a.value0.originalModel))();if(!w){t.writeSTRef(f)(new o.Just({lastSearch:l,originalModel:a.value0.originalModel}))();var h=i.filterContainsString(n)(l)(u.runConeZip(n)(a.value0.originalModel).content)();return v(s)(h)()}throw new Error("Failed pattern match at OntoPanel.Search line 48, column 22 - line 56, column 3: "+[w.constructor.name])}throw new Error("Failed pattern match at OntoPanel.Search line 46, column 13 - line 56, column 3: "+[p.constructor.name])}throw new Error("Failed pattern match at OntoPanel.Search line 34, column 5 - line 56, column 3: "+[a.constructor.name])}}}}};n.keyHandlerContains=s}(PS["OntoPanel.Search"]=PS["OntoPanel.Search"]||{}),function(n){"use strict";var e=PS.Main,t=(PS.ConeCanvas,PS["Data.List"]),r=PS["Data.Either"],o=PS["ConeCanvas.Frontend.FrontendWebGL"],a=PS["ConeCanvas.Preferences"],i=PS["Control.Monad"],u=PS["Control.Monad.Eff"],c=(PS["Control.Monad.Eff.Exception"],PS["Control.Monad.Eff.Random"],PS["Control.Monad.Eff.WebGL"],PS["Control.Monad.ST"]),l=(PS.DOM,PS["Data.Date"],PS["Data.Maybe"]),s=PS["Data.String"],f=PS["Debug.Trace"],d=PS.Extensions,v=(PS["Graphics.Canvas"],PS["OntoPanel.DynamicModel"]),m=PS["OntoPanel.FrontendCache"],h=PS["OntoPanel.IconLoading"],p=(PS["OntoPanel.OntoPanelTypes"],PS["OntoPanel.Presentation"]),w=PS["OntoPanel.STLLoading"],g=PS["OntoPanel.Search"],C=PS["OntoPanel.ServerConnection"],S=PS.Prelude,P=PS["ConeCanvas.ConeModel"],y=PS["ConeCanvas.ConeZipper"],T=PS["Data.Foreign"],b=PS["ConeCanvas.ConeControl"],E=function(n){return function(n){return f.trace("updateSearch request: "+n)(function(n){return S["return"](u.applicativeEff)(S.unit)})}},x=function(n){var t=y.selGetEntry(n);if(t.targetUri instanceof l.Just)return e.navigateToUrlInt(t.targetUri.value0);if(t.targetUri instanceof l.Nothing)return S["return"](u.applicativeEff)(S.unit);throw new Error("Failed pattern match at Main line 159, column 32 - line 163, column 1: "+[t.targetUri.constructor.name])},F=function(n){return function(e){return function(r){var o=function(n){return function(){return f.trace("navigateToCone response: "+S.show(t.showList(S.showInt))(n))(function(n){return S["return"](u.applicativeEff)(S.unit)})(),e.animate([new P.AnimClockwork(t.toList(t.foldableList)(n))])()}};return function(){var t=e.getModel(),a=P.targetUri(n)(y.selGetEntry(t));return a instanceof l.Just&&s.contains(a.value0)(r)?S.unit:f.trace("navigateToCone request: "+r)(function(n){return C.loadPath(r)(o)})()}}}},A=function(n){return function(){var t=(c.newSTRef(l.Nothing.value)(),e.getServerHash()),s=function(){return"#bench"===t}(),g=m.newCache();return C.loadIconNames(function(t){return C.loadSTLNames(function(c){return C.loadPrefs(function(m){return function(){f.traceA(u.applicativeEff)("loaded prefs: "+m)();var A=function(){var n=a.parsePrefs(m)(a.standardPrefs);if(n instanceof r.Left)return f.trace("PrefsError "+S.show(T.showForeignError)(n.value0))(function(n){return a.standardPrefs});if(n instanceof r.Right)return n.value0;throw new Error("Failed pattern match at Main line 90, column 29 - line 93, column 17: "+[n.constructor.name])}();return function(){if(s)return v.dynamicModel(g)(new l.Just(171))(l.Nothing.value);if(!s)return v.dynamicModel(g)(l.Nothing.value)(l.Nothing.value);throw new Error("Failed pattern match at Main line 93, column 18 - line 95, column 68: "+[s.constructor.name])}()(function(r){return function(){var a=y.countAllPositions(v.dynamicConeEntry)(r)();return f.traceA(u.applicativeEff)("got model with node size: "+S.show(S.showInt)(a))(),o.initGUI(A)("glcanvas")(d.alert)(d.alert)(function(a){return function(){var f=b.initConeCanvas(v.dynamicConeEntry)(y.selFromPos(r))(P.Browser.value)(new l.Just(A))(t)(c)(a)(o.myFrontend(v.dynamicConeEntry))();return f.loadIconCallback(h.imageAjax)(),f.loadSTLCallback(w.stlAjax)(),f.keyCallback(p.installPresentationCallback(v.dynamicConeEntry)(f)(g))(),i.when(u.monadEff)(!s)(f.selectedChanged(function(n){return function(){return x(n)(),e.handleSelectedPrim(v.dynamicConeEntry)(y.selGetEntry(n))(),C.sendSelected(y.selGetPath(n))()}}))(),f.alertCallback(d.alert)(),f.startup(f)(),f.animate([new P.AnimZoom(l.Nothing.value)])(),n({navigateToCone:F(v.dynamicConeEntry)(f),updateSearch:E(f)})()}})()}})()}})})})()}},N=function(n){return function(t){return function(r){return function(){var o=e.getSearchString("search")();return g.keyHandlerContains(n)(t)(r)(o)()}}}};n.updateSearchFull=E,n.navigateToConeFull=F,n.navigateToUrl=x,n.cycleHandler=N,n.main=A,n.getSearchString=e.getSearchString,n.getServerHash=e.getServerHash,n.handleSelectedPrim=e.handleSelectedPrim,n.navigateToUrlInt=e.navigateToUrlInt}(PS.Main=PS.Main||{});var gl,globDivCanvas,coneAPI,tutorial_counter=5;$(document).ready(function(){$("#democontent").blur(),$("#glcanvas").focus();var n=function(n){return function(){coneAPI=n}};PS.Main.main(n)()});var globCanvasHide=function(){globDivCanvas.is(":hidden")||globDivCanvas.slideUp()},globCanvasExpose=function(){globDivCanvas.is(":hidden")&&globDivCanvas.show("slow")};$(".subreddit_list li").click(function(){url="http://reddit.com/r/"+$(this).children("strong")[0].innerHTML});var globSelectedPrim=function(n){if("value0"in n.comment){var e=n.comment.value0,t=e[0];if("n"==t)show_subreddit(n.label);else{var r=new XMLHttpRequest;r.onreadystatechange=function(){if(4==r.readyState&&200==r.status){var e=r.responseText;"p"==t?show_post(n.targetUri.value0,n.label,e):"c"==t?show_comment(n.label,e):alert("Data error. Please reload page")}};var o="/content?id=".concat(e.slice(1));console.log("content request: GET "+o),r.open("GET",o,!0),r.timeout=2e3,r.ontimeout=function(){console.log("timeout getting content")},r.send()}}},globSetURL=function(n){console.log("globSetURL: "+n)};if("undefined"==typeof jQuery)throw new Error("Bootstrap's JavaScript requires jQuery");+function(n){"use strict";var e=n.fn.jquery.split(" ")[0].split(".");if(e[0]<2&&e[1]<9||1==e[0]&&9==e[1]&&e[2]<1||e[0]>2)throw new Error("Bootstrap's JavaScript requires jQuery version 1.9.1 or higher, but lower than version 3");
}(jQuery),+function(n){"use strict";function e(){var n=document.createElement("bootstrap"),e={WebkitTransition:"webkitTransitionEnd",MozTransition:"transitionend",OTransition:"oTransitionEnd otransitionend",transition:"transitionend"};for(var t in e)if(void 0!==n.style[t])return{end:e[t]};return!1}n.fn.emulateTransitionEnd=function(e){var t=!1,r=this;n(this).one("bsTransitionEnd",function(){t=!0});var o=function(){t||n(r).trigger(n.support.transition.end)};return setTimeout(o,e),this},n(function(){n.support.transition=e(),n.support.transition&&(n.event.special.bsTransitionEnd={bindType:n.support.transition.end,delegateType:n.support.transition.end,handle:function(e){return n(e.target).is(this)?e.handleObj.handler.apply(this,arguments):void 0}})})}(jQuery),+function(n){"use strict";function e(e){return this.each(function(){var t=n(this),o=t.data("bs.alert");o||t.data("bs.alert",o=new r(this)),"string"==typeof e&&o[e].call(t)})}var t='[data-dismiss="alert"]',r=function(e){n(e).on("click",t,this.close)};r.VERSION="3.3.6",r.TRANSITION_DURATION=150,r.prototype.close=function(e){function t(){i.detach().trigger("closed.bs.alert").remove()}var o=n(this),a=o.attr("data-target");a||(a=o.attr("href"),a=a&&a.replace(/.*(?=#[^\s]*$)/,""));var i=n(a);e&&e.preventDefault(),i.length||(i=o.closest(".alert")),i.trigger(e=n.Event("close.bs.alert")),e.isDefaultPrevented()||(i.removeClass("in"),n.support.transition&&i.hasClass("fade")?i.one("bsTransitionEnd",t).emulateTransitionEnd(r.TRANSITION_DURATION):t())};var o=n.fn.alert;n.fn.alert=e,n.fn.alert.Constructor=r,n.fn.alert.noConflict=function(){return n.fn.alert=o,this},n(document).on("click.bs.alert.data-api",t,r.prototype.close)}(jQuery),+function(n){"use strict";function e(e){return this.each(function(){var r=n(this),o=r.data("bs.button"),a="object"==typeof e&&e;o||r.data("bs.button",o=new t(this,a)),"toggle"==e?o.toggle():e&&o.setState(e)})}var t=function(e,r){this.$element=n(e),this.options=n.extend({},t.DEFAULTS,r),this.isLoading=!1};t.VERSION="3.3.6",t.DEFAULTS={loadingText:"loading..."},t.prototype.setState=function(e){var t="disabled",r=this.$element,o=r.is("input")?"val":"html",a=r.data();e+="Text",null==a.resetText&&r.data("resetText",r[o]()),setTimeout(n.proxy(function(){r[o](null==a[e]?this.options[e]:a[e]),"loadingText"==e?(this.isLoading=!0,r.addClass(t).attr(t,t)):this.isLoading&&(this.isLoading=!1,r.removeClass(t).removeAttr(t))},this),0)},t.prototype.toggle=function(){var n=!0,e=this.$element.closest('[data-toggle="buttons"]');if(e.length){var t=this.$element.find("input");"radio"==t.prop("type")?(t.prop("checked")&&(n=!1),e.find(".active").removeClass("active"),this.$element.addClass("active")):"checkbox"==t.prop("type")&&(t.prop("checked")!==this.$element.hasClass("active")&&(n=!1),this.$element.toggleClass("active")),t.prop("checked",this.$element.hasClass("active")),n&&t.trigger("change")}else this.$element.attr("aria-pressed",!this.$element.hasClass("active")),this.$element.toggleClass("active")};var r=n.fn.button;n.fn.button=e,n.fn.button.Constructor=t,n.fn.button.noConflict=function(){return n.fn.button=r,this},n(document).on("click.bs.button.data-api",'[data-toggle^="button"]',function(t){var r=n(t.target);r.hasClass("btn")||(r=r.closest(".btn")),e.call(r,"toggle"),n(t.target).is('input[type="radio"]')||n(t.target).is('input[type="checkbox"]')||t.preventDefault()}).on("focus.bs.button.data-api blur.bs.button.data-api",'[data-toggle^="button"]',function(e){n(e.target).closest(".btn").toggleClass("focus",/^focus(in)?$/.test(e.type))})}(jQuery),+function(n){"use strict";function e(e){return this.each(function(){var r=n(this),o=r.data("bs.carousel"),a=n.extend({},t.DEFAULTS,r.data(),"object"==typeof e&&e),i="string"==typeof e?e:a.slide;o||r.data("bs.carousel",o=new t(this,a)),"number"==typeof e?o.to(e):i?o[i]():a.interval&&o.pause().cycle()})}var t=function(e,t){this.$element=n(e),this.$indicators=this.$element.find(".carousel-indicators"),this.options=t,this.paused=null,this.sliding=null,this.interval=null,this.$active=null,this.$items=null,this.options.keyboard&&this.$element.on("keydown.bs.carousel",n.proxy(this.keydown,this)),"hover"==this.options.pause&&!("ontouchstart"in document.documentElement)&&this.$element.on("mouseenter.bs.carousel",n.proxy(this.pause,this)).on("mouseleave.bs.carousel",n.proxy(this.cycle,this))};t.VERSION="3.3.6",t.TRANSITION_DURATION=600,t.DEFAULTS={interval:5e3,pause:"hover",wrap:!0,keyboard:!0},t.prototype.keydown=function(n){if(!/input|textarea/i.test(n.target.tagName)){switch(n.which){case 37:this.prev();break;case 39:this.next();break;default:return}n.preventDefault()}},t.prototype.cycle=function(e){return e||(this.paused=!1),this.interval&&clearInterval(this.interval),this.options.interval&&!this.paused&&(this.interval=setInterval(n.proxy(this.next,this),this.options.interval)),this},t.prototype.getItemIndex=function(n){return this.$items=n.parent().children(".item"),this.$items.index(n||this.$active)},t.prototype.getItemForDirection=function(n,e){var t=this.getItemIndex(e),r="prev"==n&&0===t||"next"==n&&t==this.$items.length-1;if(r&&!this.options.wrap)return e;var o="prev"==n?-1:1,a=(t+o)%this.$items.length;return this.$items.eq(a)},t.prototype.to=function(n){var e=this,t=this.getItemIndex(this.$active=this.$element.find(".item.active"));return n>this.$items.length-1||0>n?void 0:this.sliding?this.$element.one("slid.bs.carousel",function(){e.to(n)}):t==n?this.pause().cycle():this.slide(n>t?"next":"prev",this.$items.eq(n))},t.prototype.pause=function(e){return e||(this.paused=!0),this.$element.find(".next, .prev").length&&n.support.transition&&(this.$element.trigger(n.support.transition.end),this.cycle(!0)),this.interval=clearInterval(this.interval),this},t.prototype.next=function(){return this.sliding?void 0:this.slide("next")},t.prototype.prev=function(){return this.sliding?void 0:this.slide("prev")},t.prototype.slide=function(e,r){var o=this.$element.find(".item.active"),a=r||this.getItemForDirection(e,o),i=this.interval,u="next"==e?"left":"right",c=this;if(a.hasClass("active"))return this.sliding=!1;var l=a[0],s=n.Event("slide.bs.carousel",{relatedTarget:l,direction:u});if(this.$element.trigger(s),!s.isDefaultPrevented()){if(this.sliding=!0,i&&this.pause(),this.$indicators.length){this.$indicators.find(".active").removeClass("active");var f=n(this.$indicators.children()[this.getItemIndex(a)]);f&&f.addClass("active")}var d=n.Event("slid.bs.carousel",{relatedTarget:l,direction:u});return n.support.transition&&this.$element.hasClass("slide")?(a.addClass(e),a[0].offsetWidth,o.addClass(u),a.addClass(u),o.one("bsTransitionEnd",function(){a.removeClass([e,u].join(" ")).addClass("active"),o.removeClass(["active",u].join(" ")),c.sliding=!1,setTimeout(function(){c.$element.trigger(d)},0)}).emulateTransitionEnd(t.TRANSITION_DURATION)):(o.removeClass("active"),a.addClass("active"),this.sliding=!1,this.$element.trigger(d)),i&&this.cycle(),this}};var r=n.fn.carousel;n.fn.carousel=e,n.fn.carousel.Constructor=t,n.fn.carousel.noConflict=function(){return n.fn.carousel=r,this};var o=function(t){var r,o=n(this),a=n(o.attr("data-target")||(r=o.attr("href"))&&r.replace(/.*(?=#[^\s]+$)/,""));if(a.hasClass("carousel")){var i=n.extend({},a.data(),o.data()),u=o.attr("data-slide-to");u&&(i.interval=!1),e.call(a,i),u&&a.data("bs.carousel").to(u),t.preventDefault()}};n(document).on("click.bs.carousel.data-api","[data-slide]",o).on("click.bs.carousel.data-api","[data-slide-to]",o),n(window).on("load",function(){n('[data-ride="carousel"]').each(function(){var t=n(this);e.call(t,t.data())})})}(jQuery),+function(n){"use strict";function e(e){var t,r=e.attr("data-target")||(t=e.attr("href"))&&t.replace(/.*(?=#[^\s]+$)/,"");return n(r)}function t(e){return this.each(function(){var t=n(this),o=t.data("bs.collapse"),a=n.extend({},r.DEFAULTS,t.data(),"object"==typeof e&&e);!o&&a.toggle&&/show|hide/.test(e)&&(a.toggle=!1),o||t.data("bs.collapse",o=new r(this,a)),"string"==typeof e&&o[e]()})}var r=function(e,t){this.$element=n(e),this.options=n.extend({},r.DEFAULTS,t),this.$trigger=n('[data-toggle="collapse"][href="#'+e.id+'"],[data-toggle="collapse"][data-target="#'+e.id+'"]'),this.transitioning=null,this.options.parent?this.$parent=this.getParent():this.addAriaAndCollapsedClass(this.$element,this.$trigger),this.options.toggle&&this.toggle()};r.VERSION="3.3.6",r.TRANSITION_DURATION=350,r.DEFAULTS={toggle:!0},r.prototype.dimension=function(){var n=this.$element.hasClass("width");return n?"width":"height"},r.prototype.show=function(){if(!this.transitioning&&!this.$element.hasClass("in")){var e,o=this.$parent&&this.$parent.children(".panel").children(".in, .collapsing");if(!(o&&o.length&&(e=o.data("bs.collapse"),e&&e.transitioning))){var a=n.Event("show.bs.collapse");if(this.$element.trigger(a),!a.isDefaultPrevented()){o&&o.length&&(t.call(o,"hide"),e||o.data("bs.collapse",null));var i=this.dimension();this.$element.removeClass("collapse").addClass("collapsing")[i](0).attr("aria-expanded",!0),this.$trigger.removeClass("collapsed").attr("aria-expanded",!0),this.transitioning=1;var u=function(){this.$element.removeClass("collapsing").addClass("collapse in")[i](""),this.transitioning=0,this.$element.trigger("shown.bs.collapse")};if(!n.support.transition)return u.call(this);var c=n.camelCase(["scroll",i].join("-"));this.$element.one("bsTransitionEnd",n.proxy(u,this)).emulateTransitionEnd(r.TRANSITION_DURATION)[i](this.$element[0][c])}}}},r.prototype.hide=function(){if(!this.transitioning&&this.$element.hasClass("in")){var e=n.Event("hide.bs.collapse");if(this.$element.trigger(e),!e.isDefaultPrevented()){var t=this.dimension();this.$element[t](this.$element[t]())[0].offsetHeight,this.$element.addClass("collapsing").removeClass("collapse in").attr("aria-expanded",!1),this.$trigger.addClass("collapsed").attr("aria-expanded",!1),this.transitioning=1;var o=function(){this.transitioning=0,this.$element.removeClass("collapsing").addClass("collapse").trigger("hidden.bs.collapse")};return n.support.transition?void this.$element[t](0).one("bsTransitionEnd",n.proxy(o,this)).emulateTransitionEnd(r.TRANSITION_DURATION):o.call(this)}}},r.prototype.toggle=function(){this[this.$element.hasClass("in")?"hide":"show"]()},r.prototype.getParent=function(){return n(this.options.parent).find('[data-toggle="collapse"][data-parent="'+this.options.parent+'"]').each(n.proxy(function(t,r){var o=n(r);this.addAriaAndCollapsedClass(e(o),o)},this)).end()},r.prototype.addAriaAndCollapsedClass=function(n,e){var t=n.hasClass("in");n.attr("aria-expanded",t),e.toggleClass("collapsed",!t).attr("aria-expanded",t)};var o=n.fn.collapse;n.fn.collapse=t,n.fn.collapse.Constructor=r,n.fn.collapse.noConflict=function(){return n.fn.collapse=o,this},n(document).on("click.bs.collapse.data-api",'[data-toggle="collapse"]',function(r){var o=n(this);o.attr("data-target")||r.preventDefault();var a=e(o),i=a.data("bs.collapse"),u=i?"toggle":o.data();t.call(a,u)})}(jQuery),+function(n){"use strict";function e(e){var t=e.attr("data-target");t||(t=e.attr("href"),t=t&&/#[A-Za-z]/.test(t)&&t.replace(/.*(?=#[^\s]*$)/,""));var r=t&&n(t);return r&&r.length?r:e.parent()}function t(t){t&&3===t.which||(n(o).remove(),n(a).each(function(){var r=n(this),o=e(r),a={relatedTarget:this};o.hasClass("open")&&(t&&"click"==t.type&&/input|textarea/i.test(t.target.tagName)&&n.contains(o[0],t.target)||(o.trigger(t=n.Event("hide.bs.dropdown",a)),t.isDefaultPrevented()||(r.attr("aria-expanded","false"),o.removeClass("open").trigger(n.Event("hidden.bs.dropdown",a)))))}))}function r(e){return this.each(function(){var t=n(this),r=t.data("bs.dropdown");r||t.data("bs.dropdown",r=new i(this)),"string"==typeof e&&r[e].call(t)})}var o=".dropdown-backdrop",a='[data-toggle="dropdown"]',i=function(e){n(e).on("click.bs.dropdown",this.toggle)};i.VERSION="3.3.6",i.prototype.toggle=function(r){var o=n(this);if(!o.is(".disabled, :disabled")){var a=e(o),i=a.hasClass("open");if(t(),!i){"ontouchstart"in document.documentElement&&!a.closest(".navbar-nav").length&&n(document.createElement("div")).addClass("dropdown-backdrop").insertAfter(n(this)).on("click",t);var u={relatedTarget:this};if(a.trigger(r=n.Event("show.bs.dropdown",u)),r.isDefaultPrevented())return;o.trigger("focus").attr("aria-expanded","true"),a.toggleClass("open").trigger(n.Event("shown.bs.dropdown",u))}return!1}},i.prototype.keydown=function(t){if(/(38|40|27|32)/.test(t.which)&&!/input|textarea/i.test(t.target.tagName)){var r=n(this);if(t.preventDefault(),t.stopPropagation(),!r.is(".disabled, :disabled")){var o=e(r),i=o.hasClass("open");if(!i&&27!=t.which||i&&27==t.which)return 27==t.which&&o.find(a).trigger("focus"),r.trigger("click");var u=" li:not(.disabled):visible a",c=o.find(".dropdown-menu"+u);if(c.length){var l=c.index(t.target);38==t.which&&l>0&&l--,40==t.which&&l<c.length-1&&l++,~l||(l=0),c.eq(l).trigger("focus")}}}};var u=n.fn.dropdown;n.fn.dropdown=r,n.fn.dropdown.Constructor=i,n.fn.dropdown.noConflict=function(){return n.fn.dropdown=u,this},n(document).on("click.bs.dropdown.data-api",t).on("click.bs.dropdown.data-api",".dropdown form",function(n){n.stopPropagation()}).on("click.bs.dropdown.data-api",a,i.prototype.toggle).on("keydown.bs.dropdown.data-api",a,i.prototype.keydown).on("keydown.bs.dropdown.data-api",".dropdown-menu",i.prototype.keydown)}(jQuery),+function(n){"use strict";function e(e,r){return this.each(function(){var o=n(this),a=o.data("bs.modal"),i=n.extend({},t.DEFAULTS,o.data(),"object"==typeof e&&e);a||o.data("bs.modal",a=new t(this,i)),"string"==typeof e?a[e](r):i.show&&a.show(r)})}var t=function(e,t){this.options=t,this.$body=n(document.body),this.$element=n(e),this.$dialog=this.$element.find(".modal-dialog"),this.$backdrop=null,this.isShown=null,this.originalBodyPad=null,this.scrollbarWidth=0,this.ignoreBackdropClick=!1,this.options.remote&&this.$element.find(".modal-content").load(this.options.remote,n.proxy(function(){this.$element.trigger("loaded.bs.modal")},this))};t.VERSION="3.3.6",t.TRANSITION_DURATION=300,t.BACKDROP_TRANSITION_DURATION=150,t.DEFAULTS={backdrop:!0,keyboard:!0,show:!0},t.prototype.toggle=function(n){return this.isShown?this.hide():this.show(n)},t.prototype.show=function(e){var r=this,o=n.Event("show.bs.modal",{relatedTarget:e});this.$element.trigger(o),this.isShown||o.isDefaultPrevented()||(this.isShown=!0,this.checkScrollbar(),this.setScrollbar(),this.$body.addClass("modal-open"),this.escape(),this.resize(),this.$element.on("click.dismiss.bs.modal",'[data-dismiss="modal"]',n.proxy(this.hide,this)),this.$dialog.on("mousedown.dismiss.bs.modal",function(){r.$element.one("mouseup.dismiss.bs.modal",function(e){n(e.target).is(r.$element)&&(r.ignoreBackdropClick=!0)})}),this.backdrop(function(){var o=n.support.transition&&r.$element.hasClass("fade");r.$element.parent().length||r.$element.appendTo(r.$body),r.$element.show().scrollTop(0),r.adjustDialog(),o&&r.$element[0].offsetWidth,r.$element.addClass("in"),r.enforceFocus();var a=n.Event("shown.bs.modal",{relatedTarget:e});o?r.$dialog.one("bsTransitionEnd",function(){r.$element.trigger("focus").trigger(a)}).emulateTransitionEnd(t.TRANSITION_DURATION):r.$element.trigger("focus").trigger(a)}))},t.prototype.hide=function(e){e&&e.preventDefault(),e=n.Event("hide.bs.modal"),this.$element.trigger(e),this.isShown&&!e.isDefaultPrevented()&&(this.isShown=!1,this.escape(),this.resize(),n(document).off("focusin.bs.modal"),this.$element.removeClass("in").off("click.dismiss.bs.modal").off("mouseup.dismiss.bs.modal"),this.$dialog.off("mousedown.dismiss.bs.modal"),n.support.transition&&this.$element.hasClass("fade")?this.$element.one("bsTransitionEnd",n.proxy(this.hideModal,this)).emulateTransitionEnd(t.TRANSITION_DURATION):this.hideModal())},t.prototype.enforceFocus=function(){n(document).off("focusin.bs.modal").on("focusin.bs.modal",n.proxy(function(n){this.$element[0]===n.target||this.$element.has(n.target).length||this.$element.trigger("focus")},this))},t.prototype.escape=function(){this.isShown&&this.options.keyboard?this.$element.on("keydown.dismiss.bs.modal",n.proxy(function(n){27==n.which&&this.hide()},this)):this.isShown||this.$element.off("keydown.dismiss.bs.modal")},t.prototype.resize=function(){this.isShown?n(window).on("resize.bs.modal",n.proxy(this.handleUpdate,this)):n(window).off("resize.bs.modal")},t.prototype.hideModal=function(){var n=this;this.$element.hide(),this.backdrop(function(){n.$body.removeClass("modal-open"),n.resetAdjustments(),n.resetScrollbar(),n.$element.trigger("hidden.bs.modal")})},t.prototype.removeBackdrop=function(){this.$backdrop&&this.$backdrop.remove(),this.$backdrop=null},t.prototype.backdrop=function(e){var r=this,o=this.$element.hasClass("fade")?"fade":"";if(this.isShown&&this.options.backdrop){var a=n.support.transition&&o;if(this.$backdrop=n(document.createElement("div")).addClass("modal-backdrop "+o).appendTo(this.$body),this.$element.on("click.dismiss.bs.modal",n.proxy(function(n){return this.ignoreBackdropClick?void(this.ignoreBackdropClick=!1):void(n.target===n.currentTarget&&("static"==this.options.backdrop?this.$element[0].focus():this.hide()))},this)),a&&this.$backdrop[0].offsetWidth,this.$backdrop.addClass("in"),!e)return;a?this.$backdrop.one("bsTransitionEnd",e).emulateTransitionEnd(t.BACKDROP_TRANSITION_DURATION):e()}else if(!this.isShown&&this.$backdrop){this.$backdrop.removeClass("in");var i=function(){r.removeBackdrop(),e&&e()};n.support.transition&&this.$element.hasClass("fade")?this.$backdrop.one("bsTransitionEnd",i).emulateTransitionEnd(t.BACKDROP_TRANSITION_DURATION):i()}else e&&e()},t.prototype.handleUpdate=function(){this.adjustDialog()},t.prototype.adjustDialog=function(){var n=this.$element[0].scrollHeight>document.documentElement.clientHeight;this.$element.css({paddingLeft:!this.bodyIsOverflowing&&n?this.scrollbarWidth:"",paddingRight:this.bodyIsOverflowing&&!n?this.scrollbarWidth:""})},t.prototype.resetAdjustments=function(){this.$element.css({paddingLeft:"",paddingRight:""})},t.prototype.checkScrollbar=function(){var n=window.innerWidth;if(!n){var e=document.documentElement.getBoundingClientRect();n=e.right-Math.abs(e.left)}this.bodyIsOverflowing=document.body.clientWidth<n,this.scrollbarWidth=this.measureScrollbar()},t.prototype.setScrollbar=function(){var n=parseInt(this.$body.css("padding-right")||0,10);this.originalBodyPad=document.body.style.paddingRight||"",this.bodyIsOverflowing&&this.$body.css("padding-right",n+this.scrollbarWidth)},t.prototype.resetScrollbar=function(){this.$body.css("padding-right",this.originalBodyPad)},t.prototype.measureScrollbar=function(){var n=document.createElement("div");n.className="modal-scrollbar-measure",this.$body.append(n);var e=n.offsetWidth-n.clientWidth;return this.$body[0].removeChild(n),e};var r=n.fn.modal;n.fn.modal=e,n.fn.modal.Constructor=t,n.fn.modal.noConflict=function(){return n.fn.modal=r,this},n(document).on("click.bs.modal.data-api",'[data-toggle="modal"]',function(t){var r=n(this),o=r.attr("href"),a=n(r.attr("data-target")||o&&o.replace(/.*(?=#[^\s]+$)/,"")),i=a.data("bs.modal")?"toggle":n.extend({remote:!/#/.test(o)&&o},a.data(),r.data());r.is("a")&&t.preventDefault(),a.one("show.bs.modal",function(n){n.isDefaultPrevented()||a.one("hidden.bs.modal",function(){r.is(":visible")&&r.trigger("focus")})}),e.call(a,i,this)})}(jQuery),+function(n){"use strict";function e(e){return this.each(function(){var r=n(this),o=r.data("bs.tooltip"),a="object"==typeof e&&e;!o&&/destroy|hide/.test(e)||(o||r.data("bs.tooltip",o=new t(this,a)),"string"==typeof e&&o[e]())})}var t=function(n,e){this.type=null,this.options=null,this.enabled=null,this.timeout=null,this.hoverState=null,this.$element=null,this.inState=null,this.init("tooltip",n,e)};t.VERSION="3.3.6",t.TRANSITION_DURATION=150,t.DEFAULTS={animation:!0,placement:"top",selector:!1,template:'<div class="tooltip" role="tooltip"><div class="tooltip-arrow"></div><div class="tooltip-inner"></div></div>',trigger:"hover focus",title:"",delay:0,html:!1,container:!1,viewport:{selector:"body",padding:0}},t.prototype.init=function(e,t,r){if(this.enabled=!0,this.type=e,this.$element=n(t),this.options=this.getOptions(r),this.$viewport=this.options.viewport&&n(n.isFunction(this.options.viewport)?this.options.viewport.call(this,this.$element):this.options.viewport.selector||this.options.viewport),this.inState={click:!1,hover:!1,focus:!1},this.$element[0]instanceof document.constructor&&!this.options.selector)throw new Error("`selector` option must be specified when initializing "+this.type+" on the window.document object!");for(var o=this.options.trigger.split(" "),a=o.length;a--;){var i=o[a];if("click"==i)this.$element.on("click."+this.type,this.options.selector,n.proxy(this.toggle,this));else if("manual"!=i){var u="hover"==i?"mouseenter":"focusin",c="hover"==i?"mouseleave":"focusout";this.$element.on(u+"."+this.type,this.options.selector,n.proxy(this.enter,this)),this.$element.on(c+"."+this.type,this.options.selector,n.proxy(this.leave,this))}}this.options.selector?this._options=n.extend({},this.options,{trigger:"manual",selector:""}):this.fixTitle()},t.prototype.getDefaults=function(){return t.DEFAULTS},t.prototype.getOptions=function(e){return e=n.extend({},this.getDefaults(),this.$element.data(),e),e.delay&&"number"==typeof e.delay&&(e.delay={show:e.delay,hide:e.delay}),e},t.prototype.getDelegateOptions=function(){var e={},t=this.getDefaults();return this._options&&n.each(this._options,function(n,r){t[n]!=r&&(e[n]=r)}),e},t.prototype.enter=function(e){var t=e instanceof this.constructor?e:n(e.currentTarget).data("bs."+this.type);return t||(t=new this.constructor(e.currentTarget,this.getDelegateOptions()),n(e.currentTarget).data("bs."+this.type,t)),e instanceof n.Event&&(t.inState["focusin"==e.type?"focus":"hover"]=!0),t.tip().hasClass("in")||"in"==t.hoverState?void(t.hoverState="in"):(clearTimeout(t.timeout),t.hoverState="in",t.options.delay&&t.options.delay.show?void(t.timeout=setTimeout(function(){"in"==t.hoverState&&t.show()},t.options.delay.show)):t.show())},t.prototype.isInStateTrue=function(){for(var n in this.inState)if(this.inState[n])return!0;return!1},t.prototype.leave=function(e){var t=e instanceof this.constructor?e:n(e.currentTarget).data("bs."+this.type);return t||(t=new this.constructor(e.currentTarget,this.getDelegateOptions()),n(e.currentTarget).data("bs."+this.type,t)),e instanceof n.Event&&(t.inState["focusout"==e.type?"focus":"hover"]=!1),t.isInStateTrue()?void 0:(clearTimeout(t.timeout),t.hoverState="out",t.options.delay&&t.options.delay.hide?void(t.timeout=setTimeout(function(){"out"==t.hoverState&&t.hide()},t.options.delay.hide)):t.hide())},t.prototype.show=function(){var e=n.Event("show.bs."+this.type);if(this.hasContent()&&this.enabled){this.$element.trigger(e);var r=n.contains(this.$element[0].ownerDocument.documentElement,this.$element[0]);if(e.isDefaultPrevented()||!r)return;var o=this,a=this.tip(),i=this.getUID(this.type);this.setContent(),a.attr("id",i),this.$element.attr("aria-describedby",i),this.options.animation&&a.addClass("fade");var u="function"==typeof this.options.placement?this.options.placement.call(this,a[0],this.$element[0]):this.options.placement,c=/\s?auto?\s?/i,l=c.test(u);l&&(u=u.replace(c,"")||"top"),a.detach().css({top:0,left:0,display:"block"}).addClass(u).data("bs."+this.type,this),this.options.container?a.appendTo(this.options.container):a.insertAfter(this.$element),this.$element.trigger("inserted.bs."+this.type);var s=this.getPosition(),f=a[0].offsetWidth,d=a[0].offsetHeight;if(l){var v=u,m=this.getPosition(this.$viewport);u="bottom"==u&&s.bottom+d>m.bottom?"top":"top"==u&&s.top-d<m.top?"bottom":"right"==u&&s.right+f>m.width?"left":"left"==u&&s.left-f<m.left?"right":u,a.removeClass(v).addClass(u)}var h=this.getCalculatedOffset(u,s,f,d);this.applyPlacement(h,u);var p=function(){var n=o.hoverState;o.$element.trigger("shown.bs."+o.type),o.hoverState=null,"out"==n&&o.leave(o)};n.support.transition&&this.$tip.hasClass("fade")?a.one("bsTransitionEnd",p).emulateTransitionEnd(t.TRANSITION_DURATION):p()}},t.prototype.applyPlacement=function(e,t){var r=this.tip(),o=r[0].offsetWidth,a=r[0].offsetHeight,i=parseInt(r.css("margin-top"),10),u=parseInt(r.css("margin-left"),10);isNaN(i)&&(i=0),isNaN(u)&&(u=0),e.top+=i,e.left+=u,n.offset.setOffset(r[0],n.extend({using:function(n){r.css({top:Math.round(n.top),left:Math.round(n.left)})}},e),0),r.addClass("in");var c=r[0].offsetWidth,l=r[0].offsetHeight;"top"==t&&l!=a&&(e.top=e.top+a-l);var s=this.getViewportAdjustedDelta(t,e,c,l);s.left?e.left+=s.left:e.top+=s.top;var f=/top|bottom/.test(t),d=f?2*s.left-o+c:2*s.top-a+l,v=f?"offsetWidth":"offsetHeight";r.offset(e),this.replaceArrow(d,r[0][v],f)},t.prototype.replaceArrow=function(n,e,t){this.arrow().css(t?"left":"top",50*(1-n/e)+"%").css(t?"top":"left","")},t.prototype.setContent=function(){var n=this.tip(),e=this.getTitle();n.find(".tooltip-inner")[this.options.html?"html":"text"](e),n.removeClass("fade in top bottom left right")},t.prototype.hide=function(e){function r(){"in"!=o.hoverState&&a.detach(),o.$element.removeAttr("aria-describedby").trigger("hidden.bs."+o.type),e&&e()}var o=this,a=n(this.$tip),i=n.Event("hide.bs."+this.type);return this.$element.trigger(i),i.isDefaultPrevented()?void 0:(a.removeClass("in"),n.support.transition&&a.hasClass("fade")?a.one("bsTransitionEnd",r).emulateTransitionEnd(t.TRANSITION_DURATION):r(),this.hoverState=null,this)},t.prototype.fixTitle=function(){var n=this.$element;(n.attr("title")||"string"!=typeof n.attr("data-original-title"))&&n.attr("data-original-title",n.attr("title")||"").attr("title","")},t.prototype.hasContent=function(){return this.getTitle()},t.prototype.getPosition=function(e){e=e||this.$element;var t=e[0],r="BODY"==t.tagName,o=t.getBoundingClientRect();null==o.width&&(o=n.extend({},o,{width:o.right-o.left,height:o.bottom-o.top}));var a=r?{top:0,left:0}:e.offset(),i={scroll:r?document.documentElement.scrollTop||document.body.scrollTop:e.scrollTop()},u=r?{width:n(window).width(),height:n(window).height()}:null;return n.extend({},o,i,u,a)},t.prototype.getCalculatedOffset=function(n,e,t,r){return"bottom"==n?{top:e.top+e.height,left:e.left+e.width/2-t/2}:"top"==n?{top:e.top-r,left:e.left+e.width/2-t/2}:"left"==n?{top:e.top+e.height/2-r/2,left:e.left-t}:{top:e.top+e.height/2-r/2,left:e.left+e.width}},t.prototype.getViewportAdjustedDelta=function(n,e,t,r){var o={top:0,left:0};if(!this.$viewport)return o;var a=this.options.viewport&&this.options.viewport.padding||0,i=this.getPosition(this.$viewport);if(/right|left/.test(n)){var u=e.top-a-i.scroll,c=e.top+a-i.scroll+r;u<i.top?o.top=i.top-u:c>i.top+i.height&&(o.top=i.top+i.height-c)}else{var l=e.left-a,s=e.left+a+t;l<i.left?o.left=i.left-l:s>i.right&&(o.left=i.left+i.width-s)}return o},t.prototype.getTitle=function(){var n,e=this.$element,t=this.options;return n=e.attr("data-original-title")||("function"==typeof t.title?t.title.call(e[0]):t.title)},t.prototype.getUID=function(n){do n+=~~(1e6*Math.random());while(document.getElementById(n));return n},t.prototype.tip=function(){if(!this.$tip&&(this.$tip=n(this.options.template),1!=this.$tip.length))throw new Error(this.type+" `template` option must consist of exactly 1 top-level element!");return this.$tip},t.prototype.arrow=function(){return this.$arrow=this.$arrow||this.tip().find(".tooltip-arrow")},t.prototype.enable=function(){this.enabled=!0},t.prototype.disable=function(){this.enabled=!1},t.prototype.toggleEnabled=function(){this.enabled=!this.enabled},t.prototype.toggle=function(e){var t=this;e&&(t=n(e.currentTarget).data("bs."+this.type),t||(t=new this.constructor(e.currentTarget,this.getDelegateOptions()),n(e.currentTarget).data("bs."+this.type,t))),e?(t.inState.click=!t.inState.click,t.isInStateTrue()?t.enter(t):t.leave(t)):t.tip().hasClass("in")?t.leave(t):t.enter(t)},t.prototype.destroy=function(){var n=this;clearTimeout(this.timeout),this.hide(function(){n.$element.off("."+n.type).removeData("bs."+n.type),n.$tip&&n.$tip.detach(),n.$tip=null,n.$arrow=null,n.$viewport=null})};var r=n.fn.tooltip;n.fn.tooltip=e,n.fn.tooltip.Constructor=t,n.fn.tooltip.noConflict=function(){return n.fn.tooltip=r,this}}(jQuery),+function(n){"use strict";function e(e){return this.each(function(){var r=n(this),o=r.data("bs.popover"),a="object"==typeof e&&e;!o&&/destroy|hide/.test(e)||(o||r.data("bs.popover",o=new t(this,a)),"string"==typeof e&&o[e]())})}var t=function(n,e){this.init("popover",n,e)};if(!n.fn.tooltip)throw new Error("Popover requires tooltip.js");t.VERSION="3.3.6",t.DEFAULTS=n.extend({},n.fn.tooltip.Constructor.DEFAULTS,{placement:"right",trigger:"click",content:"",template:'<div class="popover" role="tooltip"><div class="arrow"></div><h3 class="popover-title"></h3><div class="popover-content"></div></div>'}),t.prototype=n.extend({},n.fn.tooltip.Constructor.prototype),t.prototype.constructor=t,t.prototype.getDefaults=function(){return t.DEFAULTS},t.prototype.setContent=function(){var n=this.tip(),e=this.getTitle(),t=this.getContent();n.find(".popover-title")[this.options.html?"html":"text"](e),n.find(".popover-content").children().detach().end()[this.options.html?"string"==typeof t?"html":"append":"text"](t),n.removeClass("fade top bottom left right in"),n.find(".popover-title").html()||n.find(".popover-title").hide()},t.prototype.hasContent=function(){return this.getTitle()||this.getContent()},t.prototype.getContent=function(){var n=this.$element,e=this.options;return n.attr("data-content")||("function"==typeof e.content?e.content.call(n[0]):e.content)},t.prototype.arrow=function(){return this.$arrow=this.$arrow||this.tip().find(".arrow")};var r=n.fn.popover;n.fn.popover=e,n.fn.popover.Constructor=t,n.fn.popover.noConflict=function(){return n.fn.popover=r,this}}(jQuery),+function(n){"use strict";function e(t,r){this.$body=n(document.body),this.$scrollElement=n(n(t).is(document.body)?window:t),this.options=n.extend({},e.DEFAULTS,r),this.selector=(this.options.target||"")+" .nav li > a",this.offsets=[],this.targets=[],this.activeTarget=null,this.scrollHeight=0,this.$scrollElement.on("scroll.bs.scrollspy",n.proxy(this.process,this)),this.refresh(),this.process()}function t(t){return this.each(function(){var r=n(this),o=r.data("bs.scrollspy"),a="object"==typeof t&&t;o||r.data("bs.scrollspy",o=new e(this,a)),"string"==typeof t&&o[t]()})}e.VERSION="3.3.6",e.DEFAULTS={offset:10},e.prototype.getScrollHeight=function(){return this.$scrollElement[0].scrollHeight||Math.max(this.$body[0].scrollHeight,document.documentElement.scrollHeight)},e.prototype.refresh=function(){var e=this,t="offset",r=0;this.offsets=[],this.targets=[],this.scrollHeight=this.getScrollHeight(),n.isWindow(this.$scrollElement[0])||(t="position",r=this.$scrollElement.scrollTop()),this.$body.find(this.selector).map(function(){var e=n(this),o=e.data("target")||e.attr("href"),a=/^#./.test(o)&&n(o);return a&&a.length&&a.is(":visible")&&[[a[t]().top+r,o]]||null}).sort(function(n,e){return n[0]-e[0]}).each(function(){e.offsets.push(this[0]),e.targets.push(this[1])})},e.prototype.process=function(){var n,e=this.$scrollElement.scrollTop()+this.options.offset,t=this.getScrollHeight(),r=this.options.offset+t-this.$scrollElement.height(),o=this.offsets,a=this.targets,i=this.activeTarget;if(this.scrollHeight!=t&&this.refresh(),e>=r)return i!=(n=a[a.length-1])&&this.activate(n);if(i&&e<o[0])return this.activeTarget=null,this.clear();for(n=o.length;n--;)i!=a[n]&&e>=o[n]&&(void 0===o[n+1]||e<o[n+1])&&this.activate(a[n])},e.prototype.activate=function(e){this.activeTarget=e,this.clear();var t=this.selector+'[data-target="'+e+'"],'+this.selector+'[href="'+e+'"]',r=n(t).parents("li").addClass("active");r.parent(".dropdown-menu").length&&(r=r.closest("li.dropdown").addClass("active")),r.trigger("activate.bs.scrollspy")},e.prototype.clear=function(){n(this.selector).parentsUntil(this.options.target,".active").removeClass("active")};var r=n.fn.scrollspy;n.fn.scrollspy=t,n.fn.scrollspy.Constructor=e,n.fn.scrollspy.noConflict=function(){
return n.fn.scrollspy=r,this},n(window).on("load.bs.scrollspy.data-api",function(){n('[data-spy="scroll"]').each(function(){var e=n(this);t.call(e,e.data())})})}(jQuery),+function(n){"use strict";function e(e){return this.each(function(){var r=n(this),o=r.data("bs.tab");o||r.data("bs.tab",o=new t(this)),"string"==typeof e&&o[e]()})}var t=function(e){this.element=n(e)};t.VERSION="3.3.6",t.TRANSITION_DURATION=150,t.prototype.show=function(){var e=this.element,t=e.closest("ul:not(.dropdown-menu)"),r=e.data("target");if(r||(r=e.attr("href"),r=r&&r.replace(/.*(?=#[^\s]*$)/,"")),!e.parent("li").hasClass("active")){var o=t.find(".active:last a"),a=n.Event("hide.bs.tab",{relatedTarget:e[0]}),i=n.Event("show.bs.tab",{relatedTarget:o[0]});if(o.trigger(a),e.trigger(i),!i.isDefaultPrevented()&&!a.isDefaultPrevented()){var u=n(r);this.activate(e.closest("li"),t),this.activate(u,u.parent(),function(){o.trigger({type:"hidden.bs.tab",relatedTarget:e[0]}),e.trigger({type:"shown.bs.tab",relatedTarget:o[0]})})}}},t.prototype.activate=function(e,r,o){function a(){i.removeClass("active").find("> .dropdown-menu > .active").removeClass("active").end().find('[data-toggle="tab"]').attr("aria-expanded",!1),e.addClass("active").find('[data-toggle="tab"]').attr("aria-expanded",!0),u?(e[0].offsetWidth,e.addClass("in")):e.removeClass("fade"),e.parent(".dropdown-menu").length&&e.closest("li.dropdown").addClass("active").end().find('[data-toggle="tab"]').attr("aria-expanded",!0),o&&o()}var i=r.find("> .active"),u=o&&n.support.transition&&(i.length&&i.hasClass("fade")||!!r.find("> .fade").length);i.length&&u?i.one("bsTransitionEnd",a).emulateTransitionEnd(t.TRANSITION_DURATION):a(),i.removeClass("in")};var r=n.fn.tab;n.fn.tab=e,n.fn.tab.Constructor=t,n.fn.tab.noConflict=function(){return n.fn.tab=r,this};var o=function(t){t.preventDefault(),e.call(n(this),"show")};n(document).on("click.bs.tab.data-api",'[data-toggle="tab"]',o).on("click.bs.tab.data-api",'[data-toggle="pill"]',o)}(jQuery),+function(n){"use strict";function e(e){return this.each(function(){var r=n(this),o=r.data("bs.affix"),a="object"==typeof e&&e;o||r.data("bs.affix",o=new t(this,a)),"string"==typeof e&&o[e]()})}var t=function(e,r){this.options=n.extend({},t.DEFAULTS,r),this.$target=n(this.options.target).on("scroll.bs.affix.data-api",n.proxy(this.checkPosition,this)).on("click.bs.affix.data-api",n.proxy(this.checkPositionWithEventLoop,this)),this.$element=n(e),this.affixed=null,this.unpin=null,this.pinnedOffset=null,this.checkPosition()};t.VERSION="3.3.6",t.RESET="affix affix-top affix-bottom",t.DEFAULTS={offset:0,target:window},t.prototype.getState=function(n,e,t,r){var o=this.$target.scrollTop(),a=this.$element.offset(),i=this.$target.height();if(null!=t&&"top"==this.affixed)return t>o?"top":!1;if("bottom"==this.affixed)return null!=t?o+this.unpin<=a.top?!1:"bottom":n-r>=o+i?!1:"bottom";var u=null==this.affixed,c=u?o:a.top,l=u?i:e;return null!=t&&t>=o?"top":null!=r&&c+l>=n-r?"bottom":!1},t.prototype.getPinnedOffset=function(){if(this.pinnedOffset)return this.pinnedOffset;this.$element.removeClass(t.RESET).addClass("affix");var n=this.$target.scrollTop(),e=this.$element.offset();return this.pinnedOffset=e.top-n},t.prototype.checkPositionWithEventLoop=function(){setTimeout(n.proxy(this.checkPosition,this),1)},t.prototype.checkPosition=function(){if(this.$element.is(":visible")){var e=this.$element.height(),r=this.options.offset,o=r.top,a=r.bottom,i=Math.max(n(document).height(),n(document.body).height());"object"!=typeof r&&(a=o=r),"function"==typeof o&&(o=r.top(this.$element)),"function"==typeof a&&(a=r.bottom(this.$element));var u=this.getState(i,e,o,a);if(this.affixed!=u){null!=this.unpin&&this.$element.css("top","");var c="affix"+(u?"-"+u:""),l=n.Event(c+".bs.affix");if(this.$element.trigger(l),l.isDefaultPrevented())return;this.affixed=u,this.unpin="bottom"==u?this.getPinnedOffset():null,this.$element.removeClass(t.RESET).addClass(c).trigger(c.replace("affix","affixed")+".bs.affix")}"bottom"==u&&this.$element.offset({top:i-e-a})}};var r=n.fn.affix;n.fn.affix=e,n.fn.affix.Constructor=t,n.fn.affix.noConflict=function(){return n.fn.affix=r,this},n(window).on("load",function(){n('[data-spy="affix"]').each(function(){var t=n(this),r=t.data();r.offset=r.offset||{},null!=r.offsetBottom&&(r.offset.bottom=r.offsetBottom),null!=r.offsetTop&&(r.offset.top=r.offsetTop),e.call(t,r)})})}(jQuery);